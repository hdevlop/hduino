module.exports=[30859,a=>{a.v({className:"oxanium_cba7ab5a-module__kZukpG__className",variable:"oxanium_cba7ab5a-module__kZukpG__variable"})},14079,a=>{a.v({className:"fira_code_3f70985c-module__TKBd-W__className",variable:"fira_code_3f70985c-module__TKBd-W__variable"})},65386,a=>{"use strict";a.s(["AppProvider",()=>b]);let b=(0,a.i(74819).registerClientReference)(function(){throw Error("Attempted to call AppProvider() from the server but AppProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/providers/AppProvider.tsx <module evaluation>","AppProvider")},24536,a=>{"use strict";a.s(["AppProvider",()=>b]);let b=(0,a.i(74819).registerClientReference)(function(){throw Error("Attempted to call AppProvider() from the server but AppProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/providers/AppProvider.tsx","AppProvider")},53549,a=>{"use strict";a.i(65386);var b=a.i(24536);a.n(b)},46179,(a,b,c)=>{!function(c,d){if("function"==typeof define&&define.amd){let b;void 0!==(b=d())&&a.v(b)}else b.exports=d()}(a.e,function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B={};ai=function(a,b,c,d){if(!(a instanceof F)&&"string"!=typeof a||""===`${a}`.trim())throw Error('Invalid type "'+a+'". The type must be a non-empty string or a Blockly.registry.Type.');if(a=`${a}`.toLowerCase(),"string"!=typeof b||""===b.trim())throw Error('Invalid name "'+b+'". The name must be a non-empty string.');let e=b.toLowerCase();if(!c)throw Error("Can not register a null value");let f=C[a],g=D[a];if(f||(f=C[a]=Object.create(null),g=D[a]=Object.create(null)),aj(a,c),!d&&f[e]&&f[e]!==c)throw Error('Name "'+e+'" with type "'+a+'" already registered.');f[e]=c,g[e]=b},aj=function(a,b){if(a===String(F.FIELD)&&"function"!=typeof b.fromJson)throw Error('Type "'+a+'" must have a fromJson function')},ak=function(a,b){a=`${a}`.toLowerCase(),b=b.toLowerCase();let c=C[a];c&&c[b]?(delete C[a][b],delete D[a][b]):console.warn("Unable to unregister ["+b+"]["+a+"] from the registry.")},al=function(a,b,c){a=`${a}`.toLowerCase(),b=b.toLowerCase();let d=C[a];if(!d||!d[b]){if(b="Unable to find ["+b+"]["+a+"] in the registry.",c)throw Error(b+" You must require or register a "+a+" plugin.");return console.warn(b),null}return d[b]},am=function(a,b){return a=`${a}`.toLowerCase(),b=b.toLowerCase(),!!(a=C[a])&&!!a[b]},an=function(a,b,c){return al(a,b,c)},ao=function(a,b,c){return al(a,b,c)},ap=function(a,b,c){var d=C[a=`${a}`.toLowerCase()];if(!d){if(d=`Unable to find [${a}] in the registry.`,c)throw Error(`${d} You must require or register a ${a} plugin.`);return console.warn(d),null}if(!b)return d;for(let b of(a=D[a],c=Object.create(null),Object.keys(d)))c[a[b]]=d[b];return c},aq=function(a,b,c){return"function"==typeof(b=b.plugins[String(a)]||E)?b:an(a,b,c)},ar=function(a,b){as(),M=setTimeout(function(){b&&b.handleRightClick(a)},I)},as=function(){M&&(clearTimeout(M),M=0)},at=function(){K=null},au=function(a){return!a.type.startsWith("pointer")||a instanceof PointerEvent&&aw(a)},av=function(a){return`${a.pointerId}`},aw=function(a){let b=av(a);return K?K===b:"pointerdown"===a.type&&(K=b,!0)},ax=function(a,b,c,d,e){function f(a){(e||au(a))&&(c?d.call(c,a):d(a))}let g=[];if(b in L)for(let c=0;c<L[b].length;c++){let d=L[b][c];a.addEventListener(d,f,!1),g.push([a,d,f])}else a.addEventListener(b,f,!1),g.push([a,b,f]);return g},ay=function(a,b,c,d){function e(a){c?d.call(c,a):d(a)}let f=[];if(b in L)for(let c=0;c<L[b].length;c++){let d=L[b][c];a.addEventListener(d,e,!1),f.push([a,d,e])}else a.addEventListener(b,e,!1),f.push([a,b,e]);return f},az=function(a){let b=a[a.length-1][2];for(;a.length;){let[b,c,d]=a.pop();b.removeEventListener(c,d,!1)}return b},aA=function(a){if(a.target instanceof HTMLElement){if(a.target.isContentEditable||"true"===a.target.getAttribute("data-is-text-input"))return!0;if(a.target instanceof HTMLInputElement)return"text"===(a=a.target).type||"number"===a.type||"email"===a.type||"password"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type;if(a.target instanceof HTMLTextAreaElement)return!0}return!1},aB=function(a){return!!a.ctrlKey&&!!S||2===a.button},aC=function(a,b,c){let d=b.createSVGPoint();return d.x=a.clientX,d.y=a.clientY,c||(c=b.getScreenCTM().inverse()),d.matrixTransform(c)},aD=function(a){switch(a.deltaMode){default:return{x:a.deltaX,y:a.deltaY};case 1:return{x:a.deltaX*T,y:a.deltaY*T};case 2:return{x:a.deltaX*U,y:a.deltaY*U}}},aE=function(){return"blockly-"+(Z++).toString(36)},aF=function(){return Y.genUid()},aG=function(a){return a.type===gB.BLOCK_CREATE},aH=function(a){return a.type===gB.BLOCK_DELETE},aI=function(a){return a.type===gB.BLOCK_CHANGE},aJ=function(a){return a.type===gB.BLOCK_FIELD_INTERMEDIATE_CHANGE},aK=function(a){return a.type===gB.BLOCK_MOVE},aL=function(a){return a.type===gB.CLICK},aM=function(a){return a.type===gB.BUBBLE_OPEN},aN=function(a){return a.type===gB.VIEWPORT_CHANGE},B.setRecordUndo$$module$build$src$core$events$utils=function(a){ab=a},aO=function(){return ab},aP=function(a){af.fireInternal(a)},aQ=function(){let a=aS(ae);for(let b of(ae.length=0,a)){let a;b.workspaceId&&(null==(a=bd(b.workspaceId))||a.fireChangeListener(b))}},aR=function(a){if(aI(a)&&"mutation"===a.element){let b;for(b=ae.length;b>0;b--){let c=ae[b-1];if(c.group!==a.group||c.workspaceId!==a.workspaceId||!aK(c)||c.newParentId!==a.blockId)break}ae.splice(b,0,a)}else ae.push(a)},aS=function(a){let b=[];for(let c of a)if(a=b[b.length-1],!c.isNull())if(a&&a.workspaceId===c.workspaceId&&a.group===c.group)if(aK(c)&&aK(a)&&c.blockId===a.blockId){if(a.newParentId=c.newParentId,a.newInputName=c.newInputName,a.newCoordinate=c.newCoordinate,a.reason||c.reason){let b,d;a.reason=Array.from(new Set((null!=(b=a.reason)?b:[]).concat(null!=(d=c.reason)?d:[])))}}else aI(c)&&aI(a)&&c.blockId===a.blockId&&c.element===a.element&&c.name===a.name?a.newValue=c.newValue:aN(c)&&aN(a)?(a.viewTop=c.viewTop,a.viewLeft=c.viewLeft,a.scale=c.scale,a.oldScale=c.oldScale):aL(c)&&aM(a)||b.push(c);else b.push(c);return b.filter(a=>!a.isNull())},aT=function(){for(let a=0,b;b=ae[a];a++)b.recordUndo=!1},B.disable$$module$build$src$core$events$utils=function(){ac++},B.enable$$module$build$src$core$events$utils=function(){ac--},aU=function(){return 0===ac},B.getGroup$$module$build$src$core$events$utils=function(){return aa},B.setGroup$$module$build$src$core$events$utils=function(a){af.setGroupInternal(a)},aV=function(a){let b=[];a=a.getDescendants(!1);for(let c=0,d;d=a[c];c++)b[c]=d.id;return b},aW=function(a,b){let c=aX(a.type);if(!c)throw Error("Unknown event type.");return c.fromJson(a,b)},aX=function(a){let b=an(F.EVENT,a);if(!b)throw Error(`Event type ${a} not found in registry.`);return b},aY=function(a){if((aK(a)||aG(a))&&a.workspaceId){var b=bd(a.workspaceId);if(!a.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(a=b.getBlockById(a.blockId)){let c=ab;try{ab=!1;let c=a.getParent();if(c&&!c.hasDisabledReason(ad)){let b=a.getDescendants(!1);for(let a=0,c;c=b[a];a++)c.setDisabledReason(!1,ad)}else if((a.outputConnection||a.previousConnection)&&!b.isDragging())do a.setDisabledReason(!0,ad),a=a.getNextBlock();while(a)}finally{ab=c}}}},aZ=function(a,b,c){for(let c in a=document.createElementNS(gD,`${a}`),b)a.setAttribute(c,`${b[c]}`);return c&&c.appendChild(a),a},a$=function(a,b){return!(b=b.split(" ")).every(b=>a.classList.contains(b))&&(a.classList.add(...b),!0)},a_=function(a,b){a.classList.remove(...b.split(" "))},a0=function(a,b){return!(b=b.split(" ")).every(b=>!a.classList.contains(b))&&(a.classList.remove(...b),!0)},a1=function(a,b){return a.classList.contains(b)},a2=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null},a3=function(a,b){let c=b.nextSibling;if(!(b=b.parentNode))throw Error("Reference node has no parent.");c?b.insertBefore(a,c):b.appendChild(a)},a4=function(a,b){a.style.transform=b,a.style["-webkit-transform"]=b},a5=function(){gH++,gG||(gG=Object.create(null))},a6=function(){--gH||(gG=null)},a7=function(a){var b;let c=a.textContent+"\n"+a.className.baseVal;return gG&&(b=gG[c])||(b=window.getComputedStyle(a),b=a8(a,b.fontSize,b.fontWeight,b.fontFamily),gG&&(gG[c]=b)),b},a8=function(a,b,c,d){var e;let f=a.textContent;return a=f+"\n"+a.className.baseVal,gG&&(e=gG[a])||(gI||((e=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(e),gI=e.getContext("2d")),f&&gI?(gI.font=c+" "+b+" "+d,e=gI.measureText(f).width):e=0,gG&&(gG[a]=e)),e},a9=function(a,b,c,d){let e=document.createElement("span");e.style.font=c+" "+b+" "+d,e.textContent=a,(a=document.createElement("div")).style.width="1px",a.style.height="0",(b=document.createElement("div")).style.display="flex",b.style.position="fixed",b.style.top="0",b.style.left="0",b.appendChild(e),b.appendChild(a),document.body.appendChild(b),c={height:0,baseline:0};try{b.style.alignItems="baseline",c.baseline=a.offsetTop-e.offsetTop,b.style.alignItems="flex-end",c.height=a.offsetTop-e.offsetTop}finally{document.body.removeChild(b)}return c},B.getFocusManager$$module$build$src$core$focus_manager=function(){return gM.getFocusManager()},ba=function(a){return a&&"function"==typeof a.getFocusableElement&&"function"==typeof a.getFocusableTree&&"function"==typeof a.onNodeFocus&&"function"==typeof a.onNodeBlur&&"function"==typeof a.canBeFocused},bb=function(a){return ba(a)&&"string"==typeof a.id&&"object"==typeof a.workspace&&"function"==typeof a.select&&"function"==typeof a.unselect},bc=function(a,b){for(let c in b)null!==b[c]&&Array.isArray(b[c])?a[c]=bc(a[c]||[],b[c]):a[c]=null!==b[c]&&"object"==typeof b[c]?bc(a[c]||Object.create(null),b[c]):b[c];return a},bd=function(a){return gU[a]||null},be=function(){let a=[];for(let b in gU)a.push(gU[b]);return a},bf=function(a){gU[a.id]=a},bg=function(a){delete gU[a.id]},bh=function(){return gS},bi=function(a){gS=a},bj=function(){let a=B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return a&&bb(a)?a:null},bk=function(a){let b,c,d,e,f=bj();aP(new(aX(gB.SELECTED))(null!=(b=null==f?void 0:f.id)?b:null,null!=(c=null==a?void 0:a.id)?c:null,null!=(e=null!=(d=null==a?void 0:a.workspace.id)?d:null==f?void 0:f.workspace.id)?e:""))},bl=function(){return gT},bm=function(a){gT=a},bn=function(a){for(;a.options.parentWorkspace;)a=a.options.parentWorkspace;let b=a.getParentSvg(),c=a.getCachedParentSvgSize();var d=b.parentElement;if(d instanceof HTMLElement){var e=d.offsetWidth;d=d.offsetHeight,c.width!==e&&(b.setAttribute("width",e+"px"),a.setCachedParentSvgSize(e,null)),c.height!==d&&(b.setAttribute("height",d+"px"),a.setCachedParentSvgSize(null,d)),a.resize()}},bo=function(a,b){let c=Object.create(null),d=a.getDescendants(!0);b&&(a=a.getNextBlock())&&(a=d.indexOf(a),d.splice(a,d.length-a));for(let a=0,b;b=d[a];a++)c[b.type]?c[b.type]++:c[b.type]=1;return c},bp=function(a){return function(){this.jsonInit(a)}},bq=function(a){gW.defineBlocksWithJsonArrayInternal(a)},B.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(a){let b={};for(let c=0;c<a.length;c++){let d=a[c];if(!d){console.warn(`Block definition #${c} in JSON array is ${d}. Skipping`);continue}let e=d.type;e?b[e]={init:bp(d)}:console.warn(`Block definition #${c} in JSON array is missing a type attribute. Skipping.`)}return b},B.defineBlocks$$module$build$src$core$common=function(a){for(let b of Object.keys(a)){let c=a[b];b in H&&console.warn(`Block definition "${b}" overwrites previous definition.`),H[b]=c}},br=function(a){let b=bh(),c=B.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(let a of be())if(c===a){b=a;break}!aA(a)&&b&&(!b.rendered||b.isFlyout||b.isVisible())&&gP.registry.onKeyDown(b,a)},bs=function(a,b){return -1!==(b=a.indexOf(b))&&(a.splice(b,1),!0)},bt=function(a){if(g6)throw Error("CSS already injected");g7+="\n"+a},bu=function(a,b){g6||(g6=!0,a&&(a=b.replace(/[\\/]$/,""),b=g7.replace(/<<<PATH>>>/g,a),g7="",(a=document.createElement("style")).id="blockly-common-style",b=document.createTextNode(b),a.appendChild(b),document.head.insertBefore(a,document.head.firstChild)))},bv=function(a){return hd.getSizeInternal(a)},bw=function(a){return new hc(a.offsetWidth,a.offsetHeight)},bx=function(a,b){return(a=window.getComputedStyle(a))[b]||a.getPropertyValue(b)},by=function(a){let b=new g9(0,0);a=a.getBoundingClientRect();var c=document.documentElement;return c=new g9(window.pageXOffset||c.scrollLeft,window.pageYOffset||c.scrollTop),b.x=a.left+c.x,b.y=a.top+c.y,b},bz=function(){let a=document.body,b=document.documentElement;return new g9(a.scrollLeft||b.scrollLeft,a.scrollTop||b.scrollTop)},bA=function(a){let b=parseFloat(bx(a,"borderLeftWidth")),c=parseFloat(bx(a,"borderRightWidth"));return new hb(parseFloat(bx(a,"borderTopWidth")),a=parseFloat(bx(a,"borderBottomWidth")),b,c)},bB=function(a,b,c){a=bC(a,b,c),b.scrollLeft=a.x,b.scrollTop=a.y},bC=function(a,b,c){var d=by(a),e=by(b),f=bA(b);let g=d.x-e.x-f.left;return d=d.y-e.y-f.top,e=bw(a),a=b.clientWidth-e.width,e=b.clientHeight-e.height,f=b.scrollLeft,b=b.scrollTop,c?(f+=g-a/2,b+=d-e/2):(f+=Math.min(g,Math.max(g-a,0)),b+=Math.min(d,Math.max(d-e,0))),new g9(f,b)},bD=function(a){let b=new g9(0,0);var c=a.x&&a.getAttribute("x");let d=a.y&&a.getAttribute("y");return c&&(b.x=parseInt(c)),d&&(b.y=parseInt(d)),(c=(c=a.getAttribute("transform"))&&c.match(hf))&&(b.x+=Number(c[1]),c[3]&&(b.y+=Number(c[3]))),(a=a.getAttribute("style"))&&a.includes("translate")&&(a=a.match(hg))&&(b.x+=Number(a[1]),a[3]&&(b.y+=Number(a[3]))),b},bE=function(a){let b=0,c=0;for(;a;){let d=bD(a);if(b+=d.x,c+=d.y,(" "+(a.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;a=a.parentNode}return new g9(b,c)},bF=function(){let a=bz();return new hb(a.y,document.documentElement.clientHeight+a.y,a.x,document.documentElement.clientWidth+a.x)},bG=function(){let a=document.documentElement,b=window;return new g9(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)},bH=function(a,b){var c=b.x;b=b.y;let d=a.getInjectionDiv().getBoundingClientRect();return c=new g9(c-d.left,b-d.top),b=a.getOriginOffsetInPixels(),g9.difference(c,b).scale(1/a.scale)},bI=function(a,b){var c=b.scale(a.scale);b=c.x,c=c.y;let d=a.getInjectionDiv().getBoundingClientRect();return a=a.getOriginOffsetInPixels(),new g9(b+d.left+a.x,c+d.top+a.y)},B.createElement$$module$build$src$core$utils$xml=function(a){return hl.createElementNS(ho,a)},B.createTextNode$$module$build$src$core$utils$xml=function(a){return hl.createTextNode(a)},B.textToDom$$module$build$src$core$utils$xml=function(a){let b=hj.parseFromString(a,"text/xml");if(b&&b.documentElement&&!b.getElementsByTagName("parsererror").length)return b.documentElement;if((b=hj.parseFromString(a,"text/html"))&&b.body.firstChild&&"xml"===b.body.firstChild.nodeName.toLowerCase())return b.body.firstChild;throw Error(`DOMParser was unable to parse: ${a}`)},bJ=function(a){return bK(hk.serializeToString(a))},bK=function(a){return a.replace(hp,a=>`&#${a.charCodeAt(0)};`)},bL=function(a){return a?((a instanceof Element||"string"==typeof a)&&(a=bT(a),a=bQ(a)),bM(a),a):null},bM=function(a){let b=a.kind;if(a=a.contents,b&&b!==hv&&b!==hu)throw Error("Invalid toolbox kind "+b+". Please supply either "+hv+" or "+hu);if(!a)throw Error("Toolbox must have a contents attribute.")},bN=function(a){return a?a.contents?a.contents:Array.isArray(a)&&a.length>0&&!a[0].nodeType?a:bR(a):[]},bO=function(a){return hw.hasCategoriesInternal(a)},bP=function(a){return!!a&&!!a.contents&&!!a.contents.filter(function(a){return"CATEGORY"===a.kind.toUpperCase()}).length},bQ=function(a){let b={contents:bR(a)};return a instanceof Node&&bS(a,b),b},bR=function(a){let b=[],c=a.childNodes;c||(c=a);for(let d=0,e;e=c[d];d++){if(!e.tagName)continue;a={};let c=e.tagName.toUpperCase();a.kind=c,"BLOCK"===c?a.blockxml=e:e.childNodes&&e.childNodes.length>0&&(a.contents=bR(e)),bS(e,a),b.push(a)}return b},bS=function(a,b){for(let c=0;c<a.attributes.length;c++){let d=a.attributes[c];d.nodeName.includes("css-")?(b.cssconfig=b.cssconfig||{},b.cssconfig[d.nodeName.replace("css-","")]=d.value):b[d.nodeName]=d.value}},bT=function(a){let b=null;if(a)if("string"==typeof a){if("xml"!==(b=B.textToDom$$module$build$src$core$utils$xml(a)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else a instanceof Element&&(b=a);return b},bU=function(a,b,c,d,e,f){let g=f.scrollbar&&f.scrollbar.canScrollVertically();return a.horizontal===hL.LEFT?(c=e.absoluteMetrics.left+c,g&&f.RTL&&(c+=hi.scrollbarThickness)):(c=e.absoluteMetrics.left+e.viewMetrics.width-b.width-c,g&&!f.RTL&&(c-=hi.scrollbarThickness)),a.vertical===hK.TOP?a=e.absoluteMetrics.top+d:(a=e.absoluteMetrics.top+e.viewMetrics.height-b.height-d,f.scrollbar&&f.scrollbar.canScrollHorizontally()&&(a-=hi.scrollbarThickness)),new hb(a,a+b.height,c,c+b.width)},bV=function(a,b){return{horizontal:b.toolboxMetrics.position===ht.LEFT||a.horizontalLayout&&!a.RTL?hL.RIGHT:hL.LEFT,vertical:b.toolboxMetrics.position===ht.BOTTOM?hK.TOP:hK.BOTTOM}},bW=function(a,b,c,d){let e=a.left,f=a.right-a.left,g=a.bottom-a.top;for(let h=0;h<d.length;h++){let i=d[h];a.intersects(i)&&(a=new hb(a=c===hM.UP?i.top-g-b:i.bottom+b,a+g,e,e+f),h=-1)}return a},bX=function(a,b){ai(F.SERIALIZER,a,b)},bY=function(a,{addCoordinates:b=!1,saveIds:c=!0}={}){let d=a.workspace,e=Object.create(null);return e.height=a.getSize().height,e.width=a.getSize().width,c&&(e.id=a.id),b&&(b=a.getRelativeToSurfaceXY(),e.x=d.RTL?d.getWidth()-b.x:b.x,e.y=b.y),a.getText()&&(e.text=a.getText()),a.isCollapsed()&&(e.collapsed=!0),a.isOwnEditable()||(e.editable=!1),a.isOwnMovable()||(e.movable=!1),a.isOwnDeletable()||(e.deletable=!1),e},bZ=function(a,b,{recordUndo:c=!1}={}){let d=aO();if(B.setRecordUndo$$module$build$src$core$events$utils(c),c=b.newComment(a.id),void 0!==a.text&&c.setText(a.text),void 0!==a.x||void 0!==a.y){var e;let d=c.getRelativeToSurfaceXY(),f,g=null!=(f=a.x)?f:d.x;g=b.RTL?b.getWidth()-g:g,b=null!=(e=a.y)?e:d.y,c.moveTo(new g9(g,b))}if(void 0!==a.width||a.height){let b,d;e=c.getSize(),c.setSize(new hc(null!=(b=a.width)?b:e.width,null!=(d=a.height)?d:e.height))}return void 0!==a.collapsed&&c.setCollapsed(a.collapsed),void 0!==a.editable&&c.setEditable(a.editable),void 0!==a.movable&&c.setMovable(a.movable),void 0!==a.deletable&&c.setDeletable(a.deletable),B.setRecordUndo$$module$build$src$core$events$utils(d),c},b$=function(a,b){ai(F.PASTER,a,b)},b_=function(a){let b=a.workspace,c=a.getRelativeToSurfaceXY(),d=new g9(0,0),e=b.getTopComments(!1).filter(b=>b.id!==a.id).map(a=>a.getRelativeToSurfaceXY());for(;b0(g9.sum(c,d),e);)d.translate(b.RTL?-30:30,30);a.moveTo(g9.sum(c,d))},b0=function(a,b){return b.some(b=>1>=Math.abs(b.x-a.x)&&1>=Math.abs(b.y-a.y))},b1=function(a,b){a.setAttribute(hP,b)},b2=function(a,b,c){Array.isArray(c)&&(c=c.join(" ")),a.setAttribute(hO+b,`${c}`)},b3=function(a){return a&&"function"==typeof a.saveState&&"function"==typeof a.loadState},b4=function(a){return(b8(a),b7())?(b9(),Promise.resolve()):(h$||(h$=new Promise(a=>{h_=a,h0=window.requestAnimationFrame(()=>{b9(),a()})})),h$)},b5=function(){return h$||Promise.resolve()},b6=function(a){a||window.cancelAnimationFrame(h0),b9(a),!a&&h_&&h_()},b7=function(){return R},b8=function(a){hY.add(a),hZ.set(a,B.getGroup$$module$build$src$core$events$utils());let b=a.getParent();b?b8(b):hX.add(a)},b9=function(a){let b=new Set(a?[a]:[...hX].map(a=>a.workspace)),c=[...hX].filter(cb).filter(a=>b.has(a.workspace));for(var d of c)cc(d);for(let a of b)a.resizeContents();for(var e of c)d=e.getRelativeToSurfaceXY(),e.updateComponentLocations(d);for(let a of c)e=B.getGroup$$module$build$src$core$events$utils(),(d=hZ.get(a))&&B.setGroup$$module$build$src$core$events$utils(d),a.bumpNeighbours(),B.setGroup$$module$build$src$core$events$utils(e);for(let a of c)ca(a);a||(h$=null)},ca=function(a){for(let b of(hX.delete(a),hY.delete(a),hZ.delete(a),a.getChildren(!1)))ca(b)},cb=function(a){return!a.isDisposed()&&!a.getParent()},cc=function(a){if(hY.has(a)&&a.initialized){for(let b of a.getChildren(!1))cc(b);a.renderEfficiently()}},cd=function(a,b){h7(a,b)},ce=function(a,b){h9(a,b)},cf=function(a,b,c){ib(a,b,c)},cg=function(a){return a&&"function"==typeof a.getProcedureDef},ch=function(a){return a&&"function"==typeof a.getProcedureCall&&"function"==typeof a.renameProcedure},ci=function(a){return void 0!==a.getVariableModel},cj=function(a,b,c,d){a=a+" was deprecated in "+b+" and will be deleted in "+c+".",d&&(a+="\nUse "+d+" instead."),ih.has(a)||(ih.add(a),console.warn(a))},B.allUsedVarModels$$module$build$src$core$variables=function(a){a=a.getAllBlocks(!1);let b=new Set;for(let c=0;c<a.length;c++){let d=a[c].getVarModels();if(d)for(let a=0;a<d.length;a++){let c=d[a];c.getId()&&b.add(c)}}return Array.from(b.values())},B.allDeveloperVariables$$module$build$src$core$variables=function(a){a=a.getAllBlocks(!1);let b=new Set;for(let d=0,e;e=a[d];d++){var c=e.getDeveloperVariables;if(c){c=c();for(let a=0;a<c.length;a++)b.add(c[a])}}return Array.from(b.values())},ck=function(a){return cl(a,!1)},cl=function(a,b=!0){return(H.variables_set||H.variables_get||console.warn("There are no variable blocks, but there is a variable category."),b)?(cj("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),co(a)):(a.registerButtonCallback("CREATE_VARIABLE",function(a){cs(a.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...cn(a,a.getVariableMap().getVariablesOfType(""),!0)])},cm=function(a){return{VAR:{name:a.getName(),type:a.getType()}}},cn=function(a,b,c,d="variables_get",e="variables_set"){c&&(c=H.math_change),a=[];let f=b.slice(-1)[0];return f&&(H[e]&&a.push({kind:"block",type:e,gap:c?8:24,fields:cm(f)}),c&&a.push({kind:"block",type:"math_change",gap:H[d]?20:8,fields:cm(f),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}})),H[d]&&a.push(...b.sort(cC).map(a=>({kind:"block",type:d,gap:8,fields:cm(a)}))),a},co=function(a){let b=[],c=document.createElement("button");return c.setAttribute("text","%{BKY_NEW_VARIABLE}"),c.setAttribute("callbackKey","CREATE_VARIABLE"),a.registerButtonCallback("CREATE_VARIABLE",function(a){cs(a.getTargetWorkspace())}),b.push(c),b.concat(a=cp(a))},cp=function(a){a=a.getVariableMap().getVariablesOfType("");let b=[];if(a.length>0){var c=a[a.length-1];if(H.variables_set){var d=B.createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","variables_set"),d.setAttribute("gap",H.math_change?"8":"24"),d.appendChild(cz(c)),b.push(d)}if(H.math_change&&((d=B.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),d.setAttribute("gap",H.variables_get?"20":"8"),d.appendChild(cz(c)),c=B.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),d.appendChild(c),b.push(d)),H.variables_get){a.sort(cC);for(let d=0,e;e=a[d];d++)(c=B.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),c.setAttribute("gap","8"),c.appendChild(cz(e)),b.push(c)}}return b},cq=function(a){return il.generateUniqueNameInternal(a)},cr=function(a,b){if(!b.length)return a;let c="",d=ik.indexOf(a);for(;;){let e=!1;for(let c=0;c<b.length;c++)if(b[c].toLowerCase()===a){e=!0;break}if(!e)break;++d===ik.length&&(d=0,c=`${Number(c)+1}`),a=ik.charAt(d)+c}return a},cs=function(a,b,c){let d=c||"";!function c(e){ct(B.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,e,function(e){if(e){var f=cv(e,a);if(f){if(f.getType()===d)var g=B.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",f.getName());else g=(g=B.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",f.getName()).replace("%2",f.getType());cd(g,function(){c(e)})}else a.getVariableMap().createVariable(e,d),b&&b(e)}else b&&b(null)})}("")},B.renameVariable$$module$build$src$core$variables=function(a,b,c){!function d(e){let f=B.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",b.getName());ct(f,e,function(e){if(e){var f=cu(e,b.getType(),a),g=cw(b.getName(),e,a);if(f||g){var h="";f?h=B.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",f.getName()).replace("%2",f.getType()):g&&(h=B.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",e).replace("%2",g)),cd(h,function(){d(e)})}else a.getVariableMap().renameVariable(b,e),c&&c(e)}else c&&c(null)})}("")},ct=function(a,b,c){cf(a,b,function(a){a&&((a=a.replace(/[\s\xa0]+/g," ").trim())===B.Msg$$module$build$src$core$msg.RENAME_VARIABLE||a===B.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(a=null),c(a)})},cu=function(a,b,c){c=c.getVariableMap().getAllVariables(),a=a.toLowerCase();for(let d=0,e;e=c[d];d++)if(e.getName().toLowerCase()===a&&e.getType()!==b)return e;return null},cv=function(a,b){b=b.getVariableMap().getAllVariables(),a=a.toLowerCase();for(let c=0,d;d=b[c];c++)if(d.getName().toLowerCase()===a)return d;return null},cw=function(a,b,c){return c.getProcedureMap().getProcedures().length?cx(a,b,c):cy(a,b,c)},cx=function(a,b,c){for(let e of(a=a.toLowerCase(),b=b.toLowerCase(),c=c.getProcedureMap().getProcedures())){var d=e.getParameters().filter(ci).map(a=>a.getVariableModel().getName());if(d&&(c=d.some(b=>b.toLowerCase()===a),d=d.some(a=>a.toLowerCase()===b),c&&d))return e.getName()}return null},cy=function(a,b,c){for(let e of(a=a.toLowerCase(),b=b.toLowerCase(),c=c.getAllBlocks(!1))){if(!cg(e))continue;var d=(c=e.getProcedureDef())[1];let f=d.some(b=>b.toLowerCase()===a);if(d=d.some(a=>a.toLowerCase()===b),f&&d)return c[0]}return null},cz=function(a){let b=B.createElement$$module$build$src$core$utils$xml("field");return b.setAttribute("name","VAR"),b.setAttribute("id",a.getId()),b.setAttribute("variabletype",a.getType()),a=B.createTextNode$$module$build$src$core$utils$xml(a.getName()),b.appendChild(a),b},B.getOrCreateVariablePackage$$module$build$src$core$variables=function(a,b,c,d){let e=B.getVariable$$module$build$src$core$variables(a,b,c,d);return e||(e=cA(a,b,c,d)),e},B.getVariable$$module$build$src$core$variables=function(a,b,c,d){let e=a.getPotentialVariableMap(),f=null;if(b&&((f=a.getVariableById(b))||!e||(f=e.getVariableById(b)),f))return f;if(c){if(void 0===d)throw Error("Tried to look up a variable by name without a type");(f=a.getVariable(c,d))||!e||(f=e.getVariable(c,d))}return f},cA=function(a,b,c,d){let e=a.getVariableMap(),f=a.getPotentialVariableMap();return c||(c=cq(a.isFlyout?a.targetWorkspace:a)),f?f.createVariable(c,d,null!=b?b:void 0):e.createVariable(c,d,b)},cB=function(a,b){a=a.getAllVariables();let c=[];if(b.length!==a.length)for(let d=0;d<a.length;d++){let e=a[d];b.includes(e)||c.push(e)}return c},cC=function(a,b){return a.getName().localeCompare(b.getName(),void 0,{sensitivity:"base"})},cD=function(a,b){let c=[];a=a.getAllBlocks(!1);for(let d=0;d<a.length;d++){let e=a[d].getVarModels();if(e)for(let f=0;f<e.length;f++)e[f].getId()===b&&c.push(a[d])}return c},B.deleteVariable$$module$build$src$core$variables=function(a,b,c){var d=b.getName();let e=cD(a,b.getId());for(let a=e.length-1;a>=0;a--){let b=e[a];if("procedures_defnoreturn"===b.type||"procedures_defreturn"===b.type){c=String(b.getFieldValue("NAME")),cd(d=B.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",d).replace("%2",c));return}b===c&&e.splice(a,1)}c&&e.length||e.length>1?ce(d=B.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(e.length+(c&&!c.workspace.isFlyout?1:0))).replace("%2",d),c=>{c&&b&&a.getVariableMap().deleteVariable(b)}):a.getVariableMap().deleteVariable(b)},cE=function(a,{addCoordinates:b=!1,addInputBlocks:c=!0,addNextBlocks:d=!0,doFullSerialization:e=!0,saveIds:f=!0}={}){if(a.isInsertionMarker())return null;let g={type:a.type,id:f?a.id:void 0};return b&&cG(a,g),cF(a,g),cH(a,g,e),cI(a,g,e),cJ(a,g,e),c&&cK(a,g,e,f),d&&cL(a,g,e,f),g},cF=function(a,b){a.isCollapsed()&&(b.collapsed=!0),a.isEnabled()||(b.disabledReasons=Array.from(a.getDisabledReasons())),a.isOwnDeletable()||(b.deletable=!1),a.isOwnMovable()||(b.movable=!1),a.isOwnEditable()||(b.editable=!1),void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&(b.inline=a.inputsInline),a.data&&(b.data=a.data)},cG=function(a,b){let c=a.workspace;a=a.getRelativeToSurfaceXY(),b.x=Math.round(c.RTL?c.getWidth()-a.x:a.x),b.y=Math.round(a.y)},cH=function(a,b,c){a.saveExtraState?null!==(a=a.saveExtraState(c))&&(b.extraState=a):a.mutationToDom&&null!==(a=a.mutationToDom())&&(b.extraState=eo(a).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},cI=function(a,b,c){let d=Object.create(null);for(let b of a.getIcons())b3(b)&&(a=b.saveState(c))&&(d[b.getType().toString()]=a);Object.keys(d).length&&(b.icons=d)},cJ=function(a,b,c){let d=Object.create(null);for(let b of a.getFields())b.isSerializable()&&(d[b.name]=b.saveState(c));Object.keys(d).length&&(b.fields=d)},cK=function(a,b,c,d){let e=Object.create(null);for(let b=0;b<a.inputList.length;b++){let f=a.inputList[b];if(!f.connection)continue;let g=cM(f.connection,c,d);g&&(e[f.name]=g)}Object.keys(e).length&&(b.inputs=e)},cL=function(a,b,c,d){a.nextConnection&&(a=cM(a.nextConnection,c,d))&&(b.next=a)},cM=function(a,b,c){let d=a.getShadowState(!0);if(a=a.targetBlock(),!d&&!a)return null;let e=Object.create(null);return d&&(e.shadow=d),a&&!a.isShadow()&&(e.block=cE(a,{doFullSerialization:b,saveIds:c})),e},cN=function(a,b,{recordUndo:c=!1}={}){return a=cO(a,b,{recordUndo:c}),b.rendered&&b6(),a},cO=function(a,b,{parentConnection:c,isShadow:d=!1,recordUndo:e=!1}={}){let f,g=aO();B.setRecordUndo$$module$build$src$core$events$utils(e),(e=B.getGroup$$module$build$src$core$events$utils())||B.setGroup$$module$build$src$core$events$utils(!0),B.disable$$module$build$src$core$events$utils();let h=b.getAllVariables();try{f=cP(a,b,{parentConnection:c,isShadow:d})}finally{B.enable$$module$build$src$core$events$utils()}if(cQ(b,h),aU()&&aP(new(aX(gB.BLOCK_CREATE))(f)),B.setGroup$$module$build$src$core$events$utils(e),B.setRecordUndo$$module$build$src$core$events$utils(g),b.rendered){let a=f;setTimeout(()=>{a.disposed||a.setConnectionTracking(!0)},1)}return f},cP=function(a,b,{parentConnection:c,isShadow:d=!1}={}){if(!a.type)throw new ip(a);let e=b.newBlock(a.type,a.id);return e.setShadow(d),cR(e,a),cS(e,a),cT(e,a),cU(c,e,a),cV(e,a),cW(e,a),cX(e,a),cY(e,a),c$(e,b.rendered),e},cQ=function(a,b){if(aU())for(a=cB(a,b),b=0;b<a.length;b++){let c=a[b];aP(new(aX(gB.VAR_CREATE))(c))}},cR=function(a,b){let c=void 0===b.x?0:b.x;b=void 0===b.y?0:b.y;let d=a.workspace;c=d.RTL?d.getWidth()-c:c,a.moveBy(c,b)},cS=function(a,b){if(b.collapsed&&a.setCollapsed(!0),!1===b.deletable&&a.setDeletable(!1),!1===b.movable&&a.setMovable(!1),!1===b.editable&&a.setEditable(!1),!1===b.enabled&&a.setDisabledReason(!0,hW),Array.isArray(b.disabledReasons))for(let c of b.disabledReasons)a.setDisabledReason(!0,c);void 0!==b.inline&&a.setInputsInline(b.inline),void 0!==b.data&&(a.data=b.data)},cT=function(a,b){b.extraState&&(a.loadExtraState?a.loadExtraState(b.extraState):a.domToMutation&&a.domToMutation(B.textToDom$$module$build$src$core$utils$xml(b.extraState)))},cU=function(a,b,c){if(a){if(a.getSourceBlock().isShadow()&&!b.isShadow())throw new is(c);if(a.type===B.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var d=b.outputConnection;if(!d)throw new iq("output",b,c)}else if(!(d=b.previousConnection))throw new iq("previous",b,c);if(!a.connect(d)){let e=b.workspace.connectionChecker;throw new ir(e.getErrorMessage(e.canConnectWithReason(d,a,!1),d,a),a.type===B.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",b,c)}}},cV=function(a,b){if(b.icons){var c=Object.keys(b.icons);for(let e of c){c=b.icons[e];var d=a.getIcon(e);if(!d){if(!(d=an(F.ICON,e,!1)))throw new it(e,a,b);d=new d(a),a.addIcon(d)}b3(d)&&d.loadState(c)}}},cW=function(a,b){if(b.fields){var c=Object.keys(b.fields);for(let d=0;d<c.length;d++){let e=c[d],f=b.fields[e],g=a.getField(e);g?g.loadState(f):console.warn(`Ignoring non-existant field ${e} in block ${a.type}`)}}},cX=function(a,b){if(b.inputs){var c=Object.keys(b.inputs);for(let d=0;d<c.length;d++){let e=c[d],f=a.getInput(e);if(!f||!f.connection)throw new iq(e,a,b);cZ(f.connection,b.inputs[e])}}},cY=function(a,b){if(b.next){if(!a.nextConnection)throw new iq("next",a,b);cZ(a.nextConnection,b.next)}},cZ=function(a,b){b.shadow&&a.setShadowState(b.shadow),b.block&&cP(b.block,a.getSourceBlock().workspace,{parentConnection:a})},c$=function(a,b){if(b)for(let b of(a.setConnectionTracking(!1),a.initSvg(),a.queueRender(),a.getIcons()))b.onLocationChange(a.getRelativeToSurfaceXY());else a.initModel()},c_=function(a){return"function"==typeof a.bubbleIsVisible&&"function"==typeof a.setBubbleVisible&&"function"==typeof a.getBubble},c0=function(a){return a*Math.PI/180},c1=function(a,b,c){if(c<a){let b=c;c=a,a=b}return Math.max(a,Math.min(b,c))},c2=function(){document.querySelector(".blocklyDropDownDiv")||((iI=document.createElement("div")).className="blocklyDropDownDiv",iI.tabIndex=-1,(bl()||document.body).appendChild(iI),(iJ=document.createElement("div")).className="blocklyDropDownContent",iI.appendChild(iJ),iY=ax(iJ,"keydown",null,br),(iK=document.createElement("div")).className="blocklyDropDownArrow",iI.appendChild(iK),iI.style.opacity="0",iI.style.transition="transform "+iP+"s, opacity "+iP+"s")},c3=function(a){iU=a},c4=function(){return iV},c5=function(){return iJ},c6=function(){iY&&(az(iY),iY=null),iI.remove(),c2()},c7=function(a,b){iI.style.backgroundColor=a,iI.style.borderColor=b},c8=function(a,b,c,d=!0){return iW=!0,db(da(a),a,d,b,c)},c9=function(a){var b=a.getSvgRoot();let c=a.workspace.scale,d=a.height*c;return a=a.width*c,new hb((b=by(b)).y,b.y+d,b.x,b.x+a)},da=function(a){return new hb((a=a.getScaledBBox()).top,a.bottom,a.left,a.right)},db=function(a,b,c,d,e){let f=a.left+(a.right-a.left)/2,g=a.bottom;a=a.top,e&&(a+=e);let h=(e=b.getSourceBlock()).workspace;for(;h.options.parentWorkspace;)h=h.options.parentWorkspace;return c3(h.getParentSvg().parentNode),dc(b,e.RTL,f,g,f,a,c,d)},dc=function(a,b,c,d,e,f,g,h){return iV=a,iR=h||null,iI.style.direction=b?"rtl":"ltr",iS=(a=bh()).getRenderer().getClassName(),iT=a.getTheme().getClassName(),a$(iI,iS),a$(iI,iT),c=dk(c,d,e,f),g&&(iX=B.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(iI)),c},dd=function(a,b,c,d){return{initialX:(a=df(a,c.left,c.right,d.width)).divX,initialY:b,finalX:a.divX,finalY:b+iO,arrowX:a.arrowX,arrowY:-(iL/2+iM),arrowAtTop:!0,arrowVisible:!0}},de=function(a,b,c,d){return{initialX:(a=df(a,c.left,c.right,d.width)).divX,initialY:b-d.height,finalX:a.divX,finalY:b-d.height-iO,arrowX:a.arrowX,arrowY:d.height-2*iM-iL/2,arrowAtTop:!1,arrowVisible:!0}},df=function(a,b,c,d){return b=c1(b,a-d/2,c-d),a=a-iL/2-b,{arrowX:a=c1(c=iN,a,d-c-iL),divX:b}},dg=function(){return!!iV},dh=function(a,b){return iV===a&&(b?dj():di(),!0)},di=function(){iI.style.transform="translate(0, 0)",iI.style.opacity="0",iQ=setTimeout(function(){dj()},1e3*iP),iR&&(iR(),iR=null)},dj=function(){dg()&&(iQ&&clearTimeout(iQ),iR&&(iR(),iR=null),c6(),iV=null,bh().markFocused(),iX&&(iX(),iX=null))},dk=function(a,b,c,d){(a=iZ.getPositionMetrics(a,b,c,d)).arrowVisible?(b=a.arrowX,c=a.arrowY,d=a.arrowAtTop?45:225,iK.style.display="",iK.style.transform=`translate(${b}px, ${c}px) rotate(${d}deg)`,iK.setAttribute("class","blocklyDropDownArrow")):iK.style.display="none",b=Math.floor(a.initialX),c=Math.floor(a.initialY),d=Math.floor(a.finalX);let e=Math.floor(a.finalY);return iI.style.left=b+"px",iI.style.top=c+"px",iI.style.display="block",iI.style.opacity="1",iI.style.transform="translate("+(d-b)+"px,"+(e-c)+"px)",!!a.arrowAtTop},dl=function(){if(iV){var a=iV.getSourceBlock();let b=(a=iW?da(iV):c9(a)).left+(a.right-a.left)/2;dk(b,a.bottom,b,a.top)}else di()},dm=function(a){return a.length?a.reduce(function(a,b){return a.length<b.length?a:b}).length:0},dn=function(a,b){let c;if(!a.length)return 0;if(1===a.length)return a[0].length;let d=0;for(c=0,b=b||dm(a);c<b;c++){for(var e=a[0][c],f=1;f<a.length;f++)if(e!==a[f][c])return d;" "===e&&(d=c+1)}for(e=1;e<a.length;e++)if((f=a[e][c])&&" "!==f)return d;return b},dp=function(a,b){let c;if(!a.length)return 0;if(1===a.length)return a[0].length;let d=0;for(c=0,b=b||dm(a);c<b;c++){for(var e=a[0].substr(-c-1,1),f=1;f<a.length;f++)if(e!==a[f].substr(-c-1,1))return d;" "===e&&(d=c+1)}for(e=1;e<a.length;e++)if((f=a[e].charAt(a[e].length-c-1))&&" "!==f)return d;return b},B.wrap$$module$build$src$core$utils$string=function(a,b){a=a.split("\n");for(let c=0;c<a.length;c++)a[c]=dq(a[c],b);return a.join("\n")},dq=function(a,b){if(a.length<=b)return a;let c=a.trim().split(/\s+/);for(var d=0;d<c.length;d++)c[d].length>b&&(b=c[d].length);var e=-1/0;let f,g=1;do{d=e,f=a,a=[],e=c.length/g;let h=1;for(let b=0;b<c.length-1;b++)h<(b+1.5)/e?(h++,a[b]=!0):a[b]=!1;a=ds(c,a,b),e=dr(c,a,b),a=dt(c,a),g++}while(e>d)return f},dr=function(a,b,c){let d=[0],e=[];for(var f=0;f<a.length;f++)d[d.length-1]+=a[f].length,!0===b[f]?(d.push(0),e.push(a[f].charAt(a[f].length-1))):!1===b[f]&&d[d.length-1]++;for(f=0,a=Math.max(...d),b=0;f<d.length;f++)b-=2*Math.pow(Math.abs(c-d[f]),1.5),b-=Math.pow(a-d[f],1.5),".?!".includes(e[f])?b+=c/3:",;)]}".includes(e[f])&&(b+=c/4);return d.length>1&&d[d.length-1]<=d[d.length-2]&&(b+=.5),b},ds=function(a,b,c){let d=dr(a,b,c),e;for(let f=0;f<b.length-1;f++){if(b[f]===b[f+1])continue;let g=[].concat(b);g[f]=!g[f],g[f+1]=!g[f+1];let h=dr(a,g,c);h>d&&(d=h,e=g)}return e?ds(a,e,c):b},dt=function(a,b){let c=[];for(let d=0;d<a.length;d++)c.push(a[d]),void 0!==b[d]&&c.push(b[d]?"\n":" ");return c.join("")},B.isNumber$$module$build$src$core$utils$string=function(a){return/^\s*-?\d+(\.\d+)?\s*$/.test(a)},du=function(a){if(a=dv(a)){for(a=a.tooltip;"function"==typeof a;)a=a();if("string"!=typeof a)throw Error("Tooltip function must return a string.");return a}return""},dv=function(a){for(;a&&a.tooltip;){if("string"==typeof a.tooltip||"function"==typeof a.tooltip)return a;a=a.tooltip}return null},dw=function(){document.querySelector(".blocklyTooltipDiv")||((jf=document.createElement("div")).className="blocklyTooltipDiv",(bl()||document.body).appendChild(jf))},dx=function(a){a.mouseOverWrapper_=ay(a,"pointerover",null,dz),a.mouseOutWrapper_=ay(a,"pointerout",null,dA),a.addEventListener("pointermove",dB,!1)},dy=function(a){a&&(az(a.mouseOverWrapper_),az(a.mouseOutWrapper_),a.removeEventListener("pointermove",dB))},dz=function(a){i2||(a=dv(a.currentTarget),i8!==a&&(dD(),i9=null,i8=a),clearTimeout(i4))},dA=function(a){i2||(i4=setTimeout(function(){i9=i8=null,dD()},1),clearTimeout(i5),i5=0)},dB=function(a){if(i8&&i8.tooltip&&!i2)if(i1){let b=i6-a.pageX;Math.sqrt(b*b+(a=i7-a.pageY)*a)>jc&&dD()}else i9!==i8&&(clearTimeout(i5),i6=a.pageX,i7=a.pageY,i5=setTimeout(dJ,jd))},dC=function(){i9=i8=null,dD()},dD=function(){i1&&(i1=!1,jf&&(jf.style.display="none")),i5&&(clearTimeout(i5),i5=0)},dE=function(){dD(),i2=!0},dF=function(){i2=!1},dG=function(){jf&&i8&&("function"==typeof i0?i0(jf,i8):dH())},dH=function(){var a=du(i8);a=(a=B.wrap$$module$build$src$core$utils$string(a,i3)).split("\n");for(let b=0;b<a.length;b++){let c=document.createElement("div");c.appendChild(document.createTextNode(a[b])),jf.appendChild(c)}},dI=function(a){let b=document.documentElement.clientWidth,c=document.documentElement.clientHeight,d=i6;d=a?d-(ja+jf.offsetWidth):d+ja;let e=i7+jb;return e+jf.offsetHeight>c+window.scrollY&&(e-=jf.offsetHeight+2*jb),a?d=Math.max(je-window.scrollX,d):d+jf.offsetWidth>b+window.scrollX-2*je&&(d=b-jf.offsetWidth-2*je),{x:d,y:e}},dJ=function(){if(!i2&&(i9=i8,jf)){jf.textContent="",dG();var a=i8.RTL;jf.style.direction=a?"rtl":"ltr",jf.style.display="block",i1=!0;var{x:b,y:c}=dI(a);jf.style.left=b+"px",jf.style.top=c+"px"}},dK=function(){return jh},dL=function(){return ji},dM=function(a){var b=jj[a=`${a}`.toLowerCase().trim()];if(b||(b="#"===(b="0x"===a.substring(0,2)?"#"+a.substring(2):a)[0]?b:"#"+b,/^#[0-9a-f]{6}$/.test(b)))return b;if(/^#[0-9a-f]{3}$/.test(b))return"#"+b[1]+b[1]+b[2]+b[2]+b[3]+b[3];var c=a.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return c&&(a=Number(c[1]),b=Number(c[2]),c=Number(c[3]),a>=0&&a<256&&b>=0&&b<256&&c>=0&&c<256)?dN(a,b,c):null},dN=function(a,b,c){return b=a<<16|b<<8|c,a<16?"#"+(0x1000000|b).toString(16).substr(1):"#"+b.toString(16)},dO=function(a){return(a=dM(a))?[(a=parseInt(a.substr(1),16))>>16,a>>8&255,255&a]:[0,0,0]},dP=function(a,b,c){let d=0,e=0,f=0;if(0===b)f=e=d=c;else{let g=Math.floor(a/60),h=a/60-g;a=c*(1-b);let i=c*(1-b*h);switch(b=c*(1-b*(1-h)),g){case 1:d=i,e=c,f=a;break;case 2:d=a,e=c,f=b;break;case 3:d=a,e=i,f=c;break;case 4:d=b,e=a,f=c;break;case 5:d=c,e=a,f=i;break;case 6:case 0:d=c,e=b,f=a}}return dN(Math.floor(d),Math.floor(e),Math.floor(f))},dQ=function(a,b,c){return(a=dM(a))&&(b=dM(b))?(a=dO(a),b=dO(b),dN(Math.round(b[0]+c*(a[0]-b[0])),Math.round(b[1]+c*(a[1]-b[1])),Math.round(b[2]+c*(a[2]-b[2])))):null},dR=function(a){return dP(a,jh,255*ji)},dS=function(a,b,c){let d=[];var e=a.split("");e.push("");var f=0;a=[];let g=null;for(let j=0;j<e.length;j++){var h=e[j];if(0===f)if("%"===h)(f=a.join(""))&&d.push(f),a.length=0,f=1;else if(c&&"\n"===h){let b=a.join("");b&&d.push(b),a.length=0,d.push(h)}else a.push(h);else if(1===f)"%"===h?(a.push(h),f=0):b&&"0"<=h&&h<="9"?(f=2,g=h,(h=a.join(""))&&d.push(h),a.length=0):"{"===h?f=3:(a.push("%",h),f=0);else if(2===f)if("0"<=h&&h<="9")g+=h;else{var i=void 0;d.push(parseInt(null!=(i=g)?i:"",10)),j--,f=0}else 3===f&&(""===h?(a.splice(0,0,"%{"),j--,f=0):"}"!==h?a.push(h):(f=a.join(""),/[A-Z]\w*/i.test(f)&&(h=(h=f.toUpperCase()).startsWith("BKY_")?h.substring(4):null)&&h in B.Msg$$module$build$src$core$msg?"string"==typeof(f=B.Msg$$module$build$src$core$msg[h])?Array.prototype.push.apply(d,dS(f,b,c)):b?d.push(`${f}`):d.push(f):d.push("%{"+f+"}"),f=a.length=0))}for((b=a.join(""))&&d.push(b),i=[],a.length=0,e=0;e<d.length;e++)"string"!=typeof d[e]||c&&"\n"===d[e]?((b=a.join(""))&&i.push(b),a.length=0,i.push(d[e])):a.push(d[e]);return(b=a.join(""))&&i.push(b),a.length=0,i},dT=function(a){return dS(a,!0,!0)},dU=function(a){return"string"!=typeof a?a:(a=dS(a,!1,!1)).length?String(a[0]):""},dV=function(a){let b="string"==typeof a?dU(a):a;var c=Number(b);if(!isNaN(c)&&0<=c&&c<=360)return{hue:c,hex:dP(c,dK(),255*dL())};if(c=dM(b))return{hue:null,hex:c};throw c='Invalid colour: "'+b+'"',a!==b&&(c+=' (from "'+a+'")'),Error(c)},dW=function(){return jp},dX=function(){let a=bl()||document.body,b=document.querySelector("div."+jt);b?jp=b:((jp=document.createElement("div")).className=jt,jp.tabIndex=-1),ax(jp,"keydown",null,br),a.appendChild(jp)},dY=function(a,b,c,d,e=!0){if(dZ(),jq=a,js=c,c=jp){var f,g;if(c.style.direction=b?"rtl":"ltr",c.style.display="block",!d&&a instanceof jm){let b;d=null==(b=a.getSourceBlock())?void 0:b.workspace}jr=null!=(f=d)?f:null,ju=(a=null!=(g=d)?g:bh()).getRenderer().getClassName(),jv=a.getTheme().getClassName(),ju&&a$(c,ju),jv&&a$(c,jv),e&&(jw=B.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(c))}},dZ=function(){if(d$()){jq=null;var a=jp;a&&(a.style.display="none",a.style.left="",a.style.top="",js&&(js(),js=null),a.textContent="",ju&&(a0(a,ju),ju=""),jv&&(a0(a,jv),jv=""),bh().markFocused(),jw&&(jw(),jw=null))}},d$=function(){return!!jq},d_=function(a){jq===a&&dZ()},d0=function(a){let b=null===jr,c=a;for(;!b&&c;){if(c===a){b=!0;break}c=a.options.parentWorkspace}b&&dZ()},d1=function(a,b,c){jp.style.left=a+"px",jp.style.top=b+"px",jp.style.height=c+"px"},d2=function(a,b,c,d){let e=d4(a,b,c);a=d3(a,b,c,d),e<0?d1(a,0,c.height+e):d1(a,e,c.height)},d3=function(a,b,c,d){return d?Math.min(Math.max(b.right-c.width,a.left),a.right-c.width):Math.max(Math.min(b.left,a.right-c.width),a.left)},d4=function(a,b,c){return b.bottom+c.height>=a.bottom?b.top-c.height:b.bottom},d5=function(){var a;!(null==(a=jq)||!a.repositionForWindowResize)&&jq.repositionForWindowResize()||dZ()},d6=function(a){jy=a},d7=function(a,b,c,d,e){if(dY(jz,c,ed,d),b.length){e||(a instanceof PointerEvent?e=new g9(a.clientX,a.clientY):(console.warn("Context menu opened with keyboard but no location given"),e=new g9(0,0)));var f=d8(b,c,a,e);jA=f,d9(f,c,e),setTimeout(function(){f.focus()},1),jy=null}else ec()},d8=function(a,b,c,d){let e=new hS;e.setRole(hN.MENU);for(let f=0;f<a.length;f++){let g=a[f];if(g.separator){e.addChild(new hT);continue}let h=new hR(g.text);h.setRightToLeft(b),h.setRole(hN.MENUITEM),e.addChild(h),h.setEnabled(g.enabled),g.enabled&&h.onAction(function(a,b){ec(),requestAnimationFrame(()=>{setTimeout(()=>{g.callback(g.scope,c,b,d)},0)})},{})}return e},d9=function(a,b,c){let d=bF();c=new hb(c.y+d.top,c.y+d.top,c.x+d.left,c.x+d.left),ea(a);let e=a.getSize();b&&(c.left+=e.width,c.right+=e.width,d.left+=e.width,d.right+=e.width),d2(d,c,e,b),a.focus()},ea=function(a){var b=dW();if(!b)throw Error("Attempting to create a context menu when widget div is null");a$(b=a.render(b),"blocklyContextMenu"),ax(b,"contextmenu",null,eb),a.focus()},eb=function(a){a.preventDefault(),a.stopPropagation()},ec=function(){d_(jz),jy=null},ed=function(){jA&&(jA.dispose(),jA=null)},B.callbackFactory$$module$build$src$core$contextmenu=function(a,b){return()=>{let c;B.disable$$module$build$src$core$events$utils();try{c=b instanceof Element?eq(b,a.workspace):cO(b,a.workspace);let d=a.getRelativeToSurfaceXY();d.x=a.RTL?d.x-B.config$$module$build$src$core$config.snapRadius:d.x+B.config$$module$build$src$core$config.snapRadius,d.y+=2*B.config$$module$build$src$core$config.snapRadius,c.moveBy(d.x,d.y)}finally{B.enable$$module$build$src$core$events$utils()}return aU()&&!c.isShadow()&&aP(new(aX(gB.BLOCK_CREATE))(c)),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(c),c}},ee=function(a,b){return b=aC(b,a.getParentSvg(),a.getInverseScreenCTM()),b.x/=a.scale,b.y/=a.scale,b},ef=function(a,b,c){b=ee(a,b),jG.set(a,g9.difference(c,b))},eg=function(a,b){if(b=ee(a,b),!(a=jG.get(a)))throw Error("Drag not initialized");return g9.sum(a,b)},eh=function(a,b=!1){let c=B.createElement$$module$build$src$core$utils$xml("comment");b||c.setAttribute("id",a.id),b=a.workspace;let d=a.getRelativeToSurfaceXY().clone();return d.x=b.RTL?b.getWidth()-d.x:d.x,c.setAttribute("x",`${d.x}`),c.setAttribute("y",`${d.y}`),c.setAttribute("w",`${a.getSize().width}`),c.setAttribute("h",`${a.getSize().height}`),a.getText()&&(c.textContent=a.getText()),a.isCollapsed()&&c.setAttribute("collapsed","true"),a.isOwnEditable()||c.setAttribute("editable","false"),a.isOwnMovable()||c.setAttribute("movable","false"),a.isOwnDeletable()||c.setAttribute("deletable","false"),c},ei=function(a){let b=B.createElement$$module$build$src$core$utils$xml("variables");for(let c=0;c<a.length;c++){let d=a[c],e=B.createElement$$module$build$src$core$utils$xml("variable");e.appendChild(B.createTextNode$$module$build$src$core$utils$xml(d.getName())),d.getType()&&e.setAttribute("type",d.getType()),e.id=d.getId(),b.appendChild(e)}return b},ej=function(a,b){if(a.isInsertionMarker()&&!(a=a.getChildren(!1)[0]))return new DocumentFragment;let c=0;if(a.workspace.RTL&&(c=a.workspace.getWidth()),b=em(a,b),eC(b)){let d=a.getRelativeToSurfaceXY();b.setAttribute("x",String(Math.round(a.workspace.RTL?c-d.x:d.x))),b.setAttribute("y",String(Math.round(d.y)))}return b},ek=function(a){if(a.isSerializable()){let b=B.createElement$$module$build$src$core$utils$xml("field");return b.setAttribute("name",a.name||""),a.toXml(b)}return null},el=function(a,b){for(let c of a.getFields())(a=ek(c))&&b.appendChild(a)},em=function(a,b){let c;if(a.isInsertionMarker())return(b=a.getChildren(!1)[0])?em(b):new DocumentFragment;let d=B.createElement$$module$build$src$core$utils$xml(a.isShadow()?"shadow":"block");if(d.setAttribute("type",a.type),b||(d.id=a.id),a.mutationToDom){var e=a.mutationToDom();e&&(e.hasChildNodes()||e.hasAttributes())&&d.appendChild(e)}if(el(a,d),e=a.getCommentText()){var f=a.getIcon(ix.COMMENT),g=f.getBubbleSize(),h=f.bubbleIsVisible();f=f.getBubbleLocation();var i=B.createElement$$module$build$src$core$utils$xml("comment");i.appendChild(B.createTextNode$$module$build$src$core$utils$xml(e)),i.setAttribute("pinned",`${h}`),i.setAttribute("h",`${g.height}`),i.setAttribute("w",`${g.width}`),f&&(i.setAttribute("x",`${a.workspace.RTL?a.workspace.getWidth()-(f.x+g.width):f.x}`),i.setAttribute("y",`${f.y}`)),d.appendChild(i)}for(a.data&&((e=B.createElement$$module$build$src$core$utils$xml("data")).appendChild(B.createTextNode$$module$build$src$core$utils$xml(a.data)),d.appendChild(e)),e=0;e<a.inputList.length;e++){g=a.inputList[e];var j=void 0;h=!0,g.type!==B.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&g.type!==B.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(f=g.connection.targetBlock(),g.type===B.inputTypes$$module$build$src$core$inputs$input_types.VALUE?j=B.createElement$$module$build$src$core$utils$xml("value"):g.type===B.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(j=B.createElement$$module$build$src$core$utils$xml("statement")),!(i=g.connection.getShadowDom())||f&&f.isShadow()||j.appendChild(en(i,b)),f&&(f=em(f,b)).nodeType===gC.ELEMENT_NODE&&(j.appendChild(f),h=!1),j.setAttribute("name",g.name),h||d.appendChild(j))}return void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&d.setAttribute("inline",String(a.inputsInline)),a.isCollapsed()&&d.setAttribute("collapsed","true"),a.isEnabled()||d.setAttribute("disabled-reasons",Array.from(a.getDisabledReasons()).map(encodeURIComponent).join(",")),a.isOwnDeletable()||d.setAttribute("deletable","false"),a.isOwnMovable()||d.setAttribute("movable","false"),a.isOwnEditable()||d.setAttribute("editable","false"),(j=a.getNextBlock())&&(e=em(j,b)).nodeType===gC.ELEMENT_NODE&&((c=B.createElement$$module$build$src$core$utils$xml("next")).appendChild(e),d.appendChild(c)),!(a=a.nextConnection&&a.nextConnection.getShadowDom())||j&&j.isShadow()||c.appendChild(en(a,b)),d},en=function(a,b){let c=a=a.cloneNode(!0),d;for(;c;)if(b&&"shadow"===c.nodeName&&c.removeAttribute("id"),c.firstChild)c=c.firstChild;else{for(;c&&!c.nextSibling;){let a;d=c,c=c.parentNode,d.nodeType===gC.TEXT_NODE&&""===d.data.trim()&&(null==(a=c)?void 0:a.firstChild)!==d&&a2(d)}c&&(d=c,c=c.nextSibling,d.nodeType===gC.TEXT_NODE&&""===d.data.trim()&&a2(d))}return a},eo=function(a){return bJ(a).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},B.domToWorkspace$$module$build$src$core$xml=function(a,b){let c=0;b.RTL&&(c=b.getWidth());let d=[];a5();let e=B.getGroup$$module$build$src$core$events$utils();e||B.setGroup$$module$build$src$core$events$utils(!0),b.setResizesEnabled&&b.setResizesEnabled(!1);let f=!0;try{for(let e=0,g;g=a.childNodes[e];e++){let a=g.nodeName.toLowerCase(),e=g;if("block"!==a&&("shadow"!==a||aO())){if("shadow"===a)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===a)ep(e,b);else if("variables"===a){if(f)er(e,b);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");f=!1}}else{let a,g,h=eq(e,b);d.push(h.id);let i=parseInt(null!=(a=e.getAttribute("x"))?a:"10",10),j=parseInt(null!=(g=e.getAttribute("y"))?g:"10",10);isNaN(i)||isNaN(j)||h.moveBy(b.RTL?c-i:i,j,["create"]),f=!1}}}finally{B.setGroup$$module$build$src$core$events$utils(e),b.setResizesEnabled&&b.setResizesEnabled(!0),b.rendered&&b6(),a6()}return aP(new(aX(gB.FINISHED_LOADING))(b)),d},ep=function(a,b){var c,d,e,f;let g,h,i=null!=(c=a.getAttribute("id"))?c:void 0;return(c=b.rendered?new jR(b,i):new jQ(b,i)).setText(null!=(d=a.textContent)?d:""),d=parseInt(null!=(e=a.getAttribute("x"))?e:"",10),e=parseInt(null!=(g=a.getAttribute("y"))?g:"",10),isNaN(d)||isNaN(e)||(d=b.RTL?b.getWidth()-d:d,c.moveTo(new g9(d,e))),b=parseInt(null!=(f=a.getAttribute("w"))?f:"",10),f=parseInt(null!=(h=a.getAttribute("h"))?h:"",10),isNaN(b)||isNaN(f)||c.setSize(new hc(b,f)),"true"===a.getAttribute("collapsed")&&c.setCollapsed(!0),"false"===a.getAttribute("editable")&&c.setEditable(!1),"false"===a.getAttribute("movable")&&c.setMovable(!1),"false"===a.getAttribute("deletable")&&c.setDeletable(!1),c},B.domToBlock$$module$build$src$core$xml=function(a,b){return a=eq(a,b),b.rendered&&b6(),a},eq=function(a,b){let c;B.disable$$module$build$src$core$events$utils();var d=b.getAllVariables();try{if(c=eA(a,b),b.rendered){let a=c,d=c.getDescendants(!1);a.setConnectionTracking(!1);for(let a=d.length-1;a>=0;a--)d[a].initSvg();for(let a=d.length-1;a>=0;a--)d[a].queueRender();setTimeout(function(){a.disposed||a.setConnectionTracking(!0)},1),b.resizeContents()}else{let a=c.getDescendants(!1);for(let b=a.length-1;b>=0;b--)a[b].initModel()}}finally{B.enable$$module$build$src$core$events$utils()}if(aU()){for(a=cB(b,d),b=0;b<a.length;b++)d=a[b],aP(new(aX(gB.VAR_CREATE))(d));aP(new(aX(gB.BLOCK_CREATE))(c))}return c},er=function(a,b){for(let d=0;d<a.children.length;d++){var c=a.children[d];let e=c.getAttribute("type"),f=c.getAttribute("id");if(!(c=c.textContent))break;b.getVariableMap().createVariable(c,null!=e?e:void 0,f)}},es=function(a){let b={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let c=0;c<a.children.length;c++){let d=a.children[c];if(d.nodeType!==gC.TEXT_NODE)switch(d.nodeName.toLowerCase()){case"mutation":b.mutation.push(d);break;case"comment":b.comment.push(d);break;case"data":b.data.push(d);break;case"title":case"field":b.field.push(d);break;case"value":case"statement":b.input.push(d);break;case"next":b.next.push(d);break;default:console.warn("Ignoring unknown tag: "+d.nodeName)}}return b},et=function(a,b){let c=!1;for(let d=0;d<a.length;d++){let e=a[d];b.domToMutation&&(b.domToMutation(e),b.initSvg&&(c=!0))}return c},eu=function(a,b){for(let c=0;c<a.length;c++){let d,e,f=a[c],g=f.textContent,h="true"===f.getAttribute("pinned"),i=parseInt(null!=(d=f.getAttribute("w"))?d:"50",10),j=parseInt(null!=(e=f.getAttribute("h"))?e:"50",10),k,l=parseInt(null!=(k=f.getAttribute("x"))?k:"",10),m,n=parseInt(null!=(m=f.getAttribute("y"))?m:"",10);b.setCommentText(g);let o=b.getIcon(ix.COMMENT);isNaN(i)||isNaN(j)||o.setBubbleSize(new hc(i,j)),o.setBubbleVisible(h),setTimeout(()=>{isNaN(l)||isNaN(n)||(l=b.workspace.RTL?b.workspace.getWidth()-(l+i):l,o.setBubbleLocation(new g9(l,n))),o.setBubbleVisible(h)},1)}},ev=function(a,b){for(let c=0;c<a.length;c++)b.data=a[c].textContent},ew=function(a,b){for(let c=0;c<a.length;c++){let d=a[c],e=d.getAttribute("name");e?eB(b,e,d):console.warn(`Ignoring unnamed field in block ${b.type}`)}},ex=function(a){let b=null,c=null;for(let d=0;d<a.childNodes.length;d++){let e=a.childNodes[d];eC(e)&&("block"===e.nodeName.toLowerCase()?b=e:"shadow"===e.nodeName.toLowerCase()&&(c=e))}return{childBlockElement:b,childShadowElement:c}},ey=function(a,b,c,d){for(let f=0;f<a.length;f++){var e=a[f];let g=e.getAttribute("name"),h=g?c.getInput(g):null;if(!h){console.warn("Ignoring non-existent input "+g+" in block "+d);break}if((e=ex(e)).childBlockElement){if(!h.connection)throw TypeError("Input connection does not exist.");eA(e.childBlockElement,b,h.connection,!1)}if(e.childShadowElement){let a;null==(a=h.connection)||a.setShadowDom(e.childShadowElement)}}},ez=function(a,b,c){for(let d=0;d<a.length;d++){let e=ex(a[d]);if(e.childBlockElement){if(!c.nextConnection)throw TypeError("Next statement does not exist.");if(c.nextConnection.isConnected())throw TypeError("Next statement is already connected.");eA(e.childBlockElement,b,c.nextConnection,!0)}e.childShadowElement&&c.nextConnection&&c.nextConnection.setShadowDom(e.childShadowElement)}},eA=function(a,b,c,d){let e=a.getAttribute("type");if(!e)throw TypeError("Block type unspecified: "+a.outerHTML);var f,g=null!=(f=a.getAttribute("id"))?f:void 0;f=b.newBlock(e,g);let h=et((g=es(a)).mutation,f);if(eu(g.comment,f),ev(g.data,f),c)if(d)if(f.previousConnection)c.connect(f.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(f.outputConnection)c.connect(f.outputConnection);else if(f.previousConnection)c.connect(f.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(ew(g.field,f),ey(g.input,b,f,e),ez(g.next,b,f),h&&f.initSvg(),(b=a.getAttribute("inline"))&&f.setInputsInline("true"===b),(b=a.getAttribute("disabled"))&&f.setDisabledReason("true"===b||"disabled"===b,hW),null!==(b=a.getAttribute("disabled-reasons")))for(var i of b.split(","))f.setDisabledReason(!0,decodeURIComponent(i));if((i=a.getAttribute("deletable"))&&f.setDeletable("true"===i),(i=a.getAttribute("movable"))&&f.setMovable("true"===i),(i=a.getAttribute("editable"))&&f.setEditable("true"===i),(i=a.getAttribute("collapsed"))&&f.setCollapsed("true"===i),"shadow"===a.nodeName.toLowerCase()){for(i=0,a=f.getChildren(!1);i<a.length;i++)if(!a[i].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");f.setShadow(!0)}return f},eB=function(a,b,c){let d=a.getField(b);d?d.fromXml(c):console.warn("Ignoring non-existent field "+b+" in block "+a.type)},eC=function(a){return a.nodeType===gC.ELEMENT_NODE},eD=function(a,b){ai(F.FIELD,a,b,!0)},B.fromJson$$module$build$src$core$field_registry=function(a){return jX.fromJsonInternal(a)},eE=function(a){return a&&"object"==typeof a&&"src"in a&&"string"==typeof a.src&&"alt"in a&&"string"==typeof a.alt&&"width"in a&&"number"==typeof a.width&&"height"in a&&"number"==typeof a.height},B.register$$module$build$src$core$extensions=function(a,b){if("string"!=typeof a||""===a.trim())throw Error('Error: Invalid extension name "'+a+'"');if(j8[a])throw Error('Error: Extension "'+a+'" is already registered.');if("function"!=typeof b)throw Error('Error: Extension "'+a+'" must be a function');j8[a]=b},B.registerMixin$$module$build$src$core$extensions=function(a,b){if(!b||"object"!=typeof b)throw Error('Error: Mixin "'+a+'" must be a object');B.register$$module$build$src$core$extensions(a,function(){this.mixin(b)})},B.registerMutator$$module$build$src$core$extensions=function(a,b,c,d){let e='Error when registering mutator "'+a+'": ';eK(e,b);let f=eI(b,e);if(c&&"function"!=typeof c)throw Error(e+'Extension "'+a+'" is not a function');B.register$$module$build$src$core$extensions(a,function(){f&&this.setMutator(new B.MutatorIcon$$module$build$src$core$icons$mutator_icon(d||[],this)),this.mixin(b),c&&c.apply(this)})},eF=function(a){return!!j8[a]},eG=function(a,b,c){let d,e=j8[a];if("function"!=typeof e)throw Error('Error: Extension "'+a+'" not found.');if(c?eH(a,b):d=eL(b),e.apply(b),c)eK('Error after applying mutator "'+a+'": ',b);else if(!eM(d,b))throw Error('Error when applying extension "'+a+'": mutation properties changed when applying a non-mutator extension.')},eH=function(a,b){if(eL(b).length)throw Error('Error: tried to apply mutation "'+a+'" to a block that already has mutator functions.  Block id: '+b.id)},eI=function(a,b){return eJ(a.compose,a.decompose,b+" compose/decompose")},eJ=function(a,b,c){if(a&&b){if("function"!=typeof a||"function"!=typeof b)throw Error(c+" must be a function");return!0}if(!a&&!b)return!1;throw Error(c+"Must have both or neither functions")},eK=function(a,b){let c=eJ(b.mutationToDom,b.domToMutation,a+" mutationToDom/domToMutation"),d=eJ(b.saveExtraState,b.loadExtraState,a+" saveExtraState/loadExtraState");if(!c&&!d)throw Error(a+"Mutations must contain either XML hooks, or JSON hooks, or both");eI(b,a)},eL=function(a){let b=[];return void 0!==a.domToMutation&&b.push(a.domToMutation),void 0!==a.mutationToDom&&b.push(a.mutationToDom),void 0!==a.saveExtraState&&b.push(a.saveExtraState),void 0!==a.loadExtraState&&b.push(a.loadExtraState),void 0!==a.compose&&b.push(a.compose),void 0!==a.decompose&&b.push(a.decompose),b},eM=function(a,b){if((b=eL(b)).length!==a.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0},B.buildTooltipForDropdown$$module$build$src$core$extensions=function(a,b){let c=[];return function(){c.includes(this.type)||(eN(this,a,b),c.push(this.type)),this.setTooltip((function(){return dU(b[String(this.getFieldValue(a))])}).bind(this))}},eN=function(a,b,c){var d=a.getField(b);if(d instanceof jZ&&!d.isOptionListDynamic())for(let e of d=d.getOptions())e!==jZ.SEPARATOR&&([,d]=e,void 0===c[d]&&console.warn(`No tooltip mapping for value ${d} of field ${b} of block type ${a.type}.`))},B.buildTooltipWithFieldText$$module$build$src$core$extensions=function(a,b){return function(){this.setTooltip((function(){let c=this.getField(b);return dU(a).replace("%1",c?c.getText():"")}).bind(this))}},eO=function(a,b){return" "+a+","+b+" "},eP=function(a,b){return" "+a+b.join("")},eQ=function(a,b){return" M "+a+","+b+" "},eR=function(a,b){return" m "+a+","+b+" "},eS=function(a,b){return" l "+a+","+b+" "},eT=function(a){return" l"+a.join("")},eU=function(a,b){return" "+a+" "+b+" "},eV=function(a,b,c,d){return a+" "+c+" "+c+" "+b+d},eW=function(a,b){if(!a||!b)throw Error("Cannot connect null connections.");a.targetConnection=b,b.targetConnection=a},eX=function(a,b){let c=null,d=null==(b=b.outputConnection)?void 0:b.getConnectionChecker();for(let e=0,f;f=a.inputList[e];e++){let a=f.connection;if(a&&(null==d?0:d.canConnect(b,a,!1))){if(c)return null;c=a}}return c},eY=function(a,b){let c;for(;c=eX(a,b);)if(!(a=c.targetBlock())||a.isShadow())return c;return null},eZ=function(a){return ba(a)&&"function"==typeof a.getType&&"function"==typeof a.initView&&"function"==typeof a.dispose&&"function"==typeof a.getWeight&&"function"==typeof a.getSize&&"function"==typeof a.applyColour&&"function"==typeof a.hideForInsertionMarker&&"function"==typeof a.updateEditable&&"function"==typeof a.updateCollapsed&&"function"==typeof a.isShownWhenCollapsed&&"function"==typeof a.setOffsetInBlock&&"function"==typeof a.onLocationChange&&"function"==typeof a.onClick},e$=function(a){if(!(a.getDescendants(!1).length>100)){var b,c=a.workspace,d=a.getSvgRoot();c.getAudioManager().play("delete");var e=a.getRelativeToSurfaceXY(),f=d.cloneNode(!0);f.setAttribute("transform","translate("+e.x+","+e.y+")"),null==(b=c.getLayerManager())||b.appendToAnimationLayer({getSvgRoot:()=>f}),e_(f,{x:e.x,y:e.y,width:a.width,height:a.height},c.RTL,new Date)}},e_=function(a,b,c,d){let e=((new Date).getTime()-d.getTime())/150;e>1?a2(a):(a.setAttribute("transform","translate("+(b.x+(c?-1:1)*b.width/2*e)+","+(b.y+b.height/2*e)+") scale("+(1-e)+")"),setTimeout(e_,10,a,b,c,d))},e0=function(a){var b=a.workspace;let c=b.scale;if(b.getAudioManager().play("click"),!(c<1)){var d=b.getSvgXY(a.getSvgRoot());a.outputConnection?(d.x+=(a.RTL?3:-3)*c,d.y+=13*c):a.previousConnection&&(d.x+=(a.RTL?-23:23)*c,d.y+=3*c);var e=aZ(ha.CIRCLE,{cx:d.x,cy:d.y,r:0,fill:"none",stroke:"#888","stroke-width":10},b.getParentSvg());a=aZ(ha.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*c},e),b=aZ(ha.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},e),a.beginElement(),b.beginElement(),setTimeout(()=>void a2(e),150)}},e1=function(a){if(e3(),a.workspace.getAudioManager().play("disconnect"),!(a.workspace.scale<1)){var b=a.getHeightWidth().height;b=Math.atan(10/b)/Math.PI*180,a.RTL||(b*=-1),kw=a,e2(a,b,new Date,0)}},e2=function(a,b,c,d){let e=[.66,1,.66,0,-.66,-1,-.66,0],f="";c.getTime()+200>(new Date).getTime()&&(f=`skewX(${Math.round(e[d%e.length]*b)})`,kv=setTimeout(e2,15,a,b,c,d+1)),a.getSvgRoot().setAttribute("transform",`${a.getTranslation()} ${f}`)},e3=function(){kw&&(kv&&(clearTimeout(kv),kv=null),kw.getSvgRoot().setAttribute("transform",kw.getTranslation()),kw=null)},e4=function(a,b){a.workspace.RTL&&(b.x=a.workspace.getWidth()-b.x);let c=a.workspace,d=B.config$$module$build$src$core$config.snapRadius,e=g9.difference(b,a.getRelativeToSurfaceXY()),f=new g9(0,0),g=c.getAllBlocks(!1).filter(b=>b.id!=a.id).map(a=>a.getRelativeToSurfaceXY());for(;e5(g9.sum(b,f),g)||e6(a,g9.sum(e,f),d);)c.RTL?f.translate(-d,2*d):f.translate(d,2*d);a.moveTo(g9.sum(b,f))},e5=function(a,b){return b.some(b=>1>=Math.abs(b.x-a.x)&&1>=Math.abs(b.y-a.y))},e6=function(a,b,c){return a.getConnections_(!1).some(a=>!!a.closest(c,b).connection)},e7=function(a,b,c){let d=c.getBoundingRectangle(),e=d.right-d.left,f=c1(b.top,d.top,b.top+b.height-(d.bottom-d.top))-d.top,g=b.left;return b=b.left+b.width-e,a.RTL?g=Math.min(b,g):b=Math.max(g,b),(!!(a=c1(g,d.left,b)-d.left)||!!f)&&(c.moveBy(a,f,["inbounds"]),!0)},e8=function(a){return b=>{var c,d=a.getMetricsManager();if(d.hasFixedEdges()&&!a.isDragging())if(W.includes(null!=(c=b.type)?c:"")){c=d.getScrollMetrics(!0);let e=e9(a,b);e&&(d=B.getGroup$$module$build$src$core$events$utils()||!1,B.setGroup$$module$build$src$core$events$utils(b.group),e7(a,c,e)&&!b.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),B.setGroup$$module$build$src$core$events$utils(d))}else aN(b)&&b.scale&&b.oldScale&&b.scale>b.oldScale&&fa(a)}},e9=function(a,b){let c=null;switch(b.type){case gB.BLOCK_CREATE:case gB.BLOCK_MOVE:(c=a.getBlockById(b.blockId))&&(c=c.getRootBlock());break;case gB.COMMENT_CREATE:case gB.COMMENT_MOVE:case gB.COMMENT_RESIZE:c=a.getCommentById(b.commentId)}return c},fa=function(a){var b=a.getMetricsManager();if(b.hasFixedEdges()&&!a.isDragging()){b=b.getScrollMetrics(!0);var c=a.getTopBoundedElements();for(let d=0,e;e=c[d];d++)e7(a,b,e)}},fb=function(a){return a&&"function"==typeof a.isDeletable&&"function"==typeof a.dispose&&"function"==typeof a.setDeleteStyle},fc=function(a,b){let c=a.getIcons();for(let d of a.inputList){let e;if(d.isVisible())if(c.push(...d.fieldRow),null==(e=d.connection)?0:e.targetBlock())if(a=d.connection.targetBlock(),d.connection.type!==mU.NEXT_STATEMENT||b)c.push(a);else{let b;(a=null==(b=a.lastConnectionInStack(!1))?void 0:b.getSourceBlock())&&c.push(a)}else{let a;(null==(a=d.connection)?void 0:a.type)===mU.INPUT_VALUE&&c.push(d.connection)}}return c},fd=function(a,b){let c=a.workspace.getTopBoundedElements(!0).filter(a=>ba(a));a=c.indexOf(a instanceof kE?a.getRootBlock():a)+b;let d=null;if(a>=0&&a<c.length?d=c[a]:a<0?d=c[c.length-1]:a>=c.length&&(d=c[0]),b<0&&d instanceof kE){let a,b;return null!=(b=null==(a=d.lastConnectionInStack(!1))?void 0:a.getSourceBlock())?b:d}return d},fe=function(a,b){var c;let d,e=a instanceof kE?null!=(d=null==(c=a.outputConnection)?void 0:c.targetBlock())?d:a.getSurroundParent():a.getSourceBlock();return e instanceof kE&&-1!==(a=(c=fc(e,b>0)).indexOf(a))&&(b=a+b)>=0&&b<c.length?c[b]:null},ff=function(a,b){ai(F.ICON,a.toString(),b)},fg=function(a){return a&&"function"==typeof a.getRelativeToSurfaceXY&&"function"==typeof a.isMovable&&"function"==typeof a.startDrag&&"function"==typeof a.drag&&"function"==typeof a.endDrag&&"function"==typeof a.revertDrag},fh=function(a){return"function"==typeof a.getProcedureModel&&"function"==typeof a.doProcedureUpdate&&"function"==typeof a.isProcedureDef},fi=function(a){return a&&"function"==typeof a.startPublishing&&"function"==typeof a.stopPublishing},fj=function(a){let b=a.getProcedureMap().getProcedures().filter(a=>!a.getReturnTypes()).map(a=>[a.getName(),a.getParameters().map(a=>a.getName()),!1]);a.getBlocksByType("procedures_defnoreturn",!1).forEach(a=>{!fh(a)&&cg(a)&&b.push(a.getProcedureDef())});let c=a.getProcedureMap().getProcedures().filter(a=>!!a.getReturnTypes()).map(a=>[a.getName(),a.getParameters().map(a=>a.getName()),!0]);return a.getBlocksByType("procedures_defreturn",!1).forEach(a=>{!fh(a)&&cg(a)&&c.push(a.getProcedureDef())}),b.sort(fk),c.sort(fk),[b,c]},fk=function(a,b){return a[0].localeCompare(b[0],void 0,{sensitivity:"base"})},B.findLegalName$$module$build$src$core$procedures=function(a,b){if(b.isInFlyout)return a;for(a=a||B.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!fl(a,b.workspace,b);){let b=a.match(/^(.*?)(\d+)$/);a=b?b[1]+(parseInt(b[2])+1):a+"2"}return a},fl=function(a,b,c){return!fm(a,b,c)},fm=function(a,b,c){for(let d of b.getAllBlocks(!1))if(d!==c&&cg(d)&&B.Names$$module$build$src$core$names.equals(d.getProcedureDef()[0],a))return!0;for(let d of(c=c&&fh(c)?null==c?void 0:c.getProcedureModel():void 0,b.getProcedureMap().getProcedures()))if(d!==c&&B.Names$$module$build$src$core$names.equals(d.getName(),a))return!0;return!1},B.rename$$module$build$src$core$procedures=function(a){var b=this.getSourceBlock();if(!b)throw new jn;a=a.trim();let c=B.findLegalName$$module$build$src$core$procedures(a,b);fh(b)&&!b.isInsertionMarker()&&b.getProcedureModel().setName(c);let d=this.getValue();if(d!==a&&d!==c)for(a=b.workspace.getAllBlocks(!1),b=0;b<a.length;b++){let e=a[b];e.renameProcedure&&e.renameProcedure(d,c)}return c},fn=function(a){function b(a,b){for(let e=0;e<a.length;e++){var d=a[e][0];let f=a[e][1],g=B.createElement$$module$build$src$core$utils$xml("block");g.setAttribute("type",b),g.setAttribute("gap","16");let h=B.createElement$$module$build$src$core$utils$xml("mutation");for(h.setAttribute("name",d),g.appendChild(h),d=0;d<f.length;d++){let a=B.createElement$$module$build$src$core$utils$xml("arg");a.setAttribute("name",f[d]),h.appendChild(a)}c.push(g)}}let c=[];if(H.procedures_defnoreturn){var d=B.createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","procedures_defnoreturn"),d.setAttribute("gap","16");var e=B.createElement$$module$build$src$core$utils$xml("field");e.setAttribute("name","NAME"),e.appendChild(B.createTextNode$$module$build$src$core$utils$xml(B.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),d.appendChild(e),c.push(d)}return H.procedures_defreturn&&((d=B.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),d.setAttribute("gap","16"),(e=B.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),e.appendChild(B.createTextNode$$module$build$src$core$utils$xml(B.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),d.appendChild(e),c.push(d)),H.procedures_ifreturn&&((d=B.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),d.setAttribute("gap","16"),c.push(d)),c.length&&c[c.length-1].setAttribute("gap","24"),b((a=fj(a))[0],"procedures_callnoreturn"),b(a[1],"procedures_callreturn"),c},fo=function(a){return fp(a,!1)},fp=function(a,b=!0){function c(a,b){for(let[c,e]of a)d.push({kind:"block",type:b,gap:16,extraState:{name:c,params:e}})}if(b)return cj("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),fn(a);let d=[];return H.procedures_defnoreturn&&d.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:B.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),H.procedures_defreturn&&d.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:B.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),H.procedures_ifreturn&&d.push({kind:"block",type:"procedures_ifreturn",gap:16}),d.length&&(d[d.length-1].gap=24),c((a=fj(a))[0],"procedures_callnoreturn"),c(a[1],"procedures_callreturn"),d},fq=function(a){var b=[],c=a.getBlocksByType("procedures_mutatorarg",!1);for(let a=0,d;d=c[a];a++)b.push(d.getFieldValue("NAME"));c=B.createElement$$module$build$src$core$utils$xml("xml");let d=B.createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","procedures_mutatorarg");let e=B.createElement$$module$build$src$core$utils$xml("field");e.setAttribute("name","NAME"),b=cr(B.DEFAULT_ARG$$module$build$src$core$procedures,b),b=B.createTextNode$$module$build$src$core$utils$xml(b),e.appendChild(b),d.appendChild(e),c.appendChild(d),a.updateToolbox(c)},fr=function(a){if(aM(a)&&"mutator"===a.bubbleType&&a.isOpen&&a.blockId){var b=(a=bd(a.workspaceId).getBlockById(a.blockId)).type;("procedures_defnoreturn"===b||"procedures_defreturn"===b)&&(fq(a=a.getIcon(B.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace()),a.addChangeListener(fs))}},fs=function(a){(aG(a)||aH(a)||aI(a)||aJ(a))&&fq(a=bd(a.workspaceId))},ft=function(a,b){return b.getAllBlocks(!1).filter(b=>fu(b,a)||ch(b)&&B.Names$$module$build$src$core$names.equals(b.getProcedureCall(),a))},fu=function(a,b){return fh(a)&&!a.isProcedureDef()&&a.getProcedureModel()&&B.Names$$module$build$src$core$names.equals(a.getProcedureModel().getName(),b)},B.mutateCallers$$module$build$src$core$procedures=function(a){let b=aO();var c=a.getProcedureDef()[0];let d=a.mutationToDom(!0);a=ft(c,a.workspace);for(let f=0,g;g=a[f];f++){c=(c=g.mutationToDom())&&bJ(c),g.domToMutation&&g.domToMutation(d);var e=g.mutationToDom();c!==(e=e&&bJ(e))&&(B.setRecordUndo$$module$build$src$core$events$utils(!1),aP(new(aX(gB.BLOCK_CHANGE))(g,"mutation",null,c,e)),B.setRecordUndo$$module$build$src$core$events$utils(b))}},B.getDefinition$$module$build$src$core$procedures=function(a,b){for(let c of b.getAllBlocks(!1))if(fh(c)&&c.isProcedureDef()&&B.Names$$module$build$src$core$names.equals(c.getProcedureModel().getName(),a)||cg(c)&&B.Names$$module$build$src$core$names.equals(c.getProcedureDef()[0],a))return c;return null},fv=function(a){return a.isDynamic},fw=function(a){return void 0!==a.pathDown&&void 0!==a.pathUp},fx=function(a){return void 0!==a.pathLeft&&void 0!==a.pathRight},fy=function(a,b){ai(F.RENDERER,a,b)},fz=function(a,b,c){return(a=new(an(F.RENDERER,a))(a)).init(b,c),a},fA=function(a){cs(a.getTargetWorkspace(),void 0,"String")},fB=function(a){cs(a.getTargetWorkspace(),void 0,"Number")},fC=function(a){cs(a.getTargetWorkspace(),void 0,"Colour")},fD=function(a){return fE(a,!1)},fE=function(a,b=!0){return(H.variables_set_dynamic||H.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),b)?(cj("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),fF(a)):(a.registerButtonCallback("CREATE_VARIABLE_STRING",fA),a.registerButtonCallback("CREATE_VARIABLE_NUMBER",fB),a.registerButtonCallback("CREATE_VARIABLE_COLOUR",fC),[{kind:"button",text:B.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:B.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:B.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...cn(a,a.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},fF=function(a){let b=[],c=document.createElement("button");return c.setAttribute("text",B.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),b.push(c),(c=document.createElement("button")).setAttribute("text",B.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),b.push(c),(c=document.createElement("button")).setAttribute("text",B.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),c.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),b.push(c),a.registerButtonCallback("CREATE_VARIABLE_STRING",fA),a.registerButtonCallback("CREATE_VARIABLE_NUMBER",fB),a.registerButtonCallback("CREATE_VARIABLE_COLOUR",fC),b.concat(a=fG(a))},fG=function(a){a=a.getVariableMap().getAllVariables();let b=[];if(a.length>0){if(H.variables_set_dynamic){var c=a[a.length-1];let d=B.createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","variables_set_dynamic"),d.setAttribute("gap","24"),d.appendChild(cz(c)),b.push(d)}if(H.variables_get_dynamic){a.sort(cC);for(let d=0,e;e=a[d];d++)(c=B.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),c.setAttribute("gap","8"),c.appendChild(cz(e)),b.push(c)}}return b},fH=function(a,b){let c=a.toCopyData();return mb=c,mc=bb(a)&&a.workspace instanceof lP?a.workspace:null,md=b,c},fI=function(){return mb},fJ=function(){return mc},fK=function(){return md},fL=function(a,b,c){return a&&b?fM(a,b,c):mb&&mc?fM(mb,mc,md):null},fM=function(a,b,c){let d,e,f;return b=b.isMutator?b:null!=(d=b.options.parentWorkspace)?d:b,null!=(f=null==(e=ao(F.PASTER,a.paster,!1))?void 0:e.paste(a,b,c))?f:null},fN=function(a){return a&&"function"==typeof a.toCopyData},fO=function(){gP.registry.register({name:mX.ESCAPE,preconditionFn:a=>!a.isReadOnly(),callback:a=>(a.hideChaff(),!0),keyCodes:[mT.ESC]})},fP=function(){gP.registry.register({name:mX.DELETE,preconditionFn:(a,b)=>(b=b.focusedNode,!a.isReadOnly()&&null!=b&&fb(b)&&b.isDeletable()&&!a.isDragging()&&!B.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()),callback:(a,b,c,d)=>(b.preventDefault(),(a=d.focusedNode)instanceof kE?a.checkAndDelete():fb(a)&&a.isDeletable()&&(B.setGroup$$module$build$src$core$events$utils(!0),a.dispose(),B.setGroup$$module$build$src$core$events$utils(!1)),!0),keyCodes:[mT.DELETE,mT.BACKSPACE]})},fQ=function(a){return!!(fN(a)&&fb(a)&&fg(a))&&(a.isCopyable?a.isCopyable():a instanceof kE||a instanceof jR?a.isOwnDeletable()&&a.isOwnMovable():a.isDeletable()&&a.isMovable())},fR=function(a){return fQ(a)&&fb(a)&&a.isDeletable()},fS=function(){let a=gP.registry.createSerializedKey(mT.C,[mT.CTRL]),b=gP.registry.createSerializedKey(mT.C,[mT.META]);gP.registry.register({name:mX.COPY,preconditionFn:(a,b)=>(b=b.focusedNode,a=a.isFlyout?a.targetWorkspace:a,!!b&&!!a&&!a.isDragging()&&!B.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&fQ(b)),callback:(a,b,c,d)=>(b.preventDefault(),!!(b=d.focusedNode)&&!!fN(b)&&!!fQ(b)&&!!(a=a.isFlyout?a.targetWorkspace:a)&&(b.workspace.isFlyout||a.hideChaff(),a=fg(b)&&b.workspace==a?b.getRelativeToSurfaceXY():void 0,!!fH(b,a))),keyCodes:[a,b]})},fT=function(){let a=gP.registry.createSerializedKey(mT.X,[mT.CTRL]),b=gP.registry.createSerializedKey(mT.X,[mT.META]);gP.registry.register({name:mX.CUT,preconditionFn:(a,b)=>!!(b=b.focusedNode)&&!a.isReadOnly()&&!a.isDragging()&&!B.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&fR(b),callback:(a,b,c,d)=>!!(a=d.focusedNode)&&!!fR(a)&&!!fN(a)&&(b=fg(a)?a.getRelativeToSurfaceXY():void 0,b=fH(a,b),a instanceof kE?a.checkAndDelete():fb(a)&&a.dispose(),!!b),keyCodes:[a,b]})},fU=function(){let a=gP.registry.createSerializedKey(mT.V,[mT.CTRL]),b=gP.registry.createSerializedKey(mT.V,[mT.META]);gP.registry.register({name:mX.PASTE,preconditionFn(){var a=fJ();return!!a&&!!a.rendered&&(a=a.isFlyout?a.targetWorkspace:a,!!fI()&&!!a&&!a.isReadOnly()&&!a.isDragging()&&!B.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken())},callback(a,b){if(!(a=fI()))return!1;var c=fJ();if(!c||!(c=c.isFlyout?c.targetWorkspace:c)||c.isReadOnly())return!1;if(b instanceof PointerEvent)return b=bH(c,new g9(b.clientX,b.clientY)),!!fL(a,c,b);if(!(b=fK()))return!!fL(a,c);let{left:d,top:e,width:f,height:g}=c.getMetricsManager().getViewMetrics(!0);return new hb(e,e+g,d,d+f).contains(b.x,b.y)?!!fL(a,c):(b=new g9(d+f/2,e+g/2),!!fL(a,c,b))},keyCodes:[a,b]})},fV=function(){let a=gP.registry.createSerializedKey(mT.Z,[mT.CTRL]),b=gP.registry.createSerializedKey(mT.Z,[mT.META]);gP.registry.register({name:mX.UNDO,preconditionFn:a=>!a.isReadOnly()&&!a.isDragging()&&!B.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(a,b)=>(a.hideChaff(),a.undo(!1),b.preventDefault(),!0),keyCodes:[a,b]})},fW=function(){let a=gP.registry.createSerializedKey(mT.Z,[mT.CTRL,mT.SHIFT]),b=gP.registry.createSerializedKey(mT.Z,[mT.META,mT.SHIFT]),c=gP.registry.createSerializedKey(mT.Y,[mT.CTRL]);gP.registry.register({name:mX.REDO,preconditionFn:a=>!a.isDragging()&&!a.isReadOnly()&&!B.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(a,b)=>(a.hideChaff(),a.undo(!0),b.preventDefault(),!0),keyCodes:[a,b,c]})},fX=function(){fO(),fP(),fS(),fT(),fU(),fV(),fW()},fY=function(a){let b=a.saveState();return a.getParameters().length&&(b.parameters=a.getParameters().map(a=>a.saveState())),b},fZ=function(a,b,c,d){if(a=a.loadState(c,d),!c.parameters)return a;for(let[e,f]of c.parameters.entries())a.insertParameter(b.loadState(f,d),e);return a},f$=function(a,b){a.setAttribute("dir","LTR"),bu(b.hasCss,b.pathToMedia);let c=aZ(ha.SVG,{xmlns:gD,"xmlns:html":gE,"xmlns:xlink":gF,version:"1.1",class:"blocklySvg"},a),d=aZ(ha.DEFS,{},c),e=String(Math.random()).substring(2);return b.gridPattern=k9.createDom(e,b.gridOptions,d,a),c},f_=function(a,b,c){c.parentWorkspace=null;let d=(c=new lP(c)).options;c.scale=d.zoomOptions.startScale,b.appendChild(c.createDom("blocklyMainBackground",a));var e=c.getRenderer().getClassName();return e&&a$(a,e),(e=c.getTheme().getClassName())&&a$(a,e),!d.hasCategories&&d.languageTree&&a3(a=c.addFlyout(ha.SVG),b),d.hasTrashcan&&c.addTrashcan(),d.zoomOptions&&d.zoomOptions.controls&&c.addZoomControls(),c.getThemeManager().subscribe(b,"workspaceBackgroundColour","background-color"),c.translate(0,0),c.addChangeListener(e8(c)),bn(c),dX(),c2(),dw(),c},f0=function(a){let b=a.options;var c=a.getParentSvg();if(ax(c.parentNode,"contextmenu",null,function(a){aA(a)||a.preventDefault()}),c=ax(window,"resize",null,function(){dD(),a.hideComponents(!0),dl(),d5(),bn(a),fa(a)}),a.setResizeHandlerWrapper(c),f1(),b.languageTree){c=a.getToolbox();let d=a.getFlyout(!0);c?c.init():d&&(d.init(a),d.show(b.languageTree),"function"==typeof d.scrollToStart&&d.scrollToStart())}b.hasTrashcan&&a.trashcan.init(),b.zoomOptions&&b.zoomOptions.controls&&a.zoomControls_.init(),b.moveOptions&&b.moveOptions.scrollbars?(a.scrollbar=new k1(a,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.horizontal,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),a.scrollbar.resize()):a.setMetrics({x:.5,y:.5}),b.hasSounds&&f2(b.pathToMedia,a)},f1=function(){mB||(ax(document,"scroll",null,function(){let a=be();for(let b=0,c;c=a[b];b++)c instanceof lP&&c.updateInverseScreenCTM()}),ay(document,"touchend",null,as),ay(document,"touchcancel",null,as)),mB=!0},f2=function(a,b){function c(){for(;e.length;){let a=e.pop();a&&az(a)}d.preload()}let d=b.getAudioManager();d.load([a+"click.mp3",a+"click.wav",a+"click.ogg"],"click"),d.load([a+"disconnect.wav",a+"disconnect.mp3",a+"disconnect.ogg"],"disconnect"),d.load([a+"delete.mp3",a+"delete.ogg",a+"delete.wav"],"delete");let e=[];e.push(ax(document,"pointermove",null,c,!0)),e.push(ax(document,"touchstart",null,c,!0))},f3=function(a){let b;return!!a&&!!a.isSimpleReporter()&&(null==(b=a.getFields().next().value)?void 0:b.isFullBlockField())},f4=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.UNDO,preconditionFn:a=>a.workspace.getUndoStack().length>0?"enabled":"disabled",callback(a){a.workspace.undo(!1)},scopeType:jC.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},f5=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.REDO,preconditionFn:a=>a.workspace.getRedoStack().length>0?"enabled":"disabled",callback(a){a.workspace.undo(!0)},scopeType:jC.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},f6=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:a=>a.workspace.isMovable()?a.workspace.getTopBlocks(!1).length>1?"enabled":"disabled":"hidden",callback(a){a.workspace.cleanUp()},scopeType:jC.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},f7=function(a,b){function c(b){e--,b.setCollapsed(a),0===e&&B.setGroup$$module$build$src$core$events$utils(!1)}let d=0,e=0;B.setGroup$$module$build$src$core$events$utils(!0);for(let a=0;a<b.length;a++){let f=b[a];for(;f;)e++,setTimeout(c.bind(null,f),d),f=f.getNextBlock(),d+=10}},f8=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(let b=0;b<a.length;b++){let c=a[b];for(;c;){if(!c.isCollapsed())return"enabled";c=c.getNextBlock()}}return"disabled"}return"hidden"},callback(a){f7(!0,a.workspace.getTopBlocks(!0))},scopeType:jC.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},f9=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(let b=0;b<a.length;b++){let c=a[b];for(;c;){if(c.isCollapsed())return"enabled";c=c.getNextBlock()}}return"disabled"}return"hidden"},callback(a){f7(!1,a.workspace.getTopBlocks(!0))},scopeType:jC.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},ga=function(a,b){if(a.isDeletable())Array.prototype.push.apply(b,a.getDescendants(!1));else{a=a.getChildren(!1);for(let c=0;c<a.length;c++)ga(a[c],b)}},gb=function(a){let b=[];a=a.getTopBlocks(!0);for(let c=0;c<a.length;c++)ga(a[c],b);return b},gc=function(a,b){b?B.setGroup$$module$build$src$core$events$utils(b):(B.setGroup$$module$build$src$core$events$utils(!0),b=B.getGroup$$module$build$src$core$events$utils());let c=a.shift();c&&(c.isDeadOrDying()?gc(a,b):(c.dispose(!1,!0),setTimeout(gc,10,a,b))),B.setGroup$$module$build$src$core$events$utils(!1)},gd=function(){jC.registry.register({displayText:a=>a.workspace?1===(a=gb(a.workspace).length)?B.Msg$$module$build$src$core$msg.DELETE_BLOCK:B.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${a}`):"",preconditionFn:a=>a.workspace&&gb(a.workspace).length>0?"enabled":"disabled",callback(a){if(a.workspace){a.workspace.cancelCurrentGesture();var b=gb(a.workspace);b.length<2?gc(b):ce(B.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(b.length)),function(a){a&&gc(b)})}},scopeType:jC.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},ge=function(){f4(),f5(),f6(),f8(),f9(),gd()},gf=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:a=>!(a=a.block).isInFlyout&&a.isDeletable()&&a.isMovable()?a.isDuplicatable()?"enabled":"disabled":"hidden",callback(a){if(a.block){var b=a.block.toCopyData();b&&fL(b,a.block.workspace)}},scopeType:jC.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},gg=function(){jC.registry.register({displayText:a=>a.block.hasIcon(kX.TYPE)?B.Msg$$module$build$src$core$msg.REMOVE_COMMENT:B.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:a=>!(a=a.block)||a.isInFlyout||!a.workspace.options.comments||a.isCollapsed()||!a.isEditable()||!a.hasIcon(kX.TYPE)&&f3(a)?"hidden":"enabled",callback(a){(a=a.block)&&a.hasIcon(kX.TYPE)?a.setCommentText(null):a.setCommentText("")},scopeType:jC.ScopeType.BLOCK,id:"blockComment",weight:2})},gh=function(){jC.registry.register({displayText:a=>a.block.getInputsInline()?B.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:B.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(a){if(!(a=a.block).isInFlyout&&a.isMovable()&&!a.isCollapsed()){for(let b=1;b<a.inputList.length;b++)if(!(a.inputList[b-1]instanceof mt||a.inputList[b]instanceof mt))return"enabled"}return"hidden"},callback(a){a.block.setInputsInline(!a.block.getInputsInline())},scopeType:jC.ScopeType.BLOCK,id:"blockInline",weight:3})},gi=function(){jC.registry.register({displayText:a=>a.block.isCollapsed()?B.Msg$$module$build$src$core$msg.EXPAND_BLOCK:B.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:a=>!(a=a.block).isInFlyout&&a.isMovable()&&a.workspace.options.collapse?"enabled":"hidden",callback(a){a.block.setCollapsed(!a.block.isCollapsed())},scopeType:jC.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},gj=function(){jC.registry.register({displayText:a=>a.block.hasDisabledReason(hW)?B.Msg$$module$build$src$core$msg.ENABLE_BLOCK:B.Msg$$module$build$src$core$msg.DISABLE_BLOCK,preconditionFn(a){if(!(a=a.block).isInFlyout&&a.workspace.options.disable&&a.isEditable()){var b=a.getDisabledReasons();return b=b.size>+!!b.has(hW),a.getInheritedDisabled()||b?"disabled":"enabled"}return"hidden"},callback(a){a=a.block;let b=B.getGroup$$module$build$src$core$events$utils();b||B.setGroup$$module$build$src$core$events$utils(!0),a.setDisabledReason(!a.hasDisabledReason(hW),hW),B.setGroup$$module$build$src$core$events$utils(b)},scopeType:jC.ScopeType.BLOCK,id:"blockDisable",weight:5})},gk=function(){jC.registry.register({displayText(a){var b=a.block;return a=b.getDescendants(!1).length,(b=b.getNextBlock())&&(a-=b.getDescendants(!1).length),1===a?B.Msg$$module$build$src$core$msg.DELETE_BLOCK:B.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${a}`)},preconditionFn:a=>!a.block.isInFlyout&&a.block.isDeletable()?"enabled":"hidden",callback(a){a.block&&a.block.checkAndDelete()},scopeType:jC.ScopeType.BLOCK,id:"blockDelete",weight:6})},gl=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.HELP,preconditionFn:a=>("function"==typeof(a=a.block).helpUrl?a.helpUrl():a.helpUrl)?"enabled":"hidden",callback(a){a.block.showHelp()},scopeType:jC.ScopeType.BLOCK,id:"blockHelp",weight:7})},gm=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(a){let b;return(null==(b=a.comment)?0:b.isDeletable())?"enabled":"hidden"},callback(a){let b;B.setGroup$$module$build$src$core$events$utils(!0),null==(b=a.comment)||b.dispose(),B.setGroup$$module$build$src$core$events$utils(!1)},scopeType:jC.ScopeType.COMMENT,id:"commentDelete",weight:6})},gn=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(a){let b;return(null==(b=a.comment)?0:b.isMovable())?"enabled":"hidden"},callback(a){if(a.comment){var b=a.comment.toCopyData();b&&fL(b,a.comment.workspace)}},scopeType:jC.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},go=function(){jC.registry.register({displayText:()=>B.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:a=>{let b;return(null==(b=a.workspace)?0:b.isMutator)?"hidden":"enabled"},callback:(a,b,c,d)=>{(a=a.workspace)&&(B.setGroup$$module$build$src$core$events$utils(!0),(b=new jR(a)).setPlaceholderText(B.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),b.moveTo(bH(a,new g9(d.x,d.y))),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(b),B.setGroup$$module$build$src$core$events$utils(!1))},scopeType:jC.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},gp=function(){gf(),gg(),gh(),gi(),gj(),gk(),gl()},gq=function(){ge(),gp()},(gr=gr||{}).scope={},gr.ASSUME_ES5=!1,gr.ASSUME_ES6=!1,gr.ASSUME_ES2020=!1,gr.ASSUME_NO_NATIVE_MAP=!1,gr.ASSUME_NO_NATIVE_SET=!1,gr.ISOLATE_POLYFILLS=!1,gr.FORCE_POLYFILL_PROMISE=!1,gr.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,gr.INSTRUMENT_ASYNC_CONTEXT=!0,gr.objectCreate=gr.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};return b.prototype=a,new b},gr.defineProperty=gr.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){return a==Array.prototype||a==Object.prototype||(a[b]=c.value),a},gr.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,!1,"object"==typeof self&&self,a.g];for(var c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")},gr.global=gr.ASSUME_ES2020?globalThis:gr.getGlobal(this),gr.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),gr.TRUST_ES6_POLYFILLS=!gr.ISOLATE_POLYFILLS||gr.IS_SYMBOL_NATIVE,gr.polyfills={},gr.propertyToPolyfillSymbol={},gr.POLYFILL_PREFIX="$jscp$",gr.polyfill=function(a,b,c,d){b&&(gr.ISOLATE_POLYFILLS?gr.polyfillIsolated(a,b,c,d):gr.polyfillUnisolated(a,b,c,d))},gr.polyfillUnisolated=function(a,b,c,d){for(d=0,c=gr.global,a=a.split(".");d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}(b=b(d=c[a=a[a.length-1]]))!=d&&null!=b&&gr.defineProperty(c,a,{configurable:!0,writable:!0,value:b})},gr.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length,d=e[0],d=!a&&d in gr.polyfills?gr.polyfills:gr.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1],null!=(b=b(c=gr.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null))&&(a?gr.defineProperty(gr.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===gr.propertyToPolyfillSymbol[e]&&(c=1e9*Math.random()>>>0,gr.propertyToPolyfillSymbol[e]=gr.IS_SYMBOL_NATIVE?gr.global.Symbol(e):gr.POLYFILL_PREFIX+c+"$"+e),gr.defineProperty(d,gr.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))},gr.getConstructImplementation=function(){if(gr.TRUST_ES6_POLYFILLS&&"u">typeof Reflect&&Reflect.construct){if(function(){function a(){}return new a,Reflect.construct(a,[],function(){}),new a instanceof a}())return Reflect.construct;var a=Reflect.construct;return function(b,c,d){return b=a(b,c),d&&Reflect.setPrototypeOf(b,d.prototype),b}}return function(a,b,c){return void 0===c&&(c=a),c=gr.objectCreate(c.prototype||Object.prototype),Function.prototype.apply.call(a,c,b)||c}},gr.construct=({valueOf:gr.getConstructImplementation}).valueOf(),gr.underscoreProtoCanBeSet=function(){var a={};try{return a.__proto__={a:!0},a.a}catch(a){}return!1},gr.setPrototypeOf=gr.ASSUME_ES6||gr.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:gr.underscoreProtoCanBeSet()?function(a,b){if(a.__proto__=b,a.__proto__!==b)throw TypeError(a+" is not extensible");return a}:null,gr.inherits=function(a,b){if(a.prototype=gr.objectCreate(b.prototype),a.prototype.constructor=a,gr.ASSUME_ES6||gr.setPrototypeOf){var c=gr.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype},gr.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}},gr.arrayIterator=function(a){return{next:gr.arrayIteratorImpl(a)}},gr.makeIterator=function(a){var b="u">typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if("number"==typeof a.length)return gr.arrayIterator(a);throw Error(String(a)+" is not an iterable or ArrayLike")},gr.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c},gr.arrayFromIterable=function(a){return a instanceof Array?a:gr.arrayFromIterator(gr.makeIterator(a))},gr.generator={},gr.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw TypeError("Iterator result "+a+" is not an object")},gr.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},gr.generator.Context.prototype.start_=function(){if(this.isRunning_)throw TypeError("Generator is already running");this.isRunning_=!0},gr.generator.Context.prototype.stop_=function(){this.isRunning_=!1},gr.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},gr.generator.Context.prototype.next_=function(a){this.yieldResult=a},gr.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0},this.jumpToErrorHandler_()},gr.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a},this.nextAddress=this.finallyAddress_},gr.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a},this.nextAddress=this.finallyAddress_},gr.generator.Context.prototype.yield=function(a,b){return this.nextAddress=b,{value:a}},gr.generator.Context.prototype.yieldAll=function(a,b){var c=(a=gr.makeIterator(a)).next();if(gr.generator.ensureIteratorResultIsObject_(c),!c.done)return this.yieldAllIterator_=a,this.yield(c.value,b);this.yieldResult=c.value,this.nextAddress=b},gr.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a},gr.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},gr.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a,void 0!=b&&(this.finallyAddress_=b)},gr.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0,this.finallyAddress_=a||0},gr.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a,this.catchAddress_=b||0},gr.generator.Context.prototype.enterCatchBlock=function(a){return this.catchAddress_=a||0,a=this.abruptCompletion_.exception,this.abruptCompletion_=null,a},gr.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=a||0,this.finallyAddress_=b||0},gr.generator.Context.prototype.leaveFinallyBlock=function(a,b){if(b=this.finallyContexts_.splice(b||0)[0],b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a},gr.generator.Context.prototype.forIn=function(a){return new gr.generator.Context.PropertyIterator(a)},gr.generator.Context.PropertyIterator=function(a){for(var b in this.object_=a,this.properties_=[],a)this.properties_.push(b);this.properties_.reverse()},gr.generator.Context.PropertyIterator.prototype.getNext=function(){for(;this.properties_.length>0;){var a=this.properties_.pop();if(a in this.object_)return a}return null},gr.generator.Engine_=function(a){this.context_=new gr.generator.Context,this.program_=a},gr.generator.Engine_.prototype.next_=function(a){return(this.context_.start_(),this.context_.yieldAllIterator_)?this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_):(this.context_.next_(a),this.nextStep_())},gr.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;return b?this.yieldAllStep_("return"in b?b.return:function(a){return{value:a,done:!0}},a,this.context_.return):(this.context_.return(a),this.nextStep_())},gr.generator.Engine_.prototype.throw_=function(a){return(this.context_.start_(),this.context_.yieldAllIterator_)?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,a,this.context_.next_):(this.context_.throw_(a),this.nextStep_())},gr.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var d=a.call(this.context_.yieldAllIterator_,b);if(gr.generator.ensureIteratorResultIsObject_(d),!d.done)return this.context_.stop_(),d;var e=d.value}catch(a){return this.context_.yieldAllIterator_=null,this.context_.throw_(a),this.nextStep_()}return this.context_.yieldAllIterator_=null,c.call(this.context_,e),this.nextStep_()},gr.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(a){this.context_.yieldResult=void 0,this.context_.throw_(a)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(a=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}},gr.generator.Generator_=function(a){this.next=function(b){return a.next_(b)},this.throw=function(b){return a.throw_(b)},this.return=function(b){return a.return_(b)},this[Symbol.iterator]=function(){return this}},gr.generator.createGenerator=function(a,b){return b=new gr.generator.Generator_(new gr.generator.Engine_(b)),gr.setPrototypeOf&&a.prototype&&gr.setPrototypeOf(b,a.prototype),b},gr.asyncExecutePromiseGenerator=function(a){function b(b){return a.next(b)}function c(b){return a.throw(b)}return new Promise(function(d,e){!function a(f){f.done?d(f.value):Promise.resolve(f.value).then(b,c).then(a,e)}(a.next())})},gr.asyncExecutePromiseGeneratorFunction=function(a){return gr.asyncExecutePromiseGenerator(a())},gr.asyncExecutePromiseGeneratorProgram=function(a){return gr.asyncExecutePromiseGenerator(new gr.generator.Generator_(new gr.generator.Engine_(a)))},gr.polyfill("globalThis",function(a){return a||gr.global},"es_2020","es3"),gr.polyfill("Array.prototype.includes",function(a){return a||function(a,b){var c=this;c instanceof String&&(c=String(c));var d=c.length;for((b=b||0)<0&&(b=Math.max(b+d,0));b<d;b++){var e=c[b];if(e===a||Object.is(e,a))return!0}return!1}},"es7","es3"),gr.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new gr.global.Proxy(a,{get:function(c,d,e){return c==a&&"q"==d&&e==b}}));return!0===b.q}catch(a){return!1}},gr.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,gr.ES6_CONFORMANCE=gr.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&gr.checkEs6ConformanceViaProxy(),gr.initSymbol=function(){},gr.iteratorPrototype=function(a){return(a={next:a})[Symbol.iterator]=function(){return this},a},gr.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},gr.MapEntry=function(){},gr.polyfill("Set.prototype.difference",function(a){return a||function(a){gr.checkIsSetInstance(this),gr.checkIsSetLike(a);var b=gr.getSmallerAndLargerSets(this,a);a=new Set(this);var c=b.smallerSetIterator;b=b.largerSet;for(var d=c.next();!d.done;)b.has(d.value)&&a.delete(d.value),d=c.next();return a}},"es_next","es6"),gr.checkIsSetLike=function(a){if("object"!=typeof a||null===a||"number"!=typeof a.size||a.size<0||"function"!=typeof a.keys||"function"!=typeof a.has)throw TypeError("Argument must be set-like")},gr.checkIsValidIterator=function(a){if("object"!=typeof a||null===a||"function"!=typeof a.next)throw TypeError("Invalid iterator.");return a},gr.getSmallerAndLargerSets=function(a,b){return a.size<=b.size?{smallerSetIterator:a.keys(),largerSet:b}:{smallerSetIterator:gr.checkIsValidIterator(b.keys()),largerSet:a}},gr.checkIsSetInstance=function(a){if(!(a instanceof Set))throw TypeError("Method must be called on an instance of Set.")},gr.iteratorFromArray=function(a,b){if(gr.ASSUME_ES6)return a[Symbol.iterator]();a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}return d=!0,{done:!0,value:void 0}}};return e[Symbol.iterator]=function(){return e},e},gr.polyfill("Array.prototype.values",function(a){return a||function(){return gr.iteratorFromArray(this,function(a,b){return b})}},"es8","es3"),gr.polyfill("Array.prototype.flatMap",function(a){return a||function(a,b){var c=[];return Array.prototype.forEach.call(this,function(d,e){Array.isArray(d=a.call(b,d,e,this))?c.push.apply(c,d):c.push(d)}),c}},"es9","es5"),gr.polyfill("Array.prototype.flat",function(a){return a||function(a){a=void 0===a?1:a;var b=[];return Array.prototype.forEach.call(this,function(c){Array.isArray(c)&&a>0?(c=Array.prototype.flat.call(c,a-1),b.push.apply(b,c)):b.push(c)}),b}},"es9","es5"),gr.polyfill("Object.entries",function(a){return a||function(a){var b,c=[];for(b in a)gr.owns(a,b)&&c.push([b,a[b]]);return c}},"es8","es3"),gr.polyfill("Object.values",function(a){return a||function(a){var b,c=[];for(b in a)gr.owns(a,b)&&c.push(a[b]);return c}},"es8","es3");var C=Object.create(null),D=Object.create(null),E="default",F=class{constructor(a){this.name=a}toString(){return this.name}};F.CONNECTION_CHECKER=new F("connectionChecker"),F.CONNECTION_PREVIEWER=new F("connectionPreviewer"),F.CURSOR=new F("cursor"),F.EVENT=new F("event"),F.FIELD=new F("field"),F.INPUT=new F("input"),F.RENDERER=new F("renderer"),F.TOOLBOX=new F("toolbox"),F.THEME=new F("theme"),F.TOOLBOX_ITEM=new F("toolboxItem"),F.FLYOUTS_VERTICAL_TOOLBOX=new F("flyoutsVerticalToolbox"),F.FLYOUTS_HORIZONTAL_TOOLBOX=new F("flyoutsHorizontalToolbox"),F.FLYOUT_INFLATER=new F("flyoutInflater"),F.METRICS_MANAGER=new F("metricsManager"),F.BLOCK_DRAGGER=new F("blockDragger"),F.SERIALIZER=new F("serializer"),F.ICON=new F("icon"),F.PASTER=new F("paster"),F.VARIABLE_MODEL=new F("variableModel"),F.VARIABLE_MAP=new F("variableMap");var G={DEFAULT:E,TEST_ONLY:{typeMap:C}};G.Type=F,G.getAllItems=ap,G.getClass=an,G.getClassFromOptions=aq,G.getObject=ao,G.hasItem=am,G.register=ai,G.unregister=ak;var H=Object.create(null),I=750,J="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),K=null,L={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},M=0,N={TOUCH_ENABLED:J,TOUCH_MAP:L};N.checkTouchIdentifier=aw,N.clearTouchIdentifier=at,N.getTouchIdentifierFromEvent=av,N.longStart=ar,N.longStop=as,N.shouldHandleEvent=au;var O=globalThis.navigator&&globalThis.navigator.userAgent||"";function P(a){return Q.includes(a.toUpperCase())}let Q=(gs=O).toUpperCase();gt=P("JavaFX"),gu=P("WebKit"),gv=P("Gecko")&&!gu,gw=P("Android"),O=globalThis.navigator&&globalThis.navigator.maxTouchPoints,gx=P("iPad")||P("Macintosh")&&O>0,gy=P("iPhone")&&!gx,gz=P("Macintosh"),gA=!(gx||gw&&!P("Mobile")||P("Silk"))&&(gy||gw);var R=gt,S=gz,T=40,U=125,V={};V.bind=ay,V.conditionalBind=ax,V.getScrollDeltaPixels=aD,V.isRightButton=aB,V.isTargetInput=aA,V.mouseToSvg=aC,V.unbind=az,(ah=gB||(gB={})).BLOCK_CREATE="create",ah.BLOCK_DELETE="delete",ah.BLOCK_CHANGE="change",ah.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",ah.BLOCK_MOVE="move",ah.VAR_CREATE="var_create",ah.VAR_DELETE="var_delete",ah.VAR_RENAME="var_rename",ah.VAR_TYPE_CHANGE="var_type_change",ah.UI="ui",ah.BLOCK_DRAG="drag",ah.SELECTED="selected",ah.CLICK="click",ah.MARKER_MOVE="marker_move",ah.BUBBLE_OPEN="bubble_open",ah.TRASHCAN_OPEN="trashcan_open",ah.TOOLBOX_ITEM_SELECT="toolbox_item_select",ah.THEME_CHANGE="theme_change",ah.VIEWPORT_CHANGE="viewport_change",ah.COMMENT_CREATE="comment_create",ah.COMMENT_DELETE="comment_delete",ah.COMMENT_CHANGE="comment_change",ah.COMMENT_MOVE="comment_move",ah.COMMENT_RESIZE="comment_resize",ah.COMMENT_DRAG="comment_drag",ah.COMMENT_COLLAPSE="comment_collapse",ah.FINISHED_LOADING="finished_loading";var W=[gB.BLOCK_CREATE,gB.BLOCK_MOVE,gB.COMMENT_CREATE,gB.COMMENT_MOVE],X="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Y={genUid:()=>{let a=X.length,b=[];for(let c=0;c<20;c++)b[c]=X.charAt(Math.random()*a);return b.join("")}},Z=0,$={TEST_ONLY:Y};$.genUid=aF,$.getNextUniqueId=aE;var _={};_.isBlockChange=aI,_.isBlockCreate=aG,_.isBlockDelete=aH,_.isBlockDrag=function(a){return a.type===gB.BLOCK_DRAG},_.isBlockFieldIntermediateChange=aJ,_.isBlockMove=aK,_.isBubbleOpen=aM,_.isClick=aL,_.isCommentChange=function(a){return a.type===gB.COMMENT_CHANGE},_.isCommentCollapse=function(a){return a.type===gB.COMMENT_COLLAPSE},_.isCommentCreate=function(a){return a.type===gB.COMMENT_CREATE},_.isCommentDelete=function(a){return a.type===gB.COMMENT_DELETE},_.isCommentDrag=function(a){return a.type===gB.COMMENT_DRAG},_.isCommentMove=function(a){return a.type===gB.COMMENT_MOVE},_.isCommentResize=function(a){return a.type===gB.COMMENT_RESIZE},_.isFinishedLoading=function(a){return a.type===gB.FINISHED_LOADING},_.isSelected=function(a){return a.type===gB.SELECTED},_.isThemeChange=function(a){return a.type===gB.THEME_CHANGE},_.isToolboxItemSelect=function(a){return a.type===gB.TOOLBOX_ITEM_SELECT},_.isTrashcanOpen=function(a){return a.type===gB.TRASHCAN_OPEN},_.isVarCreate=function(a){return a.type===gB.VAR_CREATE},_.isVarDelete=function(a){return a.type===gB.VAR_DELETE},_.isVarRename=function(a){return a.type===gB.VAR_RENAME},_.isViewportChange=aN;var aa="",ab=!0,ac=0,ad="ORPHANED_BLOCK",ae=[],af={FIRE_QUEUE:ae,enqueueEvent:aR,fireNow:aQ,fireInternal:function(a){if(aU()){if(!ae.length)try{requestAnimationFrame(()=>{setTimeout(aQ,0)})}catch(a){setTimeout(aQ,0)}aR(a)}},setGroupInternal:function(a){aa="boolean"==typeof a?a?aF():"":a}},ag={TEST_ONLY:af};ag.clearPendingUndo=aT,ag.disable=B.disable$$module$build$src$core$events$utils,ag.disableOrphans=aY,ag.enable=B.enable$$module$build$src$core$events$utils,ag.filter=aS,ag.fire=aP,ag.fromJson=aW,ag.get=aX,ag.getDescendantIds=aV,ag.getGroup=B.getGroup$$module$build$src$core$events$utils,ag.getRecordUndo=aO,ag.isEnabled=aU,ag.setGroup=B.setGroup$$module$build$src$core$events$utils,ag.setRecordUndo=B.setRecordUndo$$module$build$src$core$events$utils;var ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a$,a_,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b$,b_,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c$,c_,c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,dp,dq,dr,ds,dt,du,dv,dw,dx,dy,dz,dA,dB,dC,dD,dE,dF,dG,dH,dI,dJ,dK,dL,dM,dN,dO,dP,dQ,dR,dS,dT,dU,dV,dW,dX,dY,dZ,d$,d_,d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM,eN,eO,eP,eQ,eR,eS,eT,eU,eV,eW,eX,eY,eZ,e$,e_,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,fa,fb,fc,fd,fe,ff,fg,fh,fi,fj,fk,fl,fm,fn,fo,fp,fq,fr,fs,ft,fu,fv,fw,fx,fy,fz,fA,fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f$,f_,f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD="http://www.w3.org/2000/svg",gE="http://www.w3.org/1999/xhtml",gF="http://www.w3.org/1999/xlink";(gQ=gC||(gC={}))[gQ.ELEMENT_NODE=1]="ELEMENT_NODE",gQ[gQ.TEXT_NODE=3]="TEXT_NODE",gQ[gQ.COMMENT_NODE=8]="COMMENT_NODE";var gG=null,gH=0,gI=null,gJ={HTML_NS:gE};gJ.NodeType=gC,gJ.SVG_NS=gD,gJ.XLINK_NS=gF,gJ.addClass=a$,gJ.createSvgElement=aZ,gJ.getFastTextWidth=function(a,b,c,d){return a8(a,b+"pt",c,d)},gJ.getFastTextWidthWithSizeString=a8,gJ.getTextWidth=a7,gJ.hasClass=a1,gJ.insertAfter=a3,gJ.measureFontMetrics=a9,gJ.removeClass=a0,gJ.removeClasses=a_,gJ.removeNode=a2,gJ.setCssTransform=a4,gJ.startTextWidthCache=a5,gJ.stopTextWidthCache=a6;var gK=class{static findFocusedNode(a){var b=a.getRootFocusableNode();if(!b.canBeFocused())return null;var c=b.getFocusableElement();return a1(c,gK.ACTIVE_CLASS_NAME)||a1(c,gK.PASSIVE_CSS_CLASS_NAME)||((b=c.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||b instanceof SVGElement)&&(b=gK.findFocusableNodeFor(b,a))?b:((c=c.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||c instanceof SVGElement)&&(a=gK.findFocusableNodeFor(c,a))?a:null}static findFocusableNodeFor(a,b){if(!a.id||"null"===a.id||-1!==b.getNestedTrees().map(b=>gK.findFocusableNodeFor(a,b)).findIndex(a=>!!a))return null;var c,d=b.getRootFocusableNode();return d.canBeFocused()&&a===d.getFocusableElement()||(d=null!=(c=b.lookUpFocusableNode(a.id))?c:null)?d:(c=a.parentElement,!d&&c?gK.findFocusableNodeFor(c,b):null)}};gK.ACTIVE_CLASS_NAME="blocklyActiveFocus",gK.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",gK.ACTIVE_FOCUS_NODE_CSS_SELECTOR=`.${gK.ACTIVE_CLASS_NAME}`,gK.PASSIVE_FOCUS_NODE_CSS_SELECTOR=`.${gK.PASSIVE_CSS_CLASS_NAME}`;var gL=class{constructor(a,b){this.tree=a,this.rootShouldBeAutoTabbable=b}},gM=class{constructor(a){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;const b=a=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!a;var b=null;if(a instanceof HTMLElement||a instanceof SVGElement){for(var c of this.registeredTrees)if(b=gK.findFocusableNodeFor(a,c.tree))break}if(b&&b.canBeFocused()){let d;a=b.getFocusableTree(),c=null==(d=this.focusedNode)?void 0:d.getFocusableTree(),b===a.getRootFocusableNode()&&a!==c?this.focusTree(a):this.focusNode(b)}else this.defocusCurrentFocusedNode()}};a("focusin",a=>{a instanceof FocusEvent&&b(document.activeElement)}),a("focusout",a=>{a instanceof FocusEvent&&b(a.relatedTarget)})}registerTree(a,b=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(a))throw Error(`Attempted to re-register already registered tree: ${a}.`);this.registeredTrees.push(new gL(a,b));let c=a.getRootFocusableNode().getFocusableElement();if(!c.id||"null"===c.id)throw Error(`Attempting to register a tree with a root element that has an invalid ID: ${a}.`);b&&(c.tabIndex=0)}isRegistered(a){return!!this.lookUpRegistration(a)}lookUpRegistration(a){let b;return null!=(b=this.registeredTrees.find(b=>b.tree===a))?b:null}unregisterTree(a){if(this.ensureManagerIsUnlocked(),!this.isRegistered(a))throw Error(`Attempted to unregister not registered tree: ${a}.`);var b=this.registeredTrees.findIndex(b=>b.tree===a);let c=this.registeredTrees[b];this.registeredTrees.splice(b,1),b=gK.findFocusedNode(a);let d=a.getRootFocusableNode();b&&this.removeHighlight(b),this.focusedNode!==b&&this.focusedNode!==d||this.updateFocusedNode(null),this.removeHighlight(d),c.rootShouldBeAutoTabbable&&a.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){let a,b;return null!=(b=null==(a=this.focusedNode)?void 0:a.getFocusableTree())?b:null}getFocusedNode(){return this.focusedNode}focusTree(a){let b;if(this.ensureManagerIsUnlocked(),!this.isRegistered(a))throw Error(`Attempted to focus unregistered tree: ${a}.`);let c=gK.findFocusedNode(a),d=a.getRestoredFocusableNode(c);a=a.getRootFocusableNode(),this.focusNode(null!=(b=null!=d?d:c)?b:a)}focusNode(a){this.ensureManagerIsUnlocked();let b=!this.currentlyHoldsEphemeralFocus;b&&(this.isUpdatingFocusedNode=!0);var c,d=(null==(c=this.focusedNode)?void 0:c.getFocusableElement())!==document.activeElement;if(this.focusedNode!==a||d)if(a.canBeFocused()){if(c=a.getFocusableTree(),!this.isRegistered(c))throw Error(`Attempted to focus unregistered node: ${a}.`);(d=a.getFocusableElement()).id&&"null"!==d.id||console.warn("Trying to focus a node that has an invalid ID.");var e,f=gK.findFocusableNodeFor(d,c);d=gK.findFocusedNode(c);var g=a;f!==a&&(g=c.getRestoredFocusableNode(d),a=c.getRootFocusableNode(),g=null!=(e=null!=g?g:d)?e:a),e=null==(a=this.focusedNode)?void 0:a.getFocusableTree(),a&&this.passivelyFocusNode(a,c),c=c.getRootFocusableNode(),d&&this.removeHighlight(d),c!==g&&this.removeHighlight(c),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(g,null!=e?e:null),this.updateFocusedNode(g)}else console.warn("Trying to focus a node that can't be focused.");b&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(a){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error(`Attempted to take ephemeral focus when it's already held, with new element: ${a}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),a.focus({preventScroll:!0});let b=!1;return()=>{if(b)throw Error(`Attempted to finish ephemeral focus twice for element: ${a}.`);if(b=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);let a=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===a&&this.recentlyLostAllFocus&&this.focusNode(a)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(a){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=a}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(a,b){let c;this.lockFocusStateChanges=!0;let d=a.getFocusableTree(),e=a.getFocusableElement(),f=null==(c=this.lookUpRegistration(d))?void 0:c.rootShouldBeAutoTabbable;d!==b&&(d.onTreeFocus(a,b),f&&(d.getRootFocusableNode().getFocusableElement().tabIndex=-1)),a.onNodeFocus(),this.lockFocusStateChanges=!1,f&&a===d.getRootFocusableNode()||e.hasAttribute("tabindex")||(e.tabIndex=-1),this.setNodeToVisualActiveFocus(a),e.focus({preventScroll:!0})}passivelyFocusNode(a,b){this.lockFocusStateChanges=!0;let c=a.getFocusableTree();if(c!==b){let a;c.onTreeBlur(b),(null==(a=this.lookUpRegistration(c))?0:a.rootShouldBeAutoTabbable)&&(c.getRootFocusableNode().getFocusableElement().tabIndex=0)}a.onNodeBlur(),this.lockFocusStateChanges=!1,c!==b&&this.setNodeToVisualPassiveFocus(a)}setNodeToVisualActiveFocus(a){a$(a=a.getFocusableElement(),gM.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),a0(a,gM.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(a){a0(a=a.getFocusableElement(),gM.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),a$(a,gM.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(a){a0(a=a.getFocusableElement(),gM.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),a0(a,gM.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return gM.focusManager||(gM.focusManager=new gM(document.addEventListener)),gM.focusManager}};gM.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",gM.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",gM.focusManager=null;var gN={};gN.FocusManager=gM,gN.getFocusManager=B.getFocusManager$$module$build$src$core$focus_manager;var gO={};gO.deepMerge=bc;var gP=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(a,b){if(this.shortcuts.get(a.name)&&!b)throw Error(`Shortcut named "${a.name}" already exists.`);if(this.shortcuts.set(a.name,a),null==(b=a.keyCodes)?0:b.length)for(let c of b)this.addKeyMapping(c,a.name,!!a.allowCollision)}unregister(a){return this.shortcuts.get(a)?(this.removeAllKeyMappings(a),this.shortcuts.delete(a),!0):(console.warn(`Keyboard shortcut named "${a}" not found.`),!1)}addKeyMapping(a,b,c){a=`${a}`;let d=this.keyMap.get(a);if(d&&!c)throw Error(`Shortcut named "${b}" collides with shortcuts "${d}"`);d&&c?d.unshift(b):this.keyMap.set(a,[b])}removeKeyMapping(a,b,c){let d=this.keyMap.get(a);if(!d)return c||console.warn(`No keyboard shortcut named "${b}" registered with key code "${a}"`),!1;let e=d.indexOf(b);return e>-1?(d.splice(e,1),0===d.length&&this.keyMap.delete(a),!0):(c||console.warn(`No keyboard shortcut named "${b}" registered with key code "${a}"`),!1)}removeAllKeyMappings(a){for(let b of this.keyMap.keys())this.removeKeyMapping(b,a,!0)}setKeyMap(a){for(let b in this.keyMap.clear(),a)this.keyMap.set(b,a[b])}getKeyMap(){let a=Object.create(null);for(let[b,c]of this.keyMap)a[b]=c;return a}getRegistry(){let a=Object.create(null);for(let[b,c]of this.shortcuts)a[b]=c;return bc(Object.create(null),a)}onKeyDown(a,b){var c=this.serializeKeyEvent(b);if(!(c=this.getShortcutNamesByKeyCode(c)))return!1;for(let d of c){let e,f,g,h;if((c=this.shortcuts.get(d))&&(!c.preconditionFn||c.preconditionFn(a,{focusedNode:null!=(e=B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?e:void 0}))&&(null==(g=(f=c).callback)?0:g.call(f,a,b,c,{focusedNode:null!=(h=B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?h:void 0})))return!0}return!1}getShortcutNamesByKeyCode(a){let b;return(null==(b=this.keyMap.get(a))?void 0:b.slice())||[]}getKeyCodesByShortcutName(a){let b=[];for(let[c,d]of this.keyMap)d.indexOf(a)>-1&&b.push(c);return b}serializeKeyEvent(a){let b="";for(let c in gP.modifierKeys)a.getModifierState(c)&&(""!==b&&(b+="+"),b+=c);return""!==b&&a.keyCode?b+="+"+a.keyCode:a.keyCode&&(b=String(a.keyCode)),b}checkModifiers(a){for(let b of a)if(!(b in gP.modifierKeys))throw Error(b+" is not a valid modifier key.")}createSerializedKey(a,b){let c="";if(b)for(let a in this.checkModifiers(b),gP.modifierKeys)b.includes(gP.modifierKeys[a])&&(""!==c&&(c+="+"),c+=a);return""!==c&&a?c+="+"+a:a&&(c=`${a}`),c}};gP.registry=new gP,(gR=(gR=gP||(gP={})).modifierKeys||(gR.modifierKeys={}))[gR.Shift=16]="Shift",gR[gR.Control=17]="Control",gR[gR.Alt=18]="Alt",gR[gR.Meta=91]="Meta";var gQ,gR,gS,gT,gU=Object.create(null),gV=[],gW={defineBlocksWithJsonArrayInternal:function(a){B.defineBlocks$$module$build$src$core$common(B.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(a))}},gX={TEST_ONLY:gW};gX.createBlockDefinitionsFromJsonArray=B.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,gX.defineBlocks=B.defineBlocks$$module$build$src$core$common,gX.defineBlocksWithJsonArray=bq,gX.draggingConnections=gV,gX.fireSelectedEvent=bk,gX.getAllWorkspaces=be,gX.getBlockTypeCounts=bo,gX.getMainWorkspace=bh,gX.getParentContainer=bl,gX.getSelected=bj,gX.getWorkspaceById=bd,gX.globalShortcutHandler=br,gX.registerWorkspace=bf,gX.setMainWorkspace=bi,gX.setParentContainer=bm,gX.setSelected=function(a){B.getFocusManager$$module$build$src$core$focus_manager().focusNode(a)},gX.svgResize=bn,gX.unregisterWorkpace=bg;var gY,gZ=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=B.getGroup$$module$build$src$core$events$utils(),this.recordUndo=aO()}toJson(){return{type:this.type,group:this.group}}static fromJson(a,b,c){return c.isBlank=!1,c.group=a.group||"",c.workspaceId=b.id,c}isNull(){return!1}run(a){}getEventWorkspace_(){let a;if(this.workspaceId&&(a=bd(this.workspaceId)),!a)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return a}},g$=class extends gZ{constructor(a){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=void 0===a,this.workspaceId=a||""}},g_=class extends g${constructor(a,b,c){null===(b=a?a.workspace.id:b)&&(b=void 0),super(b),this.type=gB.CLICK,this.blockId=a?a.id:void 0,this.targetType=c}toJson(){let a=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return a.targetType=this.targetType,a.blockId=this.blockId,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new g_)).targetType=a.targetType,b.blockId=a.blockId,b}};(hr=gY||(gY={})).BLOCK="block",hr.WORKSPACE="workspace",hr.ZOOM_CONTROLS="zoom_controls",ai(F.EVENT,gB.CLICK,g_);var g0={};g0.Click=g_,g0.ClickTarget=gY;var g1={};g1.removeElem=bs;var g2=class{constructor(a){this.name=a}toString(){return this.name}};g2.POSITIONABLE=new g2("positionable"),g2.DRAG_TARGET=new g2("drag_target"),g2.DELETE_AREA=new g2("delete_area"),g2.AUTOHIDEABLE=new g2("autohideable");var g3=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(a,b){let c=a.component.id;if(!b&&this.componentData.has(c)){var d;throw Error('Plugin "'+c+'" with capabilities "'+(null==(d=this.componentData.get(c))?void 0:d.capabilities)+'" already added.')}for(this.componentData.set(c,a),b=[],d=0;d<a.capabilities.length;d++){let e=String(a.capabilities[d]).toLowerCase();if(b.push(e),this.capabilityToComponentIds.has(e)){let a;null==(a=this.capabilityToComponentIds.get(e))||a.push(c)}else this.capabilityToComponentIds.set(e,[c])}this.componentData.get(c).capabilities=b}removeComponent(a){let b=this.componentData.get(a);if(b){for(let c=0;c<b.capabilities.length;c++){let d=String(b.capabilities[c]).toLowerCase();bs(this.capabilityToComponentIds.get(d),a)}this.componentData.delete(a)}}addCapability(a,b){if(!this.getComponent(a))throw Error('Cannot add capability, "'+b+'". Plugin "'+a+'" has not been added to the ComponentManager');if(this.hasCapability(a,b))console.warn('Plugin "'+a+'already has capability "'+b+'"');else{var c,d;b=`${b}`.toLowerCase(),null==(c=this.componentData.get(a))||c.capabilities.push(b),null==(d=this.capabilityToComponentIds.get(b))||d.push(a)}}removeCapability(a,b){if(!this.getComponent(a))throw Error('Cannot remove capability, "'+b+'". Plugin "'+a+'" has not been added to the ComponentManager');this.hasCapability(a,b)?(b=`${b}`.toLowerCase(),bs(this.componentData.get(a).capabilities,b),bs(this.capabilityToComponentIds.get(b),a)):console.warn('Plugin "'+a+"doesn't have capability \""+b+'" to remove')}hasCapability(a,b){return b=`${b}`.toLowerCase(),this.componentData.has(a)&&this.componentData.get(a).capabilities.includes(b)}getComponent(a){let b;return null==(b=this.componentData.get(a))?void 0:b.component}getComponents(a,b){if(a=`${a}`.toLowerCase(),!(a=this.capabilityToComponentIds.get(a)))return[];let c=[];if(b){let b=[];a.forEach(a=>{b.push(this.componentData.get(a))}),b.sort(function(a,b){return a.weight-b.weight}),b.forEach(function(a){c.push(a.component)})}else a.forEach(a=>{c.push(this.componentData.get(a).component)});return c}};g3.Capability=g2,(hs=(hs=g3||(g3={})).ComponentWeight||(hs.ComponentWeight={}))[hs.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",hs[hs.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",hs[hs.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",hs[hs.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT";var g4=g3.ComponentWeight,g5={};g5.ComponentManager=g3,g5.ComponentWeight=g4;var g6=!1,g7='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete,\n.blocklyDragging.blocklyDraggingDelete .blocklyField {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover):not(:focus),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',g8={};g8.inject=bu,g8.register=bt;var g9=class{constructor(a,b){this.x=a,this.y=b}clone(){return new g9(this.x,this.y)}scale(a){return this.x*=a,this.y*=a,this}translate(a,b){return this.x+=a,this.y+=b,this}static equals(a,b){return a===b||!!a&&!!b&&a.x===b.x&&a.y===b.y}static distance(a,b){let c=a.x-b.x;return Math.sqrt(c*c+(a=a.y-b.y)*a)}static magnitude(a){return Math.sqrt(a.x*a.x+a.y*a.y)}static difference(a,b){return new g9(a.x-b.x,a.y-b.y)}static sum(a,b){return new g9(a.x+b.x,a.y+b.y)}},ha=class{constructor(a){this.tagName=a}toString(){return this.tagName}};ha.ANIMATE=new ha("animate"),ha.CIRCLE=new ha("circle"),ha.CLIPPATH=new ha("clipPath"),ha.DEFS=new ha("defs"),ha.FECOMPOSITE=new ha("feComposite"),ha.FECOMPONENTTRANSFER=new ha("feComponentTransfer"),ha.FEFLOOD=new ha("feFlood"),ha.FEFUNCA=new ha("feFuncA"),ha.FEGAUSSIANBLUR=new ha("feGaussianBlur"),ha.FEPOINTLIGHT=new ha("fePointLight"),ha.FESPECULARLIGHTING=new ha("feSpecularLighting"),ha.FILTER=new ha("filter"),ha.FOREIGNOBJECT=new ha("foreignObject"),ha.G=new ha("g"),ha.IMAGE=new ha("image"),ha.LINE=new ha("line"),ha.PATH=new ha("path"),ha.PATTERN=new ha("pattern"),ha.POLYGON=new ha("polygon"),ha.RECT=new ha("rect"),ha.SVG=new ha("svg"),ha.TEXT=new ha("text"),ha.TSPAN=new ha("tspan");var hb=class{constructor(a,b,c,d){this.top=a,this.bottom=b,this.left=c,this.right=d}static from(a){return new hb(a.y,a.y+a.height,a.x,a.x+a.width)}clone(){return new hb(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new g9(this.left,this.top)}contains(a,b){return a>=this.left&&a<=this.right&&b>=this.top&&b<=this.bottom}intersects(a){return this.left<=a.right&&this.right>=a.left&&this.bottom>=a.top&&this.top<=a.bottom}static equals(a,b){return a===b||!!a&&!!b&&a.top===b.top&&a.bottom===b.bottom&&a.left===b.left&&a.right===b.right}static createFromPoint(a,b,c){let d=a.x;return new hb(a=a.y,a+c,d,d+b)}},hc=class{constructor(a,b){this.width=a,this.height=b}static equals(a,b){return a===b||!!a&&!!b&&a.width===b.width&&a.height===b.height}static max(a,b){return new hc(Math.max(a.width,b.width),Math.max(a.height,b.height))}static min(a,b){return new hc(Math.min(a.width,b.width),Math.min(a.height,b.height))}},hd={getSizeInternal:function(a){if("none"!==bx(a,"display"))return bw(a);let b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden",b.position="absolute",b.display="inline";let f=a.offsetWidth;return a=a.offsetHeight,b.display=c,b.position=e,b.visibility=d,new hc(f,a)}},he={TEST_ONLY:hd};he.getBorderBox=bA,he.getComputedStyle=bx,he.getContainerOffsetToScrollInto=bC,he.getPageOffset=by,he.getSize=bv,he.getViewportPageOffset=bz,he.scrollIntoContainerView=bB;var hf=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,hg=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,hh={TEST_ONLY:{XY_REGEX:hf,XY_STYLE_REGEX:hg}};hh.getDocumentScroll=bG,hh.getInjectionDivXY=bE,hh.getRelativeXY=bD,hh.getViewportBBox=bF,hh.screenToWsCoordinates=bH,hh.wsToScreenCoordinates=bI;var hi=class{constructor(a,b,c,d,e){this.workspace=a,this.horizontal=b,this.oldHostMetrics=null,this.ratio=1,this.origin=new g9(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new g9(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=c||!1,this.margin=void 0!==e?e:hi.DEFAULT_SCROLLBAR_MARGIN,a="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),d&&(a+=" "+d),this.outerSvg=aZ(ha.SVG,{class:a}),d=aZ(ha.G,{},this.outerSvg),this.svgBackground=aZ(ha.RECT,{class:"blocklyScrollbarBackground"},d),a=Math.floor((hi.scrollbarThickness-5)/2),this.svgHandle=aZ(ha.RECT,{class:"blocklyScrollbarHandle",rx:a,ry:a},d),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),a3(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),b?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=ax(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=ax(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){let a=hi.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(a)),this.outerSvg.setAttribute("height",String(a)),this.svgHandle.setAttribute("height",String(a-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(a)),this.outerSvg.setAttribute("width",String(a)),this.svgHandle.setAttribute("width",String(a-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),az(this.onMouseDownBarWrapper_),az(this.onMouseDownHandleWrapper_),a2(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(a){return a=a<=0||isNaN(a)?0:Math.min(a,this.scrollbarLength)}setHandleLength(a){this.handleLength=a,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(a){return a=a<=0||isNaN(a)?0:Math.min(a,this.scrollbarLength-this.handleLength)}setHandlePosition(a){this.handlePosition=a,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(a){this.scrollbarLength=a,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(a,b){this.position.x=a,this.position.y=b,a4(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(a){(a||(a=this.workspace.getMetrics()))&&(this.oldHostMetrics&&hi.metricsAreEquivalent(a,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(a):this.resizeVertical(a),this.oldHostMetrics=a,this.updateMetrics()))}requiresViewResize(a){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==a.viewWidth||this.oldHostMetrics.viewHeight!==a.viewHeight||this.oldHostMetrics.absoluteLeft!==a.absoluteLeft||this.oldHostMetrics.absoluteTop!==a.absoluteTop}resizeHorizontal(a){this.requiresViewResize(a)?this.resizeViewHorizontal(a):this.resizeContentHorizontal(a)}resizeViewHorizontal(a){var b=a.viewWidth-2*this.margin;this.pair&&(b-=hi.scrollbarThickness),this.setScrollbarLength(Math.max(0,b)),b=a.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(b+=hi.scrollbarThickness),this.setPosition(b,a.absoluteTop+a.viewHeight-hi.scrollbarThickness-this.margin),this.resizeContentHorizontal(a)}resizeContentHorizontal(a){if(a.viewWidth>=a.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var b=this.scrollbarLength*a.viewWidth/a.scrollWidth;b=this.constrainHandleLength(b),this.setHandleLength(b),b=a.scrollWidth-a.viewWidth;var c=this.scrollbarLength-this.handleLength;a=(a.viewLeft-a.scrollLeft)/b*c,a=this.constrainHandlePosition(a),this.setHandlePosition(a),this.ratio=c/b}}resizeVertical(a){this.requiresViewResize(a)?this.resizeViewVertical(a):this.resizeContentVertical(a)}resizeViewVertical(a){let b=a.viewHeight-2*this.margin;this.pair&&(b-=hi.scrollbarThickness),this.setScrollbarLength(Math.max(0,b)),this.setPosition(this.workspace.RTL?a.absoluteLeft+this.margin:a.absoluteLeft+a.viewWidth-hi.scrollbarThickness-this.margin,a.absoluteTop+this.margin),this.resizeContentVertical(a)}resizeContentVertical(a){if(a.viewHeight>=a.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var b=this.scrollbarLength*a.viewHeight/a.scrollHeight;b=this.constrainHandleLength(b),this.setHandleLength(b),b=a.scrollHeight-a.viewHeight;var c=this.scrollbarLength-this.handleLength;a=(a.viewTop-a.scrollTop)/b*c,a=this.constrainHandlePosition(a),this.setHandlePosition(a),this.ratio=c/b}}isVisible(){return this.isHandleVisible}setContainerVisible(a){let b=a!==this.containerVisible;this.containerVisible=a,b&&this.updateDisplay_()}setVisible(a){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(a)}setVisibleInternal(a){let b=a!==this.isVisible();this.isHandleVisible=a,b&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(a){if(this.workspace.markFocused(),at(),this.cleanUp(),aB(a))a.stopPropagation();else{var b=aC(a,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());b=this.horizontal?b.x:b.y;var c=bE(this.svgHandle);c=this.horizontal?c.x:c.y;var d=this.handlePosition,e=.95*this.handleLength;b<=c?d-=e:b>=c+this.handleLength&&(d+=e),this.setHandlePosition(this.constrainHandlePosition(d)),this.updateMetrics(),a.stopPropagation(),a.preventDefault()}}onMouseDownHandle(a){this.workspace.markFocused(),this.cleanUp(),aB(a)?a.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?a.clientX:a.clientY,this.onMouseUpWrapper_=ax(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=ax(document,"pointermove",this,this.onMouseMoveHandle),a.stopPropagation(),a.preventDefault())}onMouseMoveHandle(a){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?a.clientX:a.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){at(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(az(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(az(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let a=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(a)&&(a=0),a}updateMetrics(){let a=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:a}):this.workspace.setMetrics({y:a})}set(a,b){this.setHandlePosition(this.constrainHandlePosition(a*this.ratio)),(b||void 0===b)&&this.updateMetrics()}setOrigin(a,b){this.origin=new g9(a,b)}static metricsAreEquivalent(a,b){return a.viewWidth===b.viewWidth&&a.viewHeight===b.viewHeight&&a.viewLeft===b.viewLeft&&a.viewTop===b.viewTop&&a.absoluteTop===b.absoluteTop&&a.absoluteLeft===b.absoluteLeft&&a.scrollWidth===b.scrollWidth&&a.scrollHeight===b.scrollHeight&&a.scrollLeft===b.scrollLeft&&a.scrollTop===b.scrollTop}};hi.scrollbarThickness=J?25:15,hi.DEFAULT_SCROLLBAR_MARGIN=.5;var hj={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},hk={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:hl,DOMParser:hm,XMLSerializer:hn}=globalThis;hm&&(hj=new hm),hn&&(hk=new hn);var ho="https://developers.google.com/blockly/xml",hp=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,hq={NAME_SPACE:ho};hq.createElement=B.createElement$$module$build$src$core$utils$xml,hq.createTextNode=B.createTextNode$$module$build$src$core$utils$xml,hq.domToText=bJ,hq.injectDependencies=function(a){({document:hl=hl,DOMParser:hm=hm,XMLSerializer:hn=hn}=a),hj=new hm,hk=new hn},hq.textToDom=B.textToDom$$module$build$src$core$utils$xml;var hr,hs,ht,hu="categoryToolbox",hv="flyoutToolbox";(hG=ht||(ht={}))[hG.TOP=0]="TOP",hG[hG.BOTTOM=1]="BOTTOM",hG[hG.LEFT=2]="LEFT",hG[hG.RIGHT=3]="RIGHT";var hw={hasCategoriesInternal:function(a){if(!a)return!1;let b=a.kind;return b?b===hu:!!a.contents.filter(a=>"CATEGORY"===a.kind.toUpperCase()).length}},hx={};hx.Position=ht,hx.TEST_ONLY=hw,hx.convertFlyoutDefToJsonArray=bN,hx.convertToolboxDefToJson=bL,hx.hasCategories=bO,hx.isCategoryCollapsible=bP,hx.parseToolboxTree=bT,(hH=hK||(hK={}))[hH.TOP=0]="TOP",hH[hH.BOTTOM=1]="BOTTOM",(hI=hL||(hL={}))[hI.LEFT=0]="LEFT",hI[hI.RIGHT=1]="RIGHT",(hJ=hM||(hM={}))[hJ.UP=0]="UP",hJ[hJ.DOWN=1]="DOWN";var hy={};hy.bumpDirection=hM,hy.bumpPositionRect=bW,hy.getCornerOppositeToolbox=bV,hy.getStartPositionRect=bU,hy.horizontalPosition=hL,hy.verticalPosition=hK;var hz="sprites.png",hA=class{constructor(a){this.workspace=a,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=aZ(ha.G,{});let a=String(Math.random()).substring(2);return this.createZoomOutSvg(a),this.createZoomInSvg(a),this.workspace.isMovable()&&this.createZoomResetSvg(a),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:g3.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[g3.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){for(let a of(this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&a2(this.svgGroup),this.boundEvents))az(a);this.boundEvents.length=0}getBoundingRectangle(){let a=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(a+=this.LARGE_SPACING+this.HEIGHT),new hb(this.top,this.top+a,this.left,this.left+this.WIDTH)}position(a,b){if(this.initialized){var c,d=bV(this.workspace,a),e=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),a=bU(d,new hc(this.WIDTH,e),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,a,this.workspace),d=d.vertical,b=bW(a,this.MARGIN_VERTICAL,d===hK.TOP?hM.DOWN:hM.UP,b),d===hK.TOP){var f,g=this.SMALL_SPACING+this.HEIGHT;null==(f=this.zoomInGroup)||f.setAttribute("transform","translate(0, "+g+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(g+this.LARGE_SPACING+this.HEIGHT)+")")}else{let a;f=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==(a=this.zoomInGroup)||a.setAttribute("transform","translate(0, "+f+")"),f=f+this.SMALL_SPACING+this.HEIGHT,null==(g=this.zoomOutGroup)||g.setAttribute("transform","translate(0, "+f+")")}this.top=b.top,this.left=b.left,null==(c=this.svgGroup)||c.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(a){this.zoomOutGroup=aZ(ha.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);let b=aZ(ha.CLIPPATH,{id:"blocklyZoomoutClipPath"+a},this.zoomOutGroup);aZ(ha.RECT,{width:32,height:32},b),aZ(ha.IMAGE,{width:96,height:124,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+a+")"},this.zoomOutGroup).setAttributeNS(gF,"xlink:href",this.workspace.options.pathToMedia+hz),this.boundEvents.push(ax(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(a){this.zoomInGroup=aZ(ha.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);let b=aZ(ha.CLIPPATH,{id:"blocklyZoominClipPath"+a},this.zoomInGroup);aZ(ha.RECT,{width:32,height:32},b),aZ(ha.IMAGE,{width:96,height:124,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+a+")"},this.zoomInGroup).setAttributeNS(gF,"xlink:href",this.workspace.options.pathToMedia+hz),this.boundEvents.push(ax(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(a,b){this.workspace.markFocused(),this.workspace.zoomCenter(a),this.fireZoomEvent(),at(),b.stopPropagation(),b.preventDefault()}createZoomResetSvg(a){this.zoomResetGroup=aZ(ha.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);let b=aZ(ha.CLIPPATH,{id:"blocklyZoomresetClipPath"+a},this.zoomResetGroup);aZ(ha.RECT,{width:32,height:32},b),aZ(ha.IMAGE,{width:96,height:124,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+a+")"},this.zoomResetGroup).setAttributeNS(gF,"xlink:href",this.workspace.options.pathToMedia+hz),this.boundEvents.push(ax(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(a){this.workspace.markFocused();let b=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(b),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),at(),a.stopPropagation(),a.preventDefault()}fireZoomEvent(){aP(new(aX(gB.CLICK))(null,this.workspace.id,"zoom_controls"))}};bt("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var hB={};hB.register=bX,hB.unregister=function(a){ak(F.SERIALIZER,a)};var hC=class{constructor(){this.priority=25}save(a){let b=[];for(let c of a.getTopComments())(a=bY(c,{addCoordinates:!0,saveIds:!0}))&&b.push(a);return b.length?b:null}load(a,b){for(let c of a)bZ(c,b,{recordUndo:aO()})}clear(a){for(let b of a.getTopComments())b.dispose()}};bX("workspaceComments",new hC);var hD={};hD.WorkspaceCommentSerializer=hC,hD.append=bZ,hD.save=bY;var hE={};hE.register=b$,hE.unregister=function(a){ak(F.PASTER,a)};var hF=class{paste(a,b,c){let d;a=a.commentState,c&&(a.x=c.x,a.y=c.y),B.disable$$module$build$src$core$events$utils();try{d=bZ(a,b),b_(d)}finally{B.enable$$module$build$src$core$events$utils()}return d?(aU()&&aP(new(aX(gB.COMMENT_CREATE))(d)),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(d),d):null}};hF.TYPE="workspace-comment",b$(hF.TYPE,new hF),B.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250},B.config$$module$build$src$core$config;var hG,hH,hI,hJ,hK,hL,hM,hN,hO="aria-",hP="role";(iB=hN||(hN={})).GRID="grid",iB.GRIDCELL="gridcell",iB.GROUP="group",iB.LISTBOX="listbox",iB.MENU="menu",iB.MENUITEM="menuitem",iB.MENUITEMCHECKBOX="menuitemcheckbox",iB.OPTION="option",iB.PRESENTATION="presentation",iB.ROW="row",iB.TREE="tree",iB.TREEITEM="treeitem",iB.SEPARATOR="separator",iB.STATUS="status",(iC=iF||(iF={})).ACTIVEDESCENDANT="activedescendant",iC.COLCOUNT="colcount",iC.DISABLED="disabled",iC.EXPANDED="expanded",iC.INVALID="invalid",iC.LABEL="label",iC.LABELLEDBY="labelledby",iC.LEVEL="level",iC.ORIENTATION="orientation",iC.POSINSET="posinset",iC.ROWCOUNT="rowcount",iC.SELECTED="selected",iC.SETSIZE="setsize",iC.VALUEMAX="valuemax",iC.VALUEMIN="valuemin",iC.LIVE="live",iC.HIDDEN="hidden";var hQ={};hQ.Role=hN,hQ.State=iF,hQ.setRole=b1,hQ.setState=b2;var hR=class{constructor(a,b){this.content=a,this.opt_value=b,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){let a=document.createElement("div");a.id=aE(),this.element=a,a.className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":"");let b=document.createElement("div");if(b.className="blocklyMenuItemContent",this.checkable){var c=document.createElement("div");c.className="blocklyMenuItemCheckbox ",b.appendChild(c)}return c=this.content,"string"==typeof this.content&&(c=document.createTextNode(this.content)),b.appendChild(c),a.appendChild(b),this.roleName&&b1(a,this.roleName),b2(a,iF.SELECTED,this.checkable&&this.checked||!1),b2(a,iF.DISABLED,!this.enabled),a}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let a;return null!=(a=this.opt_value)?a:null}setRightToLeft(a){this.rightToLeft=a}setRole(a){this.roleName=a}setCheckable(a){this.checkable=a}setChecked(a){this.checked=a}setHighlighted(a){this.highlight=a;let b=this.getElement();b&&this.isEnabled()&&(a?a$(b,"blocklyMenuItemHighlight"):a0(b,"blocklyMenuItemHighlight"))}isEnabled(){return this.enabled}setEnabled(a){this.enabled=a}performAction(a){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,a)}onAction(a,b){this.actionHandler=a.bind(b)}},hS=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(a){this.menuItems.push(a)}render(a){let b=document.createElement("div");b.className="blocklyMenu",b.tabIndex=0,this.roleName&&b1(b,this.roleName),this.element=b;for(let a=0,c;c=this.menuItems[a];a++)b.appendChild(c.createDom());return this.pointerMoveHandler=ax(b,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=ax(b,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=ax(b,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=ax(b,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=ax(b,"keydown",this,this.handleKeyEvent),a.appendChild(b),b}getElement(){return this.element}focus(){let a=this.getElement();a&&a.focus({preventScroll:!0})}blur(){let a=this.getElement();a&&a.blur()}setRole(a){this.roleName=a}dispose(){this.pointerMoveHandler&&(az(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(az(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(az(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(az(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(az(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let a=0,b;b=this.menuItems[a];a++)b.dispose();this.element=null}getMenuItem(a){let b=this.getElement();for(;a&&a!==b;){if(a.classList.contains("blocklyMenuItem")){let b=this.getMenuItems();for(let c=0,d;d=b[c];c++)if(d.getElement()===a)return d}a=a.parentElement}return null}setHighlighted(a){var b=this.highlightedItem;if(b&&(b.setHighlighted(!1),this.highlightedItem=null),a){a.setHighlighted(!0),this.highlightedItem=a,b=this.getElement();let c=a.getElement();b&&c&&(bB(c,b),b2(b,iF.ACTIVEDESCENDANT,a.getId()))}}highlightNext(){let a=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(a,1)}highlightPrevious(){let a=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(a<0?this.menuItems.length:a,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(a,b){let c;a+=b;let d=this.getMenuItems();for(;c=d[a];){if(c.isEnabled()){this.setHighlighted(c);break}a+=b}}handlePointerMove(a){0!==Math.max(Math.abs(a.movementX),Math.abs(a.movementY))&&(a=this.getMenuItem(a.target))&&(a.isEnabled()?this.highlightedItem!==a&&this.setHighlighted(a):this.setHighlighted(null))}handleClick(a){var b=this.openingCoords;if(this.openingCoords=null,b&&"number"==typeof a.clientX){let c=new g9(a.clientX,a.clientY);if(1>g9.distance(b,c))return}(b=this.getMenuItem(a.target))&&b.performAction(a)}handlePointerEnter(a){this.focus()}handlePointerLeave(a){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(a){if(this.menuItems.length&&!(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)){var b=this.highlightedItem;switch(a.key){case"Enter":case" ":b&&b.performAction(a);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}a.preventDefault(),a.stopPropagation()}}getSize(){let a=this.getElement(),b=bv(a);return b.height=a.scrollHeight,b}getMenuItems(){return this.menuItems.filter(a=>a instanceof hR)}},hT=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",b1(this.element,hN.SEPARATOR),this.element}dispose(){let a;null==(a=this.element)||a.remove(),this.element=null}},hU="_TEMP_COLLAPSED_INPUT",hV="_TEMP_COLLAPSED_FIELD",hW="MANUALLY_DISABLED";(iD=B.inputTypes$$module$build$src$core$inputs$input_types||(B.inputTypes$$module$build$src$core$inputs$input_types={}))[iD.VALUE=1]="VALUE",iD[iD.STATEMENT=3]="STATEMENT",iD[iD.DUMMY=5]="DUMMY",iD[iD.CUSTOM=6]="CUSTOM",iD[iD.END_ROW=7]="END_ROW",B.inputTypes$$module$build$src$core$inputs$input_types;var hX=new Set,hY=new WeakSet,hZ=new WeakMap,h$=null,h_=null,h0=0,h1={};h1.finishQueuedRenders=b5,h1.queueRender=b4,h1.triggerQueuedRenders=b6,B.Msg$$module$build$src$core$msg=Object.create(null),iG=function(a){Object.keys(a).forEach(function(b){B.Msg$$module$build$src$core$msg[b]=a[b]})},iH={Msg:B.Msg$$module$build$src$core$msg,setLocale:iG};var h2="blocklyToast",h3="blocklyToastMessage",h4="blocklyToastCloseButton",h5=class{static show(a,b){if(b.oncePerSession&&b.id){if(this.shownIds.has(b.id))return;this.shownIds.add(b.id)}this.hide(a);let c=this.createDom(a,b);requestAnimationFrame(()=>{c.style.bottom="2rem"})}static createDom(a,b){let c,{message:d,duration:e=5,assertiveness:f=h5.Assertiveness.POLITE}=b,g=document.createElement("div");a.getInjectionDiv().appendChild(g),g.dataset.toastId=b.id,g.className=h2,b1(g,hN.STATUS),b2(g,iF.LIVE,f),(b=g.appendChild(document.createElement("div"))).className=h3,b.innerText=d,(b=g.appendChild(document.createElement("button"))).className=h4,b2(b,iF.LABEL,B.Msg$$module$build$src$core$msg.CLOSE);var h=aZ(ha.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},b);return b2(h,iF.HIDDEN,!0),aZ(ha.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},h),aZ(ha.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},h),b.addEventListener("click",()=>{g.remove(),a.markFocused()}),b=()=>{c=setTimeout(()=>g.remove(),1e3*e)},h=()=>clearTimeout(c),g.addEventListener("focusin",h),g.addEventListener("focusout",b),g.addEventListener("mouseenter",h),g.addEventListener("mousemove",h),g.addEventListener("mouseleave",b),b(),g}static hide(a,b){(a=a.getInjectionDiv().querySelector(`.${h2}`))instanceof HTMLElement&&(!b||b===a.dataset.toastId)&&a.remove()}};h5.shownIds=new Set,(iE=(iE=h5||(h5={})).Assertiveness||(iE.Assertiveness={})).ASSERTIVE="assertive",iE.POLITE="polite",bt(`
.${h2} {
  font-size: 1.2rem;
  position: absolute;
  bottom: -10rem;
  right: 2rem;
  padding: 1rem;
  color: black;
  background-color: white;
  border: 2px solid black;
  border-radius: 0.4rem;
  z-index: 999;
  display: flex;
  align-items: center;
  gap: 0.8rem;
  line-height: 1.5;
  transition: bottom 0.3s ease-out;
}

.${h2} .${h3} {
  maxWidth: 18rem;
}

.${h2} .${h4} {
  margin: 0;
  padding: 0.2rem;
  background-color: transparent;
  color: black;
  border: none;
  cursor: pointer;
}
`);var h6=function(a,b){window.alert(a),b&&b()},h7=h6,h8=function(a,b){b(window.confirm(a))},h9=h8,ia=function(a,b,c){c(window.prompt(a,b))},ib=ia,ic=h5.show.bind(h5),id=ic,ie={};ie.alert=cd,ie.confirm=ce,ie.prompt=cf,ie.setAlert=function(a=h6){h7=a},ie.setConfirm=function(a=h8){h9=a},ie.setPrompt=function(a=ia){ib=a},ie.setToast=function(a=ic){id=a},ie.toast=function(a,b){id(a,b)};var ig={};ig.isLegacyProcedureCallBlock=ch,ig.isLegacyProcedureDefBlock=cg;var ih=new Set,ii={};ii.warn=cj;var ij="VARIABLE",ik="ijkmnopqrstuvwxyzabcdefgh",il={generateUniqueNameInternal:function(a){return cr(ik.charAt(0),a.getVariableMap().getAllVariables().map(a=>a.getName()))}},im={CATEGORY_NAME:ij,TEST_ONLY:il,VAR_LETTER_OPTIONS:ik};im.allDeveloperVariables=B.allDeveloperVariables$$module$build$src$core$variables,im.allUsedVarModels=B.allUsedVarModels$$module$build$src$core$variables,im.compareByName=cC,im.createVariableButtonHandler=cs,im.deleteVariable=B.deleteVariable$$module$build$src$core$variables,im.flyoutCategory=cl,im.flyoutCategoryBlocks=cp,im.generateUniqueName=cq,im.generateUniqueNameFromOptions=cr,im.generateVariableFieldDom=cz,im.getAddedVariables=cB,im.getOrCreateVariablePackage=B.getOrCreateVariablePackage$$module$build$src$core$variables,im.getVariable=B.getVariable$$module$build$src$core$variables,im.getVariableUsesById=cD,im.internalFlyoutCategory=ck,im.jsonFlyoutCategoryBlocks=cn,im.nameUsedWithAnyType=cv,im.nameUsedWithConflictingParam=cw,im.promptName=ct,im.renameVariable=B.renameVariable$$module$build$src$core$variables;var io=class extends Error{},ip=class extends io{constructor(a){super("Expected to find a 'type' property, defining the block type"),this.state=a}},iq=class extends io{constructor(a,b,c){super(`The block ${b.toDevString()} is missing a(n) ${a}
connection`),this.block=b,this.state=c}},ir=class extends io{constructor(a,b,c,d){super(`The block ${c.toDevString()} could not connect its
${b} to its parent, because: ${a}`),this.childBlock=c,this.childState=d}},is=class extends io{constructor(a){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=a}},it=class extends io{constructor(a,b,c){super(`Cannot add an icon of type '${a}' to the block ${b.toDevString()}, because there is no icon registered with type '${a}'. Make sure that all of your icons have been registered.`),this.block=b,this.state=c}},iu={};iu.BadConnectionCheck=ir,iu.DeserializationError=io,iu.MissingBlockType=ip,iu.MissingConnection=iq,iu.RealChildOfShadow=is,iu.UnregisteredIcon=it;var iv=class{constructor(){this.priority=50}save(a){let b=[];for(let c of a.getTopBlocks(!1))(a=cE(c,{addCoordinates:!0,doFullSerialization:!1}))&&b.push(a);return b.length?{languageVersion:0,blocks:b}:null}load(a,b){for(let c of a=a.blocks)cN(c,b,{recordUndo:aO()})}clear(a){for(let b of a.getTopBlocks(!1))b.dispose(!1)}};bX("blocks",new iv);var iw={};iw.BlockSerializer=iv,iw.append=cN,iw.appendInternal=cO,iw.save=cE;var ix=class{constructor(a){this.name=a}toString(){return this.name}equals(a){return this.name===a.toString()}};ix.MUTATOR=new ix("mutator"),ix.WARNING=new ix("warning"),ix.COMMENT=new ix("comment");var iy=class extends gZ{constructor(a){super(),this.isBlank=!a,a&&(this.blockId=a.id,this.workspaceId=a.workspace.id)}toJson(){let a=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return a.blockId=this.blockId,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new iy)).blockId=a.blockId,b}},iz=class extends iy{constructor(a,b,c,d,e){super(a),this.type=gB.BLOCK_CHANGE,a&&(this.element=b,this.name=c||void 0,this.oldValue=d,this.newValue=e)}toJson(){let a=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return a.element=this.element,a.name=this.name,a.oldValue=this.oldValue,a.newValue=this.newValue,this.disabledReason&&(a.disabledReason=this.disabledReason),a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new iz)).element=a.element,b.name=a.name,b.oldValue=a.oldValue,b.newValue=a.newValue,void 0!==a.disabledReason&&(b.disabledReason=a.disabledReason),b}setDisabledReason(a){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=a}isNull(){return this.oldValue===this.newValue}run(a){var b,c=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(c=c.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");let d=c.getIcon(ix.MUTATOR);switch(d&&c_(d)&&d.bubbleIsVisible()&&d.setBubbleVisible(!1),a=a?this.newValue:this.oldValue,this.element){case"field":(c=c.getField(this.name))?c.setValue(a):console.warn("Can't set non-existent field: "+this.name);break;case"comment":c.setCommentText(a||null);break;case"collapsed":c.setCollapsed(!!a);break;case"disabled":c.setDisabledReason(!!a,null!=(b=this.disabledReason)?b:hW);break;case"inline":c.setInputsInline(!!a);break;case"mutation":b=iz.getExtraBlockState_(c),c.loadExtraState?c.loadExtraState(JSON.parse(a||"{}")):c.domToMutation&&c.domToMutation(B.textToDom$$module$build$src$core$utils$xml(a||"<mutation/>")),aP(new iz(c,"mutation",null,b,a));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(a){return a.saveExtraState?(a=a.saveExtraState(!0))?JSON.stringify(a):"":a.mutationToDom&&(a=a.mutationToDom())?eo(a):""}};ai(F.EVENT,gB.BLOCK_CHANGE,iz);var iA={};iA.clamp=c1,iA.toDegrees=function(a){return 180*a/Math.PI},iA.toRadians=c0;var iB,iC,iD,iE,iF,iG,iH,iI,iJ,iK,iL=16,iM=1,iN=12,iO=16,iP=.25,iQ=null,iR=null,iS="",iT="",iU=null,iV=null,iW=null,iX=null,iY=null,iZ={getBoundsInfo:function(){let a=by(iU),b=bv(iU);return{left:a.x,right:a.x+b.width,top:a.y,bottom:a.y+b.height,width:b.width,height:b.height}},getPositionMetrics:function(a,b,c,d){var e;let f=iZ.getBoundsInfo(),g=bv(iI);return b+g.height<f.bottom?dd(a,b,f,g):d-g.height>f.top?de(c,d,f,g):b+g.height<document.documentElement.clientHeight?dd(a,b,f,g):d-g.height>document.documentElement.clientTop?de(c,d,f,g):{initialX:(e=df(e=a,f.left,f.right,g.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}}},i$={ANIMATION_TIME:.25,ARROW_HORIZONTAL_PADDING:12,ARROW_SIZE:16,BORDER_SIZE:1,PADDING_Y:16,TEST_ONLY:iZ};i$.clearContent=c6,i$.createDom=c2,i$.getContentDiv=c5,i$.getOwner=c4,i$.getPositionX=df,i$.hide=di,i$.hideIfOwner=dh,i$.hideWithoutAnimation=dj,i$.isVisible=dg,i$.repositionForWindowResize=dl,i$.setBoundsElement=c3,i$.setColour=c7,i$.show=dc,i$.showPositionedByBlock=function(a,b,c,d,e=!0){return db(c9(b),a,e,c,d)},i$.showPositionedByField=c8;var i_={};i_.commonWordPrefix=dn,i_.commonWordSuffix=dp,i_.isNumber=B.isNumber$$module$build$src$core$utils$string,i_.shortestStringLength=dm,i_.wrap=B.wrap$$module$build$src$core$utils$string;var i0=void 0,i1=!1,i2=!1,i3=50,i4=0,i5=0,i6=0,i7=0,i8=null,i9=null,ja=0,jb=10,jc=10,jd=750,je=5,jf=null,jg={HOVER_MS:750,LIMIT:50,MARGINS:5,OFFSET_X:0,OFFSET_Y:10,RADIUS_OK:10};jg.bindMouseEvents=dx,jg.block=dE,jg.createDom=dw,jg.dispose=dC,jg.getCustomTooltip=function(){return i0},jg.getDiv=function(){return jf},jg.getTooltipOfObject=du,jg.hide=dD,jg.isVisible=function(){return i1},jg.setCustomTooltip=function(a){i0=a},jg.unbindMouseEvents=dy,jg.unblock=dF;var jh=.45,ji=.65,jj={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},jk={};jk.blend=dQ,jk.getHsvSaturation=dK,jk.getHsvValue=dL,jk.hexToRgb=dO,jk.hsvToHex=dP,jk.hueToHex=dR,jk.names=jj,jk.parse=dM,jk.rgbToHex=dN,jk.setHsvSaturation=function(a){jh=a},jk.setHsvValue=function(a){ji=a};var jl={};jl.checkMessageReferences=function(a){let b=!0,c=B.Msg$$module$build$src$core$msg,d=a.match(/%{BKY_[A-Z]\w*}/gi);if(d)for(let e=0;e<d.length;e++)void 0===c[d[e].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+d[e]+" in "+a),b=!1);return b},jl.parseBlockColour=dV,jl.replaceMessageReferences=dU,jl.tokenizeInterpolation=dT;var jm=class{get size_(){return this.size}set size_(a){this.size=a}constructor(a,b,c){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new hc(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new hc(0,0),a!==jm.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){a.tooltip&&this.setTooltip(dU(a.tooltip))}setSourceBlock(a){if(this.sourceBlock_)throw Error("Field already bound to a block");if(this.sourceBlock_=a,a.id.includes("_field"))throw Error(`Field ID indicator is contained in block ID. This may cause problems with focus: ${a.id}.`);this.id_=`${a.id}_field_${aE()}`}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var a=this.id_;if(!a)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=aZ(ha.G,{id:a}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&a$(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=aZ(ha.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=aZ(ha.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){let a=this.getClickTarget_();if(!a)throw Error("A click target has not been set.");dx(a),this.mouseDownWrapper=ax(a,"pointerdown",this,this.onMouseDown_)}fromXml(a){this.setValue(a.textContent)}toXml(a){return a.textContent=this.getValue(),a}saveState(a){return null!==(a=this.saveLegacyState(jm))?a:this.getValue()}loadState(a){this.loadLegacyState(jm,a)||this.setValue(a)}saveLegacyState(a){return a.prototype.saveState===this.saveState&&a.prototype.toXml!==this.toXml?((a=B.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),bJ(this.toXml(a)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(a,b){return a.prototype.loadState===this.loadState&&a.prototype.fromXml!==this.fromXml&&(this.fromXml(B.textToDom$$module$build$src$core$utils$xml(b)),!0)}dispose(){let a;dh(this),d_(this),(null==(a=this.getSourceBlock())?0:a.isDeadOrDying())||a2(this.fieldGroup_),this.disposed=!0}updateEditable(){let a=this.fieldGroup_,b=this.getSourceBlock();this.EDITABLE&&a&&b&&(this.enabled_&&b.isEditable()?(a$(a,"blocklyEditableField"),a0(a,"blocklyNonEditableField")):(a$(a,"blocklyNonEditableField"),a0(a,"blocklyEditableField")))}setEnabled(a){this.enabled_=a,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==jm.prototype.showEditor_}isClickableInFlyout(a){return!a}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let a=!1;return this.name&&(this.SERIALIZABLE?a=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),a=!0)),a}isVisible(){return this.visible_}setVisible(a){if(this.visible_!==a){this.visible_=a;var b=this.fieldGroup_;b&&(b.style.display=a?"block":"none")}}setValidator(a){this.validator_=a}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(a){this.isClickable()&&this.showEditor_(a)}showEditor_(a){}repositionForWindowResize(){return!1}updateSize_(a){let b=this.getConstants(),c=2*(a=void 0!==a?a:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),d=b.FIELD_TEXT_HEIGHT,e=0;this.textElement_&&(c+=e=a7(this.textElement_)),this.isFullBlockField()||(d=Math.max(d,b.FIELD_BORDER_RECT_HEIGHT)),this.size_=new hc(c,d),this.positionTextElement_(a,e),this.positionBorderRect_()}positionTextElement_(a,b){if(this.textElement_){var c,d=this.getConstants(),e=this.size_.height/2;this.textElement_.setAttribute("x",String((null==(c=this.getSourceBlock())?0:c.RTL)?this.size_.width-b-a:a)),this.textElement_.setAttribute("y",String(d.FIELD_TEXT_BASELINE_CENTER?e:e-d.FIELD_TEXT_HEIGHT/2+d.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new hc(0,0)}getScaledBBox(){let a;var b=this.getSourceBlock();if(!b)throw new jn;if(this.isFullBlockField()){var c=this.sourceBlock_.getHeightWidth();let d=b.workspace.scale;a=this.getAbsoluteXY_(),b=(c.width+1)*d,c=(c.height+1)*d,gv?(a.x+=1.5*d,a.y+=1.5*d):(a.x-=.5*d,a.y-=.5*d)}else c=this.borderRect_.getBoundingClientRect(),a=by(this.borderRect_),b=c.width,c=c.height;return new hb(a.y,a.y+c,a.x,a.x+b)}onLocationChange(a){}getDisplayText_(){let a=this.getText();return a.length>this.maxDisplayLength&&(a=a.substring(0,this.maxDisplayLength-2)+""),a=a.replace(/\s/g,jm.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(a+=""),a}getText(){let a=this.getText_();return null!==a?String(a):String(this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(a,b=!0){if(null!==a){var c=B.getGroup$$module$build$src$core$events$utils();c||B.setGroup$$module$build$src$core$events$utils(!0);try{let c=this.doClassValidation_(a),i=this.processValidation(a,c,b);if(!(i instanceof Error)){var d,e=null==(d=this.getValidator())?void 0:d.call(this,i),f=this.processValidation(i,e,b);if(!(f instanceof Error)){var g=this.sourceBlock_;if(!g||!g.disposed){var h=this.getValue();h===f?this.doValueUpdate_(f):(this.doValueUpdate_(f),b&&g&&aU()&&aP(new(aX(gB.BLOCK_CHANGE))(g,"field",this.name||null,h,f)),this.isDirty_&&this.forceRerender())}}}}finally{B.setGroup$$module$build$src$core$events$utils(c)}}}processValidation(a,b,c){return null===b?(this.doValueInvalid_(a,c),this.isDirty_&&this.forceRerender(),Error()):void 0===b?a:b}getValue(){return this.value_}doClassValidation_(a){return null==a?null:a}doValueUpdate_(a){this.value_=a,this.isDirty_=!0}doValueInvalid_(a,b){}onMouseDown_(a){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(a=this.sourceBlock_.workspace.getGesture(a))&&a.setStartField(this)}setTooltip(a){a||""===a||(a=this.sourceBlock_);let b=this.getClickTarget_();b?b.tooltip=a:this.tooltip=a}getTooltip(){let a=this.getClickTarget_();return a?du(a):du({tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return by(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let a=null,b=this.getSourceBlock();if(!b)throw new jn;let c=b.inputList;for(let d=0;d<b.inputList.length;d++){let b=c[d],e=b.fieldRow;for(let c=0;c<e.length;c++)if(e[c]===this){a=b;break}}return a}getFlipRtl(){return!1}onShortcut(a){return!1}getFocusableElement(){if(!this.fieldGroup_)throw Error("This field currently has no representative DOM element.");return this.fieldGroup_}getFocusableTree(){let a=this.getSourceBlock();if(!a)throw new jn;return a.workspace}onNodeFocus(){let a=this.getSourceBlock();a.workspace.scrollBoundsIntoView(a.getBoundingRectangleWithoutChildren())}onNodeBlur(){}canBeFocused(){return!0}static fromJson(a){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};jm.NBSP="",jm.SKIP_SETUP=Symbol("SKIP_SETUP");var jn=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},jo={};jo.Field=jm,jo.UnattachedFieldError=jn;var jp,jq=null,jr=null,js=null,jt="blocklyWidgetDiv",ju="",jv="",jw=null,jx={};jx.createDom=dX,jx.getDiv=dW,jx.hide=dZ,jx.hideIfOwner=d_,jx.hideIfOwnerIsInWorkspace=d0,jx.isVisible=d$,jx.positionWithAnchor=d2,jx.repositionForWindowResize=d5,jx.show=dY,jx.testOnly_setDiv=function(a){if(jp=a,null===a){let a;null==(a=document.querySelector("."+jt))||a.remove()}};var jy=null,jz={},jA=null,jB={};jB.callbackFactory=B.callbackFactory$$module$build$src$core$contextmenu,jB.dispose=ed,jB.getCurrentBlock=function(){return jy},jB.hide=ec,jB.setCurrentBlock=d6,jB.show=d7;var jC=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(a){if(this.registeredItems.has(a.id))throw Error('Menu item with ID "'+a.id+'" is already registered.');this.registeredItems.set(a.id,a)}unregister(a){if(!this.registeredItems.has(a))throw Error('Menu item with ID "'+a+'" not found.');this.registeredItems.delete(a)}getItem(a){let b;return null!=(b=this.registeredItems.get(a))?b:null}getContextMenuOptions(a,b){let c=[];for(let d of this.registeredItems.values()){let e;if(!d.scopeType||(d.scopeType!==jD.BLOCK||a.block)&&(d.scopeType!==jD.COMMENT||a.comment)&&(d.scopeType!==jD.WORKSPACE||a.workspace)){if(e={scope:a,weight:d.weight},d.separator)e=Object.assign({},e,{separator:!0});else{let c=d.preconditionFn(a,b);if("hidden"===c)continue;e=Object.assign({},e,{text:"function"==typeof d.displayText?d.displayText(a):d.displayText,callback:d.callback,enabled:"enabled"===c})}c.push(e)}}return c.sort(function(a,b){return a.weight-b.weight}),c}};(j_=(j$=jC||(jC={})).ScopeType||(j$.ScopeType={})).BLOCK="block",j_.WORKSPACE="workspace",j_.COMMENT="comment",j$.registry=new j$;var jD=jC.ScopeType,jE={};jE.ContextMenuRegistry=jC,jE.ScopeType=jD;var jF=class{constructor(a){this.comment=a,this.startLoc=null,this.workspace=a.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){let a;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(a=this.workspace.getLayerManager())||a.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(a){this.comment.moveDuringDrag(a)}endDrag(){let a;this.fireDragEndEvent(),this.fireMoveEvent(),null==(a=this.workspace.getLayerManager())||a.moveOffDragLayer(this.comment,50),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){aP(new(aX(gB.COMMENT_DRAG))(this.comment,!0))}fireDragEndEvent(){aP(new(aX(gB.COMMENT_DRAG))(this.comment,!1))}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var a=new(aX(gB.COMMENT_MOVE))(this.comment);a.setReason(["drag"]),a.oldCoordinate_=this.startLoc,a.recordNew(),aP(a)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},jG=new WeakMap,jH={};jH.move=eg,jH.start=ef;var jI=class{constructor(a,b,c,d){this.id=a,this.workspace=b,this.container=c,this.commentView=d}isVisible(){return this.icon.checkVisibility()}getCommentView(){return this.commentView}getSize(a=!1){var b=this.icon.getBBox();return b=hb.from(b),a&&(a=this.getMargin(),b.left-=a,b.top-=a,b.bottom+=a,b.right+=a),b}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){let a=this.getCommentView();var b=a.getRelativeToSurfaceXY();let c=a.getSize();b=new hb(b.y,b.y+c.height,b.x,b.x+c.width),a.workspace.scrollBoundsIntoView(b)}onNodeBlur(){}canBeFocused(){return this.isVisible()}},jJ="_collapse_bar_button",jK=class extends jI{constructor(a,b,c,d){super(a,b,c,d),this.id=a,this.workspace=b,this.container=c,this.commentView=d,this.icon=aZ(ha.IMAGE,{class:"blocklyFoldoutIcon",href:`${this.workspace.options.pathToMedia}foldout-icon.svg`,id:`${this.id}${jJ}`},this.container),this.bindId=ax(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){az(this.bindId)}reposition(){let a=this.getMargin();this.icon.setAttribute("y",`${a}`),this.icon.setAttribute("x",`${a}`)}performAction(a){at(),this.getCommentView().bringToFront(),a&&a instanceof PointerEvent&&aB(a)?a.stopPropagation():(this.getCommentView().setCollapsed(!this.getCommentView().isCollapsed()),this.workspace.hideChaff(),null==a||a.stopPropagation())}},jL="_comment_textarea_",jM=class{constructor(a,b,c){this.workspace=a,this.onFinishEditing=c,this.textChangeListeners=[],this.text="",this.foreignObject=aZ(ha.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),(a=document.createElementNS(gE,"body")).setAttribute("xmlns",gE),a.className="blocklyMinimalBody",this.textArea=document.createElementNS(gE,"textarea"),this.textArea.setAttribute("tabindex","-1"),this.textArea.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),a$(this.textArea,"blocklyCommentText"),a$(this.textArea,"blocklyTextarea"),a$(this.textArea,"blocklyText"),a.appendChild(this.textArea),this.foreignObject.appendChild(a),b&&(this.id=b+jL,this.textArea.setAttribute("id",this.id)),ax(this.textArea,"change",this,this.onTextChange),ax(this.textArea,"pointerdown",this,a=>{a.stopPropagation(),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),at()}),ax(this.textArea,"wheel",this,a=>{a.stopPropagation()}),ax(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(a){this.textArea.value=a,this.onTextChange()}onTextChange(){let a=this.text;this.text=this.textArea.value;for(let b=this.textChangeListeners.length-1;b>=0;b--)this.textChangeListeners[b](a,this.text)}handleKeyDown(a){("Escape"===a.key||"Enter"===a.key&&(a.ctrlKey||a.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),a.stopPropagation())}addTextChangeListener(a){this.textChangeListeners.push(a)}removeTextChangeListener(a){this.textChangeListeners.splice(this.textChangeListeners.indexOf(a),1)}setPlaceholderText(a){this.textArea.placeholder=a}setEditable(a){a?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(a,b){this.foreignObject.setAttribute("height",`${a.height-b.height}`),this.foreignObject.setAttribute("width",`${a.width}`),this.foreignObject.setAttribute("y",`${b.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",`${-a.width}`)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){let a=hb.from(this.foreignObject.getBoundingClientRect());this.workspace.scrollBoundsIntoView(hb.createFromPoint(bH(this.workspace,a.getOrigin()),a.getWidth(),a.getHeight()))}onNodeBlur(){}canBeFocused(){return!!this.id}},jN="_delete_bar_button",jO=class extends jI{constructor(a,b,c,d){super(a,b,c,d),this.id=a,this.workspace=b,this.container=c,this.commentView=d,this.icon=aZ(ha.IMAGE,{class:"blocklyDeleteIcon",href:`${this.workspace.options.pathToMedia}delete-icon.svg`,id:`${this.id}${jN}`},c),this.bindId=ax(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){az(this.bindId)}reposition(){let a=this.getMargin();this.icon.setAttribute("x","0");let b=this.container.getBBox();this.icon.setAttribute("y",`${a}`),this.icon.setAttribute("x",`${b.width-this.getSize(!0).getWidth()}`)}performAction(a){at(),a&&a instanceof PointerEvent&&aB(a)?a.stopPropagation():(this.getCommentView().dispose(),null==a||a.stopPropagation(),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}},jP=class{constructor(a,b){let c;this.workspace=a,this.commentId=b,this.collapsed=!1,this.editable=!0,this.location=new g9(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=aZ(ha.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),({topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot)),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,a),null==(c=a.getLayerManager())||c.append(this,50),this.size=jP.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new g9(0,0))}createHighlightRect(a){return aZ(ha.RECT,{class:"blocklyCommentHighlight"},a)}createTopBar(a){a=aZ(ha.G,{class:"blocklyCommentTopbar"},a);let b=aZ(ha.RECT,{class:"blocklyCommentTopbarBackground"},a),c=new jO(this.commentId,this.workspace,a,this),d=new jK(this.commentId,this.workspace,a,this);this.addDisposeListener(()=>{c.dispose(),d.dispose()});let e=aZ(ha.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},a),f=document.createTextNode("");return e.appendChild(f),{topBarGroup:a,topBarBackground:b,deleteButton:c,foldoutButton:d,textPreview:e,textPreviewNode:f}}createTextArea(){let a=new jM(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(a.getDom()),a.addTextChangeListener((a,b)=>{this.updateTextPreview(b),this.setSize(this.size)}),a}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(a,b){return ax(a=aZ(ha.IMAGE,{class:"blocklyResizeHandle",href:`${b.options.pathToMedia}resize-handle.svg`},a),"pointerdown",this,this.onResizePointerDown),a}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(a){let b=this.topBarBackground.getBBox(),c=this.textPreview.getBBox(),d=this.resizeHandle.getBBox();this.size=a=hc.max(a,this.calcMinSize(b)),this.svgRoot.setAttribute("height",`${a.height}`),this.svgRoot.setAttribute("width",`${a.width}`),this.updateHighlightRect(a),this.updateTopBarSize(a),this.commentEditor.updateSize(a,b),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(a,b,c),this.updateResizeHandlePosition(a,d)}setSize(a){let b=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(a),this.onSizeChange(b,this.size)}calcMinSize(a){var b;this.updateTextPreview(null!=(b=this.commentEditor.getText())?b:"");let c=b=a7(this.textPreview);return this.foldoutButton.isVisible()?c+=this.foldoutButton.getSize(!0).getWidth():b&&(c+=4),this.deleteButton.isVisible()?c+=this.deleteButton.getSize(!0).getWidth():b&&(c+=4),new hc(c,a.height+20)}updateHighlightRect(a){this.highlightRect.setAttribute("height",`${a.height}`),this.highlightRect.setAttribute("width",`${a.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",`${-a.width}`)}updateTopBarSize(a){this.topBarBackground.setAttribute("width",`${a.width}`)}updateTextPreviewSize(a,b,c){b=(b.height-c.height)/2;let d=this.foldoutButton.getSize(!0),e=this.deleteButton.getSize(!0);a=a.width-d.getWidth()-e.getWidth(),this.textPreview.setAttribute("x",`${(this.workspace.RTL?-1:1)*d.getWidth()}`),this.textPreview.setAttribute("y",`${b+c.height/2}`),this.textPreview.setAttribute("width",`${a}`)}updateResizeHandlePosition(a,b){this.resizeHandle.setAttribute("y",`${a.height-b.height}`),this.resizeHandle.setAttribute("x",`${a.width-b.width}`)}onSizeChange(a,b){for(let c=this.sizeChangeListeners.length-1;c>=0;c--)this.sizeChangeListeners[c](a,b)}addSizeChangeListener(a){this.sizeChangeListeners.push(a)}removeSizeChangeListener(a){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(a),1)}onResizePointerDown(a){this.isEditable()&&(this.bringToFront(),aB(a)||(this.preResizeSize=this.getSize(),ef(this.workspace,a,new g9(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=ax(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=ax(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),a.stopPropagation())}onResizePointerUp(a){at(),this.resizePointerUpListener&&(az(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(az(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(a){a=eg(this.workspace,a),this.setSizeWithoutFiringEvents(new hc(this.workspace.RTL?-a.x:a.x,a.y))}isCollapsed(){return this.collapsed}setCollapsed(a){(this.collapsed=a)?a$(this.svgRoot,"blocklyCollapsed"):a0(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let a=this.collapseChangeListeners.length-1;a>=0;a--)this.collapseChangeListeners[a](this.collapsed)}addOnCollapseListener(a){this.collapseChangeListeners.push(a)}removeOnCollapseListener(a){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(a),1)}isEditable(){return this.editable}setEditable(a){(this.editable=a)?(a$(this.svgRoot,"blocklyEditable"),a0(this.svgRoot,"blocklyReadonly")):(a0(this.svgRoot,"blocklyEditable"),a$(this.svgRoot,"blocklyReadonly")),this.commentEditor.setEditable(a)}getRelativeToSurfaceXY(){return this.location}moveTo(a){this.location=a,this.svgRoot.setAttribute("transform",`translate(${a.x}, ${a.y})`)}getText(){return this.commentEditor.getText()}setText(a){this.commentEditor.setText(a)}setPlaceholderText(a){this.commentEditor.setPlaceholderText(a)}addTextChangeListener(a){this.commentEditor.addTextChangeListener(a)}removeTextChangeListener(a){this.commentEditor.removeTextChangeListener(a)}updateTextPreview(a){this.textPreviewNode.textContent=this.truncateText(a)}truncateText(a){return a.length>=12?`${a.substring(0,9)}...`:a}bringToFront(){let a=this.svgRoot.parentNode,b=a.childNodes;b[b.length-1]!==this.svgRoot&&a.appendChild(this.svgRoot)}onDeleteDown(a){at(),aB(a)||this.dispose(),a.stopPropagation()}dispose(){this.disposing=!0,a2(this.svgRoot);for(let a=this.disposeListeners.length-1;a>=0;a--)this.disposeListeners[a]();this.disposeListeners.length=0,this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(a){this.disposeListeners.push(a)}removeDisposeListener(a){this.disposeListeners.splice(this.disposeListeners.indexOf(a),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}};jP.defaultCommentSize=new hc(120,100),bt("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklyCommentText.blocklyActiveFocus {\n  border-color: #fc3;\n  border-width: 2px;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n");var jQ=class{constructor(a,b){this.workspace=a,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new g9(0,0),this.disposing=this.disposed=!1,this.id=b&&!a.getCommentById(b)?b:aF(),this.size=jP.defaultCommentSize,a.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){aU()&&aP(new(aX(gB.COMMENT_CREATE))(this))}fireDeleteEvent(){aU()&&aP(new(aX(gB.COMMENT_DELETE))(this))}fireChangeEvent(a,b){aU()&&aP(new(aX(gB.COMMENT_CHANGE))(this,a,b))}fireCollapseEvent(a){aU()&&aP(new(aX(gB.COMMENT_COLLAPSE))(this,a))}setText(a){let b=this.text;this.text=a,this.fireChangeEvent(b,a)}getText(){return this.text}setSize(a){let b=new(aX(gB.COMMENT_RESIZE))(this);this.size=a,b.recordCurrentSizeAsNewSize(),aP(b)}getSize(){return this.size}setCollapsed(a){this.collapsed=a,this.fireCollapseEvent(a)}isCollapsed(){return this.collapsed}setEditable(a){this.editable=a}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(a){this.movable=a}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(a){this.deletable=a}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(a,b){let c=new(aX(gB.COMMENT_MOVE))(this);b&&c.setReason(b),this.location=a,c.recordNew(),aP(c)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},jR=class extends jQ{constructor(a,b){super(a,b),this.dragStrategy=new jF(this),this.workspace=a,this.view=new jP(a,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),ax(this.view.getSvgRoot(),"pointerdown",this,this.startGesture)}addModelUpdateBindings(){this.view.addTextChangeListener((a,b)=>void super.setText(b)),this.view.addSizeChangeListener((a,b)=>void super.setSize(b)),this.view.addOnCollapseListener(()=>void super.setCollapsed(this.view.isCollapsed())),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(a){this.view.setText(a)}setPlaceholderText(a){this.view.setPlaceholderText(a)}setSize(a){this.view.setSize(a)}setCollapsed(a){this.view.setCollapsed(a)}setEditable(a){super.setEditable(a),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){var a,b;let c=this.getRelativeToSurfaceXY(),d=null!=(b=null==(a=this.view)?void 0:a.getSize())?b:this.getSize();return this.workspace.RTL?(a=c.x-d.width,b=c.x):(a=c.x,b=c.x+d.width),new hb(c.y,c.y+d.height,a,b)}moveBy(a,b,c){let d=this.getRelativeToSurfaceXY();a=new g9(d.x+a,d.y+b),this.moveTo(a,c)}moveTo(a,b){super.moveTo(a,b),this.view.moveTo(a)}moveDuringDrag(a){this.location=a,this.view.moveTo(a)}setDragging(a){a?a$(this.getSvgRoot(),"blocklyDragging"):a0(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;let a=B.getFocusManager$$module$build$src$core$focus_manager();a.getFocusedNode()===this&&setTimeout(()=>a.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(a){let b=this.workspace.getGesture(a);b&&(b.handleCommentStart(a,this),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(a){a?a$(this.getSvgRoot(),"blocklyDraggingDelete"):a0(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(a){this.dragStrategy.drag(a)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){a$(this.getSvgRoot(),"blocklySelected"),bk(this)}unselect(){a0(this.getSvgRoot(),"blocklySelected"),bk(null)}toCopyData(){return{paster:hF.TYPE,commentState:bY(this,{addCoordinates:!0,saveIds:!1})}}showContextMenu(a){let b,c=jC.registry.getContextMenuOptions({comment:this,focusedNode:this},a);b=a instanceof PointerEvent?new g9(a.clientX,a.clientY):bI(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10),d7(a,c,this.workspace.RTL,this.workspace,b)}snapToGrid(){if(!this.isDeadOrDying()){var a=this.workspace.getGrid();if(null!=a&&a.shouldSnap()){var b=this.getRelativeToSurfaceXY();(a=a.alignXY(b))!==b&&this.moveTo(a,["snap"])}}}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){let a;this.select(),null==(a=this.workspace.getLayerManager())||a.append(this,50),this.workspace.scrollBoundsIntoView(this.getBoundingRectangle())}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},jS={};jS.appendDomToWorkspace=function(a,b){if(!b.getBlocksBoundingBox)return B.domToWorkspace$$module$build$src$core$xml(a,b);var c=b.getBlocksBoundingBox();if(a=B.domToWorkspace$$module$build$src$core$xml(a,b),c&&c.top!==c.bottom){var d=c.bottom;c=b.RTL?c.right:c.left;var e=1/0;let f=-1/0,g=1/0;for(let c=0;c<a.length;c++){let d=b.getBlockById(a[c]).getRelativeToSurfaceXY();d.y<g&&(g=d.y),d.x<e&&(e=d.x),d.x>f&&(f=d.x)}for(d=d-g+10,c=b.RTL?c-f:c-e,e=0;e<a.length;e++)b.getBlockById(a[e]).moveBy(c,d,["create"])}return a},jS.blockToDom=em,jS.blockToDomWithXY=ej,jS.clearWorkspaceAndLoadFromXml=function(a,b){return b.setResizesEnabled(!1),b.clear(),a=B.domToWorkspace$$module$build$src$core$xml(a,b),b.setResizesEnabled(!0),a},jS.deleteNext=function(a){for(let b=0;b<a.childNodes.length;b++){let c=a.childNodes[b];if("next"===c.nodeName.toLowerCase()){a.removeChild(c);break}}},jS.domToBlock=B.domToBlock$$module$build$src$core$xml,jS.domToBlockInternal=eq,jS.domToPrettyText=function(a){a=eo(a).split("<");let b="";for(let c=1;c<a.length;c++){let d=a[c];"/"===d[0]&&(b=b.substring(2)),a[c]=b+"<"+d,"/"!==d[0]&&"/>"!==d.slice(-2)&&(b+="  ")}return(a=(a=a.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},jS.domToText=eo,jS.domToVariables=er,jS.domToWorkspace=B.domToWorkspace$$module$build$src$core$xml,jS.loadWorkspaceComment=ep,jS.saveWorkspaceComment=eh,jS.variablesToDom=ei,jS.workspaceToDom=function(a,b=!1){let c=B.createElement$$module$build$src$core$utils$xml("xml");var d=ei(B.allUsedVarModels$$module$build$src$core$variables(a));for(let e of(d.hasChildNodes()&&c.appendChild(d),a.getTopComments()))c.appendChild(eh(e,b));for(d=0,a=a.getTopBlocks(!0);d<a.length;d++)c.appendChild(ej(a[d],b));return c};var jT=class extends iy{constructor(a){super(a),this.type=gB.BLOCK_CREATE,a&&(a.isShadow()&&(this.recordUndo=!1),this.xml=ej(a),this.ids=aV(a),this.json=cE(a,{addCoordinates:!0}))}toJson(){let a=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return a.xml=eo(this.xml),a.ids=this.ids,a.json=this.json,this.recordUndo||(a.recordUndo=this.recordUndo),a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new jT)).xml=B.textToDom$$module$build$src$core$utils$xml(a.xml),b.ids=a.ids,b.json=a.json,void 0!==a.recordUndo&&(b.recordUndo=a.recordUndo),b}run(a){let b=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!jU(b,this.ids))if(a)cN(this.json,b);else for(a=0;a<this.ids.length;a++){let c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn("Can't uncreate non-existent block: "+c)}}},jU=function(a,b){return b.map(b=>a.getBlockById(b)).filter(a=>a&&a.isShadow()).length===b.length};ai(F.EVENT,gB.BLOCK_CREATE,jT);var jV=class extends g${constructor(a,b){super(b),this.type=gB.THEME_CHANGE,this.themeName=a}toJson(){let a=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return a.themeName=this.themeName,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new jV)).themeName=a.themeName,b}};ai(F.EVENT,gB.THEME_CHANGE,jV);var jW=class extends g${constructor(a,b,c,d,e){super(d),this.type=gB.VIEWPORT_CHANGE,this.viewTop=a,this.viewLeft=b,this.scale=c,this.oldScale=e}toJson(){let a=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return a.viewTop=this.viewTop,a.viewLeft=this.viewLeft,a.scale=this.scale,a.oldScale=this.oldScale,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new jW)).viewTop=a.viewTop,b.viewLeft=a.viewLeft,b.scale=a.scale,b.oldScale=a.oldScale,b}};ai(F.EVENT,gB.VIEWPORT_CHANGE,jW);var jX={fromJsonInternal:function(a){let b=ao(F.FIELD,a.type);return b?b.fromJson(a):(console.warn("Blockly could not create a field of type "+a.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)}},jY={TEST_ONLY:jX};jY.fromJson=B.fromJson$$module$build$src$core$field_registry,jY.register=eD,jY.unregister=function(a){ak(F.FIELD,a)};var jZ=class extends jm{constructor(a,b,c){super(jm.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,a!==jm.SKIP_SETUP&&(this.setOptions(a),c&&this.configure_(c),b&&this.setValidator(b))}fromXml(a){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(a.textContent)}loadState(a){this.loadLegacyState(jZ,a)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(a))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=aZ(ha.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&a$(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(a$(this.fieldGroup_,"blocklyField"),a$(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){let a;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null==(a=this.getSourceBlock())?0:a.isShadow())}createTextArrow_(){let a,b;this.arrow=aZ(ha.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode((null==(a=this.getSourceBlock())?0:a.RTL)?jZ.ARROW_CHAR+" ":" "+jZ.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),(null==(b=this.getSourceBlock())?0:b.RTL)?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=aZ(ha.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(gF,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(a){var b=this.getSourceBlock();if(!b)throw new jn;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=a&&"number"==typeof a.clientX?new g9(a.clientX,a.clientY):null,c6(),a$(a=this.menu_.render(c5()),"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&c7(b=b.getColour(),a=this.sourceBlock_.getColourTertiary()),c8(this,this.dropdownDispose_.bind(this)),c5().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){let a=this.getSourceBlock();if(!a)throw new jn;let b=new hS;b.setRole(hN.LISTBOX),this.menu_=b;let c=this.getOptions(!1);this.selectedMenuItem=null;for(let e=0;e<c.length;e++){var d=c[e];if(d===jZ.SEPARATOR){b.addChild(new hT);continue}let[f,g]=d;eE(f)?((d=new Image(f.width,f.height)).src=f.src,d.alt=f.alt):d=f,(d=new hR(d,g)).setRole(hN.OPTION),d.setRightToLeft(a.RTL),d.setCheckable(!0),b.addChild(d),d.setChecked(g===this.value_),g===this.value_&&(this.selectedMenuItem=d),d.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(a){dh(this,!0),this.onItemSelected_(this.menu_,a)}onItemSelected_(a,b){this.setValue(b.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(a){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(a&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions)}setOptions(a){Array.isArray(a)?(this.validateOptions(a),a=this.trimOptions(a),this.menuGenerator_=a.options,this.prefixField=a.prefix||null,this.suffixField=a.suffix||null):this.menuGenerator_=a,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(a){return this.getOptions(!0).some(b=>b[1]===a)?a:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+a),null)}doValueUpdate_(a){super.doValueUpdate_(a),a=this.getOptions(!0);for(let b=0,c;c=a[b];b++)c[1]===this.value_&&(this.selectedOption=c)}applyColour(){let a=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",a.getColourTertiary()),this.menu_?this.borderRect_.setAttribute("fill",a.getColourTertiary()):this.borderRect_.setAttribute("fill","transparent")),a&&this.arrow&&(a.isShadow()?this.arrow.style.fill=a.getColourSecondary():this.arrow.style.fill=a.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";let a=this.selectedOption&&this.selectedOption[0];eE(a)?this.renderSelectedImage(a):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(a){let b,c=this.getSourceBlock();if(!c)throw new jn;this.imageElement.style.display="",this.imageElement.setAttributeNS(gF,"xlink:href",a.src),this.imageElement.setAttribute("height",String(a.height)),this.imageElement.setAttribute("width",String(a.width));let d=Number(a.height);a=Number(a.width);var e=!!this.borderRect_;let f=Math.max(e?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,d+jZ.IMAGE_Y_PADDING);e=e?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,b=this.svgArrow?this.positionSVGArrow(a+e,f/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):a7(this.arrow),this.size_=new hc(a+b+2*e,f);let g=0;c.RTL?this.imageElement.setAttribute("x",`${e+b}`):(g=a+b,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${e}`)),this.imageElement.setAttribute("y",String(f/2-d/2)),this.positionTextElement_(g+e,a+b)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var a=this.getTextElement();a$(a,"blocklyDropdownText"),a.setAttribute("text-anchor","start");var b=!!this.borderRect_;a=Math.max(b?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);let c=a7(this.getTextElement());b=b?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let d=0;this.svgArrow&&(d=this.positionSVGArrow(c+b,a/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_=new hc(c+d+2*b,a),this.positionTextElement_(b,c)}positionSVGArrow(a,b){if(!this.svgArrow)return 0;let c=this.getSourceBlock();if(!c)throw new jn;let d=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,e=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,f=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(c.RTL?d:a+e)+","+b+")"),f+e}getText_(){if(!this.selectedOption)return null;let a=this.selectedOption[0];if(eE(a))return a.alt;if("u">typeof HTMLElement&&a instanceof HTMLElement){let b,c;return null!=(c=null!=(b=a.title)?b:a.ariaLabel)?c:a.innerText}return"string"==typeof a?a:(console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar."),null)}static fromJson(a){if(!a.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(a.options,void 0,a)}trimOptions(a){let b=!1,c=a.map(a=>{if(a===jZ.SEPARATOR)return b=!0,a;let[c,d]=a;return"string"==typeof c?[dU(c),d]:(b=!0,[eE(c)?Object.assign({},c,{alt:dU(c.alt)}):c,d])});if(b||a.length<2)return{options:c};var d=c.map(([a])=>a),e=dm(d);a=dn(d,e);let f=dp(d,e);return(a||f)&&!(e<=a+f)?(e=a?d[0].substring(0,a-1):void 0,d=f?d[0].substr(1-f):void 0,{options:this.applyTrim(c,a,f),prefix:e,suffix:d}):{options:c}}applyTrim(a,b,c){return a.map(([a,d])=>[a.substring(b,a.length-c),d])}validateOptions(a){if(!Array.isArray(a))throw TypeError("FieldDropdown options must be an array.");if(!a.length)throw TypeError("FieldDropdown options must not be an empty array.");let b=!1;for(let c=0;c<a.length;c++){let d=a[c];Array.isArray(d)||d===jZ.SEPARATOR?"string"!=typeof d[1]?(b=!0,console.error(`Invalid option[${c}]: Each FieldDropdown option id must be a string.
          Found ${d[1]} in: ${d}`)):!d[0]||"string"==typeof d[0]||eE(d[0])||"u">typeof HTMLElement&&d[0]instanceof HTMLElement||(b=!0,console.error(`Invalid option[${c}]: Each FieldDropdown option must have a string
          label, image description, or HTML element. Found ${d[0]} in: ${d}`)):(b=!0,console.error(`Invalid option[${c}]: Each FieldDropdown option must be an array or
          the string literal 'separator'. Found: ${d}`))}if(b)throw TypeError("Found invalid FieldDropdown options.")}};jZ.SEPARATOR="separator",jZ.ARROW_CHAR="",jZ.IMAGE_Y_OFFSET=5,jZ.IMAGE_Y_PADDING=2*jZ.IMAGE_Y_OFFSET,eD("field_dropdown",jZ);var j$,j_,j0,j1=class{constructor(a,b,c,d){this.name=a,this.startHats=!1,this.blockStyles=b||Object.create(null),this.categoryStyles=c||Object.create(null),this.componentStyles=d||Object.create(null),this.fontStyle=Object.create(null),ai(F.THEME,a,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(a,b){this.blockStyles[a]=b}setCategoryStyle(a,b){this.categoryStyles[a]=b}getComponentStyle(a){if(!(a=this.componentStyles[a]))return null;if("string"==typeof a){let b=this.getComponentStyle(a);if(b)return b}return`${a}`}setComponentStyle(a,b){this.componentStyles[a]=b}setFontStyle(a){this.fontStyle=a}setStartHats(a){this.startHats=a}static defineTheme(a,b){let c=new j1(a=a.toLowerCase()),d=b.base;if(d){if("string"==typeof d){let a;d=null!=(a=ao(F.THEME,d))?a:void 0}d instanceof j1&&(bc(c,d),c.name=a)}return bc(c.blockStyles,b.blockStyles),bc(c.categoryStyles,b.categoryStyles),bc(c.componentStyles,b.componentStyles),bc(c.fontStyle,b.fontStyle),null!==b.startHats&&(c.startHats=b.startHats),c}},j2=new j1("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),j3=class{constructor(a){let b,c,d;this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let e=null,f=!1;var g,h=!1,i=!1,j=!1,k=!1,l=!1;const m=!!a.readOnly;m||(f=bO(e=bL(null!=(g=a.toolbox)?g:null)),h=void 0===(h=a.trashcan)?f:h,i=void 0===(i=a.collapse)?f:i,j=void 0===(j=a.comments)?f:j,k=void 0===(k=a.disable)?f:k,l=void 0===(l=a.sounds)||l),g=a.maxTrashcanContents,h?void 0===g&&(g=32):g=0;const n=!!a.rtl;let o=a.horizontalLayout;void 0===o&&(o=!1);var p="end"!==a.toolboxPosition;p=o?p?ht.TOP:ht.BOTTOM:p===n?ht.RIGHT:ht.LEFT;let q=a.css;void 0===q&&(q=!0);let r="https://blockly-demo.appspot.com/static/media/";a.media&&(r=a.media.endsWith("/")?a.media:a.media+"/");const s=a.oneBasedIndex,t=a.renderer||"geras",u=a.plugins||{};let v=a.modalInputs;void 0===v&&(v=!0),this.RTL=n,this.oneBasedIndex=void 0===s||s,this.collapse=i,this.comments=j,this.disable=k,this.readOnly=m,this.maxBlocks=a.maxBlocks||1/0,this.maxInstances=null!=(b=a.maxInstances)?b:null,this.modalInputs=v,this.pathToMedia=r,this.hasCategories=f,this.moveOptions=j3.parseMoveOptions(a,f),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=h,this.maxTrashcanContents=g,this.hasSounds=l,this.hasCss=q,this.horizontalLayout=o,this.languageTree=e,this.gridOptions=j3.parseGridOptions(a),this.zoomOptions=j3.parseZoomOptions(a),this.toolboxPosition=p,this.theme=j3.parseThemeOptions(a),this.renderer=t,this.rendererOverrides=null!=(c=a.rendererOverrides)?c:null,this.parentWorkspace=null!=(d=a.parentWorkspace)?d:null,this.plugins=u}static parseMoveOptions(a,b){let c=a.move||{},d={};return void 0===c.scrollbars&&void 0===a.scrollbars?d.scrollbars=b:"object"==typeof c.scrollbars?(d.scrollbars={horizontal:!!c.scrollbars.horizontal,vertical:!!c.scrollbars.vertical},d.scrollbars.horizontal&&d.scrollbars.vertical?d.scrollbars=!0:d.scrollbars.horizontal||d.scrollbars.vertical||(d.scrollbars=!1)):d.scrollbars=!!c.scrollbars||!!a.scrollbars,d.wheel=d.scrollbars&&void 0!==c.wheel?!!c.wheel:"object"==typeof d.scrollbars,d.drag=!!d.scrollbars&&(void 0===c.drag||!!c.drag),d}static parseZoomOptions(a){a=a.zoom||{};let b={};return b.controls=void 0!==a.controls&&!!a.controls,b.wheel=void 0!==a.wheel&&!!a.wheel,b.startScale=void 0===a.startScale?1:Number(a.startScale),b.maxScale=void 0===a.maxScale?3:Number(a.maxScale),b.minScale=void 0===a.minScale?.3:Number(a.minScale),b.scaleSpeed=void 0===a.scaleSpeed?1.2:Number(a.scaleSpeed),b.pinch=void 0===a.pinch?b.wheel||b.controls:!!a.pinch,b}static parseGridOptions(a){a=a.grid||{};let b={};return b.spacing=Number(a.spacing)||0,b.colour=a.colour||"#888",b.length=void 0===a.length?1:Number(a.length),b.snap=b.spacing>0&&!!a.snap,b}static parseThemeOptions(a){return"string"==typeof(a=a.theme||j2)?ao(F.THEME,a):a instanceof j1?a:j1.defineTheme(a.name||"builtin"+aE(),a)}},j4=class{constructor(a,b){this.bubble=a,this.workspace=b,this.startLoc=null}isMovable(){return!0}startDrag(){let a;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(a=this.workspace.getLayerManager())||a.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(a){this.bubble.moveDuringDrag(a)}endDrag(){let a;this.workspace.setResizesEnabled(!0),null==(a=this.workspace.getLayerManager())||a.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},j5=class{constructor(a,b,c,d,e){this.workspace=a,this.anchor=b,this.ownerRect=c,this.owner=e,this.size=new hc(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new j4(this,this.workspace),this.id=aE(),this.svgRoot=aZ(ha.G,{class:"blocklyBubble"},a.getBubbleCanvas()),a=aZ(ha.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=aZ(ha.PATH,{class:"blocklyBubbleTail"},a),this.background=aZ(ha.RECT,{class:"blocklyDraggable",x:0,y:0,rx:j0.BORDER_WIDTH,ry:j0.BORDER_WIDTH},a),this.contentContainer=aZ(ha.G,{},this.svgRoot),this.focusableElement=null!=d?d:this.svgRoot,this.focusableElement.setAttribute("id",this.id),ax(this.background,"pointerdown",this,this.onMouseDown),ax(this.focusableElement,"keydown",this,this.onKeyDown)}dispose(){a2(this.svgRoot),this.disposed=!0}setAnchorLocation(a,b=!1){this.anchor=a,b?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(a,b){this.relativeLeft=a,this.relativeTop=b,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(a,b=!1){a.width=Math.max(a.width,j0.MIN_SIZE),a.height=Math.max(a.height,j0.MIN_SIZE),this.size=a,this.background.setAttribute("width",`${a.width}`),this.background.setAttribute("height",`${a.height}`),b?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(a){this.colour=a,this.tail.setAttribute("fill",a),this.background.setAttribute("fill",a)}onMouseDown(a){let b;null==(b=this.workspace.getGesture(a))||b.handleBubbleStart(a,this),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}onKeyDown(a){"Escape"===a.key&&this.owner&&(this.owner.setBubbleVisible(!1),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.owner))}positionRelativeToAnchor(){let a=this.anchor.x;a=this.workspace.RTL?a-(this.relativeLeft+this.size.width):a+this.relativeLeft,this.moveTo(a,this.relativeTop+this.anchor.y)}moveTo(a,b){this.svgRoot.setAttribute("transform",`translate(${a}, ${b})`)}positionByRect(a=new hb(0,0,0,0)){var b=this.workspace.getMetricsManager().getViewMetrics(!0),c=this.getOptimalRelativeLeft(b),d=this.getOptimalRelativeTop(b);let e={x:c,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},f={x:-this.size.width-30,y:d};d={x:a.getWidth(),y:d};var g={x:c,y:a.getHeight()};c=a.getWidth()<a.getHeight()?d:g,a=a.getWidth()<a.getHeight()?g:d,d=this.getOverlap(e,b),g=this.getOverlap(f,b);let h=this.getOverlap(c,b);b=Math.max(d,g,h,b=this.getOverlap(a,b)),d===b?(this.relativeLeft=e.x,this.relativeTop=e.y):g===b?(this.relativeLeft=f.x,this.relativeTop=f.y):h===b?(this.relativeLeft=c.x,this.relativeTop=c.y):(this.relativeLeft=a.x,this.relativeTop=a.y),this.positionRelativeToAnchor()}getOverlap(a,b){var c=this.workspace.RTL?this.anchor.x-a.x-this.size.width:a.x+this.anchor.x;return a=a.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(c+this.size.width,b.left+b.width)-Math.max(c,b.left))*(Math.min(a+this.size.height,b.top+b.height)-Math.max(a,b.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(a){let b=-this.size.width/4;if(this.size.width>a.width)return b;if(a=this.getWorkspaceViewRect(a),this.workspace.RTL){var c=this.anchor.x-b;c-this.size.width<a.left?b=-(a.left-this.anchor.x+this.size.width):c>a.right&&(b=-(a.right-this.anchor.x))}else{let d=(c=b+this.anchor.x)+this.size.width;c<a.left?b=a.left-this.anchor.x:d>a.right&&(b=a.right-this.anchor.x-this.size.width)}return b}getOptimalRelativeTop(a){let b=-this.size.height/4;if(this.size.height>a.height)return b;let c=this.anchor.y+b,d=c+this.size.height;return c<(a=this.getWorkspaceViewRect(a)).top?b=a.top-this.anchor.y:d>a.bottom&&(b=a.bottom-this.anchor.y-this.size.height),b}getWorkspaceViewRect(a){let b=a.top,c=a.top+a.height,d=a.left;return a=a.left+a.width,c-=this.getScrollbarThickness(),this.workspace.RTL?d-=this.getScrollbarThickness():a-=this.getScrollbarThickness(),new hb(b,c,d,a)}getScrollbarThickness(){return hi.scrollbarThickness/this.workspace.scale}renderTail(){let a,b=[];var c=this.size.width/2,d=this.size.height/2,e=-this.relativeLeft,f=-this.relativeTop;if(c===e&&d===f)b.push("M "+c+","+d);else{f-=d,e-=c,this.workspace.RTL&&(e*=-1);var g=Math.sqrt(f*f+e*e),h=Math.acos(e/g);f<0&&(h=2*Math.PI-h);var i=h+Math.PI/2;i>2*Math.PI&&(i-=2*Math.PI);var j=Math.sin(i);let a=Math.cos(i),k=(this.size.width+this.size.height)/j0.TAIL_THICKNESS;k=Math.min(k,this.size.width,this.size.height)/4,e=c+(i=1-j0.ANCHOR_RADIUS/g)*e,f=d+i*f,i=c+k*a;let l=d+k*j;c-=k*a,d-=k*j,(j=h+(j=c0(this.workspace.RTL?-j0.TAIL_ANGLE:j0.TAIL_ANGLE)))>2*Math.PI&&(j-=2*Math.PI),h=Math.sin(j)*g/j0.TAIL_BEND,g=Math.cos(j)*g/j0.TAIL_BEND,b.push("M"+i+","+l),b.push("C"+(i+g)+","+(l+h)+" "+e+","+f+" "+e+","+f),b.push("C"+e+","+f+" "+(c+g)+","+(d+h)+" "+c+","+d)}b.push("z"),null==(a=this.tail)||a.setAttribute("d",b.join(" "))}bringToFront(){let a,b=null==(a=this.svgRoot)?void 0:a.parentNode;return!!this.svgRoot&&(null==b?void 0:b.lastChild)!==this.svgRoot&&(null==b||b.appendChild(this.svgRoot),!0)}getRelativeToSurfaceXY(){return new g9(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(a){this.moveTo(a.x,a.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-a.x-this.size.width:a.x-this.anchor.x,this.relativeTop=a.y-this.anchor.y,this.renderTail()}setDragging(a){}setDeleteStyle(a){}isDeletable(){return!1}showContextMenu(a){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(a){this.dragStrategy.drag(a)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){bk(this)}unselect(){bk(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront();var a=this.getRelativeToSurfaceXY();let b=this.getSize();a=new hb(a.y,a.y+b.height,a.x,a.x+b.width),this.workspace.scrollBoundsIntoView(a)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}getOwner(){return this.owner}};j0=j5,j5.BORDER_WIDTH=6,j5.DOUBLE_BORDER=2*j0.BORDER_WIDTH,j5.MIN_SIZE=j0.DOUBLE_BORDER,j5.TAIL_THICKNESS=1,j5.TAIL_ANGLE=20,j5.TAIL_BEND=4,j5.ANCHOR_RADIUS=8;var j6=class extends j5{constructor(a,b,c,d){let e,f;super(b,c,d),this.workspace=b,this.anchor=c,this.ownerRect=d,this.autoLayout=!0,b=new j3(a),this.validateWorkspaceOptions(b),this.svgDialog=aZ(ha.SVG,{x:j5.BORDER_WIDTH,y:j5.BORDER_WIDTH},this.contentContainer),a.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new j3(a)),this.miniWorkspace.internalIsMutator=!0,a=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(a),b.languageTree&&(a.insertBefore(this.miniWorkspace.addFlyout(ha.G),this.miniWorkspace.getCanvas()),null==(a=this.miniWorkspace.getFlyout())||a.init(this.miniWorkspace),null==a||a.show(b.languageTree)),a$(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(e=this.miniWorkspace.getFlyout())||null==(f=e.getWorkspace())||f.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(a){this.miniWorkspace.addChangeListener(a)}validateWorkspaceOptions(a){if(a.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(a.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(a.zoomOptions.controls||a.zoomOptions.wheel||a.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(a.moveOptions.scrollbars||a.moveOptions.wheel||a.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(a.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(let a of this.miniWorkspace.getTopBlocks(!1)){let b=a.getRelativeToSurfaceXY();if(b.y<20&&a.moveBy(0,20-b.y),a.RTL){let c=-20,d=this.miniWorkspace.getFlyout();d&&(c-=d.getWidth()),b.x>c&&a.moveBy(c-b.x,0)}else b.x<20&&a.moveBy(20-b.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress){this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress);var a=this.getSize(),b=this.calculateWorkspaceSize();Math.abs(a.width-b.width)<j6.MINIMUM_VIEW_CHANGE&&Math.abs(a.height-b.height)<j6.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${b.width}px`),this.svgDialog.setAttribute("height",`${b.height}px`),this.miniWorkspace.setCachedParentSvgSize(b.width,b.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${b.width}, 0)`),this.setSize(new hc(b.width+j5.DOUBLE_BORDER,b.height+j5.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var a=this.miniWorkspace.getCanvas().getBBox();let b=a.width+j6.MARGIN;a=a.height+j6.MARGIN;let c=this.miniWorkspace.getFlyout();return c&&(a=Math.max(a,c.getWorkspace().getMetricsManager().getScrollMetrics().height+20),b+=c.getWidth()),new hc(b,a)}updateBlockStyles(){let a;for(var b of this.miniWorkspace.getAllBlocks(!1))b.setStyle(b.getStyleName());if(b=null==(a=this.miniWorkspace.getFlyout())?void 0:a.getWorkspace())for(let a of b.getAllBlocks(!1))a.setStyle(a.getStyleName())}moveDuringDrag(a){super.moveDuringDrag(a),this.autoLayout=!1}moveTo(a,b){super.moveTo(a,b),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(a){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};j6.MINIMUM_VIEW_CHANGE=10,j6.MARGIN=3*j5.DOUBLE_BORDER;var j7=class{constructor(a){this.sourceBlock=a,this.offsetInBlock=new g9(0,0),this.workspaceLocation=new g9(0,0),this.svgRoot=null,this.tooltip=a,this.id=aE()}getType(){throw Error("Icons must implement getType")}initView(a){if(!this.svgRoot){var b=this.sourceBlock;this.svgRoot=aZ(ha.G,{class:"blocklyIconGroup",id:this.id}),b.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),ax(this.svgRoot,"pointerdown",this,a),this.svgRoot.tooltip=this,dx(this.svgRoot)}}dispose(){dy(this.svgRoot),a2(this.svgRoot)}getWeight(){return -1}getSize(){return new hc(0,0)}setTooltip(a){this.tooltip=null!=a?a:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",c_(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(a){this.offsetInBlock=a,this.updateSvgRootOffset()}updateSvgRootOffset(){let a;null==(a=this.svgRoot)||a.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(a){this.workspaceLocation=g9.sum(a,this.offsetInBlock)}onClick(){}isClickableInFlyout(a){return!0}getFocusableElement(){let a=this.svgRoot;if(!a)throw Error("Attempting to focus uninitialized icon.");return a}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){var a=this.sourceBlock.getBoundingRectangle();a=new hb(a.top+this.offsetInBlock.y,a.top+this.offsetInBlock.y+this.getSize().height,a.left+this.offsetInBlock.x,a.left+this.offsetInBlock.x+this.getSize().width),this.sourceBlock.workspace.scrollBoundsIntoView(a)}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}};B.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends j7{constructor(a,b){super(b),this.flyoutBlockTypes=a,this.sourceBlock=b,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return B.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(a){this.svgRoot||(super.initView(a),aZ(ha.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),aZ(ha.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),aZ(ha.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),a$(this.svgRoot,"blocklyMutatorIcon"))}dispose(){let a;super.dispose(),null==(a=this.miniWorkspaceBubble)||a.dispose()}getWeight(){return B.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new hc(17,17)}applyColour(){let a,b;super.applyColour(),null==(a=this.miniWorkspaceBubble)||a.setColour(this.sourceBlock.getColour()),null==(b=this.miniWorkspaceBubble)||b.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(a){let b;super.onLocationChange(a),null==(b=this.miniWorkspaceBubble)||b.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(a){let b=this;return(0,gr.asyncExecutePromiseGeneratorFunction)(function*(){if(b.bubbleIsVisible()!==a){if(yield b5(),a){let a;b.miniWorkspaceBubble=new j6(b.getMiniWorkspaceConfig(),b.sourceBlock.workspace,b.getAnchorLocation(),b.getBubbleOwnerRect()),b.applyColour(),b.createRootBlock(),b.addSaveConnectionsListener(),null==(a=b.miniWorkspaceBubble)||a.addWorkspaceChangeListener(b.createMiniWorkspaceChangeListener())}else{let a;null==(a=b.miniWorkspaceBubble)||a.dispose(),b.miniWorkspaceBubble=null,b.saveConnectionsListener&&b.sourceBlock.workspace.removeChangeListener(b.saveConnectionsListener),b.saveConnectionsListener=null}aP(new(aX(gB.BUBBLE_OPEN))(b.sourceBlock,a,"mutator"))}})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){let a,b={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(a=this.sourceBlock.workspace.options.rendererOverrides)?a:void 0};return this.flyoutBlockTypes.length&&(b.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(a=>({kind:"block",type:a}))}),b}getAnchorLocation(){return g9.sum(this.workspaceLocation,new g9(8.5,8.5))}getBubbleOwnerRect(){let a=this.sourceBlock.getSvgRoot().getBBox();return new hb(a.y,a.y+a.height,a.x,a.x+a.width)}createRootBlock(){let a,b,c,d;if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(d=null==(a=this.miniWorkspaceBubble)||null==(b=a.getWorkspace())||null==(c=b.getFlyout())?void 0:c.getWidth())?d:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return a=>{B.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(a)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(a){return a.isUiEvent||aG(a)||aI(a)&&"disabled"===a.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var a=B.getGroup$$module$build$src$core$events$utils();a||B.setGroup$$module$build$src$core$events$utils(!0);var b=iz.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var c=iz.getExtraBlockState_(this.sourceBlock);b!==c&&aP(new(aX(gB.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,b,c)),B.setGroup$$module$build$src$core$events$utils(a)}}getWorkspace(){let a;return null==(a=this.miniWorkspaceBubble)?void 0:a.getWorkspace()}},B.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=ix.MUTATOR,B.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,B.MutatorIcon$$module$build$src$core$icons$mutator_icon;var j8=Object.create(null);B.register$$module$build$src$core$extensions("parent_tooltip_when_inline",function(){let a=this.tooltip;this.setTooltip((function(){let b=this.getParent();return b&&b.getInputsInline()&&b.tooltip||a}).bind(this))});var j9={TEST_ONLY:{allExtensions:j8}};j9.apply=eG,j9.buildTooltipForDropdown=B.buildTooltipForDropdown$$module$build$src$core$extensions,j9.buildTooltipWithFieldText=B.buildTooltipWithFieldText$$module$build$src$core$extensions,j9.isRegistered=eF,j9.register=B.register$$module$build$src$core$extensions,j9.registerMixin=B.registerMixin$$module$build$src$core$extensions,j9.registerMutator=B.registerMutator$$module$build$src$core$extensions,j9.runAfterPageLoad=function(a){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)a();else{let b=setInterval(function(){"complete"===document.readyState&&(clearInterval(b),a())},10)}},j9.unregister=function(a){eF(a)?delete j8[a]:console.warn('No extension mapping for name "'+a+'" found to unregister')},(mN=mT||(mT={}))[mN.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",mN[mN.MAC_ENTER=3]="MAC_ENTER",mN[mN.BACKSPACE=8]="BACKSPACE",mN[mN.TAB=9]="TAB",mN[mN.NUM_CENTER=12]="NUM_CENTER",mN[mN.ENTER=13]="ENTER",mN[mN.SHIFT=16]="SHIFT",mN[mN.CTRL=17]="CTRL",mN[mN.ALT=18]="ALT",mN[mN.PAUSE=19]="PAUSE",mN[mN.CAPS_LOCK=20]="CAPS_LOCK",mN[mN.ESC=27]="ESC",mN[mN.SPACE=32]="SPACE",mN[mN.PAGE_UP=33]="PAGE_UP",mN[mN.PAGE_DOWN=34]="PAGE_DOWN",mN[mN.END=35]="END",mN[mN.HOME=36]="HOME",mN[mN.LEFT=37]="LEFT",mN[mN.UP=38]="UP",mN[mN.RIGHT=39]="RIGHT",mN[mN.DOWN=40]="DOWN",mN[mN.PLUS_SIGN=43]="PLUS_SIGN",mN[mN.PRINT_SCREEN=44]="PRINT_SCREEN",mN[mN.INSERT=45]="INSERT",mN[mN.DELETE=46]="DELETE",mN[mN.ZERO=48]="ZERO",mN[mN.ONE=49]="ONE",mN[mN.TWO=50]="TWO",mN[mN.THREE=51]="THREE",mN[mN.FOUR=52]="FOUR",mN[mN.FIVE=53]="FIVE",mN[mN.SIX=54]="SIX",mN[mN.SEVEN=55]="SEVEN",mN[mN.EIGHT=56]="EIGHT",mN[mN.NINE=57]="NINE",mN[mN.FF_SEMICOLON=59]="FF_SEMICOLON",mN[mN.FF_EQUALS=61]="FF_EQUALS",mN[mN.FF_DASH=173]="FF_DASH",mN[mN.FF_HASH=163]="FF_HASH",mN[mN.QUESTION_MARK=63]="QUESTION_MARK",mN[mN.AT_SIGN=64]="AT_SIGN",mN[mN.A=65]="A",mN[mN.B=66]="B",mN[mN.C=67]="C",mN[mN.D=68]="D",mN[mN.E=69]="E",mN[mN.F=70]="F",mN[mN.G=71]="G",mN[mN.H=72]="H",mN[mN.I=73]="I",mN[mN.J=74]="J",mN[mN.K=75]="K",mN[mN.L=76]="L",mN[mN.M=77]="M",mN[mN.N=78]="N",mN[mN.O=79]="O",mN[mN.P=80]="P",mN[mN.Q=81]="Q",mN[mN.R=82]="R",mN[mN.S=83]="S",mN[mN.T=84]="T",mN[mN.U=85]="U",mN[mN.V=86]="V",mN[mN.W=87]="W",mN[mN.X=88]="X",mN[mN.Y=89]="Y",mN[mN.Z=90]="Z",mN[mN.META=91]="META",mN[mN.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",mN[mN.CONTEXT_MENU=93]="CONTEXT_MENU",mN[mN.NUM_ZERO=96]="NUM_ZERO",mN[mN.NUM_ONE=97]="NUM_ONE",mN[mN.NUM_TWO=98]="NUM_TWO",mN[mN.NUM_THREE=99]="NUM_THREE",mN[mN.NUM_FOUR=100]="NUM_FOUR",mN[mN.NUM_FIVE=101]="NUM_FIVE",mN[mN.NUM_SIX=102]="NUM_SIX",mN[mN.NUM_SEVEN=103]="NUM_SEVEN",mN[mN.NUM_EIGHT=104]="NUM_EIGHT",mN[mN.NUM_NINE=105]="NUM_NINE",mN[mN.NUM_MULTIPLY=106]="NUM_MULTIPLY",mN[mN.NUM_PLUS=107]="NUM_PLUS",mN[mN.NUM_MINUS=109]="NUM_MINUS",mN[mN.NUM_PERIOD=110]="NUM_PERIOD",mN[mN.NUM_DIVISION=111]="NUM_DIVISION",mN[mN.F1=112]="F1",mN[mN.F2=113]="F2",mN[mN.F3=114]="F3",mN[mN.F4=115]="F4",mN[mN.F5=116]="F5",mN[mN.F6=117]="F6",mN[mN.F7=118]="F7",mN[mN.F8=119]="F8",mN[mN.F9=120]="F9",mN[mN.F10=121]="F10",mN[mN.F11=122]="F11",mN[mN.F12=123]="F12",mN[mN.NUMLOCK=144]="NUMLOCK",mN[mN.SCROLL_LOCK=145]="SCROLL_LOCK",mN[mN.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",mN[mN.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",mN[mN.SEMICOLON=186]="SEMICOLON",mN[mN.DASH=189]="DASH",mN[mN.EQUALS=187]="EQUALS",mN[mN.COMMA=188]="COMMA",mN[mN.PERIOD=190]="PERIOD",mN[mN.SLASH=191]="SLASH",mN[mN.APOSTROPHE=192]="APOSTROPHE",mN[mN.TILDE=192]="TILDE",mN[mN.SINGLE_QUOTE=222]="SINGLE_QUOTE",mN[mN.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",mN[mN.BACKSLASH=220]="BACKSLASH",mN[mN.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",mN[mN.WIN_KEY=224]="WIN_KEY",mN[mN.MAC_FF_META=224]="MAC_FF_META",mN[mN.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",mN[mN.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",mN[mN.WIN_IME=229]="WIN_IME",mN[mN.VK_NONAME=252]="VK_NONAME",mN[mN.PHANTOM=255]="PHANTOM";var ka={};ka.arc=eV,ka.curve=eP,ka.line=eT,ka.lineOnAxis=eU,ka.lineTo=eS,ka.moveBy=eR,ka.moveTo=eQ,ka.point=eO;var kb={};kb.Coordinate=g9,kb.KeyCodes=mT,kb.Rect=hb,kb.Size=hc,kb.Svg=ha,kb.aria=hQ,kb.array=g1,kb.browserEvents=V,kb.colour=jk,kb.deprecation=ii,kb.dom=gJ,kb.extensions=j9,kb.idGenerator=$,kb.math=iA,kb.object=gO,kb.parsing=jl,kb.string=i_,kb.style=he,kb.svgMath=hh,kb.svgPaths=ka,kb.toolbox=hx,kb.userAgent={ANDROID:gw,GECKO:gv,IPAD:gx,IPHONE:gy,JavaFx:R,MAC:S,MOBILE:gA,raw:gs},kb.xml=hq;var kc=class extends j5{constructor(a,b,c,d){super(a,b,c,void 0,d),this.workspace=a,this.anchor=b,this.ownerRect=c,this.owner=d,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.sizeChangeListeners=[],this.locationChangeListeners=[],this.DEFAULT_SIZE=new hc(160+j5.DOUBLE_BORDER,80+j5.DOUBLE_BORDER),this.MIN_SIZE=new hc(45+j5.DOUBLE_BORDER,20+j5.DOUBLE_BORDER),this.editable=!0,a$(this.svgRoot,"blocklyTextInputBubble"),this.editor=new jM(a,this.id,()=>{B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}),this.contentContainer.appendChild(this.editor.getDom()),this.resizeGroup=this.createResizeHandle(this.svgRoot,a),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.editor.getText()}setText(a){this.editor.setText(a)}setEditable(a){this.editable=a,this.editor.setEditable(a)}isEditable(){return this.editable}addTextChangeListener(a){this.editor.addTextChangeListener(a)}addSizeChangeListener(a){this.sizeChangeListeners.push(a)}addLocationChangeListener(a){this.locationChangeListeners.push(a)}createResizeHandle(a,b){return ax(a=aZ(ha.IMAGE,{class:"blocklyResizeHandle",href:`${b.options.pathToMedia}resize-handle.svg`},a),"pointerdown",this,this.onResizePointerDown),a}setSize(a,b=!1){a.width=Math.max(a.width,this.MIN_SIZE.width),a.height=Math.max(a.height,this.MIN_SIZE.height);let c=a.width-j5.DOUBLE_BORDER,d=a.height-j5.DOUBLE_BORDER;this.editor.updateSize(new hc(c,d),new hc(0,0)),this.editor.getDom().setAttribute("x",`${j5.DOUBLE_BORDER/2}`),this.editor.getDom().setAttribute("y",`${j5.DOUBLE_BORDER/2}`),this.resizeGroup.setAttribute("y",`${d}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",`${-j5.DOUBLE_BORDER}`):this.resizeGroup.setAttribute("x",`${c}`),super.setSize(a,b),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(a){super.moveDuringDrag(a),this.onLocationChange()}setPositionRelativeToAnchor(a,b){super.setPositionRelativeToAnchor(a,b),this.onLocationChange()}positionByRect(a=new hb(0,0,0,0)){super.positionByRect(a),this.onLocationChange()}onResizePointerDown(a){this.bringToFront(),aB(a)||(ef(this.workspace,a,new g9(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=ax(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=ax(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),a.stopPropagation()}onResizePointerUp(a){at(),this.resizePointerUpListener&&(az(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(az(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(a){a=eg(this.workspace,a),this.setSize(new hc(this.workspace.RTL?-a.x:a.x,a.y),!1),this.onSizeChange()}onSizeChange(){for(let a of this.sizeChangeListeners)a()}onLocationChange(){for(let a of this.locationChangeListeners)a()}getEditor(){return this.editor}};bt("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n"),(mO=mU||(mU={}))[mO.INPUT_VALUE=1]="INPUT_VALUE",mO[mO.OUTPUT_VALUE=2]="OUTPUT_VALUE",mO[mO.NEXT_STATEMENT=3]="NEXT_STATEMENT",mO[mO.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT";var kd=class{constructor(a){this.connectionChecker=a,this.connections=[]}addConnection(a,b){b=this.calculateIndexForYPos(b),this.connections.splice(b,0,a)}findIndexOfConnection(a,b){if(!this.connections.length)return -1;let c=this.calculateIndexForYPos(b);if(c>=this.connections.length)return -1;b=a.y;let d=c;for(;d>=0&&this.connections[d].y===b;){if(this.connections[d]===a)return d;d--}for(d=c;d<this.connections.length&&this.connections[d].y===b;){if(this.connections[d]===a)return d;d++}return -1}calculateIndexForYPos(a){if(!this.connections.length)return 0;let b=0,c=this.connections.length;for(;b<c;){let d=Math.floor((b+c)/2);if(this.connections[d].y<a)b=d+1;else if(this.connections[d].y>a)c=d;else{b=d;break}}return b}removeConnection(a,b){if(-1===(a=this.findIndexOfConnection(a,b)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(a,1)}getNeighbours(a,b){function c(a){let c=e-d[a].x,g=f-d[a].y;return Math.sqrt(c*c+g*g)<=b&&i.push(d[a]),g<b}let d=this.connections,e=a.x,f=a.y;a=0;let g=d.length-2,h=g;for(;a<h;)d[h].y<f?a=h:g=h,h=Math.floor((a+g)/2);let i=[];if(g=a=h,d.length){for(;a>=0&&c(a);)a--;do g++;while(g<d.length&&c(g))}return i}isInYRange(a,b,c){return Math.abs(this.connections[a].y-b)<=c}searchForClosest(a,b,c){if(!this.connections.length)return{connection:null,radius:b};let d=a.y,e=a.x;a.x=e+c.x,a.y=d+c.y;var f=this.calculateIndexForYPos(a.y);c=null;let g=b,h,i=f-1;for(;i>=0&&this.isInYRange(i,a.y,b);)h=this.connections[i],this.connectionChecker.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),i--;for(;f<this.connections.length&&this.isInYRange(f,a.y,b);)h=this.connections[f],this.connectionChecker.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),f++;return a.x=e,a.y=d,{connection:c,radius:g}}static init(a){let b=[];return b[mU.INPUT_VALUE]=new kd(a),b[mU.OUTPUT_VALUE]=new kd(a),b[mU.NEXT_STATEMENT]=new kd(a),b[mU.PREVIOUS_STATEMENT]=new kd(a),b}},ke=class extends g${constructor(a,b,c){super(c),this.type=gB.SELECTED,this.oldElementId=null!=a?a:void 0,this.newElementId=null!=b?b:void 0}toJson(){let a=super.toJson();return a.oldElementId=this.oldElementId,a.newElementId=this.newElementId,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new ke)).oldElementId=a.oldElementId,b.newElementId=a.newElementId,b}};ai(F.EVENT,gB.SELECTED,ke);var kf=class extends iy{constructor(a){if(super(a),this.type=gB.BLOCK_DELETE,a){if(a.getParent())throw Error("Connected blocks cannot be deleted.");a.isShadow()&&(this.recordUndo=!1),this.oldXml=ej(a),this.ids=aV(a),this.wasShadow=a.isShadow(),this.oldJson=cE(a,{addCoordinates:!0})}}toJson(){let a=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return a.oldXml=eo(this.oldXml),a.ids=this.ids,a.wasShadow=this.wasShadow,a.oldJson=this.oldJson,this.recordUndo||(a.recordUndo=this.recordUndo),a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new kf)).oldXml=B.textToDom$$module$build$src$core$utils$xml(a.oldXml),b.ids=a.ids,b.wasShadow=a.wasShadow||"shadow"===b.oldXml.tagName.toLowerCase(),b.oldJson=a.oldJson,void 0!==a.recordUndo&&(b.recordUndo=a.recordUndo),b}run(a){let b=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(a)for(a=0;a<this.ids.length;a++){let c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn("Can't delete non-existent block: "+c)}else cN(this.oldJson,b)}};ai(F.EVENT,gB.BLOCK_DELETE,kf);var kg=class{constructor(a,b){if(this.type=b,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=a,a.id.includes("_connection"))throw Error(`Connection ID indicator is contained in block ID. This will cause problems with focus: ${a.id}.`);this.id=`${a.id}_connection_${aE()}`}connect_(a){let b,c,d=mU.INPUT_VALUE,e=this.getSourceBlock();var f=a.getSourceBlock();if(a.isConnected()&&a.disconnectInternal(!1),this.isConnected()){let a=this.stashShadowState(),c=this.targetBlock();c.isShadow()?c.dispose(!1):(this.disconnectInternal(),b=c),this.applyShadowState(a)}aU()&&(c=new(aX(gB.BLOCK_MOVE))(f)).setReason(["connect"]),eW(this,a),f.setParent(e),c&&(c.recordNew(),aP(c)),b&&(a=this.type===d?b.outputConnection:b.previousConnection)&&((f=kg.getConnectionForOrphanedConnection(f,a))?a.connect(f):a.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();let a=this.targetBlock();a&&!a.isDeadOrDying()&&a.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===mU.INPUT_VALUE||this.type===mU.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(a){}connect(a){if(this.targetConnection===a)return!0;if(this.getConnectionChecker().canConnect(this,a,!1)){let b=B.getGroup$$module$build$src$core$events$utils();b||B.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(a):a.connect_(this),B.setGroup$$module$build$src$core$events$utils(b)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(a=!0){let b,{parentConnection:c,childConnection:d}=this.getParentAndChildConnections();if(!c||!d)throw Error("Source connection not connected.");let e=B.getGroup$$module$build$src$core$events$utils();e||B.setGroup$$module$build$src$core$events$utils(!0),aU()&&(b=new(aX(gB.BLOCK_MOVE))(d.getSourceBlock())).setReason(["disconnect"]);let f=this.targetConnection;f&&(f.targetConnection=null),this.targetConnection=null,a&&d.getSourceBlock().setParent(null),b&&(b.recordNew(),aP(b)),d.getSourceBlock().isShadow()||c.respawnShadow_(),B.setGroup$$module$build$src$core$events$utils(e)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(a,b){var c;return!this.getSourceBlock().isDeadOrDying()&&(b=null==(c=a.getInput(b))?void 0:c.connection,(!(c=this.targetBlock())||c===a)&&!!b&&b.targetConnection!==this&&(b.isConnected()&&b.disconnect(),b.connect(this),!0))}targetBlock(){if(this.isConnected()){let a,b;return null!=(b=null==(a=this.targetConnection)?void 0:a.getSourceBlock())?b:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(a){return a?(Array.isArray(a)||(a=[a]),this.check=a,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(a){this.setShadowStateInternal({shadowDom:a})}getShadowDom(a){return a&&this.targetBlock().isShadow()?em(this.targetBlock()):this.shadowDom}setShadowState(a){this.setShadowStateInternal({shadowState:a})}getShadowState(a){return a&&this.targetBlock()&&this.targetBlock().isShadow()?cE(this.targetBlock()):this.shadowState}neighbours(a){return[]}getParentInput(){let a=null,b=this.sourceBlock_.inputList;for(let c=0;c<b.length;c++)if(b[c].connection===this){a=b[c];break}return a}toString(){let a=this.sourceBlock_;if(!a)return"Orphan Connection";if(a.outputConnection===this)var b="Output Connection of ";else if(a.previousConnection===this)b="Previous Connection of ";else if(a.nextConnection===this)b="Next Connection of ";else{b=null;for(let c=0,d;d=a.inputList[c];c++)if(d.connection===this){b=d;break}if(!b)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";b='Input "'+b.name+'" connection on '}return b+a.toDevString()}stashShadowState(){let a=this.getShadowDom(!0),b=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:a,shadowState:b}}applyShadowState({shadowDom:a,shadowState:b}){this.shadowDom=a,this.shadowState=b}setShadowStateInternal({shadowDom:a=null,shadowState:b=null}={}){this.shadowDom=a,this.shadowState=b,this.getSourceBlock().isDeadOrDying()||((a=this.targetBlock())?a.isShadow()?(a.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(a=this.createShadowBlock(!1),this.serializeShadow(a),a&&a.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(a){var b=this.getSourceBlock();let c=this.getShadowState(),d=this.getShadowDom();if(b.isDeadOrDying()||!c&&!d)return null;if(c)return cO(c,b.workspace,{parentConnection:a?this:void 0,isShadow:!0,recordUndo:!1});if(d){if(b=eq(d,b.workspace),a)if(this.type===mU.INPUT_VALUE){if(!b.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(b.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===mU.NEXT_STATEMENT){if(!b.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(b.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return b}return null}serializeShadow(a){a&&(this.shadowDom=em(a),this.shadowState=cE(a))}static getConnectionForOrphanedConnection(a,b){if(b.type===mU.OUTPUT_VALUE)return eY(a,b.getSourceBlock());a=a.lastConnectionInStack(!0);let c=b.getConnectionChecker();return a&&c.canConnect(b,a,!1)?a:null}};kg.CAN_CONNECT=0,kg.REASON_SELF_CONNECTION=1,kg.REASON_WRONG_TYPE=2,kg.REASON_TARGET_NULL=3,kg.REASON_CHECKS_FAILED=4,kg.REASON_DIFFERENT_WORKSPACES=5,kg.REASON_SHADOW_PARENT=6,kg.REASON_DRAG_CHECKS_FAILED=7,kg.REASON_PREVIOUS_AND_OUTPUT=8;var kh=class extends Error{constructor(a){super(`Tried to append an icon of type ${a.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=a}},ki={};ki.DuplicateIconType=kh,(mP=B.Align$$module$build$src$core$inputs$align||(B.Align$$module$build$src$core$inputs$align={}))[mP.LEFT=-1]="LEFT",mP[mP.CENTRE=0]="CENTRE",mP[mP.RIGHT=1]="RIGHT",B.Align$$module$build$src$core$inputs$align;var kj=class extends jm{constructor(a,b,c){super(jm.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,a!==jm.SKIP_SETUP&&(c?this.configure_(c):this.class=b||null,this.setValue(a))}configure_(a){super.configure_(a),a.class&&(this.class=a.class)}initView(){this.createTextElement_(),this.class&&a$(this.getTextElement(),this.class),this.fieldGroup_&&a$(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(a){return null==a?null:`${a}`}setClass(a){this.textElement_&&(this.class&&a0(this.textElement_,this.class),a&&a$(this.textElement_,a)),this.class=a}static fromJson(a){return new this(dU(a.text),void 0,a)}};eD("field_label",kj),kj.prototype.DEFAULT_VALUE="";var kk=[];kk[mU.INPUT_VALUE]=mU.OUTPUT_VALUE,kk[mU.OUTPUT_VALUE]=mU.INPUT_VALUE,kk[mU.NEXT_STATEMENT]=mU.PREVIOUS_STATEMENT,kk[mU.PREVIOUS_STATEMENT]=mU.NEXT_STATEMENT;var kl="RENAME_VARIABLE_ID",km="DELETE_VARIABLE_ID",kn=class extends kg{constructor(a,b){super(a,b),this.highlighted=!1,this.targetConnection=null,this.db=a.workspace.connectionDBList[b],this.dbOpposite=a.workspace.connectionDBList[kk[b]],this.offsetInBlock=new g9(0,0),this.trackedState=kn.TrackedState.WILL_TRACK}dispose(){let a,b;super.dispose(),this.trackedState===kn.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(b=(a=this.sourceBlock_.pathObject).removeConnectionHighlight)||b.call(a,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(a){let b=this.x-a.x;return Math.sqrt(b*b+(a=this.y-a.y)*a)}bumpAwayFrom(a,b=!1){if(!this.sourceBlock_.workspace.isDragging()){var c=B.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),d=B.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),e=a.sourceBlock_.getRootBlock(),f=this.sourceBlock_.getRootBlock();if(!e.isInFlyout&&!f.isInFlyout){var g=!0;if(f.isMovable())e.isMovable()&&b&&(d=-d);else{if(!e.isMovable())return;g=!1,c=-c,d=-d}b=g?a:this,a=g?this:a,(e=g?f:e).RTL&&(c=-c),e.moveBy(b.x+c-a.x,b.y+d-a.y,["bump"])}}}moveTo(a,b){let c=!1;return this.trackedState===kn.TrackedState.WILL_TRACK?(this.db.addConnection(this,b),this.trackedState=kn.TrackedState.TRACKED,c=!0):this.trackedState===kn.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,b),c=!0),this.x=a,this.y=b,c}moveBy(a,b){return this.moveTo(this.x+a,this.y+b)}moveToOffset(a){return this.moveTo(a.x+this.offsetInBlock.x,a.y+this.offsetInBlock.y)}setOffsetInBlock(a,b){this.offsetInBlock.x=a,this.offsetInBlock.y=b}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var a=this.targetConnection;let b=this.targetBlock();a&&b&&(a=g9.difference(this.offsetInBlock,a.offsetInBlock),b.translate(a.x,a.y))}closest(a,b){return this.dbOpposite.searchForClosest(this,a,b)}highlight(){this.highlighted=!0;let a=this.findHighlightSvg();a&&(a.style.display="")}unhighlight(){this.highlighted=!1;let a=this.findHighlightSvg();a&&(a.style.display="none")}isHighlighted(){return this.highlighted}setTracking(a){a&&this.trackedState===kn.TrackedState.TRACKED||!a&&this.trackedState===kn.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(a?(this.db.addConnection(this,this.y),this.trackedState=kn.TrackedState.TRACKED):(this.trackedState===kn.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=kn.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){let a=this.targetBlock().getDescendants(!1);for(let b=0;b<a.length;b++){let c=a[b],d=c.getConnections_(!0);for(let a=0;a<d.length;a++)d[a].setTracking(!1);for(let a of c.getIcons())c_(a)&&a.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let a=[];if(this.type!==mU.INPUT_VALUE&&this.type!==mU.NEXT_STATEMENT)return a;let b=this.targetBlock();if(b){let c;b.isCollapsed()?(c=[],b.outputConnection&&c.push(b.outputConnection),b.nextConnection&&c.push(b.nextConnection),b.previousConnection&&c.push(b.previousConnection)):c=b.getConnections_(!0);for(let b=0;b<c.length;b++)a.push(...c[b].startTrackingAll());a.length||(a=[b])}return a}onFailedConnect(a){let b=this.getSourceBlock();if(aO()){let c=B.getGroup$$module$build$src$core$events$utils();setTimeout((function(){b.isDisposed()||b.getParent()||(B.setGroup$$module$build$src$core$events$utils(c),this.bumpAwayFrom(a),B.setGroup$$module$build$src$core$events$utils(!1))}).bind(this),B.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(a=!0){let{parentConnection:b,childConnection:c}=this.getParentAndChildConnections();if(b&&c){var d=B.getGroup$$module$build$src$core$events$utils();d||B.setGroup$$module$build$src$core$events$utils(!0);var e=b.getSourceBlock(),f=c.getSourceBlock();super.disconnectInternal(a),e.queueRender(),f.updateDisabled(),f.queueRender(),f.getSvgRoot().style.display="block",B.setGroup$$module$build$src$core$events$utils(d)}}respawnShadow_(){super.respawnShadow_();let a=this.targetBlock();a&&(a.initSvg(),a.queueRender())}neighbours(a){return this.dbOpposite.getNeighbours(this,a)}connect_(a){super.connect_(a);var b=this.getSourceBlock();a=a.getSourceBlock(),b.updateDisabled(),a.updateDisabled(),a.queueRender(),(b=b.getInputWithBlock(a))&&(b=b.isVisible(),a.getSvgRoot().style.display=b?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(a){return super.setCheck(a),this.sourceBlock_.queueRender(),this}showContextMenu(a){let b=jC.registry.getContextMenuOptions({focusedNode:this},a);if(b.length){var c=this.getSourceBlock(),d=c.workspace;if(a instanceof PointerEvent)var e=new g9(a.clientX,a.clientY);else e=bI(d,e=new g9(this.x,this.y)).translate(c.RTL?-5:5,5);d7(a,b,c.RTL,d,e)}}getFocusableElement(){let a=this.findHighlightSvg();if(a)return a;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight(),this.getSourceBlock().workspace.scrollBoundsIntoView(this.getSourceBlock().getBoundingRectangleWithoutChildren())}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}};(mQ=(mQ=kn||(kn={})).TrackedState||(mQ.TrackedState={}))[mQ.WILL_TRACK=-1]="WILL_TRACK",mQ[mQ.UNTRACKED=0]="UNTRACKED",mQ[mQ.TRACKED=1]="TRACKED";var ko=kn.TrackedState,kp={};kp.RenderedConnection=kn,kp.TrackedState=ko;var kq=class{constructor(a,b){this.name=a,this.sourceBlock=b,this.fieldRow=[],this.align=B.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=B.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(a,b){return this.insertFieldAt(this.fieldRow.length,a,b),this}insertFieldAt(a,b,c){if(a<0||a>this.fieldRow.length)throw Error("index "+a+" out of bounds.");return(b||""===b&&c)&&("string"==typeof b&&(b=B.fromJson$$module$build$src$core$field_registry({type:"field_label",text:b})),b.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(b),b.name=c,b.setVisible(this.isVisible()),b.prefixField&&(a=this.insertFieldAt(a,b.prefixField)),this.fieldRow.splice(a,0,b),a++,b.suffixField&&(a=this.insertFieldAt(a,b.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),a}removeField(a,b){for(let b=0,c;c=this.fieldRow[b];b++)if(c.name===a)return c.dispose(),this.fieldRow.splice(b,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(b)return!1;throw Error('Field "'+a+'" not found.')}isVisible(){return this.visible}setVisible(a){let b=[];if(this.visible===a)return b;this.visible=a;for(let b=0,c;c=this.fieldRow[b];b++)c.setVisible(a);if(this.connection&&this.connection instanceof kn){a?b=this.connection.startTrackingAll():this.connection.stopTrackingAll();let c=this.connection.targetBlock();c&&(c.getSvgRoot().style.display=a?"block":"none")}return b}markDirty(){for(let a=0,b;b=this.fieldRow[a];a++)b.markDirty()}setCheck(a){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(a),this}setAlign(a){return this.align=a,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(a){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(a),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(let a of this.fieldRow)a.init()}initModel(){for(let a of this.fieldRow)a.initModel()}initField(a){this.sourceBlock.rendered?a.init():a.initModel()}dispose(){for(let a=0,b;b=this.fieldRow[a];a++)b.dispose();this.connection&&this.connection.dispose()}makeConnection(a){return this.sourceBlock.makeConnection_(a)}},kr=class extends kq{constructor(a,b){super(a,b),this.name=a,this.type=B.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},ks=class extends kq{constructor(a,b){super(a,b),this.name=a,this.type=B.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},kt=class extends kq{constructor(a,b){if(!a)throw Error("Statement inputs must have a non-empty name");super(a,b),this.name=a,this.type=B.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(mU.NEXT_STATEMENT)}};B.ValueInput$$module$build$src$core$inputs$value_input=class extends kq{constructor(a,b){if(!a)throw Error("Value inputs must have a non-empty name");super(a,b),this.name=a,this.type=B.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(mU.INPUT_VALUE)}},B.ValueInput$$module$build$src$core$inputs$value_input;var ku=class{constructor(a,b,c){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=a,this.id=c&&!a.getBlockById(c)?c:aF(),a.setBlockById(this.id,this),this.xy=new g9(0,0),this.isInFlyout=a.isFlyout,this.isInMutator=a.isMutator,this.RTL=a.RTL,b){if(this.type=b,!(c=H[b])||"object"!=typeof c)throw TypeError("Invalid block definition for type: "+b);Object.assign(this,c)}a.addTopBlock(this),a.addTypedBlock(this),new.target===ku&&this.doInit_()}doInit_(){let a=B.getGroup$$module$build$src$core$events$utils();a||B.setGroup$$module$build$src$core$events$utils(!0);let b=aO();try{"function"==typeof this.init&&(B.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),B.setRecordUndo$$module$build$src$core$events$utils(b)),aU()&&aP(new(aX(gB.BLOCK_CREATE))(this))}finally{B.setGroup$$module$build$src$core$events$utils(a),B.setRecordUndo$$module$build$src$core$events$utils(b)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(a=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(a),aU()&&aP(new(aX(gB.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(a=>a.disposeInternal()),this.inputList.forEach(a=>a.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(a=>a.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(let a of this.inputList)a.initModel();this.initialized=!0}}unplug(a){this.outputConnection&&this.unplugFromRow(a),this.previousConnection&&this.unplugFromStack(a)}unplugFromRow(a){let b=null,c;(null==(c=this.outputConnection)?0:c.isConnected())&&(b=this.outputConnection.targetConnection,this.outputConnection.disconnect()),b&&a&&(a=this.getOnlyValueConnection())&&a.isConnected()&&!a.targetBlock().isShadow()&&(null==(a=a.targetConnection)||a.disconnect(),this.workspace.connectionChecker.canConnect(a,b,!1)?b.connect(a):null==a||a.onFailedConnect(b))}getOnlyValueConnection(){let a=null;for(let b=0;b<this.inputList.length;b++){let c=this.inputList[b].connection;if(c&&c.type===mU.INPUT_VALUE&&c.targetConnection){if(a)return null;a=c}}return a}unplugFromStack(a){let b=null,c;if((null==(c=this.previousConnection)?0:c.isConnected())&&(b=this.previousConnection.targetConnection,this.previousConnection.disconnect()),a){for(a=this.getNextBlock();a&&(a.isShadow()||!a.isMovable());)a=a.getNextBlock();if(a){var d,e,f,g;null==(a=null!=(g=null==(d=a.previousConnection)||null==(e=d.targetBlock())||null==(f=e.nextConnection)?void 0:f.targetConnection)?g:null)||a.disconnect(),b&&this.workspace.connectionChecker.canConnect(b,a,!1)&&b.connect(a)}}}getConnections_(a){a=[],this.outputConnection&&a.push(this.outputConnection),this.previousConnection&&a.push(this.previousConnection),this.nextConnection&&a.push(this.nextConnection);for(let b=0,c;c=this.inputList[b];b++)c.connection&&a.push(c.connection);return a}lastConnectionInStack(a){let b=this.nextConnection;for(;b;){let c=b.targetBlock();if(!c||a&&c.isShadow())return b;b=c.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(a){for(let b=0,c;c=this.inputList[b];b++)if(c.connection&&c.connection.targetBlock()===a)return c;return null}getSurroundParent(){let a=this,b;do if(b=a,!(a=a.getParent()))return null;while(a.getNextBlock()===b)return a}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let a,b=this;do b=(a=b).parentBlock_;while(b)return a}getTopStackBlock(){let a=this,b;do b=a.getPreviousBlock();while(b&&b.getNextBlock()===a&&(a=b))return a}getChildren(a){if(!a)return this.childBlocks_;a=[];for(let c=0,d;d=this.inputList[c];c++)if(d.connection){var b=d.connection.targetBlock();b&&a.push(b)}return(b=this.getNextBlock())&&a.push(b),a}setParent(a){if(a!==this.parentBlock_){var b=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),c=!!b;if(c&&a&&b!==a)throw Error("Block connected to superior one that is not new parent.");if(!c&&a)throw Error("Block not connected to new parent.");if(c&&!a)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?bs(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=a)?a.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(a){let b=[this],c=this.getChildren(a);for(let d,e=0;d=c[e];e++)b.push(...d.getDescendants(a));return b}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(a){this.deletable=a}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(a){this.movable=a}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(bo(this,!0))}isShadow(){return this.shadow}setShadow(a){this.shadow=a}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(a){this.isInsertionMarker_=a}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(a){for(let b of(this.editable=a,this.getFields()))b.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(let a of this.inputList)if(a.connection||a.fieldRow.length>1)return!1;return!0}getMatchingConnection(a,b){let c=this.getConnections_(!0);if(a=a.getConnections_(!0),c.length!==a.length)throw Error("Connection lists did not match in length.");for(let d=0;d<a.length;d++)if(a[d]===b)return c[d];return null}setHelpUrl(a){this.helpUrl=a}setTooltip(a){this.tooltip=a}getTooltip(){return du(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(a){a=dV(a),this.hue=a.hue,this.colour_=a.hex}setStyle(a){this.styleName_=a}setOnChange(a){if(a&&"function"!=typeof a)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=a,this.onchangeWrapper=a.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(a){if("string"!=typeof a)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===a?"nothing":a+" of type "+typeof a)+" instead");for(let b of this.getFields())if(b.name===a)return b;return null}*getFields(){for(let a of this.inputList)for(let b of a.fieldRow)yield b}getVars(){let a=[];for(let b of this.getFields())b.referencesVariables()&&a.push(b.getValue());return a}getVarModels(){let a=[];for(let b of this.getFields())if(b.referencesVariables()){let c=this.workspace.getVariableById(b.getValue());c&&a.push(c)}return a}updateVarName(a){for(let b of this.getFields())b.referencesVariables()&&a.getId()===b.getValue()&&b.refreshVariableName()}renameVarById(a,b){for(let c of this.getFields())c.referencesVariables()&&a===c.getValue()&&c.setValue(b)}getFieldValue(a){return(a=this.getField(a))?a.getValue():null}setFieldValue(a,b){let c=this.getField(b);if(!c)throw Error('Field "'+b+'" not found.');c.setValue(a)}setPreviousStatement(a,b){if(a)void 0===b&&(b=null),this.previousConnection||(this.previousConnection=this.makeConnection_(mU.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(b);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(a,b){if(a)void 0===b&&(b=null),this.nextConnection||(this.nextConnection=this.makeConnection_(mU.NEXT_STATEMENT)),this.nextConnection.setCheck(b);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(a,b){if(a)void 0===b&&(b=null),this.outputConnection||(this.outputConnection=this.makeConnection_(mU.OUTPUT_VALUE)),this.outputConnection.setCheck(b);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(a){this.inputsInline!==a&&(aP(new(aX(gB.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,a)),this.inputsInline=a)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var a=1;a<this.inputList.length;a++)if(this.inputList[a-1]instanceof kr&&this.inputList[a]instanceof kr)return!1;for(a=1;a<this.inputList.length;a++)if(this.inputList[a-1]instanceof B.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[a]instanceof kr)return!0;for(a=0;a<this.inputList.length;a++)if(this.inputList[a]instanceof ks)return!0;return!1}setOutputShape(a){this.outputShape_=a}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(a,b){a||this.workspace.options.disable||!this.hasDisabledReason(hW)||b==hW||this.setDisabledReason(!1,hW),this.disabledReasons.has(b)!==a&&(a?this.disabledReasons.add(b):this.disabledReasons.delete(b),(a=new(aX(gB.BLOCK_CHANGE))(this,"disabled",null,!a,a)).setDisabledReason(b),aP(a))}getInheritedDisabled(){let a=this.getSurroundParent();for(;a;){if(!a.isEnabled())return!0;a=a.getSurroundParent()}return!1}hasDisabledReason(a){return this.disabledReasons.has(a)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(a){this.collapsed_!==a&&(aP(new(aX(gB.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,a)),this.collapsed_=a)}toString(a,b){b=this.toTokens(b);for(let a=2;a<b.length;a++)"("===b[a-2]&&")"===b[a]&&(b[a-2]=b[a-1],b.splice(a-1,2));let c="";return b=(b=b.reduce((a,b)=>(a=a+("("===c||")"===b?"":" ")+b,c=b[b.length-1],a),"")).trim()||"???",a&&b.length>a&&(b=b.substring(0,a-3)+"..."),b}toTokens(a="?"){let b=[];for(let d of this.inputList)if(d.name!=hU){for(let a of d.fieldRow)b.push(a.getText());if(d.connection){let e=d.connection.targetBlock();if(e){var c=d.connection;let f=c.getCheck();!f&&c.targetConnection&&(f=c.targetConnection.getCheck()),(c=!!f&&(f.includes("Boolean")||f.includes("Number")))&&b.push("("),b.push(...e.toTokens(a)),c&&b.push(")")}else b.push(a)}}return b}appendValueInput(a){return this.appendInput(new B.ValueInput$$module$build$src$core$inputs$value_input(a,this))}appendStatementInput(a){return this.statementInputCount++,this.appendInput(new kt(a,this))}appendDummyInput(a=""){return this.appendInput(new kr(a,this))}appendEndRowInput(a=""){return this.appendInput(new ks(a,this))}appendInput(a){return this.inputList.push(a),a}appendInputFromRegistry(a,b){return(a=an(F.INPUT,a,!1))?this.appendInput(new a(b,this)):null}jsonInit(a){var b=a.type?'Block "'+a.type+'": ':"";if(a.output&&a.previousStatement)throw Error(b+"Must not have both an output and a previousStatement.");for(var c=0;a["args"+c];){if(void 0===a["message"+c])throw Error(b+`args${c} must have a corresponding message (message${c}).`);c++}if(a.style&&a.style.hat&&(this.hat=a.style.hat,a.style=null),a.style&&a.colour)throw Error(b+"Must not have both a colour and a style.");for(a.style?this.jsonInitStyle(a,b):this.jsonInitColour(a,b),c=0;void 0!==a["message"+c];)this.interpolate(a["message"+c],a["args"+c]||[],a["implicitAlign"+c]||a["lastDummyAlign"+c],b),c++;if(void 0!==a.inputsInline&&(B.disable$$module$build$src$core$events$utils(),this.setInputsInline(a.inputsInline),B.enable$$module$build$src$core$events$utils()),void 0!==a.output&&this.setOutput(!0,a.output),void 0!==a.outputShape&&this.setOutputShape(a.outputShape),void 0!==a.previousStatement&&this.setPreviousStatement(!0,a.previousStatement),void 0!==a.nextStatement&&this.setNextStatement(!0,a.nextStatement),void 0!==a.tooltip&&(c=dU(a.tooltip),this.setTooltip(c)),void 0!==a.enableContextMenu&&(this.contextMenu=!!a.enableContextMenu),void 0!==a.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!a.suppressPrefixSuffix),void 0!==a.helpUrl&&(c=dU(a.helpUrl),this.setHelpUrl(c)),"string"==typeof a.extensions&&(console.warn(b+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+a.type+"' block."),a.extensions=[a.extensions]),void 0!==a.mutator&&eG(a.mutator,this,!0),Array.isArray(a=a.extensions))for(b=0;b<a.length;b++)eG(a[b],this,!1)}jsonInitColour(a,b){if("colour"in a)if(void 0===a.colour)console.warn(b+"Undefined colour value.");else{a=a.colour;try{this.setColour(a)}catch(c){console.warn(b+"Illegal colour value: ",a)}}}jsonInitStyle(a,b){a=a.style;try{this.setStyle(a)}catch(c){console.warn(b+"Style does not exist: ",a)}}mixin(a,b){if(void 0!==b&&"boolean"!=typeof b)throw Error("opt_disableCheck must be a boolean if provided");if(!b){for(let c in b=[],a)void 0!==this[c]&&b.push(c);if(b.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(b))}Object.assign(this,a)}interpolate(a,b,c,d){a=dT(a),this.validateTokens(a,b.length),b=this.interpolateArguments(a,b,c),c=[];for(let e=0,f;f=b[e];e++)if(this.isInputKeyword(f.type)){if(a=this.inputFromJson(f,d)){for(let b=0,d;d=c[b];b++)a.appendField(d[0],d[1]);c.length=0}}else(a=this.fieldFromJson(f))&&c.push([a,f.name])}validateTokens(a,b){let c=[],d=0;for(let e=0;e<a.length;e++){let f=a[e];if("number"==typeof f){if(f<1||f>b)throw Error('Block "'+this.type+'": Message index %'+f+" out of range.");if(c[f])throw Error('Block "'+this.type+'": Message index %'+f+" duplicated.");c[f]=!0,d++}}if(d!==b)throw Error('Block "'+this.type+'": Message does not reference all '+b+" arg(s).")}interpolateArguments(a,b,c){let d=[];for(let f=0;f<a.length;f++){var e=a[f];if("number"==typeof e&&(e=b[e-1]),"string"==typeof e){if("\n"===e)e={type:"input_end_row"},c&&(e.align=c);else if(!(e=this.stringToFieldJson(e)))continue}d.push(e)}return(a=d.length)&&!this.isInputKeyword(d[a-1].type)&&(a={type:"input_dummy"},c&&(a.align=c),d.push(a)),d}fieldFromJson(a){let b=B.fromJson$$module$build$src$core$field_registry(a);return!b&&a.alt?"string"==typeof a.alt?(a=this.stringToFieldJson(a.alt))?this.fieldFromJson(a):null:this.fieldFromJson(a.alt):b}inputFromJson(a,b){let c;var d={LEFT:B.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:B.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:B.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:B.Align$$module$build$src$core$inputs$align.CENTRE};switch(a.type){case"input_value":c=this.appendValueInput(a.name);break;case"input_statement":c=this.appendStatementInput(a.name);break;case"input_dummy":c=this.appendDummyInput(a.name);break;case"input_end_row":c=this.appendEndRowInput(a.name);break;default:c=this.appendInputFromRegistry(a.type,a.name)}return c?(a.check&&c.setCheck(a.check),a.align&&(void 0===(d=d[a.align.toUpperCase()])?console.warn(b+"Illegal align value: ",a.align):c.setAlign(d)),c):null}isInputKeyword(a){return"input_value"===a||"input_statement"===a||"input_dummy"===a||"input_end_row"===a||am(F.INPUT,a)}stringToFieldJson(a){return(a=a.trim())?{type:"field_label",text:a}:null}moveInputBefore(a,b){if(a!==b){var c=-1,d=b?-1:this.inputList.length;for(let e=0,f;f=this.inputList[e];e++)if(f.name===a){if(c=e,-1!==d)break}else if(b&&f.name===b&&(d=e,-1!==c))break;if(-1===c)throw Error('Named input "'+a+'" not found.');if(-1===d)throw Error('Reference input "'+b+'" not found.');this.moveNumberedInputBefore(c,d)}}moveNumberedInputBefore(a,b){if(a===b)throw Error("Can't move input to itself.");if(a>=this.inputList.length)throw RangeError("Input index "+a+" out of bounds.");if(b>this.inputList.length)throw RangeError("Reference input "+b+" out of bounds.");let c=this.inputList[a];this.inputList.splice(a,1),a<b&&b--,this.inputList.splice(b,0,c)}removeInput(a,b){for(let b=0,c;c=this.inputList[b];b++)if(c.name===a)return c instanceof kt&&this.statementInputCount--,c.dispose(),this.inputList.splice(b,1),!0;if(b)return!1;throw Error("Input not found: "+a)}getInput(a){for(let b=0,c;c=this.inputList[b];b++)if(c.name===a)return c;return null}getInputTargetBlock(a){return(a=this.getInput(a))&&a.connection&&a.connection.targetBlock()}getCommentText(){let a,b;return null!=(b=null==(a=this.getIcon(ix.COMMENT))?void 0:a.getText())?b:null}setCommentText(a){var b,c;let d,e=null!=(d=null==(b=this.getIcon(ix.COMMENT))?void 0:b.getText())?d:null;if(e!==a){if(null!==a){if(!(b=this.getIcon(ix.COMMENT))){if(!(b=an(F.ICON,ix.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(!(eZ(c=b=new b(this))&&c_(c)&&b3(c)&&"function"==typeof c.setText&&"function"==typeof c.getText&&"function"==typeof c.setBubbleSize&&"function"==typeof c.getBubbleSize&&"function"==typeof c.setBubbleLocation&&"function"==typeof c.getBubbleLocation&&c.getType()===ix.COMMENT))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");b=this.addIcon(b)}B.disable$$module$build$src$core$events$utils(),b.setText(a),B.enable$$module$build$src$core$events$utils()}else this.removeIcon(ix.COMMENT);aP(new(aX(gB.BLOCK_CHANGE))(this,"comment",null,e,a))}}setWarningText(a,b){}setMutator(a){}addIcon(a){if(this.hasIcon(a.getType()))throw new kh(a);return this.icons.push(a),this.icons.sort((a,b)=>a.getWeight()-b.getWeight()),a}removeIcon(a){let b;return!!this.hasIcon(a)&&(null==(b=this.getIcon(a))||b.dispose(),this.icons=this.icons.filter(b=>!b.getType().equals(a)),!0)}hasIcon(a){return this.icons.some(b=>b.getType().equals(a))}getIcon(a){return a instanceof ix?this.icons.find(b=>b.getType().equals(a)):this.icons.find(b=>b.getType().toString()===a)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(a,b,c){if(this.parentBlock_)throw Error("Block has parent");let d=new(aX(gB.BLOCK_MOVE))(this);c&&d.setReason(c),this.xy.translate(a,b),d.recordNew(),aP(d)}makeConnection_(a){return new kg(this,a)}allInputsFilled(a){if(void 0===a&&(a=!0),!a&&this.isShadow())return!1;for(let c=0,d;d=this.inputList[c];c++)if(d.connection){var b=d.connection.targetBlock();if(!b||!b.allInputsFilled(a))return!1}return!(b=this.getNextBlock())||b.allInputsFilled(a)}toDevString(){let a=this.type?'"'+this.type+'" block':"Block";return this.id&&(a+=' (id="'+this.id+'")'),a}};ku.COLLAPSED_INPUT_NAME=hU,ku.COLLAPSED_FIELD_NAME=hV;var kv=null,kw=null,kx={};kx.connectionUiEffect=e0,kx.disconnectUiEffect=e1,kx.disconnectUiStop=e3,kx.disposeUiEffect=e$;var ky=class{paste(a,b,c){let d;if(!b.isCapacityAvailable(a.typeCounts))return null;c&&(a.blockState.x=c.x,a.blockState.y=c.y),c=c||new g9(a.blockState.x||0,a.blockState.y||0),B.disable$$module$build$src$core$events$utils();try{d=cN(a.blockState,b),e4(d,c)}finally{B.enable$$module$build$src$core$events$utils()}if(!d)return d;aU()&&!d.isShadow()&&aP(new(aX(gB.BLOCK_CREATE))(d));let e=d;return b5().then(()=>B.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)),d}};ky.TYPE="block",b$(ky.TYPE,new ky);var kz={};kz.BlockPaster=ky,kz.moveBlockToNotConflict=e4;var kA={};kA.bumpIntoBounds=e7,kA.bumpIntoBoundsHandler=e8,kA.bumpTopObjectsIntoBounds=fa;var kB=class{constructor(a){this.block=a,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new g9(0,0),this.originalEventGroup="",this.workspace=a.workspace}isMovable(){if(this.block.isShadow()){let a,b;return null!=(b=null==(a=this.block.getParent())?void 0:a.isMovable())&&b}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(a){if(this.block.isShadow())this.startDraggingShadow(a);else{var b;this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(aq(F.CONNECTION_PREVIEWER,this.workspace.options))(this.block),a5(),this.workspace.setResizesEnabled(!1),e3(),a=this.shouldHealStack(a),this.shouldDisconnect(a)&&this.disconnectBlock(a),this.block.setDragging(!0),null==(b=this.workspace.getLayerManager())||b.moveToDragLayer(this.block)}}shouldHealStack(a){return!!a&&(a.altKey||a.ctrlKey||a.metaKey)}startDraggingShadow(a){let b=this.block.getParent();if(!b)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=g9.difference(b.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),b.startDrag(a)}shouldDisconnect(a){return!!(this.block.getParent()||a&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(a){let b,c,d;if(this.startParentConn=null!=(d=null==(b=this.block.outputConnection)?void 0:b.targetConnection)?d:null==(c=this.block.previousConnection)?void 0:c.targetConnection,a){let a;this.startChildConn=null==(a=this.block.nextConnection)?void 0:a.targetConnection}this.block.unplug(a),e1(this.block)}fireDragStartEvent(){aP(new(aX(gB.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1)))}fireDragEndEvent(){aP(new(aX(gB.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1)))}fireMoveEvent(){if(!this.block.isDeadOrDying()){var a=new(aX(gB.BLOCK_MOVE))(this.block);a.setReason(["drag"]),a.oldCoordinate=this.startLoc,a.recordNew(),aP(a)}}drag(a){if(this.block.isShadow()){let b;null==(b=this.block.getParent())||b.drag(g9.sum(a,this.dragOffset))}else this.block.moveDuringDrag(a),this.updateConnectionPreview(this.block,g9.difference(a,this.startLoc))}updateConnectionPreview(a,b){var c=this.connectionCandidate;let d=this.getConnectionCandidate(a,b);if(d){this.connectionCandidate=b=c&&this.currCandidateIsBetter(c,b,d)?c:d;var e,f,{local:g,neighbour:h}=b;if(b=g.type===mU.OUTPUT_VALUE||g.type===mU.PREVIOUS_STATEMENT,c=h.isConnected()&&!(null==(e=h.targetBlock())?0:e.isInsertionMarker()),b&&c&&!this.orphanCanConnectAtEnd(a,h.targetBlock(),g.type)){let a;null==(a=this.connectionPreviewer)||a.previewReplacement(g,h,h.targetBlock())}else null==(f=this.connectionPreviewer)||f.previewConnection(g,h)}else{let a;null==(a=this.connectionPreviewer)||a.hidePreview(),this.connectionCandidate=null}}orphanCanConnectAtEnd(a,b,c){return!!kg.getConnectionForOrphanedConnection(a,c===mU.OUTPUT_VALUE?b.outputConnection:b.previousConnection)}currCandidateIsBetter(a,b,c){let{local:d,neighbour:e}=a;a=new g9(d.x,d.y);let f=new g9(e.x,e.y);return b=g9.distance(g9.sum(a,b),f),c.distance>b-B.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(a,b){a=this.getLocalConnections(a);let c=this.getSearchRadius(),d=null;for(let e of a){let{connection:a,radius:f}=e.closest(c,b);a&&(d={local:e,neighbour:a,distance:f},c=f)}return d}getSearchRadius(){return this.connectionCandidate?B.config$$module$build$src$core$config.connectingSnapRadius:B.config$$module$build$src$core$config.snapRadius}getLocalConnections(a){let b=a.getConnections_(!1),c=a.lastConnectionInStack(!0);return c&&c!==a.nextConnection&&b.push(c),b}endDrag(a){if(this.block.isShadow()){let b;null==(b=this.block.getParent())||b.endDrag(a)}else{var b;if(this.originalEventGroup=B.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),a6(),e3(),null==(b=this.connectionPreviewer)||b.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let a;null==(a=this.workspace.getLayerManager())||a.moveOffDragLayer(this.block,50),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep())}}disposeStep(){let a,b=B.getGroup$$module$build$src$core$events$utils();B.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null==(a=this.connectionPreviewer)||a.dispose(),this.workspace.setResizesEnabled(!0),B.setGroup$$module$build$src$core$events$utils(b)}applyConnections(a){let{local:b,neighbour:c}=a;b.connect(c);let d=b.isSuperior()?c:b,e=this.block.getRootBlock();b5().then(()=>{e0(d.getSourceBlock()),setTimeout(()=>{e.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let a;null==(a=this.block.getParent())||a.revertDrag()}else{var a,b;if(null==(a=this.connectionPreviewer)||a.hidePreview(),this.connectionCandidate=null,null==(b=this.startChildConn)||b.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case mU.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case mU.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{let a;this.block.moveTo(this.startLoc,["drag"]),null==(a=this.workspace.getLayerManager())||a.moveOffDragLayer(this.block,50),e7(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}},kC=class extends j5{constructor(a,b,c,d){super(b,c,d),this.text=a,this.workspace=b,this.anchor=c,this.ownerRect=d,this.paragraph=this.stringToSvg(a,this.contentContainer),this.updateBubbleSize(),a$(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(a){this.text=a,a2(this.paragraph),this.paragraph=this.stringToSvg(a,this.contentContainer),this.updateBubbleSize()}stringToSvg(a,b){return b=this.createParagraph(b),a=this.createTextFragments(b,a),this.workspace.RTL&&this.rightAlignTextFragments(b.getBBox().width,a),b}createParagraph(a){return aZ(ha.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${j5.BORDER_WIDTH})`,style:`direction: ${this.workspace.RTL?"rtl":"ltr"}`},a)}createTextFragments(a,b){let c=1;return b.split("\n").map(b=>{let d=aZ(ha.TEXT,{y:`${c}em`,x:j5.BORDER_WIDTH},a);return b=document.createTextNode(b),d.appendChild(b),c+=1,d})}rightAlignTextFragments(a,b){for(let c of b)c.setAttribute("text-anchor","start"),c.setAttribute("x",`${a+j5.BORDER_WIDTH}`)}updateBubbleSize(){let a=this.paragraph.getBBox();this.setSize(new hc(a.width+2*j5.BORDER_WIDTH,a.height+2*j5.BORDER_WIDTH),!0)}},kD=class extends j7{constructor(a){super(a),this.sourceBlock=a,this.textMap=new Map,this.textBubble=null}getType(){return kD.TYPE}initView(a){this.svgRoot||(super.initView(a),aZ(ha.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),aZ(ha.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),aZ(ha.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),a$(this.svgRoot,"blocklyWarningIcon"))}dispose(){let a;super.dispose(),null==(a=this.textBubble)||a.dispose()}getWeight(){return kD.WEIGHT}getSize(){return new hc(17,17)}applyColour(){let a;super.applyColour(),null==(a=this.textBubble)||a.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(a){let b;super.onLocationChange(a),null==(b=this.textBubble)||b.setAnchorLocation(this.getAnchorLocation())}addMessage(a,b){let c;return this.textMap.get(b)===a||(a?this.textMap.set(b,a):this.textMap.delete(b),null==(c=this.textBubble)||c.setText(this.getText())),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(a){let b=this;return(0,gr.asyncExecutePromiseGeneratorFunction)(function*(){if(b.bubbleIsVisible()!==a){if(yield b5(),a)b.textBubble=new kC(b.getText(),b.sourceBlock.workspace,b.getAnchorLocation(),b.getBubbleOwnerRect()),b.applyColour();else{let a;null==(a=b.textBubble)||a.dispose(),b.textBubble=null}aP(new(aX(gB.BUBBLE_OPEN))(b.sourceBlock,a,"warning"))}})}getBubble(){return this.textBubble}getAnchorLocation(){return g9.sum(this.workspaceLocation,new g9(8.5,8.5))}getBubbleOwnerRect(){let a=this.sourceBlock.getSvgRoot().getBBox();return new hb(a.y,a.y+a.height,a.x,a.x+a.width)}};kD.TYPE=ix.WARNING,kD.WEIGHT=2;var kE=class extends ku{constructor(a,b,c){if(super(a,b,c),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new g9(0,0),this.dragStrategy=new kB(this),!a.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=a,this.svgGroup=aZ(ha.G,{}),b&&a$(this.svgGroup,b),this.style=a.getRenderer().getConstants().getBlockStyle(null),this.pathObject=a.getRenderer().makePathObject(this.svgGroup,this.style),(a=this.pathObject.svgPath).tooltip=this,dx(a),this.svgGroup.setAttribute("data-id",this.id),a.id=aE(),this.doInit_()}initSvg(){if(!this.initialized){for(var a of this.inputList)a.init();for(let a of this.getIcons())a.initView(this.createIconPointerDownListener(a)),a.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(a=this.getSvgRoot())&&ax(a,"pointerdown",this,this.onMouseDown),a.parentNode||this.workspace.getCanvas().appendChild(a),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),bk(this)}unselect(){this.removeSelect(),bk(null)}setParent(a){var b=this.parentBlock_;if(a!==b){a5(),super.setParent(a),a6();var c=this.getSvgRoot();if(!this.workspace.isClearing&&c){var d,e=this.getRelativeToSurfaceXY(),f=B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),g=this.getSvgRoot().contains(null!=(d=null==f?void 0:f.getFocusableElement())?d:null);a?(a.getSvgRoot().appendChild(c),g&&f&&B.getFocusManager$$module$build$src$core$focus_manager().focusNode(f)):b&&((b=null==(a=this.workspace.getCanvas().querySelector(".blocklyDragging"))?void 0:a.parentElement)===(d=this.workspace.getCanvas())?d.insertBefore(c,a):(d.appendChild(c),g&&f&&B.getFocusManager$$module$build$src$core$focus_manager().focusNode(f)),this.translate(e.x,e.y)),this.applyColour()}}}getRelativeToSurfaceXY(){let a=this.workspace.getLayerManager();if(!a)throw Error("Cannot calculate position because the workspace has not been appended");let b=0,c=0,d=this.getSvgRoot();if(d)do{let a=bD(d);b+=a.x,c+=a.y,d=d.parentNode}while(d&&!a.hasLayer(d))return new g9(b,c)}moveBy(a,b,c){if(this.parentBlock_)throw Error("Block has parent");let d=aU(),e=null;d&&(e=new(aX(gB.BLOCK_MOVE))(this),c&&e.setReason(c)),a=new g9(a,b),b=this.getRelativeToSurfaceXY(),a=g9.sum(b,a),this.translate(a.x,a.y),this.updateComponentLocations(a),d&&e&&(e.recordNew(),aP(e)),this.workspace.resizeContents()}translate(a,b){this.translation=`translate(${a}, ${b})`,this.relativeCoords=new g9(a,b),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(a,b){let c=this.getRelativeToSurfaceXY();this.moveBy(a.x-c.x,a.y-c.y,b)}moveDuringDrag(a){this.translate(a.x,a.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(a)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var a=this.workspace.getGrid();if(null!=a&&a.shouldSnap()){var b=this.getRelativeToSurfaceXY();(a=a.alignXY(b))!==b&&this.moveTo(a,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(a){let b,c,d=this.getRelativeToSurfaceXY();return this.RTL?(b=d.x-a.width,c=d.x):(b=d.x,c=d.x+a.width),new hb(d.y,d.y+a.height,b,c)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let a=0,b;b=this.inputList[a];a++)b.markDirty()}setCollapsed(a){this.collapsed_!==a&&(super.setCollapsed(a),this.updateCollapsed())}childHasWarning(){for(let a of this.getChildren(!1))if(a.getIcon(kD.TYPE)||a.childHasWarning())return!0;return!1}updateCollapsed(){var a=this.isCollapsed();for(let b=0,c;c=this.inputList[b];b++)c.name!==hU&&c.setVisible(!a);for(var b of this.getIcons())b.updateCollapsed();a?(a$(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(B.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,kE.COLLAPSED_WARNING_ID),a=this.toString(30),(b=this.getField(hV))?b.setValue(a):(this.getInput(hU)||this.appendDummyInput(hU)).appendField(new kj(a),hV)):(this.updateDisabled(),this.removeInput(hU),a0(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,kE.COLLAPSED_WARNING_ID))}onMouseDown(a){if(!this.workspace.isReadOnly()){var b=this.workspace.getGesture(a);b&&b.handleBlockStart(a,this)}}showHelp(){let a="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;a&&window.open(a)}generateContextMenu(a){return this.workspace.isReadOnly()||!this.contextMenu?null:(a=jC.registry.getContextMenuOptions({block:this,focusedNode:this},a),this.customContextMenu&&this.customContextMenu(a),a)}calculateContextMenuLocation(a){let b,c;if(a instanceof PointerEvent)return new g9(a.clientX,a.clientY);a=bI(this.workspace,this.getRelativeToSurfaceXY());let d=null==(b=this.inputList.filter(a=>a.isVisible()).flatMap(a=>a.fieldRow).find(a=>a.isVisible()))||null==(c=b.getSvgRoot())?void 0:c.getBoundingClientRect();return new g9(this.RTL?a.x-5:a.x+5,(d&&d.height?d.y+d.height:a.y+this.height)+5)}showContextMenu(a){let b=this.generateContextMenu(a),c=this.calculateContextMenuLocation(a);b&&b.length&&(d7(a,b,this.RTL,this.workspace,c),d6(this))}updateComponentLocations(a){for(let b of(this.dragging||this.updateConnectionLocations(a),this.updateIconLocations(a),this.updateFieldLocations(a),this.getChildren(!1)))b.updateComponentLocations(g9.sum(a,b.relativeCoords))}updateConnectionLocations(a){for(let b of this.getConnections_(!1))b.moveToOffset(a)}updateIconLocations(a){for(let b of this.getIcons())b.onLocationChange(a)}updateFieldLocations(a){for(let b of this.inputList)for(let c of b.fieldRow)c.onLocationChange(a)}addClass(a){a$(this.svgGroup,a)}removeClass(a){a0(this.svgGroup,a)}setDragging(a){(this.dragging=a)?(this.translation="",gV.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(gV.length=0,this.removeClass("blocklyDragging"));for(let b=0;b<this.childBlocks_.length;b++)this.childBlocks_[b].setDragging(a)}setMovable(a){super.setMovable(a),this.pathObject.updateMovable(a)}setEditable(a){super.setEditable(a),a?a0(this.svgGroup,"blocklyNotEditable"):a$(this.svgGroup,"blocklyNotEditable"),a=this.getIcons();for(let b=0;b<a.length;b++)a[b].updateEditable()}setShadow(a){super.setShadow(a),this.applyColour()}setInsertionMarker(a){this.isInsertionMarker_!==a&&(this.isInsertionMarker_=a)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(a,b){var c,d;this.disposing=!0,dC(),ec();let e=B.getFocusManager$$module$build$src$core$focus_manager();if(this.getSvgRoot().contains(null!=(d=null==(c=e.getFocusedNode())?void 0:c.getFocusableElement())?d:null)){if(!(c=this.getParent())){let a;if(d=null!=(a=this.outputConnection)?a:this.previousConnection){let a;c=null==(a=d.closest(0,new g9(0,0)).connection)?void 0:a.getSourceBlock()}}c?e.focusNode(c):setTimeout(()=>e.focusTree(this.workspace),0)}b&&(this.unplug(a),e$(this)),super.dispose(!!a),a2(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(a=>clearTimeout(a)),this.warningTextDb.clear(),this.getIcons().forEach(a=>a.dispose())}checkAndDelete(){this.workspace.isFlyout||(B.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),B.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(a=!1){return this.isInsertionMarker_?null:{paster:ky.TYPE,blockState:cE(this,{addCoordinates:!0,addNextBlocks:a,saveIds:!1}),typeCounts:bo(this,!0)}}applyColour(){var a,b;for(null==(b=(a=this.pathObject).applyColour)||b.call(a,this),a=this.getIcons(),b=0;b<a.length;b++)a[b].applyColour();for(let a of this.getFields())a.applyColour()}updateDisabled(){let a=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===a){let a;null==(a=this.getNextBlock())||a.updateDisabled()}else for(let b of(this.applyColour(),this.visuallyDisabled=a,this.getChildren(!1)))b.updateDisabled()}setWarningText(a,b=""){if(b)this.warningTextDb.has(b)&&(clearTimeout(this.warningTextDb.get(b)),this.warningTextDb.delete(b));else{for(var c of this.warningTextDb.values())clearTimeout(c);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(b,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(b),this.setWarningText(a,b))},100));else if(this.isInFlyout&&(a=null),c=this.getIcon(kD.TYPE),a){let d=this.getSurroundParent(),e=null;for(;d;)d.isCollapsed()&&(e=d),d=d.getSurroundParent();e&&e.setWarningText(B.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,kE.COLLAPSED_WARNING_ID),c?c.addMessage(a,b):this.addIcon(new kD(this).addMessage(a,b))}else c&&(b?(c.addMessage("",b),c.getText()||this.removeIcon(kD.TYPE)):this.removeIcon(kD.TYPE))}setMutator(a){this.removeIcon(B.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),a&&this.addIcon(a)}addIcon(a){return super.addIcon(a),a instanceof B.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=a),a.initView(this.createIconPointerDownListener(a)),a.applyColour(),a.updateEditable(),this.queueRender(),a}createIconPointerDownListener(a){return b=>{this.isDeadOrDying()||(b=this.workspace.getGesture(b))&&b.setStartIcon(a)}}removeIcon(a){let b=super.removeIcon(a);return a.equals(B.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),b}setDisabledReason(a,b){let c=this.isEnabled();super.setDisabledReason(a,b),this.isEnabled()===c||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(a){super.setDeletable(a),a?a0(this.svgGroup,"blocklyNotDeletable"):a$(this.svgGroup,"blocklyNotDeletable")}setHighlighted(a){this.pathObject.updateHighlighted(a)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(a){this.pathObject.updateDraggingDelete(a)}getColour(){return this.style.colourPrimary}setColour(a){let b,c;super.setColour(a),a=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null==(c=(b=this.pathObject).setStyle)||c.call(b,a.style),this.style=a.style,this.styleName_=a.name,this.applyColour()}setStyle(a){let b=this.workspace.getRenderer().getConstants().getBlockStyle(a);if(this.styleName_&&a0(this.svgGroup,this.styleName_),b){let c,d;this.hat=b.hat,null==(d=(c=this.pathObject).setStyle)||d.call(c,b),this.colour_=b.colourPrimary,this.style=b,this.applyColour(),a$(this.svgGroup,a),this.styleName_=a}else throw Error("Invalid style name: "+a)}getStyle(){return this.style}bringToFront(a=!1){let b=B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),c=this;if(!c.isDeadOrDying()){do{let b=c.getSvgRoot(),d=b.parentNode,e=d.childNodes;if(e[e.length-1]!==b&&d.appendChild(b),a)break;c=c.getParent()}while(c)b&&B.getFocusManager$$module$build$src$core$focus_manager().focusNode(b)}}setPreviousStatement(a,b){super.setPreviousStatement(a,b),this.queueRender()}setNextStatement(a,b){super.setNextStatement(a,b),this.queueRender()}setOutput(a,b){super.setOutput(a,b),this.queueRender()}setInputsInline(a){super.setInputsInline(a),this.queueRender()}removeInput(a,b){return a=super.removeInput(a,b),this.queueRender(),a}moveNumberedInputBefore(a,b){super.moveNumberedInputBefore(a,b),this.queueRender()}appendInput(a){return super.appendInput(a),this.queueRender(),a}setConnectionTracking(a){if(this.previousConnection&&this.previousConnection.setTracking(a),this.outputConnection&&this.outputConnection.setTracking(a),this.nextConnection){this.nextConnection.setTracking(a);var b=this.nextConnection.targetBlock();b&&b.setConnectionTracking(a)}if(!this.collapsed_)for(b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;c&&(c.setTracking(a),(c=c.targetBlock())&&c.setConnectionTracking(a))}}getConnections_(a){let b=[];if(this.outputConnection&&b.push(this.outputConnection),this.previousConnection&&b.push(this.previousConnection),this.nextConnection&&b.push(this.nextConnection),a||!this.collapsed_)for(let a=0,c;c=this.inputList[a];a++)c.connection&&b.push(c.connection);return b}lastConnectionInStack(a){return super.lastConnectionInStack(a)}getMatchingConnection(a,b){return super.getMatchingConnection(a,b)}makeConnection_(a){return new kn(this,a)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){let a=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||a.isInFlyout))for(let b of this.getConnections_(!1)){if(b.isSuperior()){let a;null==(a=b.targetBlock())||a.bumpNeighbours()}for(let c of b.neighbours(B.config$$module$build$src$core$config.snapRadius))c.getSourceBlock().getRootBlock()!==a&&(b.isConnected()&&c.isConnected()||(b.isSuperior()?c.bumpAwayFrom(b,!1):b.bumpAwayFrom(c,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(a,b,c){if(a.type===mU.NEXT_STATEMENT||a.type===mU.INPUT_VALUE){let d=b.x;b=b.y,d+=c.x-a.getOffsetInBlock().x,b+=c.y-a.getOffsetInBlock().y,this.moveBy(d,b)}}getChildren(a){return super.getChildren(a)}queueRender(){return b4(this)}render(){this.queueRender(),b6()}renderEfficiently(){a5(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),a6()}tightenChildrenEfficiently(){for(let a of this.inputList){let b=a.connection;b&&b.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let a=this.height,b=this.width;var c=this.getNextBlock();if(c){c=c.getHeightWidth();let d=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;a+=c.height-d,b=Math.max(b,c.width)}return{height:a,width:b}}fadeForReplacement(a){this.pathObject.updateReplacementFade(a)}highlightShapeForInput(a,b){this.pathObject.updateShapeForInputHighlight(a,b)}getDragStrategy(){return this.dragStrategy}setDragStrategy(a){this.dragStrategy=a}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(a){this.dragStrategy.startDrag(a)}drag(a,b){this.dragStrategy.drag(a,b)}endDrag(a){this.dragStrategy.endDrag(a)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){let a=Object.assign({},{kind:"BLOCK"},cE(this)),b=new Set(["id","height","width","pinned","enabled"]),c=function(a){for(let d in a)b.has(d)?delete a[d]:"object"==typeof a[d]&&c(a[d])};return c(a),[a]}jsonInit(a){super.jsonInit(a),a.classes&&this.addClass(Array.isArray(a.classes)?a.classes.join(" "):a.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.workspace.scrollBoundsIntoView(this.getBoundingRectangleWithoutChildren())}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};kE.INLINE=-1,kE.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var kF=class{onDragEnter(a){}onDragOver(a){}onDragExit(a){}onDrop(a){}getClientRect(){return null}shouldPreventMove(a){return!1}},kG=class extends kF{constructor(){super(),this.wouldDelete_=!1}wouldDelete(a){return a instanceof kE?(a=!a.getParent()&&a.isDeletable(),this.updateWouldDelete_(a)):this.updateWouldDelete_(fb(a)&&a.isDeletable()),this.wouldDelete_}updateWouldDelete_(a){this.wouldDelete_=a}},kH=class{constructor(a,b){this.element=a,this.type=b}getElement(){return this.element}getType(){return this.type}},kI=class{constructor(a){this.workspace_=a}getDimensionsPx_(a){let b=0,c=0;return a&&(b=a.getWidth(),c=a.getHeight()),new hc(b,c)}getFlyoutMetrics(a){return{width:(a=this.getDimensionsPx_(this.workspace_.getFlyout(a))).width,height:a.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){let a=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:a.width,height:a.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){var a;let b=0,c=0,d=this.getToolboxMetrics(),e=this.getFlyoutMetrics(),f=!!this.workspace_.getToolbox(),g=!(null==(a=this.workspace_.getFlyout())?0:a.autoClose),h=(a=f?d.position:e.position)===ht.TOP;return a===ht.LEFT&&(f&&(b+=d.width),g&&(b+=e.width)),h&&(f&&(c+=d.height),g&&(c+=e.height)),{top:c,left:b}}getViewMetrics(a){var b;a=a?this.workspace_.scale:1;let c=this.getSvgMetrics(),d=this.getToolboxMetrics(),e=this.getFlyoutMetrics(),f=!!this.workspace_.getToolbox(),g=!(null==(b=this.workspace_.getFlyout())?0:b.autoClose),h=(b=f?d.position:e.position)===ht.LEFT||b===ht.RIGHT;return(b===ht.TOP||b===ht.BOTTOM)&&(f&&(c.height-=d.height),g&&(c.height-=e.height)),h&&(f&&(c.width-=d.width),g&&(c.width-=e.width)),{height:c.height/a,width:c.width/a,top:-this.workspace_.scrollY/a,left:-this.workspace_.scrollX/a}}getContentMetrics(a){a=a?1:this.workspace_.scale;let b=this.workspace_.getBlocksBoundingBox();return{height:(b.bottom-b.top)*a,width:(b.right-b.left)*a,top:b.top*a,left:b.left*a}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(a){if(!this.hasFixedEdges())return{};let b=this.workspace_.isMovableHorizontally(),c=this.workspace_.isMovableVertically();a=a||this.getViewMetrics(!1);let d={};return c||(d.top=a.top,d.bottom=a.top+a.height),b||(d.left=a.left,d.right=a.left+a.width),d}getPaddedContent_(a,b){let c=b.top+b.height,d=b.left+b.width,e=a.width;a=a.height;let f=e/2,g=a/2;return{top:Math.min(b.top-g,c-a),bottom:Math.max(c+g,b.top+a),left:Math.min(b.left-f,d-e),right:Math.max(d+f,b.left+e)}}getScrollMetrics(a,b,c){a=a?this.workspace_.scale:1,b=b||this.getViewMetrics(!1);var d=c||this.getContentMetrics();c=this.getComputedFixedEdges_(b),b=this.getPaddedContent_(b,d),d=void 0!==c.top?c.top:b.top;let e=void 0!==c.left?c.left:b.left;return{top:d/a,left:e/a,width:((void 0!==c.right?c.right:b.right)-e)/a,height:((void 0!==c.bottom?c.bottom:b.bottom)-d)/a}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){let a=this.getToolboxMetrics(),b=this.getFlyoutMetrics(!0),c=this.getSvgMetrics(),d=this.getAbsoluteMetrics(),e=this.getViewMetrics(),f=this.getContentMetrics(),g=this.getScrollMetrics(!1,e,f);return{contentHeight:f.height,contentWidth:f.width,contentTop:f.top,contentLeft:f.left,scrollHeight:g.height,scrollWidth:g.width,scrollTop:g.top,scrollLeft:g.left,viewHeight:e.height,viewWidth:e.width,viewTop:e.top,viewLeft:e.left,absoluteTop:d.top,absoluteLeft:d.left,svgHeight:c.height,svgWidth:c.width,toolboxWidth:a.width,toolboxHeight:a.height,toolboxPosition:a.position,flyoutWidth:b.width,flyoutHeight:b.height}}};ai(F.METRICS_MANAGER,E,kI);var kJ=class extends kI{constructor(a,b){super(a),this.flyout_=b}getBoundingBox(){let a;try{a=this.workspace_.getCanvas().getBBox()}catch(b){a={height:0,y:0,width:0,x:0}}return a}getContentMetrics(a){let b=this.getBoundingBox();return a=a?1:this.workspace_.scale,{height:b.height*a,width:b.width*a,top:b.y*a,left:b.x*a}}getScrollMetrics(a,b,c){return b=c||this.getContentMetrics(),c=this.flyout_.MARGIN*this.workspace_.scale,a=a?this.workspace_.scale:1,{height:(b.height+2*c)/a,width:(b.width+b.left+c)/a,top:0,left:0}}},kK=class{constructor(a,b,c,d){let e;this.workspace=a,this.targetWorkspace=b,this.isFlyoutLabel=d,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=c.text,this.position=new g9(0,0),this.callbackKey=c.callbackKey||c.callbackkey,this.cssClass=c["web-class"]||null,this.info=c,a=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(a+=" "+this.cssClass),this.id=aE(),this.svgGroup=aZ(ha.G,{id:this.id,class:a},this.workspace.getCanvas()),this.isFlyoutLabel||(e=aZ(ha.RECT,{class:"blocklyFlyoutButtonShadow",rx:kK.BORDER_RADIUS,ry:kK.BORDER_RADIUS,x:1,y:1},this.svgGroup)),a=aZ(ha.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:kK.BORDER_RADIUS,ry:kK.BORDER_RADIUS},this.svgGroup),b=aZ(ha.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),c=dU(this.text),this.workspace.RTL&&(c+=""),b.textContent=c,this.isFlyoutLabel&&(this.svgText=b,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),d=bx(b,"fontSize");const f=bx(b,"fontWeight"),g=bx(b,"fontFamily");if(this.width=a8(b,d,f,g),c=a9(c,d,f,g),this.height=this.height||c.height,!this.isFlyoutLabel){let a,b;this.width+=2*kK.TEXT_MARGIN_X,this.height+=2*kK.TEXT_MARGIN_Y,null==(a=e)||a.setAttribute("width",String(this.width)),null==(b=e)||b.setAttribute("height",String(this.height))}a.setAttribute("width",String(this.width)),a.setAttribute("height",String(this.height)),b.setAttribute("x",String(this.width/2)),b.setAttribute("y",String(this.height/2-c.height/2+c.baseline)),this.updateTransform(),this.onMouseDownWrapper=ax(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=ax(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(a,b){this.position.x=a,this.position.y=b,this.updateTransform()}moveBy(a,b,c){this.moveTo(this.position.x+a,this.position.y+b)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new hb(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){az(this.onMouseDownWrapper),az(this.onMouseUpWrapper),this.svgGroup&&a2(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(a){a?this.svgGroup&&(this.svgGroup.appendChild(a),this.cursorSvg=a):this.cursorSvg=null}onMouseUp(a){(a=this.targetWorkspace.getGesture(a))&&a.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(a=this.targetWorkspace.getButtonCallback(this.callbackKey))&&a(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(a){let b=this.targetWorkspace.getGesture(a),c=this.targetWorkspace.getFlyout();b&&c&&b.handleFlyoutStart(a,c)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){var a=this.getPosition();a=new hb(a.y,a.y+this.height,a.x,a.x+this.width),this.workspace.scrollBoundsIntoView(a)}onNodeBlur(){}canBeFocused(){return!0}};kK.TEXT_MARGIN_X=5,kK.TEXT_MARGIN_Y=2,kK.BORDER_RADIUS=4,bt("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var kL=class{getFirstChild(a){return null}getParent(a){return a.getWorkspace()}getNextSibling(a){return null}getPreviousSibling(a){return null}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof kK}},kM=class{constructor(a,b){this.policy=a,this.flyout=b}getFirstChild(a){return null}getParent(a){return this.policy.getParent(a)}getNextSibling(a){let b=this.flyout.getContents();if(!b)return null;let c=b.findIndex(b=>b.getElement()===a);return -1===c?null:(++c>=b.length&&(c=0),b[c].getElement())}getPreviousSibling(a){let b=this.flyout.getContents();if(!b)return null;let c=b.findIndex(b=>b.getElement()===a);return -1===c?null:(--c<0&&(c=b.length-1),b[c].getElement())}isNavigable(a){return this.policy.isNavigable(a)}isApplicable(a){return this.policy.isApplicable(a)}},kN=class{constructor(a,b){this.gap=a,this.axis=b,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new hb(this.y,this.y,this.x,this.x+this.gap);case"y":return new hb(this.y,this.y+this.gap,this.x,this.x)}}moveBy(a,b,c){this.x+=a,this.y+=b}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},kO=class{getFirstChild(a){return null}getParent(a){return null}getNextSibling(a){return null}getPreviousSibling(a){return null}isNavigable(a){return!1}isApplicable(a){return a instanceof kN}},kP=class{getFirstChild(a){return a.getEditor()}getParent(a){let b;return null!=(b=a.getOwner())?b:null}getNextSibling(a){return null}getPreviousSibling(a){return null}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof kc}},kQ=class{getFirstChild(a){return fc(a,!0)[0]}getParent(a){var b;if(null==(b=a.previousConnection)?0:b.targetBlock()){if(b=a.getSurroundParent())return b}else{let b;if(null==(b=a.outputConnection)?0:b.targetBlock())return a.outputConnection.targetBlock()}return a.workspace}getNextSibling(a){let b,c;if(null==(b=a.nextConnection)?0:b.targetBlock()){let b;return null==(b=a.nextConnection)?void 0:b.targetBlock()}return(null==(c=a.outputConnection)?0:c.targetBlock())?fe(a,1):a.getSurroundParent()?fe(a.getTopStackBlock(),1):this.getParent(a)instanceof lP?fd(a,1):null}getPreviousSibling(a){let b,c;if(null==(b=a.previousConnection)?0:b.targetBlock()){let b;return null==(b=a.previousConnection)?void 0:b.targetBlock()}return(null==(c=a.outputConnection)?0:c.targetBlock())?fe(a,-1):this.getParent(a)instanceof lP?fd(a,-1):null}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof kE}},kR={};kR.BlockNavigationPolicy=kQ,kR.navigateBlock=fe,kR.navigateStacks=fd;var kS=class{getFirstChild(a){return null}getParent(a){return a.getCommentView().workspace.getCommentById(a.getCommentView().commentId)}getNextSibling(a){let b=a.getCommentView().getCommentBarButtons();return(a=b.indexOf(a))>=0&&a+1<b.length?b[a+1]:null}getPreviousSibling(a){let b=a.getCommentView().getCommentBarButtons();return(a=b.indexOf(a))>0?b[a-1]:null}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof jI}},kT=class{getFirstChild(a){return null}getParent(a){return null}getNextSibling(a){return null}getPreviousSibling(a){return null}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof jM}},kU=class{getFirstChild(a){return a.getParentInput()?a.targetConnection:null}getParent(a){return a.getSourceBlock()}getNextSibling(a){if(a.getParentInput())return fe(a,1);if(a.type===mU.NEXT_STATEMENT){let c=a.targetConnection;var b=a.getSourceBlock();if(!c&&b.getRootBlock().lastConnectionInStack(!1)===a){let c;return(b=(a=b.workspace.getTopBlocks(!0)).indexOf(b.getRootBlock())+1)>=a.length&&(b=0),b=a[b],null!=(c=this.getParentConnection(b))?c:b}return c}return a.getSourceBlock()}getPreviousSibling(a){if(a.getParentInput())return fe(a,-1);if(a.type===mU.PREVIOUS_STATEMENT||a.type===mU.OUTPUT_VALUE){let c=a.targetConnection&&!a.targetConnection.getParentInput()?a.targetConnection:null;var b=a.getSourceBlock();if(!c&&this.getParentConnection(b.getRootBlock())===a){let c;return(b=(a=b.workspace.getTopBlocks(!0)).indexOf(b.getRootBlock())-1)<0&&(b=a.length-1),null!=(c=(b=a[b]).lastConnectionInStack(!1))?c:b}return c}return a.type===mU.NEXT_STATEMENT?a.getSourceBlock():null}getParentConnection(a){let b;return!a.outputConnection||(null==(b=a.previousConnection)?0:b.isConnected())?a.previousConnection:a.outputConnection}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof kn}},kV=class{getFirstChild(a){return null}getParent(a){return a.getSourceBlock()}getNextSibling(a){return fe(a,1)}getPreviousSibling(a){return fe(a,-1)}isNavigable(a){let b;return a.canBeFocused()&&a.isVisible()&&(a.isClickable()||a.isCurrentlyEditable())&&!((null==(b=a.getSourceBlock())?0:b.isSimpleReporter())&&a.isFullBlockField())&&a.getParentInput().isVisible()}isApplicable(a){return a instanceof jm}},kW={};kW.register=ff,kW.unregister=function(a){ak(F.ICON,a)};var kX=class extends j7{constructor(a){super(a),this.sourceBlock=a,this.textInputBubble=null,this.text="",this.bubbleSize=new hc(160,80),this.bubbleVisiblity=!1}getType(){return kX.TYPE}initView(a){this.svgRoot||(super.initView(a),aZ(ha.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),aZ(ha.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),aZ(ha.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),a$(this.svgRoot,"blocklyCommentIcon"))}dispose(){let a;super.dispose(),null==(a=this.textInputBubble)||a.dispose()}getWeight(){return kX.WEIGHT}getSize(){return new hc(17,17)}applyColour(){let a;super.applyColour();let b=this.sourceBlock.getColour();null==(a=this.textInputBubble)||a.setColour(b)}updateEditable(){let a=this,b=()=>super.updateEditable;return(0,gr.asyncExecutePromiseGeneratorFunction)(function*(){b().call(a),a.bubbleIsVisible()&&(yield a.setBubbleVisible(!1),yield a.setBubbleVisible(!0))})}onLocationChange(a){let b,c=this.workspaceLocation;super.onLocationChange(a),this.bubbleLocation&&(a=g9.difference(this.workspaceLocation,c),this.bubbleLocation=g9.sum(this.bubbleLocation,a)),a=this.getAnchorLocation(),null==(b=this.textInputBubble)||b.setAnchorLocation(a)}setText(a){let b,c=this.text;aP(new(aX(gB.BLOCK_CHANGE))(this.sourceBlock,"comment",null,c,a)),this.text=a,null==(b=this.textInputBubble)||b.setText(this.text)}getText(){return this.text}setBubbleSize(a){let b;this.bubbleSize=a,null==(b=this.textInputBubble)||b.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(a){let b;this.bubbleLocation=a,null==(b=this.textInputBubble)||b.moveDuringDrag(a)}getBubbleLocation(){return this.bubbleLocation}saveState(){if(this.text){let a={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},b=this.getBubbleLocation();return b&&(a.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(b.x+this.bubbleSize.width):b.x,a.y=b.y),a}return null}loadState(a){let b,c,d,e;this.text=null!=(b=a.text)?b:"",this.bubbleSize=new hc(null!=(c=a.width)?c:160,null!=(d=a.height)?d:80),this.bubbleVisiblity=null!=(e=a.pinned)&&e,this.setBubbleVisible(this.bubbleVisiblity);let f=a.x,g=a.y;b5().then(()=>{f&&g&&(f=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(f+this.bubbleSize.width):f,this.setBubbleLocation(new g9(f,g)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var a=this.textInputBubble.getText();this.text!==a&&(aP(new(aX(gB.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,a)),this.text=a)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(a){let b=this;return(0,gr.asyncExecutePromiseGeneratorFunction)(function*(){b.bubbleVisiblity!==a&&(b.bubbleVisiblity=a,yield b5(),!b.sourceBlock.rendered||b.sourceBlock.isInFlyout||b.sourceBlock.isInsertionMarker()||(a?(b.sourceBlock.isEditable()?b.showEditableBubble():b.showNonEditableBubble(),b.applyColour()):b.hideBubble(),aP(new(aX(gB.BUBBLE_OPEN))(b.sourceBlock,a,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){let a,b;this.createBubble(),null==(a=this.textInputBubble)||a.addTextChangeListener(()=>this.onTextChange()),null==(b=this.textInputBubble)||b.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){let a;this.createBubble(),null==(a=this.textInputBubble)||a.setEditable(!1)}createBubble(){this.textInputBubble=new kc(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect(),this),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){let a;null==(a=this.textInputBubble)||a.dispose(),this.textInputBubble=null}getAnchorLocation(){return g9.sum(this.workspaceLocation,new g9(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};kX.TYPE=ix.COMMENT,kX.WEIGHT=3,ff(kX.TYPE,kX);var kY=class{getFirstChild(a){if(a instanceof B.MutatorIcon$$module$build$src$core$icons$mutator_icon&&a.bubbleIsVisible()&&B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===a){let b,c;return null!=(c=null==(b=a.getBubble())?void 0:b.getWorkspace())?c:null}if(a instanceof kX&&a.bubbleIsVisible()&&B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===a){let b,c;return null!=(c=null==(b=a.getBubble())?void 0:b.getEditor())?c:null}return null}getParent(a){return a.getSourceBlock()}getNextSibling(a){return fe(a,1)}getPreviousSibling(a){return fe(a,-1)}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof j7}},kZ=class{getFirstChild(a){return a.view.getCommentBarButtons()[0]}getParent(a){return a.workspace}getNextSibling(a){return fd(a,1)}getPreviousSibling(a){return fd(a,-1)}isNavigable(a){return a.canBeFocused()}isApplicable(a){return a instanceof jR}},k$=class{getFirstChild(a){return(a=a.getTopBlocks(!0)).length?a[0]:null}getParent(a){return null}getNextSibling(a){return null}getPreviousSibling(a){return null}isNavigable(a){return a.canBeFocused()&&!a.isMutator}isApplicable(a){return a instanceof lP}},k_=class{constructor(){this.rules=[new kQ,new kV,new kU,new k$,new kY,new kZ,new kS,new kP,new kT]}addNavigationPolicy(a){this.rules.push(a)}get(a){return this.rules.find(b=>b.isApplicable(a))}getFirstChild(a){let b,c,d=null==(b=this.get(a))?void 0:b.getFirstChild(a);return d?null!=(c=this.get(d))&&c.isNavigable(d)?d:this.getFirstChild(d)||this.getNextSibling(d):null}getParent(a){let b,c,d=null==(b=this.get(a))?void 0:b.getParent(a);return d?null!=(c=this.get(d))&&c.isNavigable(d)?d:this.getParent(d):null}getNextSibling(a){let b,c,d=null==(b=this.get(a))?void 0:b.getNextSibling(a);return d?null!=(c=this.get(d))&&c.isNavigable(d)?d:this.getNextSibling(d):null}getPreviousSibling(a){let b,c,d=null==(b=this.get(a))?void 0:b.getPreviousSibling(a);return d?null!=(c=this.get(d))&&c.isNavigable(d)?d:this.getPreviousSibling(d):null}},k0=class extends k_{constructor(a){super(),this.rules.push(new kL,new kO),this.rules=this.rules.map(b=>new kM(b,a))}},k1=class{constructor(a,b,c,d,e){this.workspace=a,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,c=void 0===c||c;const f=(b=void 0===b||b)&&c;b&&(this.hScroll=new hi(a,!0,f,d,e)),c&&(this.vScroll=new hi(a,!1,f,d,e)),f&&(this.corner_=aZ(ha.RECT,{height:hi.scrollbarThickness,width:hi.scrollbarThickness,class:"blocklyScrollbarBackground"}),a3(this.corner_,a.getBubbleCanvas()))}dispose(){a2(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){let a=this.workspace.getMetrics();if(a){var b=!1,c=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===a.viewWidth&&this.oldHostMetrics.viewHeight===a.viewHeight&&this.oldHostMetrics.absoluteTop===a.absoluteTop&&this.oldHostMetrics.absoluteLeft===a.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===a.scrollWidth&&this.oldHostMetrics.viewLeft===a.viewLeft&&this.oldHostMetrics.scrollLeft===a.scrollLeft||(b=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===a.scrollHeight&&this.oldHostMetrics.viewTop===a.viewTop&&this.oldHostMetrics.scrollTop===a.scrollTop||(c=!0)):c=b=!0,b||c){try{B.disable$$module$build$src$core$events$utils(),this.hScroll&&b&&this.hScroll.resize(a),this.vScroll&&c&&this.vScroll.resize(a)}finally{B.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==a.viewWidth||this.oldHostMetrics.absoluteLeft!==a.absoluteLeft){let a;null==(a=this.corner_)||a.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==a.viewHeight||this.oldHostMetrics.absoluteTop!==a.absoluteTop){let a;null==(a=this.corner_)||a.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=a}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(a,b){this.hScroll&&this.hScroll.setOrigin(a,b),this.vScroll&&this.vScroll.setOrigin(a,b)}set(a,b,c){this.hScroll&&this.hScroll.set(a,!1),this.vScroll&&this.vScroll.set(b,!1),(c||void 0===c)&&(a={},this.hScroll&&(a.x=this.hScroll.getRatio_()),this.vScroll&&(a.y=this.vScroll.getRatio_()),this.workspace.setMetrics(a))}setX(a){this.hScroll&&this.hScroll.set(a,!0)}setY(a){this.vScroll&&this.vScroll.set(a,!0)}setContainerVisible(a){this.hScroll&&this.hScroll.setContainerVisible(a),this.vScroll&&this.vScroll.setContainerVisible(a)}isVisible(){let a=!1;return this.hScroll&&(a=this.hScroll.isVisible()),this.vScroll&&(a=a||this.vScroll.isVisible()),a}setVisible(a){this.hScroll&&this.hScroll.setVisibleInternal(a),this.vScroll&&this.vScroll.setVisibleInternal(a)}resizeContent(a){this.hScroll&&this.hScroll.resizeContentHorizontal(a),this.vScroll&&this.vScroll.resizeContentVertical(a)}resizeView(a){this.hScroll&&this.hScroll.resizeViewHorizontal(a),this.vScroll&&this.vScroll.resizeViewVertical(a)}},k2=class{load(a,b){return new kH(new kN(0,b.horizontalLayout?"x":"y"),"sep")}gapForItem(a,b){let c;return null!=(c=parseInt(String(a.gap)))?c:b}disposeItem(a){}getType(){return"sep"}};ai(F.FLYOUT_INFLATER,"sep",k2);var k3=class extends kG{constructor(a){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,a.setMetrics=this.setMetrics_.bind(this),this.workspace_=new lP(a),this.workspace_.setMetricsManager(new kJ(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new k0(this)),this.id=aF(),this.RTL=!!a.RTL,this.toolboxPosition_=a.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(a){return this.svgGroup_=aZ(a,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=aZ(ha.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(a){this.targetWorkspace=a,this.workspace_.targetWorkspace=a,this.workspace_.scrollbar=new k1(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(ax(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(ax(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),a.getComponentManager().addComponent({component:this,weight:g3.ComponentWeight.FLYOUT_WEIGHT,capabilities:[g3.Capability.AUTOHIDEABLE,g3.Capability.DELETE_AREA,g3.Capability.DRAG_TARGET]})}dispose(){for(let a of(this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id),this.boundEvents))az(a);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&a2(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(a){this.autoClose=a,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(a){!a&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(a){let b=a!==this.isVisible();this.visible=a,b&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(a){let b=a!==this.containerVisible;this.containerVisible=a,b&&this.updateDisplay()}getContents(){return this.contents}setContents(a){this.contents=a}updateDisplay(){let a,b;a=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=a?"block":"none"),null==(b=this.workspace_.scrollbar)||b.setContainerVisible(a)}positionAt_(a,b,c,d){let e,f;null==(e=this.svgGroup_)||e.setAttribute("width",`${a}`),null==(f=this.svgGroup_)||f.setAttribute("height",`${b}`),this.workspace_.setCachedParentSvgSize(a,b),this.svgGroup_&&a4(this.svgGroup_,"translate("+c+"px,"+d+"px)"),(a=this.workspace_.scrollbar)&&(a.setOrigin(c,d),a.resize(),a.hScroll&&a.hScroll.setPosition(a.hScroll.position.x,a.hScroll.position.y),a.vScroll&&a.vScroll.setPosition(a.vScroll.position.x,a.vScroll.position.y))}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null))}show(a){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof a&&(a=this.getDynamicCategoryContents(a)),this.setVisible(!0),a=bN(a),a=this.createFlyoutInfo(a),b6(this.workspace_),this.setContents(a),this.layout_(a),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=a=>{a.type!==gB.BLOCK_CHANGE&&a.type!==gB.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(a){let b=[],c=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(let d of a)"custom"in d&&(a=bN(a=this.getDynamicCategoryContents(d.custom)),b.push(...this.createFlyoutInfo(a))),a=d.kind.toLowerCase(),(a=this.getInflaterForType(a))&&(b.push(a.load(d,this)),(a=a.gapForItem(d,c))&&b.push(new kH(new kN(a,this.horizontalLayout?"x":"y"),"sep")));return this.normalizeSeparators(b)}normalizeSeparators(a){for(let b=a.length-1;b>0;b--){let c=a[b].getType().toLowerCase(),d=a[b-1].getType().toLowerCase();"sep"===c&&"sep"===d&&a.splice(b-1,1)}return a}getDynamicCategoryContents(a){if("function"!=typeof(a=this.workspace_.targetWorkspace.getToolboxCategoryCallback(a)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return a(this.workspace_.targetWorkspace)}clearOldBlocks(){let a;this.getContents().forEach(a=>{let b;null==(b=this.getInflaterForType(a.getType()))||b.disposeItem(a)}),null==(a=this.workspace_.getPotentialVariableMap())||a.clear()}onMouseDown(a){let b=this.targetWorkspace.getGesture(a);b&&b.handleFlyoutStart(a,this)}isBlockCreatable(a){return a.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(a){let b=null;B.disable$$module$build$src$core$events$utils();var c=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{b=this.placeNewBlock(a)}finally{B.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),a=cB(this.targetWorkspace,c),aU()){for(B.setGroup$$module$build$src$core$events$utils(!0),c=0;c<a.length;c++){let b=a[c];aP(new(aX(gB.VAR_CREATE))(b))}aP(new(aX(gB.BLOCK_CREATE))(b))}return this.autoClose&&this.hide(),b}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(a){var b=this.targetWorkspace;if(!a.getSvgRoot())throw Error("oldBlock is not rendered");let c=this.serializeBlock(a);return b.setResizesEnabled(!1),b=cN(c,b),this.positionNewBlock(a,b),b}serializeBlock(a){return cE(a)}positionNewBlock(a,b){let c=this.targetWorkspace;var d=c.getOriginOffsetInPixels(),e=this.workspace_.getOriginOffsetInPixels();(a=a.getRelativeToSurfaceXY()).scale(this.workspace_.scale),e=g9.sum(e,a),(d=g9.difference(e,d)).scale(1/c.scale),b.moveTo(new g9(d.x,d.y))}getInflaterForType(a){if(this.inflaters.has(a)){var b;return null!=(b=this.inflaters.get(a))?b:null}return(b=an(F.FLYOUT_INFLATER,a))?(b=new b,this.inflaters.set(a,b),b):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(a){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(a){throw Error("Flyouts are not directly focusable.")}onTreeFocus(a,b){}onTreeBlur(a){throw Error("Flyouts are not directly focusable.")}},k4=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(a=!0){this.isActive=a,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},k5=new k4,k6={};k6.KeyboardNavigationController=k4,k6.keyboardNavigationController=k5;var k7=class{constructor(a){this.workspace=a,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new g9(a.scrollX,a.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(a){this.drag(a)}drag(a){if(a=g9.sum(this.startScrollXY_,a),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(a.x,a.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(a.x,this.workspace.scrollY);else if(this.verticalScrollEnabled)this.workspace.scroll(this.workspace.scrollX,a.y);else throw TypeError("Invalid state.")}},k8=class{constructor(a,b){this.creatorWorkspace=b,this.mouseDownXY=new g9(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=a,this.currentDragDeltaXY=new g9(0,0)}dispose(){for(let a of(at(),dF(),this.creatorWorkspace.clearGesture(),this.boundEvents))az(a);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(a){let b=new g9(a.clientX,a.clientY);this.updateDragDelta(b)&&(this.updateIsDragging(a),as()),this.mostRecentEvent=a}updateDragDelta(a){return this.currentDragDeltaXY=g9.difference(a,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=g9.magnitude(this.currentDragDeltaXY)>(this.flyout?B.config$$module$build$src$core$config.flyoutDragRadius:B.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let a;if(!this.targetBlock||null==(a=this.flyout)||!a.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!!(!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY))&&(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),B.getGroup$$module$build$src$core$events$utils()||B.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),!0)}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new k7(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(a){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();let b=bj();b&&fg(b)&&b.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(b,this.startWorkspace_),this.dragger.onDragStart(a),this.dragger.onDrag(a,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(a,b){return new(aq(F.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(a,b)}doStart(a){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,aA(a)?this.cancel():(this.gestureHasStarted=!0,e3(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=c4(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=a,dE(),aB(a)?this.handleRightClick(a):("pointerdown"===a.type.toLowerCase()&&"mouse"!==a.pointerType&&ar(a,this),this.mouseDownXY=new g9(a.clientX,a.clientY),this.bindMouseEvents(a),this.isEnding_||this.handleTouchStart(a)))}bindMouseEvents(a){this.boundEvents.push(ax(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(ax(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(ax(document,"pointerup",null,this.handleUp.bind(this),!0)),this.boundEvents.push(ax(document,"pointercancel",null,this.handleUp.bind(this),!0)),a.preventDefault(),a.stopPropagation()}handleStart(a){this.isDragging()||(this.handleTouchStart(a),this.isMultiTouch()&&as())}handleMove(a){this.isDragging()&&au(a)||!this.isMultiTouch()?(this.updateFromEvent(a),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),a.preventDefault(),a.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(a),as())}handleUp(a){if(this.isDragging()||this.handleTouchEnd(a),!this.isMultiTouch()||this.isDragging()){if(!au(a))return;if(this.updateFromEvent(a),as(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(k5.setIsActive(!1),this.dragger.onDragEnd(a,this.currentDragDeltaXY)):this.workspaceDragger?(k5.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(a))}a.preventDefault(),a.stopPropagation(),this.dispose()}handleTouchStart(a){var b=av(a);this.cachedPoints.set(b,this.getTouchPoint(a));var c=Array.from(this.cachedPoints.keys());2===c.length&&(b=this.cachedPoints.get(c[0]),c=this.cachedPoints.get(c[1]),this.startDistance=g9.distance(b,c),this.multiTouch=!0,a.preventDefault())}handleTouchMove(a){let b=av(a);this.cachedPoints.set(b,this.getTouchPoint(a)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(a):(this.updateFromEvent(a),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),a.preventDefault(),a.stopPropagation())}handlePinch(a){var b=Array.from(this.cachedPoints.keys()),c=this.cachedPoints.get(b[0]);if(b=this.cachedPoints.get(b[1]),c=g9.distance(c,b)/this.startDistance,this.previousScale>0&&this.previousScale<1/0){if(b=(b=c-this.previousScale)>0?5*b:6*b,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");let d=this.startWorkspace_,e=aC(a,d.getParentSvg(),d.getInverseScreenCTM());d.zoom(e.x,e.y,b)}this.previousScale=c,a.preventDefault()}handleTouchEnd(a){a=av(a),this.cachedPoints.has(a)&&this.cachedPoints.delete(a),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(a){return this.startWorkspace_?new g9(a.pageX,a.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(as(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(a){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(a)):this.startBubble?this.startBubble.showContextMenu(a):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(a)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(a)),a.preventDefault(),a.stopPropagation(),k5.setIsActive(!1),this.dispose()}handleWsStart(a,b){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(b),this.mostRecentEvent=a,this.startBlock||this.startBubble||this.startComment?this.startBlock&&B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):B.getFocusManager$$module$build$src$core$focus_manager().focusNode(b),this.doStart(a)}fireWorkspaceClick(a){aP(new(aX(gB.CLICK))(null,a.id,"workspace"))}handleFlyoutStart(a,b){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(b),this.handleWsStart(a,b.getWorkspace())}handleBlockStart(a,b){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(b),this.mostRecentEvent=a}handleBubbleStart(a,b){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(b),this.mostRecentEvent=a}handleCommentStart(a,b){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(b),this.mostRecentEvent=a}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.flyout.isBlockCreatable(this.targetBlock)){B.getGroup$$module$build$src$core$events$utils()||B.setGroup$$module$build$src$core$events$utils(!0);var a=this.flyout.createBlock(this.targetBlock);a.snapToGrid(),a.bumpNeighbours(),B.getFocusManager$$module$build$src$core$focus_manager().focusNode(a)}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");aP(a=new(aX(gB.CLICK))(this.startBlock,this.startWorkspace_.id,"block"))}this.bringBlockToFront(),B.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(a){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(a){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=a)}setStartIcon(a){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=a)}setStartBubble(a){this.startBubble||(this.startBubble=a)}setStartComment(a){this.startComment||(this.startComment=a)}setStartBlock(a){this.startBlock||this.startBubble||(this.startBlock=a,a.isInFlyout&&a!==a.getRootBlock()?this.setTargetBlock(a.getRootBlock()):this.setTargetBlock(a))}setTargetBlock(a){a.isShadow()?this.setTargetBlock(a.getParent()):(this.targetBlock=a,B.getFocusManager$$module$build$src$core$focus_manager().focusNode(a))}setStartWorkspace(a){this.startWorkspace_||(this.startWorkspace_=a)}setStartFlyout(a){this.flyout||(this.flyout=a)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;let a=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&a}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}getCurrentDragger(){let a,b;return null!=(b=null!=(a=this.workspaceDragger)?a:this.dragger)?b:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){let a=be();for(let b=0,c;c=a[b];b++)if(c.currentGesture_)return!0;return!1}},k9=class{constructor(a,b){let c,d,e;this.pattern=a,this.scale=1,this.spacing=null!=(c=b.spacing)?c:0,this.length=null!=(d=b.length)?d:1,this.line2=(this.line1=a.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(e=b.snap)&&e}setSpacing(a){this.spacing=a,this.update(this.scale)}getSpacing(){return this.spacing}setLength(a){this.length=a,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(a){this.snapToGrid=a}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(a){this.scale=a;var b=this.spacing*a;this.pattern.setAttribute("width",`${b}`),this.pattern.setAttribute("height",`${b}`);let c=(b=Math.floor(this.spacing/2)+.5)-this.length/2,d=b+this.length/2;b*=a,c*=a,d*=a,this.setLineAttributes(this.line1,a,c,d,b,b),this.setLineAttributes(this.line2,a,b,b,c,d)}setLineAttributes(a,b,c,d,e,f){a&&(a.setAttribute("stroke-width",`${b}`),a.setAttribute("x1",`${c}`),a.setAttribute("y1",`${e}`),a.setAttribute("x2",`${d}`),a.setAttribute("y2",`${f}`))}moveTo(a,b){this.pattern.setAttribute("x",`${a}`),this.pattern.setAttribute("y",`${b}`)}alignXY(a){var b=this.getSpacing();let c=b/2,d=Math.round(Math.round((a.x-c)/b)*b+c);return b=Math.round(Math.round((a.y-c)/b)*b+c),d===a.x&&b===a.y?a:new g9(d,b)}static createDom(a,b,c,d){let e,f;if(a=aZ(ha.PATTERN,{id:"blocklyGridPattern"+a,patternUnits:"userSpaceOnUse"},c),(null!=(e=b.length)?e:1)>0&&(null!=(f=b.spacing)?f:0)>0){let c;aZ(ha.LINE,{stroke:b.colour},a),null!=(c=b.length)&&c&&aZ(ha.LINE,{stroke:b.colour},a)}else aZ(ha.LINE,{},a);return d&&d.style.setProperty("--blocklyGridPattern",`url(#${a.id})`),a}},la=class{constructor(a){this.workspace=a,this.layers=new Map,(a=a.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(a),this.animationLayer=this.createAnimationLayer(a)),a$(a=this.createLayer(50),"blocklyBlockCanvas"),a$(a=this.createLayer(100),"blocklyBubbleCanvas")}createDragLayer(a){let b=aZ(ha.SVG,{class:"blocklyBlockDragSurface",xmlns:gD,"xmlns:html":gE,"xmlns:xlink":gF,version:"1.1"});return a.append(b),aZ(ha.G,{},b)}createAnimationLayer(a){let b=aZ(ha.SVG,{class:"blocklyAnimationLayer",xmlns:gD,"xmlns:html":gE,"xmlns:xlink":gF,version:"1.1"});return a.append(b),aZ(ha.G,{},b)}appendToAnimationLayer(a){let b,c,d=null==(b=this.dragLayer)?void 0:b.getAttribute("transform");if(d){let a;null==(a=this.animationLayer)||a.setAttribute("transform",d)}null==(c=this.animationLayer)||c.appendChild(a.getSvgRoot())}translateLayers(a,b){let c;for(let[,d]of(a=`translate(${a.x}, ${a.y}) scale(${b})`,null==(c=this.dragLayer)||c.setAttribute("transform",a),this.layers))d.setAttribute("transform",a)}moveToDragLayer(a){let b;null==(b=this.dragLayer)||b.appendChild(a.getSvgRoot()),a.canBeFocused()&&B.getFocusManager$$module$build$src$core$focus_manager().focusNode(a)}moveOffDragLayer(a,b){this.append(a,b),a.canBeFocused()&&B.getFocusManager$$module$build$src$core$focus_manager().focusNode(a)}append(a,b){let c;if(this.layers.has(b)||this.createLayer(b),a=a.getSvgRoot(),(null==(c=this.layers.get(b))?void 0:c.lastChild)!==a){let c;null==(c=this.layers.get(b))||c.appendChild(a)}}createLayer(a){let b=this.workspace.getSvgGroup(),c=aZ(ha.G,{}),d=!1;for(let[e,f]of[...this.layers].sort((a,b)=>a[0]-b[0]))if(a<e){b.insertBefore(c,f),d=!0;break}return d||b.appendChild(c),this.layers.set(a,c),c}hasLayer(a){return a===this.dragLayer||new Set(this.layers.values()).has(a)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}},lb=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(a){this.curNode=a}dispose(){this.curNode=null}getSourceBlockFromNode(a){return a instanceof kE?a:a instanceof jm||a instanceof kn?a.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},lc=class extends lb{constructor(a){super(),this.workspace=a,this.type="cursor",this.potentialNodes=null}next(){var a=this.getCurNode();return a?((a=this.getNextNode(a,a=>{let b;return a instanceof kE&&!(null==(b=a.outputConnection)?0:b.targetBlock())||a instanceof jR},!0))&&this.setCurNode(a),a):null}in(){var a=this.getCurNode();return a?((a=this.getNextNode(a,()=>!0,!0))&&this.setCurNode(a),a):null}prev(){var a=this.getCurNode();return a?((a=this.getPreviousNode(a,a=>{let b;return a instanceof kE&&!(null==(b=a.outputConnection)?0:b.targetBlock())||a instanceof jR},!0))&&this.setCurNode(a),a):null}out(){var a=this.getCurNode();return a?((a=this.getPreviousNode(a,()=>!0,!0))&&this.setCurNode(a),a):null}atEndOfLine(){var a=this.getCurNode();return!!a&&this.getNextNode(a,()=>!0,!0)===(a=this.getNextNode(a,a=>{let b;return a instanceof kE&&!(null==(b=a.outputConnection)?0:b.targetBlock())},!0))}getNextNodeImpl(a,b,c=new Set){if(!a||c.has(a))return null;let d=this.workspace.getNavigator().getFirstChild(a)||this.workspace.getNavigator().getNextSibling(a);for(var e=a;e&&!d&&(e=this.workspace.getNavigator().getParent(e));)d=this.workspace.getNavigator().getNextSibling(e);return b(d)?d:d?(c.add(a),this.getNextNodeImpl(d,b,c)):null}getNextNode(a,b,c){return a&&(c||this.getLastNode()!==a)?this.getNextNodeImpl(a,b):null}getPreviousNodeImpl(a,b,c=new Set){if(!a||c.has(a))return null;let d=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(a),a)||this.workspace.getNavigator().getParent(a);return b(d)?d:d?(c.add(a),this.getPreviousNodeImpl(d,b,c)):null}getPreviousNode(a,b,c){return a&&(c||this.getFirstNode()!==a)?this.getPreviousNodeImpl(a,b):null}getRightMostChild(a,b){if(!a)return a;let c=this.workspace.getNavigator().getFirstChild(a);if(!c||c===b)return a;for(a=c;a&&a!==b;a=this.workspace.getNavigator().getNextSibling(c))c=a;return this.getRightMostChild(c,b)}preDelete(a){let b,c;var d,e=this.getCurNode();e=e?[e]:[];let f=null!=(c=null==(d=a.previousConnection)?void 0:d.targetConnection)?c:null==(b=a.outputConnection)?void 0:b.targetConnection;f&&e.push(f),(d=a.getNextBlock())&&e.push(d),(a=a.getParent())&&e.push(a),e.push(this.workspace),this.potentialNodes=e}postDelete(){let a=this.potentialNodes;if(this.potentialNodes=null,!a)throw Error("must call preDelete first");for(let b of a){let a;if(null==(a=this.getSourceBlockFromNode(b))||!a.disposed)return void this.setCurNode(b)}throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return B.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(a){B.getFocusManager$$module$build$src$core$focus_manager().focusNode(a)}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){let a=this.getFirstNode();return this.getPreviousNode(a,()=>!0,!0)}};ai(F.CURSOR,E,lc);var ld=class{constructor(a){this.workspace=a,this.markers=new Map,this.cursor=new lc(this.workspace)}registerMarker(a,b){this.markers.has(a)&&this.unregisterMarker(a),this.markers.set(a,b)}unregisterMarker(a){let b=this.markers.get(a);if(b)b.dispose(),this.markers.delete(a);else throw Error("Marker with ID "+a+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor}getMarker(a){return this.markers.get(a)||null}setCursor(a){this.cursor=a}dispose(){let a=Object.keys(this.markers);for(let b=0,c;c=a[b];b++)this.unregisterMarker(c);this.markers.clear(),this.cursor.dispose()}};ld.LOCAL_MARKER="local_marker_1";var le={};le.CommentIcon=kX,le.Icon=j7,le.IconType=ix,le.MutatorIcon=B.MutatorIcon$$module$build$src$core$icons$mutator_icon,le.WarningIcon=kD,le.exceptions=ki,le.registry=kW,B.Names$$module$build$src$core$names=class{constructor(a,b){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=b||"",this.reservedWords=new Set(a?a.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(a){this.variableMap=a}getNameForUserVariable(a){return this.variableMap?(a=this.variableMap.getVariableById(a))?a.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(a){a=B.allUsedVarModels$$module$build$src$core$variables(a);for(let b=0;b<a.length;b++)this.getName(a[b].getId(),B.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(a){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(a,b){let c=a;b===B.NameType$$module$build$src$core$names.VARIABLE&&(a=this.getNameForUserVariable(a))&&(c=a),a=c.toLowerCase();let d=b===B.NameType$$module$build$src$core$names.VARIABLE||b===B.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(b)||this.db.set(b,new Map);let e=this.db.get(b);return e.has(a)?d+e.get(a):(b=this.getDistinctName(c,b),e.set(a,b.substr(d.length)),b)}getUserNames(a){let b;return(a=null==(b=this.db.get(a))?void 0:b.keys())?Array.from(a):[]}getDistinctName(a,b){let c;a=this.safeName(a);let d=null,e,f;for(;this.dbReverse.has(a+(null!=(e=d)?e:""))||this.reservedWords.has(a+(null!=(f=d)?f:""));)d=d?d+1:2;return a+=null!=(c=d)?c:"",this.dbReverse.add(a),(b===B.NameType$$module$build$src$core$names.VARIABLE||b===B.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+a}safeName(a){return a?(a=encodeURI(a.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(a[0])&&(a="my_"+a)):a=B.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",a}static equals(a,b){return a.toLowerCase()===b.toLowerCase()}},(mR=(mR=B.Names$$module$build$src$core$names||(B.Names$$module$build$src$core$names={})).NameType||(mR.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",mR.VARIABLE="VARIABLE",mR.PROCEDURE="PROCEDURE",B.NameType$$module$build$src$core$names=B.Names$$module$build$src$core$names.NameType,B.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=B.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,({NameType:B.NameType$$module$build$src$core$names}).Names=B.Names$$module$build$src$core$names;var lf=class extends Map{constructor(){super()}set(a,b){return this.get(a)===b||(super.set(a,b),fi(b)&&b.startPublishing()),this}delete(a){let b=this.get(a);return(a=super.delete(a))&&fi(b)&&b.stopPublishing(),a}clear(){if(this.size)for(let a of this.keys())this.delete(a)}add(a){return this.set(a.getId(),a)}getProcedures(){return[...this.values()]}};mV="PROCEDURE",B.DEFAULT_ARG$$module$build$src$core$procedures="x",(mW={CATEGORY_NAME:mV,DEFAULT_ARG:B.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=lf,mW.allProcedures=fj,mW.findLegalName=B.findLegalName$$module$build$src$core$procedures,mW.flyoutCategory=fp,mW.getCallers=ft,mW.getDefinition=B.getDefinition$$module$build$src$core$procedures,mW.internalFlyoutCategory=fo,mW.isNameUsed=fm,mW.isProcedureBlock=fh,mW.mutateCallers=B.mutateCallers$$module$build$src$core$procedures,mW.mutatorOpenListener=fr,mW.rename=B.rename$$module$build$src$core$procedures;var lg=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=0x1000000}getType(a){return Object.prototype.hasOwnProperty.call(this,a)||(this[a]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[a]}isField(a){return(a.type&this.FIELD)>=1}isHat(a){return(a.type&this.HAT)>=1}isIcon(a){return(a.type&this.ICON)>=1}isSpacer(a){return(a.type&this.SPACER)>=1}isInRowSpacer(a){return(a.type&this.IN_ROW_SPACER)>=1}isSpacerRow(a){return(a.type&this.BETWEEN_ROW_SPACER)>=1}isInput(a){return(a.type&this.INPUT)>=1}isExternalInput(a){return(a.type&this.EXTERNAL_VALUE_INPUT)>=1}isInlineInput(a){return(a.type&this.INLINE_INPUT)>=1}isStatementInput(a){return(a.type&this.STATEMENT_INPUT)>=1}isPreviousConnection(a){return(a.type&this.PREVIOUS_CONNECTION)>=1}isNextConnection(a){return(a.type&this.NEXT_CONNECTION)>=1}isPreviousOrNextConnection(a){return this.isPreviousConnection(a)||this.isNextConnection(a)}isRoundCorner(a){return(a.type&this.LEFT_ROUND_CORNER)>=1||(a.type&this.RIGHT_ROUND_CORNER)>=1}isLeftRoundedCorner(a){return this.isRoundCorner(a)&&(a.type&this.LEFT_ROUND_CORNER)>=1}isRightRoundedCorner(a){return this.isRoundCorner(a)&&(a.type&this.RIGHT_ROUND_CORNER)>=1}isLeftSquareCorner(a){return(a.type&this.LEFT_SQUARE_CORNER)>=1}isRightSquareCorner(a){return(a.type&this.RIGHT_SQUARE_CORNER)>=1}isCorner(a){return(a.type&this.CORNER)>=1}isJaggedEdge(a){return(a.type&this.JAGGED_EDGE)>=1}isRow(a){return(a.type&this.ROW)>=1}isBetweenRowSpacer(a){return(a.type&this.BETWEEN_ROW_SPACER)>=1}isTopRow(a){return(a.type&this.TOP_ROW)>=1}isBottomRow(a){return(a.type&this.BOTTOM_ROW)>=1}isTopOrBottomRow(a){return this.isTopRow(a)||this.isBottomRow(a)}isInputRow(a){return(a.type&this.INPUT_ROW)>=1}},lh=class{constructor(a){this.centerline=this.xPos=this.height=this.width=0,this.constants_=a,this.type=lg.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},li=class{constructor(a){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=a,this.type=lg.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let a=this.elements.length-1;a>=0;a--){let b=this.elements[a];if(lg.isInput(b))return b}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let a=0;a<this.elements.length;a++){let b=this.elements[a];if(lg.isInRowSpacer(b))return b}return null}getLastSpacer(){for(let a=this.elements.length-1;a>=0;a--){let b=this.elements[a];if(lg.isInRowSpacer(b))return b}return null}},lj=class extends li{constructor(a){super(a),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=lg.BOTTOM_ROW}hasLeftSquareCorner(a){return!!a.outputConnection||!!a.getNextBlock()}hasRightSquareCorner(a){return!0}measure(){let a=0,b=0,c=0;for(let d=0;d<this.elements.length;d++){let e=this.elements[d];b+=e.width,lg.isSpacer(e)||(lg.isNextConnection(e)?c=Math.max(c,e.height):a=Math.max(a,e.height))}this.width=Math.max(this.minWidth,b),this.height=Math.max(this.minHeight,a)+c,this.descenderHeight=c,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},lk=class extends lh{constructor(a,b){super(a),this.connectionModel=b,this.type|=lg.CONNECTION,this.shape=this.constants_.shapeFor(b),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=b.isHighlighted()}},ll=class extends lk{constructor(a,b){super(a,b.connection),this.input=b,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=lg.INPUT,this.align=b.align,(this.connectedBlock=b.connection&&b.connection.targetBlock()?b.connection.targetBlock():null)?(a=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=a.width,this.connectedBlockHeight=a.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},lm=class extends ll{constructor(a,b){super(a,b),this.height=0,this.type|=lg.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},ln=class extends lh{constructor(a,b,c){super(a),this.field=b,this.parentInput=c,this.isEditable=b.EDITABLE,this.flipRtl=b.getFlipRtl(),this.type|=lg.FIELD,a=this.field.getSize(),this.height=a.height,this.width=a.width}},lo=class extends lh{constructor(a){super(a),this.type|=lg.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},lp=class extends lh{constructor(a,b){super(a),this.icon=b,this.flipRtl=!1,this.type|=lg.ICON,a=b.getSize(),this.height=a.height,this.width=a.width}},lq=class extends lh{constructor(a,b){super(a),this.type|=lg.SPACER|lg.IN_ROW_SPACER,this.width=b,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},lr=class extends ll{constructor(a,b){super(a,b),this.type|=lg.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},ls=class extends li{constructor(a){super(a),this.connectedBlockWidths=0,this.type|=lg.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let a=0;for(let b=0;b<this.elements.length;b++){let c=this.elements[b];this.width+=c.width,lg.isInput(c)&&(lg.isStatementInput(c)?a+=c.connectedBlockWidth:lg.isExternalInput(c)&&0!==c.connectedBlockWidth&&(a+=c.connectedBlockWidth-c.connectionWidth)),lg.isSpacer(c)||(this.height=Math.max(this.height,c.height))}this.connectedBlockWidths=a,this.widthWithConnectedBlocks=this.width+a}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},lt=class extends lh{constructor(a){super(a),this.type|=lg.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},lu=class extends lk{constructor(a,b){super(a,b),this.type|=lg.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},lv=class extends lk{constructor(a,b){super(a,b),this.connectionOffsetX=0,this.type|=lg.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},lw=class extends lk{constructor(a,b){super(a,b),this.type|=lg.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},lx=class extends lh{constructor(a,b){super(a),this.type=(b&&"left"!==b?lg.RIGHT_ROUND_CORNER:lg.LEFT_ROUND_CORNER)|lg.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},ly=class extends li{constructor(a,b,c){super(a),this.height=b,this.width=c,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=lg.SPACER|lg.BETWEEN_ROW_SPACER,this.elements=[new lq(this.constants_,c)]}measure(){}},lz=class extends lh{constructor(a,b){super(a),this.type=(b&&"left"!==b?lg.RIGHT_SQUARE_CORNER:lg.LEFT_SQUARE_CORNER)|lg.CORNER,this.width=this.height=this.constants_.NO_PADDING}},lA=class extends ll{constructor(a,b){super(a,b),this.type|=lg.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},lB=class extends li{constructor(a){super(a),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=lg.TOP_ROW}hasLeftSquareCorner(a){let b=(a.hat?"cap"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection,c=a.getPreviousBlock();return!!a.outputConnection||b||!!c&&c.getNextBlock()===a}hasRightSquareCorner(a){return!0}measure(){let a=0,b=0,c=0;for(let d=0;d<this.elements.length;d++){let e=this.elements[d];b+=e.width,lg.isSpacer(e)||(lg.isHat(e)?c=Math.max(c,e.ascenderHeight):a=Math.max(a,e.height))}this.width=Math.max(this.minWidth,b),this.height=Math.max(this.minHeight,a)+c,this.capline=this.ascenderHeight=c,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},lC=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=eR(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(a){this.blockStyles=Object.create(null);let b=a.blockStyles;for(let a in b)this.blockStyles[a]=this.validatedBlockStyle_(b[a]);this.setDynamicProperties_(a)}setDynamicProperties_(a){this.setFontConstants_(a),this.setComponentConstants_(a),this.ADD_START_HATS=void 0!==a.startHats?a.startHats:this.ADD_START_HATS}setFontConstants_(a){a.fontStyle&&a.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=a.fontStyle.family),a.fontStyle&&a.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=a.fontStyle.weight),a.fontStyle&&a.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=a.fontStyle.size),a=a9("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=a.height,this.FIELD_TEXT_BASELINE=a.baseline}setComponentConstants_(a){this.CURSOR_COLOUR=a.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=a.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=a.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(a.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(a){let b="auto_"+a;return this.blockStyles[b]||(this.blockStyles[b]=this.createBlockStyle_(a)),{style:this.blockStyles[b],name:b}}getBlockStyle(a){return this.blockStyles[a||""]||(a&&a.startsWith("auto_")?this.getBlockStyleForColour(a.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(a){return this.validatedBlockStyle_({colourPrimary:a})}validatedBlockStyle_(a){let b={};return a&&Object.assign(b,a),a=dV(b.colourPrimary||"#000"),b.colourPrimary=a.hex,b.colourSecondary=b.colourSecondary?dV(b.colourSecondary).hex:this.generateSecondaryColour_(b.colourPrimary),b.colourTertiary=b.colourTertiary?dV(b.colourTertiary).hex:this.generateTertiaryColour_(b.colourPrimary),b.hat=b.hat||"",b}generateSecondaryColour_(a){return dQ("#fff",a,.6)||a}generateTertiaryColour_(a){return dQ("#fff",a,.3)||a}dispose(){this.embossFilter&&a2(this.embossFilter),this.disabledPattern&&a2(this.disabledPattern),this.debugFilter&&a2(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){let a=this.JAGGED_TEETH_HEIGHT,b=this.JAGGED_TEETH_WIDTH,c=eT([eO(b,a/4),eO(-(2*b),a/2),eO(b,a/4)]);return{height:a,width:b,path:c}}makeStartHat(){let a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH,c=eP("c",[eO(30,-a),eO(70,-a),eO(b,0)]);return{height:.75*a,width:b,path:c}}makePuzzleTab(){function a(a){let d=-(a=a?-1:1);var e=c/2;let f=e+2.5,g=e+.5,h=eO(-b,a*e);return e=eO(b,a*e),eP("c",[eO(0,a*f),eO(-b,d*g),h])+eP("s",[eO(b,2.5*d),e])}let b=this.TAB_WIDTH,c=this.TAB_HEIGHT,d=a(!0),e=a(!1);return{type:this.SHAPES.PUZZLE,width:b,height:c,pathDown:e,pathUp:d}}makeNotch(){function a(a){return eT([eO(a*d,c),eO(3*a,0),eO(a*d,-c)])}let b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=(b-3)/2,e=a(1),f=a(-1);return{type:this.SHAPES.NOTCH,width:b,height:c,pathLeft:e,pathRight:f}}makeInsideCorners(){let a=this.CORNER_RADIUS,b=eV("a","0 0,0",a,eO(-a,a)),c=eV("a","0 0,0",a,eO(a,a));return{width:a,height:a,pathTop:b,pathBottom:c}}makeOutsideCorners(){let a=this.CORNER_RADIUS,b=eR(0,a)+eV("a","0 0,1",a,eO(a,-a)),c=eV("a","0 0,1",a,eO(a,a)),d=eV("a","0 0,1",a,eO(-a,-a));return{topLeft:b,topRight:c,bottomRight:eV("a","0 0,1",a,eO(-a,a)),bottomLeft:d,rightHeight:a}}shapeFor(a){switch(a.type){case mU.INPUT_VALUE:case mU.OUTPUT_VALUE:return this.PUZZLE_TAB;case mU.PREVIOUS_STATEMENT:case mU.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(a,b,c,d){this.injectCSS_(b,c),this.defs=aZ(ha.DEFS,{},a),a=aZ(ha.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),aZ(ha.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},a),b=aZ(ha.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},a),aZ(ha.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},b),aZ(ha.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},a),aZ(ha.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},a),this.embossFilterId=a.id,this.embossFilter=a,a=aZ(ha.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),aZ(ha.RECT,{width:10,height:10,fill:"#aaa"},a),aZ(ha.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},a),this.disabledPatternId=a.id,this.disabledPattern=a,this.createDebugFilter(),d&&(d.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),d.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),d.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){if(!this.debugFilter){let a=aZ(ha.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),b=aZ(ha.FECOMPONENTTRANSFER,{result:"outBlur"},a);aZ(ha.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},b),aZ(ha.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},a),aZ(ha.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},a),this.debugFilterId=a.id,this.debugFilter=a}}injectCSS_(a,b){b=this.getCSS_(b),a="blockly-renderer-style-"+a,this.cssNode=document.getElementById(a);let c=b.join("\n");this.cssNode?this.cssNode.firstChild.textContent=c:((b=document.createElement("style")).id=a,a=document.createTextNode(c),b.appendChild(a),document.head.insertBefore(b,document.head.firstChild),this.cssNode=b)}getCSS_(a){return[`${a} .blocklyText, `,`${a} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${a} .blocklyText {`,"fill: #fff;","}",`${a} .blocklyNonEditableField>rect,`,`${a} .blocklyEditableField>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${a} .blocklyNonEditableField>text,`,`${a} .blocklyEditableField>text {`,"fill: #000;","}",`${a} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${a} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${a} .blocklyEditableField:not(.blocklyEditing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${a} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${a} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${a} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${a} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${a} .blocklyReplaceable .blocklyPathLight,`,`${a} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${a} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},lD={};lD.ConstantProvider=lC,lD.isDynamicShape=fv,lD.isNotch=fx,lD.isPuzzleTab=fw;var lE=class{constructor(a,b){this.inlinePath_=this.outlinePath_="",this.block_=a,this.info_=b,this.topLeft_=a.getRelativeToSurfaceXY(),this.constants_=b.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let a=1;a<this.info_.rows.length-1;a++){let b=this.info_.rows[a];b.hasJaggedEdge?this.drawJaggedEdge_(b):b.hasStatement?this.drawStatementInput_(b):b.hasExternalInput?this.drawValueInput_(b):this.drawRightSideRow_(b)}this.drawBottom_(),this.drawLeft_()}drawTop_(){let a=this.info_.topRow,b=a.elements;this.positionPreviousConnection_(),this.outlinePath_+=eR(a.xPos,this.info_.startY);for(let a=0,c;c=b[a];a++)lg.isLeftRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:lg.isRightRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:lg.isPreviousConnection(c)?this.outlinePath_+=c.shape.pathLeft:lg.isHat(c)?this.outlinePath_+=this.constants_.START_HAT.path:lg.isSpacer(c)&&(this.outlinePath_+=eU("h",c.width));this.outlinePath_+=eU("v",a.height-a.ascenderHeight)}drawJaggedEdge_(a){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+eU("v",a.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(a){let b=a.getLastInput();this.positionExternalValueConnection_(a);let c=fv(b.shape)?b.shape.pathDown(b.height):b.shape.pathDown;this.outlinePath_+=eU("H",b.xPos+b.width)+c+eU("v",a.height-b.connectionHeight)}drawStatementInput_(a){var b=a.getLastInput();if(b){var c=b.xPos+b.notchOffset+b.shape.width;b=b.shape.pathRight+eU("h",-(b.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var d=a.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=eU("H",c)+b+eU("v",d)+this.constants_.INSIDE_CORNERS.pathBottom+eU("H",a.xPos+a.width),this.positionStatementInputConnection_(a)}}drawRightSideRow_(a){this.outlinePath_+=eU("V",a.yPos+a.height)}drawBottom_(){let a=this.info_.bottomRow,b=a.elements;this.positionNextConnection_();let c=0,d="";for(let e=b.length-1,f;f=b[e];e--)lg.isNextConnection(f)?d+=f.shape.pathRight:lg.isLeftSquareCorner(f)?d+=eU("H",a.xPos):lg.isLeftRoundedCorner(f)?d+=this.constants_.OUTSIDE_CORNERS.bottomLeft:lg.isRightRoundedCorner(f)?(d+=this.constants_.OUTSIDE_CORNERS.bottomRight,c=this.constants_.OUTSIDE_CORNERS.rightHeight):lg.isSpacer(f)&&(d+=eU("h",-1*f.width));this.outlinePath_+=eU("V",a.baseline-c),this.outlinePath_+=d}drawLeft_(){var a=this.info_.outputConnection;if(this.positionOutputConnection_(),a){let b=a.connectionOffsetY+a.height;a=fv(a.shape)?a.shape.pathUp(a.height):a.shape.pathUp,this.outlinePath_+=eU("V",b)+a}this.outlinePath_+="z"}drawInternals_(){for(let a=0,b;b=this.info_.rows[a];a++)for(let a=0,c;c=b.elements[a];a++)lg.isInlineInput(c)?this.drawInlineInput_(c):(lg.isIcon(c)||lg.isField(c))&&this.layoutField_(c)}layoutField_(a){let b=a.centerline-a.height/2,c=a.xPos;var d="";this.info_.RTL&&(c=-(c+a.width),a.flipRtl&&(c+=a.width,d="scale(-1 1)")),lg.isIcon(a)?((d=a.icon).setOffsetInBlock(new g9(c,b)),this.info_.isInsertionMarker&&d.hideForInsertionMarker()):((a=a.field.getSvgRoot()).setAttribute("transform","translate("+c+","+b+")"+d),this.info_.isInsertionMarker&&a.setAttribute("display","none"))}drawInlineInput_(a){let b=a.width,c=a.height,d=a.connectionOffsetY,e=a.connectionHeight+d;this.inlinePath_+=eQ(a.xPos+a.connectionWidth,a.centerline-c/2)+eU("v",d)+a.shape.pathDown+eU("v",c-e)+eU("h",b-a.connectionWidth)+eU("v",-c)+"z",this.positionInlineInputConnection_(a)}positionInlineInputConnection_(a){let b=a.centerline-a.height/2;if(a.connectionModel){let c=a.xPos+a.connectionWidth+a.connectionOffsetX;this.info_.RTL&&(c*=-1),a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY)}}positionStatementInputConnection_(a){let b=a.getLastInput();if(null==b?0:b.connectionModel){let c=a.xPos+a.statementEdge+b.notchOffset;this.info_.RTL&&(c*=-1),b.connectionModel.setOffsetInBlock(c,a.yPos)}}positionExternalValueConnection_(a){let b=a.getLastInput();if(b&&b.connectionModel){let c=a.xPos+a.width;this.info_.RTL&&(c*=-1),b.connectionModel.setOffsetInBlock(c,a.yPos)}}positionPreviousConnection_(){let a=this.info_.topRow;if(a.connection){let b=a.xPos+a.notchOffset;a.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-b:b,0)}}positionNextConnection_(){let a=this.info_.bottomRow;if(a.connection){let b=a.connection,c=b.xPos;b.connectionModel.setOffsetInBlock(this.info_.RTL?-c:c,a.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){let a=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-a:a,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(let a of this.info_.rows)for(let b of a.elements){if(!(b instanceof lk))continue;let a=this.drawConnectionHighlightPath(b);a&&(a.style.display=b.highlighted?"":"none")}}drawConnectionHighlightPath(a){let b,c,d=a.connectionModel;a=d.type===mU.INPUT_VALUE||d.type===mU.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(a):this.getStatementConnectionHighlightPath(a);let e=d.getSourceBlock();return null==(c=(b=e.pathObject).addConnectionHighlight)?void 0:c.call(b,d,a,d.getOffsetInBlock(),e.RTL)}getExpressionConnectionHighlightPath(a){let b="";return fv(a.shape)?b=a.shape.pathDown(a.height):fw(a.shape)&&(b=a.shape.pathDown),eR(0,-(a=this.constants_.TAB_OFFSET_FROM_TOP))+eU("v",a)+b+eU("v",a)}getStatementConnectionHighlightPath(a){if(!fx(a.shape))throw Error("Statement connections should have notch shapes");let b=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return eR(-b,0)+eU("h",b)+a.shape.pathLeft+eU("h",b)}},lF=class{constructor(a,b){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=a,this.block_=b,this.constants_=this.renderer_.getConstants(),this.outputConnection=b.outputConnection?new lv(this.constants_,b.outputConnection):null,this.isInline=b.getInputsInline()&&!b.isCollapsed(),this.isCollapsed=b.isCollapsed(),this.isInsertionMarker=b.isInsertionMarker(),this.RTL=b.RTL,this.topRow=new lB(this.constants_),this.bottomRow=new lj(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let a=new ls(this.constants_);this.inputRows.push(a);var b=this.block_.getIcons();for(let c=0,d;d=b[c];c++){let b=new lp(this.constants_,d);this.isCollapsed&&!d.isShownWhenCollapsed()||a.elements.push(b)}b=void 0;for(let c=0,d;d=this.block_.inputList[c];c++)if(d.isVisible()){this.shouldStartNewRow_(d,b)&&(this.rows.push(a),a=new ls(this.constants_),this.inputRows.push(a));for(let b=0,c;c=d.fieldRow[b];b++)a.elements.push(new ln(this.constants_,c,d));this.addInput_(d,a),b=d}this.isCollapsed&&(a.hasJaggedEdge=!0,a.elements.push(new lt(this.constants_))),(a.elements.length||a.hasDummyInput)&&this.rows.push(a),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var a=!!this.block_.previousConnection;let b=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!a,c=this.topRow.hasLeftSquareCorner(this.block_)?lz:lx;this.topRow.elements.push(new c(this.constants_)),b?(a=new lo(this.constants_),this.topRow.elements.push(a)):a&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new lw(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof kt&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,c=this.topRow.hasRightSquareCorner(this.block_)?lz:lx,this.topRow.elements.push(new c(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof kt?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new lz(this.constants_)):this.bottomRow.elements.push(new lx(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new lu(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new lz(this.constants_,"right")):this.bottomRow.elements.push(new lx(this.constants_,"right"))}addInput_(a,b){this.isInline&&a instanceof B.ValueInput$$module$build$src$core$inputs$value_input?(b.elements.push(new lr(this.constants_,a)),b.hasInlineInput=!0):a instanceof kt?(b.elements.push(new lA(this.constants_,a)),b.hasStatement=!0):a instanceof B.ValueInput$$module$build$src$core$inputs$value_input?(b.elements.push(new lm(this.constants_,a)),b.hasExternalInput=!0):(a instanceof kr||a instanceof ks)&&(b.minHeight=Math.max(b.minHeight,a.getSourceBlock()&&a.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0),null===b.align&&(b.align=a.align)}shouldStartNewRow_(a,b){return!!b&&(b instanceof ks||a instanceof kt||b instanceof kt||(a instanceof B.ValueInput$$module$build$src$core$inputs$value_input||a instanceof kr||b instanceof B.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let a=0,b;b=this.rows[a];a++){let a=b.elements;if(b.elements=[],b.startsWithElemSpacer()&&b.elements.push(new lq(this.constants_,this.getInRowSpacing_(null,a[0]))),a.length){for(let c=0;c<a.length-1;c++){b.elements.push(a[c]);let d=this.getInRowSpacing_(a[c],a[c+1]);b.elements.push(new lq(this.constants_,d))}b.elements.push(a[a.length-1]),b.endsWithElemSpacer()&&b.elements.push(new lq(this.constants_,this.getInRowSpacing_(a[a.length-1],null)))}}}getInRowSpacing_(a,b){if(!a&&b&&lg.isStatementInput(b))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(a&&lg.isInput(a)&&!b){if(lg.isExternalInput(a))return this.constants_.NO_PADDING;if(lg.isInlineInput(a))return this.constants_.LARGE_PADDING;if(lg.isStatementInput(a))return this.constants_.NO_PADDING}return a&&lg.isLeftSquareCorner(a)&&b&&(lg.isPreviousConnection(b)||lg.isNextConnection(b))?b.notchOffset:a&&lg.isLeftRoundedCorner(a)&&b&&(lg.isPreviousConnection(b)||lg.isNextConnection(b))?b.notchOffset-this.constants_.CORNER_RADIUS:a&&lg.isField(a)&&0===a.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let a=0,b=0,c=0;for(let e=0,f;f=this.rows[e];e++){if(f.measure(),b=Math.max(b,f.width),f.hasStatement){let b,c;var d=f.getLastInput();a=Math.max(a,d=f.width-(null!=(c=null==(b=d)?void 0:b.width)?c:0))}c=Math.max(c,f.widthWithConnectedBlocks)}this.statementEdge=a,this.width=b;for(let a=0,b;b=this.rows[a];a++)b.hasStatement&&(b.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(b,c),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let b=0,c;c=this.rows[b];b++)if(c.hasStatement)this.alignStatementRow_(c);else{var a=c.width;(a=this.getDesiredRowWidth_(c)-a)>0&&this.addAlignmentPadding_(c,a),lg.isTopOrBottomRow(c)&&(c.widthWithConnectedBlocks=c.width)}}getDesiredRowWidth_(a){return this.width-this.startX}addAlignmentPadding_(a,b){let c=a.getFirstSpacer(),d=a.getLastSpacer();if((a.hasExternalInput||a.hasStatement)&&(a.widthWithConnectedBlocks+=b),a.align===B.Align$$module$build$src$core$inputs$align.LEFT&&d)d.width+=b;else if(a.align===B.Align$$module$build$src$core$inputs$align.CENTRE&&c&&d)c.width+=b/2,d.width+=b/2;else if(a.align===B.Align$$module$build$src$core$inputs$align.RIGHT&&c)c.width+=b;else{if(!d)return;d.width+=b}a.width+=b}alignStatementRow_(a){let b=a.getLastInput();if(b){var c=a.width-b.width,d=this.statementEdge;(c=d-c)>0&&this.addAlignmentPadding_(a,c),c=a.width,d=this.getDesiredRowWidth_(a),b.width+=d-c,b.height=Math.max(b.height,a.height),a.width+=d-c,a.widthWithConnectedBlocks=Math.max(a.width,this.statementEdge+a.connectedBlockWidths)}}addRowSpacing_(){let a=this.rows;this.rows=[];for(let b=0;b<a.length;b++)this.rows.push(a[b]),b!==a.length-1&&this.rows.push(this.makeSpacerRow_(a[b],a[b+1]))}makeSpacerRow_(a,b){var c=this.getSpacerRowHeight_(a,b);let d=this.getSpacerRowWidth_(a,b);return c=new ly(this.constants_,c,d),a.hasStatement&&(c.followsStatement=!0),b.hasStatement&&(c.precedesStatement=!0),c}getSpacerRowWidth_(a,b){return this.width-this.startX}getSpacerRowHeight_(a,b){return this.constants_.MEDIUM_PADDING}getElemCenterline_(a,b){return lg.isSpacer(b)?a.yPos+b.height/2:lg.isBottomRow(a)?(a=a.yPos+a.height-a.descenderHeight,lg.isNextConnection(b)?a+b.height/2:a-b.height/2):lg.isTopRow(a)?lg.isHat(b)?a.capline-b.height/2:a.capline+b.height/2:a.yPos+a.height/2}recordElemPositions_(a){let b=a.xPos;for(let c=0,d;d=a.elements[c];c++)lg.isSpacer(d)&&(d.height=a.height),d.xPos=b,d.centerline=this.getElemCenterline_(a,d),b+=d.width}finalize_(){let a=0,b=0;for(let c=0,d;d=this.rows[c];c++)d.yPos=b,d.xPos=this.startX,b+=d.height,a=Math.max(a,d.widthWithConnectedBlocks),this.recordElemPositions_(d);if(this.outputConnection&&this.block_.nextConnection){let b=this.block_.nextConnection.targetBlock();b&&(a=Math.max(a,b.getHeightWidth().width))}this.widthWithChildren=a+this.startX,this.height=b,this.startY=this.topRow.capline,this.bottomRow.baseline=b-this.bottomRow.descenderHeight}getMeasureableForConnection(a){let b;if((null==(b=this.outputConnection)?void 0:b.connectionModel)===a)return this.outputConnection;for(let b of this.rows)for(let c of b.elements)if(c instanceof lk&&c.connectionModel===a)return c;return null}},lG=class{constructor(a,b,c){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=c,this.style=b,this.svgRoot=a,this.svgPath=aZ(ha.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(a){this.svgPath.setAttribute("d",a)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(a){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(a.isShadow()),this.updateDisabled_(!a.isEnabled()||a.getInheritedDisabled())}setStyle(a){this.style=a}setClass_(a,b){a&&(b?a$(this.svgRoot,a):a0(this.svgRoot,a))}updateHighlighted(a){a?this.setClass_("blocklyHighlighted",!0):this.setClass_("blocklyHighlighted",!1)}updateShadow_(a){a?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(a){this.setClass_("blocklyDisabled",a),this.setClass_("blocklyDisabledPattern",a)}updateSelected(a){this.setClass_("blocklySelected",a)}updateDraggingDelete(a){this.setClass_("blocklyDraggingDelete",a)}updateInsertionMarker(a){this.setClass_("blocklyInsertionMarker",a)}updateMovable(a){this.setClass_("blocklyDraggable",a)}updateReplacementFade(a){this.setClass_("blocklyReplaceable",a)}updateShapeForInputHighlight(a,b){}addConnectionHighlight(a,b,c,d){return(c=`translate(${c.x}, ${c.y})`+(d?" scale(-1 1)":""),d=this.connectionHighlights.get(a))?(d.setAttribute("d",b),d.setAttribute("transform",c),d):(b=aZ(ha.PATH,{id:a.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:b,transform:c},this.svgRoot),this.connectionHighlights.set(a,b),b)}removeConnectionHighlight(a){let b=this.connectionHighlights.get(a);b&&(a2(b),this.connectionHighlights.delete(a))}},lH=class{constructor(a){this.overrides=null,this.name=a}getClassName(){return this.name+"-renderer"}init(a,b){this.constants_=this.makeConstants_(),b&&(this.overrides=b,Object.assign(this.constants_,b)),this.constants_.setTheme(a),this.constants_.init()}createDom(a,b,c){this.constants_.createDom(a,this.name+"-"+b.name,"."+this.getClassName()+"."+b.getClassName(),c)}refreshDom(a,b,c){let d=this.getConstants();d.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=d.randomIdentifier,this.constants_.setTheme(b),this.constants_.init(),this.createDom(a,b,c)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new lC}makeRenderInfo_(a){return new lF(this,a)}makeDrawer_(a,b){return new lE(a,b)}makePathObject(a,b){return new lG(a,b,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(a){return!0}orphanCanConnectAtEnd(a,b,c){return!!kg.getConnectionForOrphanedConnection(a,c===mU.OUTPUT_VALUE?b.outputConnection:b.previousConnection)}render(a){let b=this.makeRenderInfo_(a);b.measure(),this.makeDrawer_(a,b).draw()}},lI={};lI.BottomRow=lj,lI.Connection=lk,lI.ConstantProvider=lC,lI.Drawer=lE,lI.ExternalValueInput=lm,lI.Field=ln,lI.Hat=lo,lI.Icon=lp,lI.InRowSpacer=lq,lI.InlineInput=lr,lI.InputConnection=ll,lI.InputRow=ls,lI.JaggedEdge=lt,lI.Measurable=lh,lI.NextConnection=lu,lI.OutputConnection=lv,lI.PathObject=lG,lI.PreviousConnection=lw,lI.RenderInfo=lF,lI.Renderer=lH,lI.RoundCorner=lx,lI.Row=li,lI.SpacerRow=ly,lI.SquareCorner=lz,lI.StatementInput=lA,lI.TopRow=lB,lI.Types=lg,lI.init=fz,lI.register=fy,lI.unregister=function(a){ak(F.RENDERER,a)};var lJ=class{constructor(a,b){this.workspace=a,this.theme=b,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(a){var b=this.theme;this.theme=a,(a=this.workspace.getInjectionDiv())&&(b&&(b=b.getClassName())&&a0(a,b),(b=this.theme.getClassName())&&a$(a,b));for(let a=0,b;b=this.subscribedWorkspaces[a];a++)b.refreshTheme();for(let[c,d]of this.componentDB)for(let e of d){a=e.element,b=e.propertyName;let d=this.theme&&this.theme.getComponentStyle(c);a.style.setProperty(b,d||"")}for(let a of this.subscribedWorkspaces)a.hideChaff()}subscribeWorkspace(a){this.subscribedWorkspaces.push(a)}unsubscribeWorkspace(a){if(!bs(this.subscribedWorkspaces,a))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(a,b,c){this.componentDB.has(b)||this.componentDB.set(b,[]),this.componentDB.get(b).push({element:a,propertyName:c}),b=this.theme&&this.theme.getComponentStyle(b),a.style.setProperty(c,b||"")}unsubscribe(a){if(a)for(let[b,c]of this.componentDB){for(let b=c.length-1;b>=0;b--)c[b].element===a&&c.splice(b,1);c.length||this.componentDB.delete(b)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},lK="VARIABLE_DYNAMIC",lL={CATEGORY_NAME:lK};lL.flyoutCategory=fE,lL.flyoutCategoryBlocks=fG,lL.internalFlyoutCategory=fD,lL.onCreateVariableButtonClick_Colour=fC,lL.onCreateVariableButtonClick_Number=fB,lL.onCreateVariableButtonClick_String=fA;var lM=class{canConnect(a,b,c,d){return this.canConnectWithReason(a,b,c,d)===kg.CAN_CONNECT}canConnectWithReason(a,b,c,d){let e=this.doSafetyChecks(a,b);return e!==kg.CAN_CONNECT?e:this.doTypeChecks(a,b)?c&&!this.doDragChecks(a,b,d||0)?kg.REASON_DRAG_CHECKS_FAILED:kg.CAN_CONNECT:kg.REASON_CHECKS_FAILED}getErrorMessage(a,b,c){switch(a){case kg.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case kg.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case kg.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case kg.REASON_TARGET_NULL:return"Target connection is null.";case kg.REASON_CHECKS_FAILED:return"Connection checks failed. "+(b+" expected "+b.getCheck())+", found "+c.getCheck();case kg.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case kg.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case kg.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(a,b){let c,d,e;return a&&b?(a.isSuperior()?(c=a.getSourceBlock(),d=b.getSourceBlock(),e=b):(d=a.getSourceBlock(),c=b.getSourceBlock(),e=a,a=b),c===d?kg.REASON_SELF_CONNECTION:e.type!==kk[a.type]?kg.REASON_WRONG_TYPE:c.workspace!==d.workspace?kg.REASON_DIFFERENT_WORKSPACES:c.isShadow()&&!d.isShadow()?kg.REASON_SHADOW_PARENT:e.type===mU.OUTPUT_VALUE&&d.previousConnection&&d.previousConnection.isConnected()||e.type===mU.PREVIOUS_STATEMENT&&d.outputConnection&&d.outputConnection.isConnected()?kg.REASON_PREVIOUS_AND_OUTPUT:kg.CAN_CONNECT):kg.REASON_TARGET_NULL}doTypeChecks(a,b){if(a=a.getCheck(),b=b.getCheck(),!a||!b)return!0;for(let c=0;c<a.length;c++)if(b.includes(a[c]))return!0;return!1}doDragChecks(a,b,c){if(a.distanceFrom(b)>c||b.getSourceBlock().isInsertionMarker())return!1;switch(b.type){case mU.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(a,b);case mU.OUTPUT_VALUE:if(b.isConnected()&&!b.targetBlock().isInsertionMarker()||a.isConnected())return!1;break;case mU.INPUT_VALUE:if(b.isConnected()&&!b.targetBlock().isMovable()&&!b.targetBlock().isShadow())return!1;break;case mU.NEXT_STATEMENT:if(b.isConnected()&&!a.getSourceBlock().nextConnection&&!b.targetBlock().isShadow()&&b.targetBlock().nextConnection||b.targetBlock()&&!b.targetBlock().isMovable()&&!b.targetBlock().isShadow())return!1;break;default:return!1}return!gV.includes(b)}canConnectToPrevious_(a,b){return!(a.targetConnection||gV.includes(b))&&(!b.targetConnection||!!(a=b.targetBlock()).isInsertionMarker()&&!a.getPreviousBlock())}};ai(F.CONNECTION_CHECKER,E,lM);var lN=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(a){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new lf,this.readOnly=!1,this.potentialVariableMap=null,this.id=aF(),bf(this),this.options=a||new j3({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(aq(F.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),bg(this)}sortObjects(a,b){let c=a=>({getBoundingRectangle:()=>{let b=a.getRelativeToSurfaceXY();return new hb(b.y,b.y,b.x,b.x)},moveBy:()=>{}});return this.sortByOrigin(c(a),c(b))}sortByOrigin(a,b){let c=Math.sin(c0(lN.SCAN_ANGLE))*(this.RTL?-1:1);return a=a.getBoundingRectangle().getOrigin(),b=b.getBoundingRectangle().getOrigin(),a.y+c*a.x-(b.y+c*b.x)}addTopBlock(a){this.topBlocks.push(a)}removeTopBlock(a){if(!bs(this.topBlocks,a))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(a=!1){let b=[].concat(this.topBlocks);return a&&b.length>1&&b.sort(this.sortObjects.bind(this)),b}addTypedBlock(a){this.typedBlocksDB.has(a.type)||this.typedBlocksDB.set(a.type,[]),this.typedBlocksDB.get(a.type).push(a)}removeTypedBlock(a){bs(this.typedBlocksDB.get(a.type),a),this.typedBlocksDB.get(a.type).length||this.typedBlocksDB.delete(a.type)}getBlocksByType(a,b=!1){return this.typedBlocksDB.has(a)?(a=this.typedBlocksDB.get(a).slice(0),b&&a&&a.length>1&&a.sort(this.sortObjects.bind(this)),a.filter(a=>!a.isInsertionMarker())):[]}addTopComment(a){this.topComments.push(a),this.commentDB.has(a.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+a.id+'"'),this.commentDB.set(a.id,a)}removeTopComment(a){if(!bs(this.topComments,a))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(a.id)}getTopComments(a=!1){let b=[].concat(this.topComments);return a&&b.length>1&&b.sort(this.sortObjects.bind(this)),b}getAllBlocks(a=!1){if(a){var b=this.getTopBlocks(!0);a=[];for(let c=0;c<b.length;c++)a.push(...b[c].getDescendants(!0))}else for(a=this.getTopBlocks(!1),b=0;b<a.length;b++)a.push(...a[b].getChildren(!1));return a.filter(a=>!a.isInsertionMarker())}clear(){this.isClearing=!0;try{let a=B.getGroup$$module$build$src$core$events$utils();for(a||B.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();B.setGroup$$module$build$src$core$events$utils(a),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(a,b){cj("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(a=this.variableMap.getVariableById(a))&&this.variableMap.renameVariable(a,b)}createVariable(a,b,c){return cj("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(a,null!=b?b:void 0,null!=c?c:void 0)}getVariableUsesById(a){return cj("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),cD(this,a)}deleteVariableById(a){cj("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");let b=this.variableMap.getVariableById(a);b?B.deleteVariable$$module$build$src$core$variables(this,b):console.warn(`Can't delete non-existent variable: ${a}`)}getVariable(a,b){return cj("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(a,b)}getVariableById(a){return cj("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(a)}getVariablesOfType(a){return cj("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(null!=a?a:"")}getAllVariables(){return cj("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return cj("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(a=>a.getName())}getWidth(){return 0}newBlock(a,b){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(a){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(a){return this.options.maxInstances?(void 0!==this.options.maxInstances[a]?this.options.maxInstances[a]:1/0)-this.getBlocksByType(a,!1).length:1/0}isCapacityAvailable(a){if(!this.hasBlockLimits())return!0;let b=0;for(let c in a){if(a[c]>this.remainingCapacityOfType(c))return!1;b+=a[c]}return!(b>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(a){var b=a?this.redoStack_:this.undoStack_,c=a?this.undoStack_:this.redoStack_;let d=b.pop();if(d){for(var e=[d];b.length&&d.group&&d.group===b[b.length-1].group;){let a=b.pop();a&&e.push(a)}for(b=0;b<e.length;b++)c.push(e[b]);B.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(c=0;c<e.length;c++)e[c].run(a)}finally{B.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,aT()}addChangeListener(a){return this.listeners.push(a),a}removeChangeListener(a){bs(this.listeners,a)}fireChangeListener(a){if(a.recordUndo)for(this.undoStack_.push(a),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&this.MAX_UNDO>=0;)this.undoStack_.shift();for(let b=0;b<this.listeners.length;b++)(0,this.listeners[b])(a)}getBlockById(a){return this.blockDB.get(a)||null}setBlockById(a,b){this.blockDB.set(a,b)}removeBlockById(a){this.blockDB.delete(a)}getCommentById(a){let b;return null!=(b=this.commentDB.get(a))?b:null}allInputsFilled(a){let b=this.getTopBlocks(!1);for(let c=0;c<b.length;c++)if(!b[c].allInputsFilled(a))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(a){this.variableMap=a}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let a=null,b=this.options.parentWorkspace;return this.isFlyout?b&&b.options&&(a=b.options.parentWorkspace):b&&(a=b),a}static getById(a){return bd(a)}static getAll(){return be()}getVariableMapClass(){let a=aq(F.VARIABLE_MAP,this.options,!0);if(!a)throw Error("No variable map is registered.");return a}isReadOnly(){return this.readOnly}setIsReadOnly(a){this.readOnly=a,this.options.readOnly=a}};lN.SCAN_ANGLE=3;var lO=class{constructor(a){this.parentWorkspace=a,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(a,b){if(a.length){try{var c=new globalThis.Audio}catch(a){return}for(let b=0;b<a.length;b++){let e=a[b],f=e.match(/\.(\w+)$/);if(f&&c.canPlayType("audio/"+f[1])){var d=new globalThis.Audio(e);break}}d&&this.sounds.set(b,d)}}preload(){for(let a of this.sounds.values()){a.volume=.01;let b=a.play();if(void 0!==b?b.then(a.pause).catch(function(){}):a.pause(),gx||gy)break}}play(a,b){if(!this.muted){var c=this.sounds.get(a);c?(a=new Date,null!==this.lastSound&&a.getTime()-this.lastSound.getTime()<100||(this.lastSound=a,(c=gx||gw?c:c.cloneNode()).volume=void 0===b?1:b,c.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(a,b)}}setMuted(a){this.muted=a}getMuted(){return this.muted}},lP=class extends lN{constructor(a){let b;super(a),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new k_,this.metricsManager=new(aq(F.METRICS_MANAGER,a,!0))(this),this.getMetrics=a.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=a.setMetrics||lP.setTopLevelWorkspaceMetrics,this.componentManager=new g3,this.connectionDBList=kd.init(this.connectionChecker),this.audioManager=new lO(a.parentWorkspace),this.grid=this.options.gridPattern?new k9(this.options.gridPattern,a.gridOptions):null,this.markerManager=new ld(this),im&&ck&&this.registerToolboxCategoryCallback(ij,ck),lL&&fD&&this.registerToolboxCategoryCallback(lK,fD),mW&&fo&&(this.registerToolboxCategoryCallback(mV,fo),this.addChangeListener(fr)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new lJ(this,this.options.theme||j2),this.themeManager_.subscribeWorkspace(this),this.renderer=fz(this.options.renderer||"geras",this.getTheme(),null!=(b=this.options.rendererOverrides)?b:void 0),this.cachedParentSvgSize=new hc(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(a){this.metricsManager=a,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(a){return this.markerManager.getMarker(a)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(a){a||(a=j2),this.themeManager_.setTheme(a)}refreshTheme(){if(this.svgGroup_){var a=null===this.options.parentWorkspace;this.renderer.refreshDom(this.svgGroup_,this.getTheme(),a?this.getInjectionDiv():void 0)}this.updateBlockStyles(this.getAllBlocks(!1).filter(a=>!!a.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),aP(a=new(aX(gB.THEME_CHANGE))(this.getTheme().name,this.id))}updateBlockStyles(a){for(let b=0,c;c=a[b];b++){let a=c.getStyleName();a&&c.setStyle(a)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){let a=this.getParentSvg().getScreenCTM();a&&(this.inverseScreenCTM=a.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(a){let b=0,c=0,d=1;(this.getCanvas().contains(a)||this.getBubbleCanvas().contains(a))&&(d=this.scale);do{let e=bD(a);(a===this.getCanvas()||a===this.getBubbleCanvas())&&(d=1),b+=e.x*d,c+=e.y*d,a=a.parentNode}while(a&&a!==this.getParentSvg()&&a!==this.getInjectionDiv())return new g9(b,c)}getCachedParentSvgSize(){let a=this.cachedParentSvgSize;return new hc(a.width,a.height)}getOriginOffsetInPixels(){return bE(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let a=this.svgGroup_;for(;a;){if((" "+(a.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=a;break}a=a.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(a){this.resizeHandlerWrapper=a}createDom(a,b){return this.injectionDiv||(this.injectionDiv=null!=b?b:null),this.svgGroup_=aZ(ha.G,{class:"blocklyWorkspace",id:this.id}),b&&b2(this.svgGroup_,iF.LABEL,B.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),a&&(this.svgBackground_=aZ(ha.RECT,{height:"100%",width:"100%",class:a},this.svgGroup_),"blocklyMainBackground"===a&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new la(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(ax(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),ax(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(aq(F.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(a=aq(F.CURSOR,this.options))&&this.markerManager.setCursor(new a(this)),a=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),a?this.getInjectionDiv():void 0),B.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&a2(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){let a=this.getParentSvg();a&&a.parentNode&&a2(a.parentNode)}this.resizeHandlerWrapper&&(az(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),B.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&B.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=lP.newTrashcan(this);let a=this.trashcan.createDom();this.svgGroup_.insertBefore(a,this.getCanvas())}static newTrashcan(a){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new hA(this);let a=this.zoomControls_.createDom();this.svgGroup_.appendChild(a)}copyOptionsForFlyout(){return new j3({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(a){let b=this.copyOptionsForFlyout();return b.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(aq(F.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(b):new(aq(F.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(b),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(a)}getFlyout(a){return this.flyout||a?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();let a=this.componentManager.getComponents(g3.Capability.POSITIONABLE,!0),b=this.getMetricsManager().getUiMetrics(),c=[];for(let d=0,e;e=a[d];d++){e.position(b,c);let a=e.getBoundingRectangle();a&&c.push(a)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){let a=bG();g9.equals(this.lastRecordedPageScroll,a)||(this.lastRecordedPageScroll=a,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(a,b){let c=this.getParentSvg();null!=a&&(this.cachedParentSvgSize.width=a,c.setAttribute("data-cached-width",`${a}`)),null!=b&&(this.cachedParentSvgSize.height=b,c.setAttribute("data-cached-height",`${b}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let a=this.svgGroup_;for(;a;){if("svg"===a.tagName){this.cachedParentSvg=a;break}a=a.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(aU()){var a=this.scale,b=-this.scrollY,c=-this.scrollX;if(!(a===this.oldScale&&1>Math.abs(b-this.oldTop)&&1>Math.abs(c-this.oldLeft))){var d=new(aX(gB.VIEWPORT_CHANGE))(b,c,a,this.id,this.oldScale);this.oldScale=a,this.oldTop=b,this.oldLeft=c,aP(d)}}}translate(a,b){let c,d;null==(c=this.layerManager)||c.translateLayers(new g9(a,b),this.scale),null==(d=this.grid)||d.moveTo(a,b),this.maybeFireViewportChangeEvent()}getWidth(){let a=this.getMetrics();return a?a.viewWidth/this.scale:0}setVisible(a){this.visible=a,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(a),this.getFlyout()&&this.getFlyout().setContainerVisible(a),this.getParentSvg().style.display=a?"block":"none",this.toolbox&&this.toolbox.setVisible(a),a||this.hideChaff(!0))}render(){let a=this.getAllBlocks(!1);for(let b=a.length-1;b>=0;b--)a[b].queueRender();this.getTopBlocks().flatMap(a=>a.getDescendants(!1)).filter(a=>a.isInsertionMarker()).forEach(a=>a.queueRender())}highlightBlock(a,b){if(void 0===b){for(let a=0,b;b=this.highlightedBlocks[a];a++)b.setHighlighted(!1);this.highlightedBlocks.length=0}(a=a?this.getBlockById(a):null)&&((b=void 0===b||b)?this.highlightedBlocks.includes(a)||this.highlightedBlocks.push(a):bs(this.highlightedBlocks,a),a.setHighlighted(b))}variableChangeCallback(a){switch(a.type){case gB.VAR_CREATE:case gB.VAR_DELETE:case gB.VAR_RENAME:case gB.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){let a=this.isFlyout?this.targetWorkspace:this;a&&!a.currentGesture_&&a.toolbox&&a.toolbox.getFlyout()&&a.toolbox.refreshSelection()}recordDragTargets(){let a=this.componentManager.getComponents(g3.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let b=0,c;c=a[b];b++){let a=c.getClientRect();a&&this.dragTargetAreas.push({component:c,clientRect:a})}}newBlock(a,b){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(a){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(a){for(let b=0,c;c=this.dragTargetAreas[b];b++)if(c.clientRect.contains(a.clientX,a.clientY))return c.component;return null}onMouseDown(a){let b=this.getGesture(a);b&&b.handleWsStart(a,this)}startDrag(a,b){ef(this,a,b)}moveDrag(a){return eg(this,a)}setKeyboardMoveInProgress(a){this.keyboardMoveInProgress=a}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){let a=!!this.scrollbar;return this.isMovable()&&(!a||a&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){let a=!!this.scrollbar;return this.isMovable()&&(!a||a&&this.scrollbar.canScrollVertically())}onMouseWheel(a){if(k8.inProgress())a.preventDefault(),a.stopPropagation();else{var b=this.options.zoomOptions&&this.options.zoomOptions.wheel,c=this.options.moveOptions&&this.options.moveOptions.wheel;if(b||c){var d=aD(a);if(S)var e=a.metaKey;b&&(a.ctrlKey||e||!c)?(d=-d.y/50,b=aC(a,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(b.x,b.y,d)):(b=this.scrollX-d.x,c=this.scrollY-d.y,a.shiftKey&&!d.x&&(b=this.scrollX-d.y,c=this.scrollY),this.scroll(b,c)),a.preventDefault()}}}getBlocksBoundingBox(){let a=this.getTopBoundedElements();if(!a.length)return new hb(0,0,0,0);let b=a[0].getBoundingRectangle();for(let d=1;d<a.length;d++){var c=a[d];c.isInsertionMarker&&c.isInsertionMarker()||((c=c.getBoundingRectangle()).top<b.top&&(b.top=c.top),c.bottom>b.bottom&&(b.bottom=c.bottom),c.left<b.left&&(b.left=c.left),c.right>b.right&&(b.right=c.right))}return b}cleanUp(){this.setResizesEnabled(!1);let a=B.getGroup$$module$build$src$core$events$utils();a||B.setGroup$$module$build$src$core$events$utils(!0);var b=this.getTopBlocks(!0),c=b.filter(a=>a.isMovable());let d=b.filter(a=>!a.isMovable()).map(a=>a.getBoundingRectangle());b=function(a){for(let b of d)if(a.intersects(b))return b;return null};var e=0;let f=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(let a of c){for(c=a.getBoundingRectangle(),a.moveBy(-c.left,e-c.top,["cleanup"]),a.snapToGrid(),e=b(c=a.getBoundingRectangle());null!=e;)e=e.top+e.getHeight()+f,a.moveBy(0,e-c.top,["cleanup"]),a.snapToGrid(),e=b(c=a.getBoundingRectangle());e=a.getRelativeToSurfaceXY().y+a.getHeightWidth().height+f}B.setGroup$$module$build$src$core$events$utils(a),this.setResizesEnabled(!0)}showContextMenu(a){if(!this.isReadOnly()&&!this.isFlyout){var b=jC.registry.getContextMenuOptions({workspace:this,focusedNode:this},a);this.configureContextMenu&&this.configureContextMenu(b,a);var c=a instanceof PointerEvent?new g9(a.clientX,a.clientY):bI(this,new g9(5,5));d7(a,b,this.RTL,this,c)}}updateToolbox(a){if(a=bL(a)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(bO(a)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=a,this.toolbox.render(a)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=a,this.flyout.show(a)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(bi(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(a,b,c){c=Math.pow(this.options.zoomOptions.scaleSpeed,c);let d=this.scale*c;if(this.scale!==d){d>this.options.zoomOptions.maxScale?c=this.options.zoomOptions.maxScale/this.scale:d<this.options.zoomOptions.minScale&&(c=this.options.zoomOptions.minScale/this.scale);var e=this.getCanvas().getCTM(),f=this.getParentSvg().createSVGPoint();f.x=a,f.y=b,a=(f=f.matrixTransform(e.inverse())).x,b=f.y,e=e.translate(a*(1-c),b*(1-c)).scale(c),this.scrollX=e.e,this.scrollY=e.f,this.setScale(d)}}zoomCenter(a){let b;var c=this.getMetrics();this.flyout?(b=c.svgWidth?c.svgWidth/2:0,c=c.svgHeight?c.svgHeight/2:0):(b=c.viewWidth/2+c.absoluteLeft,c=c.viewHeight/2+c.absoluteTop),this.zoom(b,c,a)}zoomToFit(){if(this.isMovable()){var a=this.getMetrics(),b=a.viewWidth;a=a.viewHeight;var c=this.getBlocksBoundingBox(),d=c.right-c.left+40;if(c=c.bottom-c.top+40,d){this.flyout&&(this.horizontalLayout?(a+=this.flyout.getHeight(),c+=this.flyout.getHeight()/this.scale):(b+=this.flyout.getWidth(),d+=this.flyout.getWidth()/this.scale)),b/=d,a/=c,B.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(b,a)),this.scrollCenter()}finally{B.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){a$(this.getCanvas(),"blocklyCanvasTransitioning"),a$(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){a0(this.getCanvas(),"blocklyCanvasTransitioning"),a0(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var a=this.getMetrics(),b=(a.scrollWidth-a.viewWidth)/2,c=(a.scrollHeight-a.viewHeight)/2;b=-b-a.scrollLeft,c=-c-a.scrollTop,this.scroll(b,c)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(a,b){if(this.isMovable()){var c=a?this.getBlockById(a):null;if(c){a=c.getRelativeToSurfaceXY(),c=b?{height:c.height,width:c.width}:c.getHeightWidth();var d=this.scale;b=(a.x+(this.RTL?-1:1)*c.width/2)*d,a=(a.y+c.height/2)*d,c=this.getMetrics(),this.scroll(-(b-c.viewWidth/2),-(a-c.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(a){this.options.zoomOptions.maxScale&&a>this.options.zoomOptions.maxScale?a=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&a<this.options.zoomOptions.minScale&&(a=this.options.zoomOptions.minScale),this.scale=a,this.hideChaff(!1),(a=this.getFlyout(!1))&&a.isVisible()&&(a.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),a=this.getMetrics(),this.scrollX-=a.absoluteLeft,this.scrollY-=a.absoluteTop,a.viewLeft+=a.absoluteLeft,a.viewTop+=a.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(a):this.scrollbar.resizeContent(a))}getScale(){return this.scale}getAbsoluteScale(){let a=a=>{if(a.isFlyout){let b,c=null==(b=a.targetWorkspace)?void 0:b.getFlyout();if(c instanceof k3)return c.getFlyoutScale()}return a.getScale()},b=(c,d)=>c.options.parentWorkspace&&c.options.parentWorkspace.getSvgGroup().contains(c.getSvgGroup())?b(c.options.parentWorkspace,d*a(c)):d*a(c);return b(this,1)}scroll(a,b){this.hideChaff(!0);let c=this.getMetrics();a=Math.min(a,-c.scrollLeft),b=Math.min(b,-c.scrollTop);let d=c.scrollTop+Math.max(0,c.scrollHeight-c.viewHeight);a=Math.max(a,-(c.scrollLeft+Math.max(0,c.scrollWidth-c.viewWidth))),b=Math.max(b,-d),this.scrollX=a,this.scrollY=b,this.scrollbar&&this.scrollbar.set(-(a+c.scrollLeft),-(b+c.scrollTop),!1),a+=c.absoluteLeft,b+=c.absoluteTop,this.translate(a,b)}getBlockById(a){return super.getBlockById(a)}getAllBlocks(a=!1){return super.getAllBlocks(a)}getTopBlocks(a=!1){return super.getTopBlocks(a)}addTopBlock(a){this.addTopBoundedElement(a),super.addTopBlock(a)}removeTopBlock(a){this.removeTopBoundedElement(a),super.removeTopBlock(a)}addTopComment(a){this.addTopBoundedElement(a),super.addTopComment(a)}removeTopComment(a){this.removeTopBoundedElement(a),super.removeTopComment(a)}getTopComments(a=!1){return super.getTopComments(a)}getCommentById(a){return super.getCommentById(a)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(a){this.topBoundedElements.push(a)}removeTopBoundedElement(a){bs(this.topBoundedElements,a)}getTopBoundedElements(a=!1){let b=[].concat(this.topBoundedElements);return a&&b.sort(this.sortByOrigin.bind(this)),b}setResizesEnabled(a){let b=!this.resizesEnabled&&a;this.resizesEnabled=a,b&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(a,b){if("function"!=typeof b)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(a,b)}getButtonCallback(a){let b;return null!=(b=this.flyoutButtonCallbacks.get(a))?b:null}removeButtonCallback(a){this.flyoutButtonCallbacks.delete(a)}registerToolboxCategoryCallback(a,b){if("function"!=typeof b)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(a,b)}getToolboxCategoryCallback(a){return this.toolboxCategoryCallbacks.get(a)||null}removeToolboxCategoryCallback(a){this.toolboxCategoryCallbacks.delete(a)}getGesture(a){let b;if(this.keyboardMoveInProgress)return a.preventDefault(),a.stopPropagation(),null;let c="pointerdown"===a.type;return c&&(null==(b=this.currentGesture_)?0:b.hasStarted())&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&c&&(this.currentGesture_=new k8(a,this)),this.currentGesture_}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(a=!1){dD(),d0(this),dj(),this.hideComponents(a)}hideComponents(a=!1){this.getComponentManager().getComponents(g3.Capability.AUTOHIDEABLE,!0).forEach(b=>b.autoHide(a))}static setTopLevelWorkspaceMetrics(a){let b=this.getMetrics();"number"==typeof a.x&&(this.scrollX=-(b.scrollLeft+(b.scrollWidth-b.viewWidth)*a.x)),"number"==typeof a.y&&(this.scrollY=-(b.scrollTop+(b.scrollHeight-b.viewHeight)*a.y)),this.translate(this.scrollX+b.absoluteLeft,this.scrollY+b.absoluteTop)}addClass(a){this.injectionDiv&&a$(this.injectionDiv,a)}removeClass(a){this.injectionDiv&&a0(this.injectionDiv,a)}setIsReadOnly(a){super.setIsReadOnly(a),a?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(a,b=10){if(!k8.inProgress()){var c=this.getScale(),d=this.getMetricsManager().getViewMetrics(!0);if(d=new hb(d.top,d.top+d.height,d.left,d.left+d.width),!(a.left>=d.left&&a.top>=d.top&&a.right<=d.right&&a.bottom<=d.bottom)){a=a.clone(),a.top-=b,a.bottom+=b,a.left-=b,a.right+=b;var e=b=0;a.left<d.left?b=this.RTL?Math.min(d.left-a.left,d.right-a.right):d.left-a.left:a.right>d.right&&(b=this.RTL?d.right-a.right:Math.max(d.right-a.right,d.left-a.left)),a.top<d.top?e=d.top-a.top:a.bottom>d.bottom&&(e=Math.max(d.bottom-a.bottom,d.top-a.top)),this.scroll(this.scrollX+b*c,this.scrollY+e*c)}}}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(a){let b,c;if(a)return null;if(a=null==(b=this.targetWorkspace)?void 0:b.getFlyout(),this.isFlyout&&a){let b,c;return null!=(c=null==(b=a.getContents().find(a=>ba(a=a.getElement())&&a.canBeFocused()))?void 0:b.getElement())?c:null}return null!=(c=this.getTopBlocks(!0)[0])?c:null}getNestedTrees(){let a=this.getAllBlocks().map(a=>a.getIcons()).flat().filter(a=>a instanceof B.MutatorIcon$$module$build$src$core$icons$mutator_icon&&a.bubbleIsVisible()).map(a=>{let b;return null==(b=a.getBubble())?void 0:b.getWorkspace()}).filter(a=>!!a),b=this.getFlyout(!0);return b&&a.push(b.getWorkspace()),a}searchForWorkspaceComment(a){for(let b of this.getTopComments())if(b instanceof jR&&b.canBeFocused()&&b.getFocusableElement().id===a)return b}lookUpFocusableNode(a){let b=null==(d=this.targetWorkspace)?void 0:d.getFlyout();if(this.isFlyout&&b){for(var c of b.getContents())if(ba(d=c.getElement())&&d.canBeFocused()&&d.getFocusableElement().id===a)return d}if(c=a.indexOf("_field_"),d=a.indexOf("_connection_"),-1!==c){var d,e,f=a.substring(0,c);if(f=this.getBlockById(f)){for(var g of f.getFields())if(g.canBeFocused()&&g.getFocusableElement().id===a)return g}return null}if(-1!==d){if(f=a.substring(0,d),f=this.getBlockById(f)){for(let b of f.getConnections_(!0))if(b.id===a)return b}return null}if(-1!==(g=Math.max(a.indexOf(jL),a.indexOf(jJ),a.indexOf(jN)))&&(g=a.substring(0,g),g=this.searchForWorkspaceComment(g)))return a.indexOf(jL)>-1?g.getEditorFocusableNode():null!=(e=g.view.getCommentBarButtons().find(b=>b.getFocusableElement().id.includes(a)))?e:null;if((e=this.getAllBlocks(!1).find(b=>b.getFocusableElement().id===a))||(e=this.searchForWorkspaceComment(a)))return e;for(f of e=this.getAllBlocks().map(a=>a.getIcons()).flat()){if(f.canBeFocused()&&f.getFocusableElement().id===a)return f;if(c_(f)){if((e=f.getBubble())&&e.canBeFocused()&&e.getFocusableElement().id===a)return e;if(e instanceof kc&&e.getEditor().getFocusableElement().id===a)return e.getEditor()}}return null}onTreeFocus(a,b){}onTreeBlur(a){if(this.isFlyout&&this.targetWorkspace&&!B.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()){var b,c=this.targetWorkspace.getToolbox();c&&a===c||(b=c)&&"function"==typeof b.autoHide&&c.autoHide(!1)}}getNavigator(){return this.navigator}setNavigator(a){this.navigator=a}},lQ={};lQ.WorkspaceSvg=lP,lQ.resizeSvgContents=function(a){a.resizeContents()};var lR=class extends gZ{constructor(a){super(),this.isBlank=void 0===a,a&&(this.varId=a.getId(),this.workspaceId=a.getWorkspace().id)}toJson(){let a=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return a.varId=this.varId,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new lR)).varId=a.varId,b}},lS=class extends lR{constructor(a){super(a),this.type=gB.VAR_CREATE,a&&(this.varType=a.getType(),this.varName=a.getName())}toJson(){let a=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return a.varType=this.varType,a.varName=this.varName,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new lS)).varType=a.varType,b.varName=a.varName,b}run(a){var b=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");b=b.getVariableMap(),a?b.createVariable(this.varName,this.varType,this.varId):(a=b.getVariableById(this.varId))&&b.deleteVariable(a)}};ai(F.EVENT,gB.VAR_CREATE,lS);var lT=class{constructor(a,b,c,d){this.workspace=a,this.name=b,this.type=c||"",this.id=d||aF()}getId(){return this.id}getName(){return this.name}setName(a){return this.name=a,this}getType(){return this.type}setType(a){return this.type=a,this}getWorkspace(){return this.workspace}save(){let a={name:this.getName(),id:this.getId()},b=this.getType();return b&&(a.type=b),a}static load(a,b){a=new this(b,a.name,a.type,a.id),b.getVariableMap().addVariable(a),aP(new(aX(gB.VAR_CREATE))(a))}};ai(F.VARIABLE_MODEL,E,lT);var lU=class extends lR{constructor(a){super(a),this.type=gB.VAR_DELETE,a&&(this.varType=a.getType(),this.varName=a.getName())}toJson(){let a=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return a.varType=this.varType,a.varName=this.varName,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new lU)).varType=a.varType,b.varName=a.varName,b}run(a){var b=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");b=b.getVariableMap(),a?(a=b.getVariableById(this.varId))&&b.deleteVariable(a):b.createVariable(this.varName,this.varType,this.varId)}};ai(F.EVENT,gB.VAR_DELETE,lU);var lV=class extends lR{constructor(a,b){super(a),this.type=gB.VAR_RENAME,a&&(this.oldName=a.getName(),this.newName=void 0===b?"":b)}toJson(){let a=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return a.oldName=this.oldName,a.newName=this.newName,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new lV)).oldName=a.oldName,b.newName=a.newName,b}run(a){var b=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");let c=(b=b.getVariableMap()).getVariableById(this.varId);a?c&&b.renameVariable(c,this.newName):c&&b.renameVariable(c,this.oldName)}};ai(F.EVENT,gB.VAR_RENAME,lV);var lW=class{constructor(a,b=!1){this.workspace=a,this.potentialMap=b,this.variableMap=new Map}clear(){for(let a of this.variableMap.values())for(let b of a.values())this.deleteVariable(b);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(a,b){if(a.getName()===b)return a;var c=a.getType();c=this.getVariable(b,c);let d=this.workspace.getAllBlocks(!1),e="";this.potentialMap||(e=B.getGroup$$module$build$src$core$events$utils())||B.setGroup$$module$build$src$core$events$utils(!0);try{c&&c.getId()!==a.getId()?this.renameVariableWithConflict(a,b,c,d):this.renameVariableAndUses(a,b,d)}finally{this.potentialMap||B.setGroup$$module$build$src$core$events$utils(e)}return a}changeVariableType(a,b){let c,d=a.getType();if(d===b)return a;var e=this.variableMap.get(d);return null==e||e.delete(a.getId()),(null==e?void 0:e.size)===0&&this.variableMap.delete(d),a.setType(b),(e=null!=(c=this.variableMap.get(b))?c:new Map).set(a.getId(),a),this.variableMap.has(b)||this.variableMap.set(b,e),aP(new(aX(gB.VAR_TYPE_CHANGE))(a,d,b)),a}renameVariableById(a,b){cj("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");let c=this.getVariableById(a);if(!c)throw Error("Tried to rename a variable that didn't exist. ID: "+a);this.renameVariable(c,b)}renameVariableAndUses(a,b,c){for(this.potentialMap||aP(new(aX(gB.VAR_RENAME))(a,b)),a.setName(b),b=0;b<c.length;b++)c[b].updateVarName(a)}renameVariableWithConflict(a,b,c,d){let e,f=a.getType(),g=c.getName();for(b!==g&&this.renameVariableAndUses(c,b,d),b=0;b<d.length;b++)d[b].renameVarById(a.getId(),c.getId());this.potentialMap||aP(new(aX(gB.VAR_DELETE))(a)),null==(e=this.variableMap.get(f))||e.delete(a.getId())}createVariable(a,b,c){let d;var e=this.getVariable(a,b);if(e){if(c&&e.getId()!==c)throw Error('Variable "'+a+'" is already in use and its id is "'+e.getId()+'" which conflicts with the passed in id, "'+c+'".');return e}if(c&&this.getVariableById(c))throw Error('Variable id, "'+c+'", is already in use.');if(e=c||aF(),b=b||"",!(c=aq(F.VARIABLE_MODEL,this.workspace.options,!0)))throw Error("No variable model is registered.");return e=new c(this.workspace,a,b,e),(a=null!=(d=this.variableMap.get(b))?d:new Map).set(e.getId(),e),this.variableMap.has(b)||this.variableMap.set(b,a),this.potentialMap||aP(new(aX(gB.VAR_CREATE))(e)),e}addVariable(a){let b,c=a.getType();this.variableMap.has(c)||this.variableMap.set(c,new Map),null==(b=this.variableMap.get(c))||b.set(a.getId(),a)}deleteVariable(a){let b=cD(this.workspace,a.getId()),c="";this.potentialMap||(c=B.getGroup$$module$build$src$core$events$utils())||B.setGroup$$module$build$src$core$events$utils(!0);try{for(let a=0;a<b.length;a++)b[a].dispose(!0);let c=this.variableMap.get(a.getType());c&&c.has(a.getId())&&(c.delete(a.getId()),this.potentialMap||aP(new(aX(gB.VAR_DELETE))(a)),0===c.size&&this.variableMap.delete(a.getType()))}finally{this.potentialMap||B.setGroup$$module$build$src$core$events$utils(c)}}deleteVariableById(a){cj("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(a=this.getVariableById(a))&&B.deleteVariable$$module$build$src$core$variables(this.workspace,a)}getVariable(a,b){let c;return(b=this.variableMap.get(b||""))&&null!=(c=[...b.values()].find(b=>B.Names$$module$build$src$core$names.equals(b.getName(),a)))?c:null}getVariableById(a){for(let b of this.variableMap.values())if(b.has(a)){let c;return null!=(c=b.get(a))?c:null}return null}getVariablesOfType(a){return(a=this.variableMap.get(a||""))?[...a.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let a=[];for(let b of this.variableMap.values())a=a.concat(...b.values());return a}getAllVariableNames(){cj("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");let a=[];for(let b of this.variableMap.values())for(let c of b.values())a.push(c.getName());return a}getVariableUsesById(a){return cj("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),cD(this.workspace,a)}};ai(F.VARIABLE_MAP,E,lW);var lX=class extends g${constructor(a,b){super(b),this.type=gB.TRASHCAN_OPEN,this.isOpen=a}toJson(){let a=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return a.isOpen=this.isOpen,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new lX)).isOpen=a.isOpen,b}};ai(F.EVENT,gB.TRASHCAN_OPEN,lX);var lY=class extends kG{constructor(a){super(),this.workspace=a,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(a=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(a.toolboxPosition=this.workspace.toolboxPosition===ht.TOP?ht.BOTTOM:ht.TOP,this.flyout=new(aq(F.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(a)):(a.toolboxPosition=this.workspace.toolboxPosition===ht.RIGHT?ht.LEFT:ht.RIGHT,this.flyout=new(aq(F.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(a)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let a;this.svgGroup=aZ(ha.G,{class:"blocklyTrash"});let b=String(Math.random()).substring(2);a=aZ(ha.CLIPPATH,{id:"blocklyTrashBodyClipPath"+b},this.svgGroup),aZ(ha.RECT,{width:lZ,height:l$,y:l_},a);let c=aZ(ha.IMAGE,{width:96,x:-l3,height:124,y:-l4,"clip-path":"url(#blocklyTrashBodyClipPath"+b+")"},this.svgGroup);return c.setAttributeNS(gF,"xlink:href",this.workspace.options.pathToMedia+hz),a=aZ(ha.CLIPPATH,{id:"blocklyTrashLidClipPath"+b},this.svgGroup),aZ(ha.RECT,{width:lZ,height:l_},a),this.svgLid=aZ(ha.IMAGE,{width:96,x:-l3,height:124,y:-l4,"clip-path":"url(#blocklyTrashLidClipPath"+b+")"},this.svgGroup),this.svgLid.setAttributeNS(gF,"xlink:href",this.workspace.options.pathToMedia+hz),ay(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),ay(this.svgGroup,"pointerup",this,this.click),ay(c,"pointerover",this,this.mouseOver),ay(c,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){if(this.workspace.options.maxTrashcanContents>0){let a=this.flyout.createDom(ha.SVG);a$(a,"blocklyTrashcanFlyout"),a3(a,this.workspace.getParentSvg()),this.flyout.init(this.workspace)}this.workspace.getComponentManager().addComponent({component:this,weight:g3.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[g3.Capability.AUTOHIDEABLE,g3.Capability.DELETE_AREA,g3.Capability.DRAG_TARGET,g3.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&a2(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var a=this.contents.map(function(a){return JSON.parse(a)}),b=this.workspace.getParentSvg().style;b.cursor="wait",setTimeout(()=>{let c,d;null==(c=this.flyout)||c.show(a),b.cursor="",null==(d=this.workspace.scrollbar)||d.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var a,b;null==(a=this.flyout)||a.hide(),null==(b=this.workspace.scrollbar)||b.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(a){!a&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(a,b){if(this.initialized){var c,d,e=bV(this.workspace,a);b=bW(a=bU(e,new hc(lZ,l$+l_),l1,l0,a,this.workspace),l0,e.vertical===hK.TOP?hM.DOWN:hM.UP,b),this.top=b.top,this.left=b.left,null==(c=this.svgGroup)||c.setAttribute("transform","translate("+this.left+","+this.top+")"),null==(d=this.flyout)||d.position()}}getBoundingRectangle(){return new hb(this.top,this.top+l$+l_,this.left,this.left+lZ)}getClientRect(){if(!this.svgGroup)return null;var a=this.svgGroup.getBoundingClientRect();let b=a.top+l4-l2;return a=a.left+l3-l2,new hb(b,b+l_+l$+2*l2,a,a+lZ+2*l2)}onDragOver(a){this.setLidOpen(this.wouldDelete_)}onDragExit(a){this.setLidOpen(!1)}onDrop(a){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(a){this.isLidOpen!==a&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=a,this.animateLid())}animateLid(){var a=1/(l7+1);this.lidOpen+=this.isLidOpen?a:-a,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*ma),a=l8+this.lidOpen*(l9-l8),this.svgGroup&&(this.svgGroup.style.opacity=`${a}`),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),l6/l7))}setLidAngle(a){let b,c=this.workspace.toolboxPosition===ht.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;null==(b=this.svgLid)||b.setAttribute("transform","rotate("+(c?-a:a)+","+(c?4:lZ-4)+","+(l_-2)+")")}setMinOpenness(a){this.minOpenness=a,this.isLidOpen||this.setLidAngle(a*ma)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(a){aP(a=new(aX(gB.TRASHCAN_OPEN))(a,this.workspace.id))}blockMouseDownWhenOpenable(a){!this.contentsIsOpen()&&this.hasContents()&&a.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(a){if(!(this.workspace.options.maxTrashcanContents<=0||!aH(a)||a.wasShadow)){if(!a.oldJson)throw Error("Encountered a delete event without proper oldJson");if(a=JSON.stringify(this.cleanBlockJson(a.oldJson)),!this.contents.includes(a)){for(this.contents.unshift(a);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(l5)}}}cleanBlockJson(a){return!function a(b){if(b){if(delete b.id,delete b.x,delete b.y,delete b.enabled,delete b.disabledReasons,b.icons&&b.icons.comment){var c=b.icons.comment;delete c.height,delete c.width,delete c.pinned}for(var d in c=b.inputs){var e=c[d];let b=e.block;e=e.shadow,b&&a(b),e&&a(e)}b.next&&(b=(d=b.next).block,d=d.shadow,b&&a(b),d&&a(d))}}(a=JSON.parse(JSON.stringify(a))),Object.assign({},{kind:"BLOCK"},a)}},lZ=47,l$=44,l_=16,l0=20,l1=20,l2=10,l3=0,l4=32,l5=.1,l6=80,l7=4,l8=.4,l9=.8,ma=45,mb=null,mc=null,md=void 0,me={};me.BlockPaster=ky,me.copy=fH,me.getLastCopiedData=fI,me.getLastCopiedLocation=fK,me.getLastCopiedWorkspace=fJ,me.paste=fL,me.registry=hE,me.setLastCopiedData=function(a){mb=a},me.setLastCopiedLocation=function(a){md=a},me.setLastCopiedWorkspace=function(a){mc=a};var mf={};mf.CollapseCommentBarButton=jK,mf.CommentBarButton=jI,mf.CommentEditor=jM,mf.CommentView=jP,mf.DeleteCommentBarButton=jO,mf.RenderedWorkspaceComment=jR,mf.WorkspaceComment=jQ,(mS=mX||(mX={})).ESCAPE="escape",mS.DELETE="delete",mS.COPY="copy",mS.CUT="cut",mS.PASTE="paste",mS.UNDO="undo",mS.REDO="redo",fX();var mg={};mg.names=mX,mg.registerCopy=fS,mg.registerCut=fT,mg.registerDefaultShortcuts=fX,mg.registerDelete=fP,mg.registerEscape=fO,mg.registerPaste=fU,mg.registerRedo=fW,mg.registerUndo=fV;var mh=class{constructor(a,b){this.procedureModelClass=a,this.parameterModelClass=b,this.priority=75}save(a){return(a=a.getProcedureMap().getProcedures().map(a=>fY(a))).length?a:null}load(a,b){let c=b.getProcedureMap();for(let d of a)c.add(fZ(this.procedureModelClass,this.parameterModelClass,d,b))}clear(a){a.getProcedureMap().clear()}},mi={};mi.ProcedureSerializer=mh,mi.loadProcedure=fZ,mi.saveProcedure=fY;var mj=class{constructor(){this.priority=100}save(a){return(a=a.getAllVariables().map(a=>a.save())).length?a:null}load(a,b){let c=ao(F.VARIABLE_MODEL,E);a.forEach(a=>{null==c||c.load(a,b)})}clear(a){a.getVariableMap().clear()}};bX("variables",new mj);var mk={};mk.VariableSerializer=mj;var ml={};ml.load=function(a,b,{recordUndo:c=!1}={}){var d=ap(F.SERIALIZER,!0);if(d){d=Object.entries(d).sort((a,b)=>b[1].priority-a[1].priority);var e=aO();for(let[,a]of(B.setRecordUndo$$module$build$src$core$events$utils(c),(c=B.getGroup$$module$build$src$core$events$utils())||B.setGroup$$module$build$src$core$events$utils(!0),a5(),b instanceof lP&&b.setResizesEnabled(!1),d.reverse()))null==a||a.clear(b);for(let[c,e]of d.reverse())a[c]&&(null==e||e.load(a[c],b));b instanceof lP&&b.setResizesEnabled(!0),a6(),aP(new(aX(gB.FINISHED_LOADING))(b)),B.setGroup$$module$build$src$core$events$utils(c),B.setRecordUndo$$module$build$src$core$events$utils(e)}},ml.save=function(a){let b=Object.create(null),c=ap(F.SERIALIZER,!0);for(let d in c){let e,f=null==(e=c[d])?void 0:e.save(a);f&&(b[d]=f)}return b},"Blockly"in globalThis||(globalThis.Blockly={Msg:iH});var mm="label",mn=class{load(a,b){return(a=new kK(b.getWorkspace(),b.targetWorkspace,a,!0)).show(),new kH(a,mm)}gapForItem(a,b){return b}disposeItem(a){(a=a.getElement())instanceof kK&&a.dispose()}getType(){return mm}};ai(F.FLYOUT_INFLATER,mm,mn);var mo=class extends lC{constructor(a){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:+this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,a&&(this.GRID_UNIT=a),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=+this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=+this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(a){super.setFontConstants_(a),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(a){super.setDynamicProperties_(a),this.SELECTED_GLOW_COLOUR=a.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;let b=Number(a.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=b&&!isNaN(b)?b:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=a.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(a=Number(a.getComponentStyle("replacementGlowSize")))&&!isNaN(a)?a:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&a2(this.selectedGlowFilter),this.replacementGlowFilter&&a2(this.replacementGlowFilter)}makeStartHat(){let a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH,c=eP("c",[eO(25,-a),eO(71,-a),eO(b,0)]);return{height:.75*a,width:b,path:c}}makeHexagonal(){function a(a,c,d){var e=a/2;return eS(-(d=d?-1:1)*(e=e>b?b:e),a=(c?-1:1)*a/2)+eS(d*e,a)}let b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:a=>(a/=2)>b?b:a,height:a=>a,connectionOffsetY:a=>a/2,connectionOffsetX:a=>-a,pathDown:b=>a(b,!1,!1),pathUp:b=>a(b,!0,!1),pathRightDown:b=>a(b,!1,!0),pathRightUp:b=>a(b,!1,!0)}}makeRounded(){function a(a,b,d){let e=a>c?a-c:0,f=d===b?"0":"1";return eV("a","0 0,"+f,a=(a>c?c:a)/2,eO((d?1:-1)*a,(b?-1:1)*a))+eU("v",(b?-1:1)*e)+eV("a","0 0,"+f,a,eO((d?-1:1)*a,(b?-1:1)*a))}let b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,c=2*b;return{type:this.SHAPES.ROUND,isDynamic:!0,width:a=>(a/=2)>b?b:a,height:a=>a,connectionOffsetY:a=>a/2,connectionOffsetX:a=>-a,pathDown:b=>a(b,!1,!1),pathUp:b=>a(b,!0,!1),pathRightDown:b=>a(b,!1,!0),pathRightUp:b=>a(b,!1,!0)}}makeSquared(){function a(a,c,d){a-=2*b;let e=d===c?"0":"1";return eV("a","0 0,"+e,b,eO((d?1:-1)*b,(c?-1:1)*b))+eU("v",(c?-1:1)*a)+eV("a","0 0,"+e,b,eO((d?-1:1)*b,(c?-1:1)*b))}let b=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:a=>b,height:a=>a,connectionOffsetY:a=>a/2,connectionOffsetX:a=>-a,pathDown:b=>a(b,!1,!1),pathUp:b=>a(b,!0,!1),pathRightDown:b=>a(b,!1,!0),pathRightUp:b=>a(b,!1,!0)}}shapeFor(a){let b=a.getCheck();switch(!b&&a.targetConnection&&(b=a.targetConnection.getCheck()),a.type){case mU.INPUT_VALUE:case mU.OUTPUT_VALUE:if(null!==(a=a.getSourceBlock().getOutputShape()))switch(a){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}if(b&&b.includes("Boolean"))return this.HEXAGONAL;if(b&&b.includes("Number"))return this.ROUNDED;return b&&b.includes("String"),this.ROUNDED;case mU.PREVIOUS_STATEMENT:case mU.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function a(a){return eP("c",[eO(a*e/2,0),eO(a*e*3/4,g/2),eO(a*e,g)])+eT([eO(a*e,f)])+eP("c",[eO(a*e/4,g/2),eO(a*e/2,g),eO(a*e,g)])+eU("h",a*d)+eP("c",[eO(a*e/2,0),eO(a*e*3/4,-(g/2)),eO(a*e,-g)])+eT([eO(a*e,-f)])+eP("c",[eO(a*e/4,-(g/2)),eO(a*e/2,-g),eO(a*e,-g)])}let b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=b/3,e=d/3,f=c/2,g=f/2,h=a(1),i=a(-1);return{type:this.SHAPES.NOTCH,width:b,height:c,pathLeft:h,pathRight:i}}makeInsideCorners(){let a=this.CORNER_RADIUS,b=eV("a","0 0,0",a,eO(-a,a)),c=eV("a","0 0,1",a,eO(-a,a)),d=eV("a","0 0,0",a,eO(a,a)),e=eV("a","0 0,1",a,eO(a,a));return{width:a,height:a,pathTop:b,pathBottom:d,rightWidth:a,rightHeight:a,pathTopRight:c,pathBottomRight:e}}generateSecondaryColour_(a){return dQ("#000",a,.15)||a}generateTertiaryColour_(a){return dQ("#000",a,.25)||a}createDom(a,b,c,d){super.createDom(a,b,c,d),a=aZ(ha.DEFS,{},a),b=aZ(ha.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},a),aZ(ha.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},b),c=aZ(ha.FECOMPONENTTRANSFER,{result:"outBlur"},b),aZ(ha.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},c),aZ(ha.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},b),aZ(ha.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},b),this.selectedGlowFilterId=b.id,this.selectedGlowFilter=b,a=aZ(ha.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},a),aZ(ha.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},a),b=aZ(ha.FECOMPONENTTRANSFER,{result:"outBlur"},a),aZ(ha.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},b),aZ(ha.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},a),aZ(ha.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},a),aZ(ha.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},a),this.replacementGlowFilterId=a.id,this.replacementGlowFilter=a,d&&(d.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),d.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(a){return[`${a} .blocklyText,`,`${a} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${a} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${a} .blocklyText {`,"fill: #fff;","}",`${a} .blocklyNonEditableField>rect:not(.blocklyDropdownRect),`,`${a} .blocklyEditableField>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${a} .blocklyNonEditableField>text,`,`${a} .blocklyEditableField>text,`,`${a} .blocklyNonEditableField>g>text,`,`${a} .blocklyEditableField>g>text {`,"fill: #575E75;","}",`${a} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${a} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${a} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>rect,",`${a} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${a} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${a} .blocklyDropdownText {`,"fill: #fff !important;","}",`${a}.blocklyWidgetDiv .blocklyMenuItem,`,`${a}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${a}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${a} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${a} .blocklyDisabledPattern > .blocklyOutlinePath {`,"fill: var(--blocklyDisabledPattern)","}",`${a} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",`${a} .blocklySelected>.blocklyPath.blocklyPathSelected {`,"fill: none;","filter: var(--blocklySelectedGlowFilter);","}",`${a} .blocklyReplaceable>.blocklyPath {`,"filter: var(--blocklyReplacementGlowFilter);","}"]}},mp=class extends lE{constructor(a,b){super(a,b)}draw(){let a=this.block_.pathObject;a.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),a.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&a.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(a.outputShapeType=this.info_.outputConnection.shape.type),a.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(a){if(!(a.height<=0)){if(lg.isSpacer(a)){let d=a.precedesStatement;var b=a.followsStatement;if(d||b){let e=this.constants_.INSIDE_CORNERS;var c=e.rightHeight;c=a.height-(d?c:0),b=b?e.pathBottomRight:"",a=c>0?eU("V",a.yPos+c):"",this.outlinePath_+=b+a+(d?e.pathTopRight:"");return}}this.outlinePath_+=eU("V",a.yPos+a.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){let a=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=eR(a.xPos,this.info_.startY),this.outlinePath_+=eU("h",a.width)}drawFlatBottom_(){let a=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=eU("V",a.baseline),this.outlinePath_+=eU("h",-a.width)}drawInlineInput_(a){this.positionInlineInputConnection_(a);let b=a.input.name;a.connectedBlock||this.info_.isInsertionMarker||(a=eQ(a.xPos+a.connectionWidth,a.centerline-a.height/2)+this.getInlineInputPath(a),this.block_.pathObject.setOutlinePath(b,a))}getInlineInputPath(a){let b=a.width-2*a.connectionWidth,c=a.height;return eU("h",b)+a.shape.pathRightDown(c)+eU("h",-b)+a.shape.pathUp(c)+"z"}drawStatementInput_(a){var b=a.getLastInput();let c=b.xPos+b.notchOffset+b.shape.width,d=this.constants_.INSIDE_CORNERS,e=b.shape.pathRight+eU("h",-(b.notchOffset-d.width))+d.pathTop,f=a.height-2*d.height;b=d.pathBottom+eU("h",b.notchOffset-d.width)+(b.connectedBottomNextConnection?"":b.shape.pathLeft),this.outlinePath_+=eU("H",c)+e+eU("v",f)+b+eU("H",a.xPos+a.width),this.positionStatementInputConnection_(a)}drawConnectionHighlightPath(a){let b,c,d=a.connectionModel;if(d.type===mU.NEXT_STATEMENT||d.type===mU.PREVIOUS_STATEMENT||d.type===mU.OUTPUT_VALUE&&!a.isDynamicShape)return super.drawConnectionHighlightPath(a);a=d.type===mU.INPUT_VALUE?eQ(a.connectionWidth,-a.height/2)+this.getInlineInputPath(a):eQ(a.width,-a.height/2)+a.shape.pathDown(a.height);let e=d.getSourceBlock();return null==(c=(b=e.pathObject).addConnectionHighlight)?void 0:c.call(b,d,a,d.getOffsetInBlock(),e.RTL)}},mq=class extends jm{constructor(a,b,c,d,e,f,g){if(super(jm.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",c=Number(dU(c)),b=Number(dU(b)),isNaN(c)||isNaN(b))throw Error("Height and width values of an image field must cast to numbers.");if(c<=0||b<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new hc(b,c+mq.Y_PADDING),this.imageHeight=c,"function"==typeof e&&(this.clickHandler=e),a!==jm.SKIP_SETUP&&(g?this.configure_(g):(this.flipRtl=!!f,this.altText=dU(d)||""),this.setValue(dU(a)))}configure_(a){super.configure_(a),a.flipRtl&&(this.flipRtl=a.flipRtl),a.alt&&(this.altText=dU(a.alt))}initView(){this.imageElement=aZ(ha.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(gF,"xlink:href",this.value_),this.fieldGroup_&&a$(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(a){return"string"!=typeof a?null:a}doValueUpdate_(a){this.value_=a,this.imageElement&&this.imageElement.setAttributeNS(gF,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(a){a!==this.altText&&(this.altText=a||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(a){this.clickHandler=a}getText_(){return this.altText}static fromJson(a){if(!a.src||!a.width||!a.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(a.src,a.width,a.height,void 0,void 0,void 0,a)}};mq.Y_PADDING=1,eD("field_image",mq),mq.prototype.DEFAULT_VALUE="";var mr=class extends jm{set size_(a){super.size_=a}get size_(){let a=super.size_;return a.width<14&&(a.width=14),a}constructor(a,b,c){super(jm.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,a!==jm.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){super.configure_(a),void 0!==a.spellcheck&&(this.spellcheck_=a.spellcheck)}initView(){if(!this.getSourceBlock())throw new jn;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&a$(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){let a,b=this.getSourceBlock();if(!b)throw new jn;return this.fullBlockClickTarget_=!(null==(a=this.getConstants())||!a.FULL_BLOCK_FIELDS)&&b.isSimpleReporter()}doValueInvalid_(a,b=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,a=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&aU()&&this.value_!==a&&b&&aP(new(aX(gB.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,a,this.value_)))}doValueUpdate_(a){this.isTextValid_=this.isDirty_=!0,this.value_=a}applyColour(){let a=this.getSourceBlock();if(!a)throw new jn;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",a.getColourTertiary())):(this.borderRect_.style.display="none",a.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let a;return(null==(a=this.getConstants())?0:a.FULL_BLOCK_FIELDS)&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var a=this.htmlInput_;this.isTextValid_?(a0(a,"blocklyInvalidInput"),b2(a,iF.INVALID,!1)):(a$(a,"blocklyInvalidInput"),b2(a,iF.INVALID,!0))}if(!(a=this.getSourceBlock()))throw new jn;this.getConstants().FULL_BLOCK_FIELDS&&a.applyColour()}setSpellcheck(a){a!==this.spellcheck_&&(this.spellcheck_=a,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(a,b=!1,c=!0){this.workspace_=this.sourceBlock_.workspace,!b&&this.workspace_.options.modalInputs&&(gA||gw||gx)?this.showPromptEditor():this.showInlineEditor(b,c)}showPromptEditor(){cf(B.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),a=>{null!==a&&this.setValue(this.getValueFromEditorText_(a)),this.onFinishEditing_(this.value_)})}showInlineEditor(a,b){let c=this.getSourceBlock();if(!c)throw new jn;dY(this,c.RTL,this.widgetDispose_.bind(this),this.workspace_,b),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,a||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var a=this.getSourceBlock();if(!a)throw new jn;B.setGroup$$module$build$src$core$events$utils(!0);let b=dW();var c=this.getClickTarget_();if(!c)throw Error("A click target has not been set.");a$(c,"blocklyEditing"),(c=document.createElement("input")).className="blocklyHtmlInput",c.setAttribute("spellcheck",this.spellcheck_);let d=this.workspace_.getAbsoluteScale();var e=this.getConstants().FIELD_TEXT_FONTSIZE*d+"pt";return b.style.fontSize=e,c.style.fontSize=e,e=mr.BORDERRADIUS*d+"px",this.isFullBlockField()&&(e=((e=this.getScaledBBox()).bottom-e.top)/2+"px",a=a.getParent()?a.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),c.style.border=+d+"px solid "+a,b.style.borderRadius=e,b.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(b.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*d+"px")),c.style.borderRadius=e,b.appendChild(c),c.value=c.defaultValue=this.getEditorText_(this.value_),c.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(c),c}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&aU()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(aP(new(aX(gB.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),B.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var a=dW().style;if(a.width="auto",a.height="auto",a.fontSize="",a.transition="",a.boxShadow="",this.htmlInput_=null,!(a=this.getClickTarget_()))throw Error("A click target has not been set.");a0(a,"blocklyEditing")}onFinishEditing_(a){}bindInputEvents_(a){this.onKeyDownWrapper=ax(a,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=ax(a,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(az(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(az(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(a){if("Enter"===a.key)d_(this),dj();else if("Escape"===a.key)this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),d_(this),dj();else if("Tab"===a.key){a.preventDefault();var b,c=null==(b=this.workspace_)?void 0:b.getCursor();b=a=>(a instanceof mr||a instanceof kE&&a.isSimpleReporter())&&a!==this.getSourceBlock(),(a=(a=a.shiftKey?null==c?void 0:c.getPreviousNode(this,b,!1):null==c?void 0:c.getNextNode(this,b,!1))instanceof kE&&a.isSimpleReporter()?a.getFields().next().value:a)instanceof mr&&(d_(this),dj(),c=a.getSourceBlock(),a.isFullBlockField()&&c&&c instanceof kE?B.getFocusManager$$module$build$src$core$focus_manager().focusNode(c):B.getFocusManager$$module$build$src$core$focus_manager().focusNode(a),a.showEditor())}}onHtmlInputChange(a){a=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&aU()&&this.value_!==a&&aP(new(aX(gB.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,a,this.value_))}setEditorValue_(a,b=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(a)),this.setValue(a,b)}resizeEditor_(){b5().then(()=>{let a=this.getSourceBlock();if(!a)throw new jn;let b=dW(),c=this.getScaledBBox();b.style.width=c.right-c.left+"px",b.style.height=c.bottom-c.top+"px";let d=c.top;b.style.left=`${a.RTL?c.right-b.offsetWidth:c.left}px`,b.style.top=`${d}px`})}repositionForWindowResize(){let a,b=null==(a=this.getSourceBlock())?void 0:a.getRootBlock();return b instanceof kE&&(e7(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),b)||this.resizeEditor_(),!0)}positionTextElement_(a,b){let c=2*a+b;super.positionTextElement_(a+(c<14?(14-c)/2:0),b)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(a){return`${a}`}getValueFromEditorText_(a){return a}};mr.BORDERRADIUS=4,B.FieldTextInput$$module$build$src$core$field_textinput=class extends mr{constructor(a,b,c){super(a,b,c)}initView(){super.initView(),this.fieldGroup_&&a$(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(a){return void 0===a?null:`${a}`}static fromJson(a){return new this(dU(a.text),void 0,a)}},eD("field_input",B.FieldTextInput$$module$build$src$core$field_textinput),B.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",B.FieldTextInput$$module$build$src$core$field_textinput;var ms=class extends lj{constructor(a){super(a)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(a){return!!a.outputConnection}hasRightSquareCorner(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection}},mt=class extends lA{constructor(a,b){if(super(a,b),this.connectedBottomNextConnection=!1,this.connectedBlock){for(a=this.connectedBlock;b=a.getNextBlock();)a=b;a.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},mu=class extends lh{constructor(a){super(a),this.width=this.height=0,this.type|=lg.getType("RIGHT_CONNECTION")}},mv=class extends lB{constructor(a){super(a)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(a){let b=(a.hat?"cap"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection;return!!a.outputConnection||b}hasRightSquareCorner(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection}},mw=class extends lF{constructor(a,b){super(a,b),this.isInline=!0,this.renderer_=a,this.constants_=this.renderer_.getConstants(),this.topRow=new mv(this.constants_),this.bottomRow=new ms(this.constants_),this.isMultiRow=!b.getInputsInline()||b.isCollapsed(),this.hasStatementInput=b.statementInputCount>0,this.rightSide=this.outputConnection?new mu(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(a,b){return!!b&&(b instanceof ks||a instanceof kt||b instanceof kt||(a instanceof B.ValueInput$$module$build$src$core$inputs$value_input||a instanceof kr||a instanceof ks)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(a){return a.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(a)}getInRowSpacing_(a,b){return a&&b||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!a&&b&&lg.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:a&&lg.isLeftRoundedCorner(a)&&b&&(lg.isPreviousConnection(b)||lg.isNextConnection(b))?b.notchOffset-this.constants_.CORNER_RADIUS:a&&lg.isLeftSquareCorner(a)&&b&&lg.isHat(b)||a&&lg.isField(a)&&0===a.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(a,b){if(lg.isTopRow(a)&&lg.isBottomRow(b))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;let c=lg.isInputRow(a)&&a.hasStatement,d=lg.isInputRow(b)&&b.hasStatement;return d||c?(a=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),d&&c?Math.max(a,this.constants_.DUMMY_INPUT_MIN_HEIGHT):a):lg.isTopRow(a)?a.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):lg.isBottomRow(b)?this.outputConnection?!b.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(a,b){let c=this.width-this.startX;return lg.isInputRow(a)&&a.hasStatement||lg.isInputRow(b)&&b.hasStatement?Math.max(c,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):c}getElemCenterline_(a,b){if(a.hasStatement&&!lg.isSpacer(b)&&!lg.isStatementInput(b))return a.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(lg.isInlineInput(b)){let c=b.connectedBlock;if(c&&c.outputConnection&&c.nextConnection)return a.yPos+c.height/2}return super.getElemCenterline_(a,b)}addInput_(a,b){if((a instanceof kr||a instanceof ks)&&b.hasDummyInput&&b.align===B.Align$$module$build$src$core$inputs$align.LEFT&&a.align===B.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(b,a);else if(a instanceof kt){b.elements.push(new mt(this.constants_,a)),b.hasStatement=!0,null===b.align&&(b.align=a.align);return}super.addInput_(a,b)}addAlignmentPadding_(a,b){if(this.rightAlignedDummyInputs.get(a)){let c;for(let b=0;b<a.elements.length;b++){let d=a.elements[b];if(lg.isSpacer(d)&&(c=d),lg.isField(d)&&d.parentInput===this.rightAlignedDummyInputs.get(a))break}if(c){c.width+=b,a.width+=b;return}}super.addAlignmentPadding_(a,b)}adjustXPosition_(){let a=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,b=a;for(let e=2;e<this.rows.length-1;e+=2){var c=this.rows[e-1];let f=this.rows[e];var d=this.rows[e+1];if(c=2===e?!!this.topRow.hasPreviousConnection:!!c.followsStatement,d=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!d.precedesStatement,lg.isInputRow(f)&&f.hasStatement){let c,d;f.measure(),b=f.width-(null!=(d=null==(c=f.getLastInput())?void 0:c.width)?d:0)+a}else if(c&&(2===e||d)&&lg.isInputRow(f)&&!f.hasStatement){d=f.xPos,c=null;for(let a=0;a<f.elements.length;a++){let e=f.elements[a];lg.isSpacer(e)&&(c=e),!(c&&(lg.isField(e)||lg.isInput(e))&&d<b)||lg.isField(e)&&(e.field instanceof kj||e.field instanceof mq)||(c.width+=b-d),d+=e.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var a=this.outputConnection.shape;if("isDynamic"in a&&a.isDynamic){for(var b=0,c=0;c<this.rows.length;c++){let a=this.rows[c];a.yPos=b,b+=a.height}this.height=b,c=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,b=a.height(c),c=a.width(c),this.outputConnection.height=b,this.outputConnection.width=c,this.outputConnection.startX=c,this.outputConnection.connectionOffsetY=a.connectionOffsetY(b),this.outputConnection.connectionOffsetX=a.connectionOffsetX(c),a=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(a=c,this.rightSide.height=b,this.rightSide.width=a,this.rightSide.centerline=b/2,this.rightSide.xPos=this.width+a),this.startX=c,this.width+=c+a,this.widthWithChildren+=c+a}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var a=0,b=0;b<this.rows.length;b++){var c=this.rows[b];if(!lg.isInputRow(c))continue;a=c.elements[c.elements.length-2];let d=this.getNegativeSpacing_(c.elements[1]),e=this.getNegativeSpacing_(a);a=d+e;let f=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-a<f&&(d=(a=this.width-f)/2,e=a/2),c.elements.unshift(new lq(this.constants_,-d)),c.elements.push(new lq(this.constants_,-e))}if(a)for(this.width-=a,this.widthWithChildren-=a,this.rightSide.xPos-=a,b=0;b<this.rows.length;b++)c=this.rows[b],lg.isTopOrBottomRow(c)&&(c.elements[1].width-=a),c.width-=a,c.widthWithConnectedBlocks-=a}}getNegativeSpacing_(a){if(!a||!this.outputConnection)return 0;let b=this.outputConnection.width;var c=this.outputConnection.shape.type;let d=this.constants_;if(this.inputRows.length>1)if(c===d.SHAPES.ROUND)return c=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,b-(c=this.height/2>c?c:this.height/2)*(1-Math.sin(Math.acos((c-this.constants_.SMALL_PADDING)/c)));else return 0;if(lg.isInlineInput(a)){let e=a.connectedBlock;return null==(a=e?e.pathObject.outputShapeType:a.shape.type)||e&&e.outputConnection&&(e.statementInputCount||e.nextConnection)||c===d.SHAPES.HEXAGONAL&&c!==a?0:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][a]}return lg.isField(a)?c===d.SHAPES.ROUND&&a.field instanceof B.FieldTextInput$$module$build$src$core$field_textinput?b-2.75*d.GRID_UNIT:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][0]:lg.isIcon(a)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let d=2;d<this.rows.length-1;d+=2){let e=this.rows[d-1],f=this.rows[d],g=this.rows[d+1];var a=2===d,b=d+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!g.precedesStatement;if(a?this.topRow.hasPreviousConnection:e.followsStatement){var c=f.elements[1];if(c=3===f.elements.length&&c instanceof ln&&(c.field instanceof kj||c.field instanceof mq),!a&&c)e.height-=this.constants_.SMALL_PADDING,g.height-=this.constants_.SMALL_PADDING,f.height-=this.constants_.MEDIUM_PADDING;else if(a||b){if(b){for(b=0,a=!1;b<f.elements.length;b++)if(c=f.elements[b],lg.isInlineInput(c)&&c.connectedBlock&&!c.connectedBlock.isShadow()&&c.connectedBlock.getHeightWidth().height>=40){a=!0;break}a&&(e.height-=this.constants_.SMALL_PADDING,g.height-=this.constants_.SMALL_PADDING)}}else e.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},mx=class extends lG{constructor(a,b,c){super(a,b,c),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=c}setPath(a){super.setPath(a),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",a)}applyColour(a){super.applyColour(a);let b=a.getParent();for(let c of(a.isShadow()&&b&&this.svgPath.setAttribute("stroke",b.getColourTertiary()),this.outlines.values()))c.setAttribute("fill",this.style.colourTertiary)}flipRTL(){for(let a of(super.flipRTL(),this.outlines.values()))a.setAttribute("transform","scale(-1 1)")}updateSelected(a){this.setClass_("blocklySelected",a),a?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),a0(this.svgPathSelected,gM.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),a0(this.svgPathSelected,gM.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(a){this.setClass_("blocklyReplaceable",a)}updateShapeForInputHighlight(a,b){a=a.getParentInput().name,(a=this.getOutlinePath(a))&&(b?a.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):a.removeAttribute("filter"))}beginDrawing(){for(let a of(this.remainingOutlines.clear(),this.outlines.keys()))this.remainingOutlines.add(a)}endDrawing(){if(this.remainingOutlines.size)for(let a of this.remainingOutlines)this.removeOutlinePath(a);this.remainingOutlines.clear()}setOutlinePath(a,b){(a=this.getOutlinePath(a)).setAttribute("d",b),a.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(a){return this.outlines.has(a)||this.outlines.set(a,aZ(ha.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(a),this.outlines.get(a)}removeOutlinePath(a){let b,c;null==(b=this.outlines.get(a))||null==(c=b.parentNode)||c.removeChild(this.outlines.get(a)),this.outlines.delete(a)}},my=class extends lH{constructor(a){super(a)}makeConstants_(){return new mo}makeRenderInfo_(a){return new mw(this,a)}makeDrawer_(a,b){return new mp(a,b)}makePathObject(a,b){return new mx(a,b,this.getConstants())}getConstants(){return this.constants_}};fy("zelos",my);var mz=class{constructor(a){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=a.workspace}previewReplacement(a,b,c){B.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=c,c.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(b)&&(b.highlight(),this.staticConn=b)}finally{B.enable$$module$build$src$core$events$utils()}}previewConnection(a,b){if(a!==this.draggedConn||b!==this.staticConn){B.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(a,b)&&(this.markerConn=this.previewMarker(a,b)),this.workspace.getRenderer().shouldHighlightConnection(b)&&b.highlight(),this.draggedConn=a,this.staticConn=b}finally{B.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(a,b){return b.type===mU.PREVIOUS_STATEMENT||b.type===mU.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof my)}previewMarker(a,b){let c=a.getSourceBlock(),d=this.createInsertionMarker(c),e=this.getMatchingConnection(c,d,a);if(!e)return null;d.queueRender(),b6(),e.connect(b);let f={x:b.x-e.x,y:b.y-e.y},g=e.getOffsetInBlock().clone();return b5().then(()=>{if(!d.isDeadOrDying()){B.disable$$module$build$src$core$events$utils();try{null==d||d.positionNearConnection(e,f,g),null==d||d.getSvgRoot().setAttribute("visibility","visible")}finally{B.enable$$module$build$src$core$events$utils()}}}),e}serializeBlockToInsertionMarker(a){let b=cE(a,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!b)throw Error(`Failed to serialize source block. ${a.toDevString()}`);return b}createInsertionMarker(a){for(let b of(a=cN(a=this.serializeBlockToInsertionMarker(a),this.workspace)).getDescendants(!1))b.setInsertionMarker(!0);return a.initSvg(),a.getSvgRoot().setAttribute("visibility","hidden"),a}getMatchingConnection(a,b,c){if(a=a.getConnections_(!0),b=b.getConnections_(!0),a.length!==b.length)return null;for(let d=0;d<a.length;d++)if(a[d]===c)return b[d];return null}hidePreview(){B.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{B.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(a){let b,c=a.getSourceBlock(),d=c.outputConnection;if((null==(b=c.previousConnection)?0:b.targetConnection)||(null==d?0:d.targetConnection))c.unplug(!0);else{let b;null==(b=a.targetBlock())||b.unplug(!1)}c.dispose()}dispose(){this.hidePreview()}};ai(F.CONNECTION_PREVIEWER,E,mz);var mA={};mA.Align=B.Align$$module$build$src$core$inputs$align,mA.DummyInput=kr,mA.EndRowInput=ks,mA.Input=kq,mA.StatementInput=kt,mA.ValueInput=B.ValueInput$$module$build$src$core$inputs$value_input,mA.inputTypes=B.inputTypes$$module$build$src$core$inputs$input_types;var mB=!1;B.CodeGenerator$$module$build$src$core$generator=class{constructor(a){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=a,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(a){a||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),a=bh());var b=[];this.init(a),a=a.getTopBlocks(!0);for(let c=0,d;d=a[c];c++){let a=this.blockToCode(d);Array.isArray(a)&&(a=a[0]),a&&(d.outputConnection&&(a=this.scrubNakedValue(a),this.STATEMENT_PREFIX&&!d.suppressPrefixSuffix&&(a=this.injectId(this.STATEMENT_PREFIX,d)+a),this.STATEMENT_SUFFIX&&!d.suppressPrefixSuffix&&(a+=this.injectId(this.STATEMENT_SUFFIX,d))),b.push(a))}return b=b.join("\n"),(b=(b=(b=this.finish(b)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(a,b){return b+a.replace(/(?!\n$)\n/g,"\n"+b)}allNestedComments(a){let b=[];a=a.getDescendants(!0);for(let c=0;c<a.length;c++){let d=a[c].getCommentText();d&&b.push(d)}return b.length&&b.push(""),b.join("\n")}blockToCode(a,b){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!a)return"";if(!a.isEnabled())return b?"":this.blockToCode(a.getNextBlock());if(a.isInsertionMarker())return b?"":this.blockToCode(a.getChildren(!1)[0]);var c=this.forBlock[a.type];if("function"!=typeof c)throw Error(`${this.name_} generator does not know how to generate code for block type "${a.type}".`);if(Array.isArray(c=c.call(a,a,this))){if(!a.outputConnection)throw TypeError("Expecting string from statement block: "+a.type);return[this.scrub_(a,c[0],b),c[1]]}if("string"==typeof c)return this.STATEMENT_PREFIX&&!a.suppressPrefixSuffix&&(c=this.injectId(this.STATEMENT_PREFIX,a)+c),this.STATEMENT_SUFFIX&&!a.suppressPrefixSuffix&&(c+=this.injectId(this.STATEMENT_SUFFIX,a)),this.scrub_(a,c,b);if(null===c)return"";throw SyntaxError("Invalid code generated: "+c)}valueToCode(a,b,c){if(isNaN(c))throw TypeError("Expecting valid order from block: "+a.type);var d=a.getInputTargetBlock(b);if(!d&&!a.getInput(b))throw ReferenceError(`Input "${b}" doesn't exist on "${a.type}"`);if(!d||""===(b=this.blockToCode(d)))return"";if(!Array.isArray(b))throw TypeError(`Expecting tuple from value block: ${d.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(a=b[0],isNaN(b=b[1]))throw TypeError("Expecting valid order from value block: "+d.type);if(!a)return"";d=!1;var e=Math.floor(c);let f=Math.floor(b);if(e<=f&&(e!==f||0!==e&&99!==e)){for(d=!0,e=0;e<this.ORDER_OVERRIDES.length;e++)if(this.ORDER_OVERRIDES[e][0]===c&&this.ORDER_OVERRIDES[e][1]===b){d=!1;break}}return d&&(a="("+a+")"),a}statementToCode(a,b){let c=a.getInputTargetBlock(b);if(!c&&!a.getInput(b))throw ReferenceError(`Input "${b}" doesn't exist on "${a.type}"`);if("string"!=typeof(a=this.blockToCode(c)))throw TypeError("Expecting code from statement block: "+(c&&c.type));return a&&(a=this.prefixLines(a,this.INDENT)),a}addLoopTrap(a,b){return this.INFINITE_LOOP_TRAP&&(a=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,b),this.INDENT)+a),this.STATEMENT_SUFFIX&&!b.suppressPrefixSuffix&&(a=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,b),this.INDENT)+a),this.STATEMENT_PREFIX&&!b.suppressPrefixSuffix&&(a+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,b),this.INDENT)),a}injectId(a,b){return b=b.id.replace(/\$/g,"$$$$"),a.replace(/%1/g,"'"+b+"'")}addReservedWords(a){this.RESERVED_WORDS_+=a+","}provideFunction_(a,b){if(!this.definitions_[a]){let c,d=this.nameDB_.getDistinctName(a,B.NameType$$module$build$src$core$names.PROCEDURE);for(this.functionNames_[a]=d,Array.isArray(b)&&(b=b.join("\n")),b=b.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,d);c!==b;)c=b,b=b.replace(/^(( {2})*) {2}/gm,"$1\0");b=b.replace(/\0/g,this.INDENT),this.definitions_[a]=b}return this.functionNames_[a]}getVariableName(a){return this.getName(a,B.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(a){return this.getName(a,B.NameType$$module$build$src$core$names.PROCEDURE)}getName(a,b){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(a,b)}init(a){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(a,b,c){return b}finish(a){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),a}scrubNakedValue(a){return a}},B.CodeGenerator$$module$build$src$core$generator;var mC=class extends k3{constructor(a){super(a)}setMetrics_(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics(),"number"==typeof a.y&&(this.workspace_.scrollY=-(c.top+(c.height-d.height)*a.y)),this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top)}}getX(){if(!this.isVisible())return 0;var a=this.targetWorkspace.getMetricsManager();let b=a.getAbsoluteMetrics(),c=a.getViewMetrics();return a=a.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===ht.LEFT?a.width:c.width-this.getWidth():this.toolboxPosition_===ht.LEFT?0:c.width:this.toolboxPosition_===ht.LEFT?0:c.width+b.left-this.getWidth()}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=a.height;var b=this.getWidth()-this.CORNER_RADIUS;this.setBackgroundPath(b,a.height-2*this.CORNER_RADIUS),a=this.getX(),b=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),a,b)}}setBackgroundPath(a,b){let c=this.toolboxPosition_===ht.RIGHT;var d=a+this.CORNER_RADIUS;(d=["M "+(c?d:0)+",0"]).push("h",c?-a:a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,+!c,c?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("v",Math.max(0,b)),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,+!c,c?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("h",c?a:-a),d.push("z"),this.svgBackground_.setAttribute("d",d.join(" "))}scrollToStart(){let a;null==(a=this.workspace_.scrollbar)||a.setY(0)}wheel_(a){var b=aD(a);if(b.y){let a,c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();b=c.getViewMetrics().top-d.top+b.y,null==(a=this.workspace_.scrollbar)||a.setY(b),d0(this.workspace_),dj()}a.preventDefault(),a.stopPropagation()}layout_(a){this.workspace_.scale=this.targetWorkspace.scale;var b=this.MARGIN;let c=this.RTL?b:b+this.tabWidth_;for(let d of a)d.getElement().moveBy(c,b),b+=d.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(a){a=Math.atan2(a.y,a.x)/Math.PI*180;let b=this.dragAngleRange_;return a<b&&a>-b||a<-180+b||a>180-b}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;let a=this.svgGroup_.getBoundingClientRect(),b=a.left;return this.toolboxPosition_===ht.LEFT?new hb(-1e9,1e9,-1e9,b+a.width):new hb(-1e9,1e9,b,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let a=this.getContents().reduce((a,b)=>Math.max(a,b.getElement().getBoundingRectangle().getWidth()),0);if(a+=1.5*this.MARGIN+this.tabWidth_,a*=this.workspace_.scale,a+=hi.scrollbarThickness,this.getWidth()!==a){if(this.RTL)for(let b of this.getContents()){let c=b.getElement().getBoundingRectangle().left,d=a/this.workspace_.scale-b.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;b.getElement().moveBy(d-c,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==ht.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+a,this.targetWorkspace.scrollY),this.width_=a,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};mC.registryName="verticalFlyout",ai(F.FLYOUTS_VERTICAL_TOOLBOX,E,mC);var mD=class extends k3{constructor(a){super(a),this.horizontalLayout=!0}setMetrics_(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics(),"number"==typeof a.x&&(this.workspace_.scrollX=-(c.left+(c.width-d.width)*a.x)),this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var a=this.targetWorkspace.getMetricsManager();let b=a.getAbsoluteMetrics(),c=a.getViewMetrics();a=a.getToolboxMetrics();let d=this.toolboxPosition_===ht.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?d?a.height:c.height-this.getHeight():d?0:c.height:d?0:c.height+b.top-this.getHeight()}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=a.width,a=a.width-2*this.CORNER_RADIUS;var b=this.getHeight()-this.CORNER_RADIUS;this.setBackgroundPath(a,b),a=this.getX(),b=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),a,b)}}setBackgroundPath(a,b){let c=this.toolboxPosition_===ht.TOP,d=["M 0,"+(c?0:this.CORNER_RADIUS)];c?(d.push("h",a+2*this.CORNER_RADIUS),d.push("v",b),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("h",-a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),d.push("h",a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("v",b),d.push("h",-a-2*this.CORNER_RADIUS)),d.push("z"),this.svgBackground_.setAttribute("d",d.join(" "))}scrollToStart(){let a;null==(a=this.workspace_.scrollbar)||a.setX(this.RTL?1/0:0)}wheel_(a){var b=aD(a);if(b=b.x||b.y){let a,c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();b=c.getViewMetrics().left-d.left+b,null==(a=this.workspace_.scrollbar)||a.setX(b),d0(this.workspace_),dj()}a.preventDefault(),a.stopPropagation()}layout_(a){this.workspace_.scale=this.targetWorkspace.scale;let b=this.MARGIN,c=b+this.tabWidth_;for(let d of(this.RTL&&(a=a.reverse()),a))a=d.getElement().getBoundingRectangle(),a=this.RTL?c+a.getWidth():c,d.getElement().moveBy(a,b),c+=d.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(a){a=Math.atan2(a.y,a.x)/Math.PI*180;let b=this.dragAngleRange_;return a<90+b&&a>90-b||a>-90-b&&a<-90+b}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;let a=this.svgGroup_.getBoundingClientRect(),b=a.top;return this.toolboxPosition_===ht.TOP?new hb(-1e9,b+a.height,-1e9,1e9):new hb(b,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let a=this.getContents().reduce((a,b)=>Math.max(a,b.getElement().getBoundingRectangle().getHeight()),0);a+=1.5*this.MARGIN,a*=this.workspace_.scale,a+=hi.scrollbarThickness,this.getHeight()!==a&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==ht.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+a),this.height_=a,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}};ai(F.FLYOUTS_HORIZONTAL_TOOLBOX,E,mD);var mE=class extends jZ{constructor(a,b,c,d,e){super(jm.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=mE.dropdownCreate,this.defaultVariableName="string"==typeof a?a:"",this.size_=new hc(0,0),a!==jm.SKIP_SETUP&&(e?this.configure_(e):this.setTypes(c,d),b&&this.setValidator(b))}configure_(a){super.configure_(a),this.setTypes(a.variableTypes,a.defaultType)}initModel(){var a=this.getSourceBlock();if(!a)throw new jn;this.variable||(a=B.getOrCreateVariablePackage$$module$build$src$core$variables(a.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(a.getId()))}initView(){super.initView(),a$(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){let a=this.getSourceBlock();if(!a)throw new jn;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==a.type)}fromXml(a){var b=this.getSourceBlock();if(!b)throw new jn;let c=a.getAttribute("id"),d=a.textContent,e=a.getAttribute("variabletype")||a.getAttribute("variableType")||"";if(b=B.getOrCreateVariablePackage$$module$build$src$core$variables(b.workspace,c,d,e),null!==e&&e!==b.getType())throw Error("Serialized variable type with id '"+b.getId()+"' had type "+b.getType()+", and does not match variable field that references it: "+eo(a)+".");this.setValue(b.getId())}toXml(a){return this.initModel(),a.id=this.variable.getId(),a.textContent=this.variable.getName(),this.variable.getType()&&a.setAttribute("variabletype",this.variable.getType()),a}saveState(a){var b=this.saveLegacyState(mE);return null!==b||(this.initModel(),b={id:this.variable.getId()},a&&(b.name=this.variable.getName(),b.type=this.variable.getType())),b}loadState(a){let b=this.getSourceBlock();if(!b)throw new jn;this.loadLegacyState(mE,a)||(a=B.getOrCreateVariablePackage$$module$build$src$core$variables(b.workspace,a.id||null,a.name,a.type||""),this.setValue(a.getId()))}setSourceBlock(a){if(a.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(a)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(a){if(null===a)return null;var b=this.getSourceBlock();if(!b)throw new jn;return(b=B.getVariable$$module$build$src$core$variables(b.workspace,a))?(b=b.getType(),this.typeIsAllowed(b)?a:(console.warn("Variable type doesn't match this field!  Type was "+b),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+a),null)}doValueUpdate_(a){let b=this.getSourceBlock();if(!b)throw new jn;this.variable=B.getVariable$$module$build$src$core$variables(b.workspace,a),super.doValueUpdate_(a)}typeIsAllowed(a){let b=this.getVariableTypes();if(!b)return!0;for(let c=0;c<b.length;c++)if(a===b[c])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let a=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){let b=this.sourceBlock_.workspace.getPotentialVariableMap();if(!b)return a;a=Array.from(new Set([...a,...b.getTypes()]))}return a}setTypes(a=null,b=""){var c=this.getText();if(Array.isArray(a)){if(0===a.length)throw Error(`'variableTypes' of field variable ${c} was an empty list. If you want to include all variable types, pass 'null' instead.`);c=!1;for(let d=0;d<a.length;d++)a[d]===b&&(c=!0);if(!c)throw Error("Invalid default type '"+b+"' in the definition of a FieldVariable")}else if(null!==a)throw Error(`'variableTypes' was not an array or null in the definition of FieldVariable ${c}`);this.defaultType=b,this.variableTypes=a}refreshVariableName(){this.forceRerender()}onItemSelected_(a,b){if(a=b.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(a===kl&&this.variable)return void B.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(a===km&&this.variable){a=this.variable.getWorkspace(),B.deleteVariable$$module$build$src$core$variables(a,this.variable,this.sourceBlock_);return}}this.setValue(a)}referencesVariables(){return!0}static fromJson(a){return new this(dU(a.variable),void 0,void 0,void 0,a)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");let a=this.getText(),b=[];var c=this.getSourceBlock();if(c&&!c.isDeadOrDying()){c=c.workspace;let a=this.getVariableTypes();for(let f=0;f<a.length;f++){let g=a[f],h=c.getVariableMap().getVariablesOfType(g);if(b=b.concat(h),c.isFlyout){var d=void 0,e=void 0;b=b.concat(null!=(e=null==(d=c.getPotentialVariableMap())?void 0:d.getVariablesOfType(g))?e:[])}}}for(b.sort(cC),d=[],e=0;e<b.length;e++)d[e]=[b[e].getName(),b[e].getId()];return d.push([B.Msg$$module$build$src$core$msg.RENAME_VARIABLE,kl]),B.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&d.push([B.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",a),km]),d}};eD("field_variable",mE);var mF=class extends mr{constructor(a,b,c,d,e,f){super(jm.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,a!==jm.SKIP_SETUP&&(f?this.configure_(f):this.setConstraints(b,c,d),this.setValue(a),e&&this.setValidator(e))}configure_(a){super.configure_(a),this.setMinInternal(a.min),this.setMaxInternal(a.max),this.setPrecisionInternal(a.precision)}setConstraints(a,b,c){this.setMinInternal(a),this.setMaxInternal(b),this.setPrecisionInternal(c),this.setValue(this.getValue())}setMin(a){this.setMinInternal(a),this.setValue(this.getValue())}setMinInternal(a){null==a?this.min_=-1/0:isNaN(a=Number(a))||(this.min_=a)}getMin(){return this.min_}setMax(a){this.setMaxInternal(a),this.setValue(this.getValue())}setMaxInternal(a){null==a?this.max_=1/0:isNaN(a=Number(a))||(this.max_=a)}getMax(){return this.max_}setPrecision(a){this.setPrecisionInternal(a),this.setValue(this.getValue())}setPrecisionInternal(a){this.precision_=Number(a)||0;let b=String(this.precision_);b.includes("e")&&(b=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));let c=b.indexOf(".");this.decimalPlaces=-1===c?a?0:null:b.length-c-1}getPrecision(){return this.precision_}doClassValidation_(a){return null===a||isNaN(a=Number((a=(a=(a=`${a}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"))||0))?null:(a=Math.min(Math.max(a,this.min_),this.max_),this.precision_&&isFinite(a)&&(a=Math.round(a/this.precision_)*this.precision_),null!==this.decimalPlaces&&(a=Number(a.toFixed(this.decimalPlaces))),a)}widgetCreate_(){let a=super.widgetCreate_();return this.min_>-1/0&&(a.min=`${this.min_}`,b2(a,iF.VALUEMIN,this.min_)),this.max_<1/0&&(a.max=`${this.max_}`,b2(a,iF.VALUEMAX,this.max_)),a}initView(){super.initView(),this.fieldGroup_&&a$(this.fieldGroup_,"blocklyNumberField")}static fromJson(a){return new this(a.value,void 0,void 0,void 0,void 0,a)}};eD("field_number",mF),mF.prototype.DEFAULT_VALUE=0;var mG=class extends kj{constructor(a,b,c){super(String(null!=a?a:""),b,c),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(a){return new this(dU(a.text),void 0,a)}};eD("field_label_serializable",mG);var mH=class extends jm{constructor(a,b,c){super(jm.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=mH.CHECK_CHAR,a!==jm.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b))}configure_(a){super.configure_(a),a.checkCharacter&&(this.checkChar=a.checkCharacter)}saveState(){let a=this.saveLegacyState(mH);return null!==a?a:this.getValueBoolean()}initView(){super.initView();let a=this.getTextElement();a$(this.fieldGroup_,"blocklyCheckboxField"),a.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(a){this.checkChar=a||mH.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(a){return!0===a||"TRUE"===a?"TRUE":!1===a||"FALSE"===a?"FALSE":null}doValueUpdate_(a){this.value_=this.convertValueToBool(a),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(a){return"string"==typeof a?"TRUE"===a:!!a}static fromJson(a){return new this(a.checked,void 0,a)}};mH.CHECK_CHAR="",eD("field_checkbox",mH),mH.prototype.DEFAULT_VALUE=!1;var mI=class{constructor(a,b){this.draggable=a,this.workspace=b,this.dragTarget=null,this.startLoc=a.getRelativeToSurfaceXY()}onDragStart(a){B.getGroup$$module$build$src$core$events$utils()||B.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(a)}onDrag(a,b){this.moveDraggable(a,b),fb(b=this.getRoot(this.draggable))&&b.setDeleteStyle(this.wouldDeleteDraggable(a,b)),this.updateDragTarget(a)}updateDragTarget(a){a=this.workspace.getDragTarget(a);let b=this.getRoot(this.draggable);if(this.dragTarget!==a){let c;null==(c=this.dragTarget)||c.onDragExit(b),null==a||a.onDragEnter(b)}null==a||a.onDragOver(b),this.dragTarget=a}moveDraggable(a,b){b=this.pixelsToWorkspaceUnits(b),b=g9.sum(this.startLoc,b),this.draggable.drag(b,a)}wouldDeleteDraggable(a,b){return!!((a=this.workspace.getDragTarget(a))&&this.workspace.getComponentManager().hasCapability(a.id,g3.Capability.DELETE_AREA))&&a.wouldDelete(b)}onDragEnd(a){let b=B.getGroup$$module$build$src$core$events$utils();var c=this.workspace.getDragTarget(a);let d=this.getRoot(this.draggable);if(c){let a;null==(a=this.dragTarget)||a.onDrop(d)}this.shouldReturnToStart(a,d)&&this.draggable.revertDrag(),(c=fb(d)&&this.wouldDeleteDraggable(a,d))&&this.draggable instanceof kE&&e$(this.draggable.getRootBlock()),this.draggable.endDrag(a),c&&fb(d)&&(B.setGroup$$module$build$src$core$events$utils(b),d.dispose()),B.setGroup$$module$build$src$core$events$utils(!1),!c&&ba(this.draggable)&&B.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(a){return a instanceof kE?a.getRootBlock():a}shouldReturnToStart(a,b){return!!(a=this.workspace.getDragTarget(a))&&a.shouldPreventMove(b)}pixelsToWorkspaceUnits(a){return a=new g9(a.x/this.workspace.scale,a.y/this.workspace.scale),this.workspace.isMutator&&a.scale(1/this.workspace.options.parentWorkspace.scale),a}};ai(F.BLOCK_DRAGGER,E,mI);var mJ={};mJ.BlockDragStrategy=kB,mJ.BubbleDragStrategy=j4,mJ.CommentDragStrategy=jF,mJ.Dragger=mI;var mK=class extends g${constructor(a,b,c){super(a?a.workspace.id:void 0),this.type=gB.BLOCK_DRAG,a&&(this.blockId=a.id,this.isStart=b,this.blocks=c)}toJson(){let a=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return a.isStart=this.isStart,a.blockId=this.blockId,a.blocks=this.blocks,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new mK)).isStart=a.isStart,b.blockId=a.blockId,b.blocks=a.blocks,b}};ai(F.EVENT,gB.BLOCK_DRAG,mK);var mL=class extends iy{constructor(a,b,c,d){super(a),this.type=gB.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,a&&(this.name=b,this.oldValue=c,this.newValue=d)}toJson(){let a=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return a.name=this.name,a.oldValue=this.oldValue,a.newValue=this.newValue,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new mL)).name=a.name,b.oldValue=a.oldValue,b.newValue=a.newValue,b}isNull(){return this.oldValue===this.newValue}run(a){var b=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(b=b.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");a=a?this.newValue:this.oldValue,(b=b.getField(this.name))?b.setValue(a):console.warn("Can't set non-existent field: "+this.name)}};ai(F.EVENT,gB.BLOCK_FIELD_INTERMEDIATE_CHANGE,mL);var mM=class extends iy{constructor(a){super(a),this.type=gB.BLOCK_MOVE,a&&(a.isShadow()&&(this.recordUndo=!1),a=this.currentLocation(),this.oldParentId=a.parentId,this.oldInputName=a.inputName,this.oldCoordinate=a.coordinate)}toJson(){let a=super.toJson();return a.oldParentId=this.oldParentId,a.oldInputName=this.oldInputName,this.oldCoordinate&&(a.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),a.newParentId=this.newParentId,a.newInputName=this.newInputName,this.newCoordinate&&(a.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(a.reason=this.reason),this.recordUndo||(a.recordUndo=this.recordUndo),a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new mM)).oldParentId=a.oldParentId,b.oldInputName=a.oldInputName,a.oldCoordinate&&(c=a.oldCoordinate.split(","),b.oldCoordinate=new g9(Number(c[0]),Number(c[1]))),b.newParentId=a.newParentId,b.newInputName=a.newInputName,a.newCoordinate&&(c=a.newCoordinate.split(","),b.newCoordinate=new g9(Number(c[0]),Number(c[1]))),void 0!==a.reason&&(b.reason=a.reason),void 0!==a.recordUndo&&(b.recordUndo=a.recordUndo),b}recordNew(){let a=this.currentLocation();this.newParentId=a.parentId,this.newInputName=a.inputName,this.newCoordinate=a.coordinate}setReason(a){this.reason=a}currentLocation(){var a=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var b=a.getBlockById(this.blockId);if(!b)throw Error("The block associated with the block move event could not be found");a={};let c=b.getParent();return c?(a.parentId=c.id,(b=c.getInputWithBlock(b))&&(a.inputName=b.name)):a.coordinate=b.getRelativeToSurfaceXY(),a}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&g9.equals(this.oldCoordinate,this.newCoordinate)}run(a){var b=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var c=b.getBlockById(this.blockId);if(c){var d=a?this.newParentId:this.oldParentId,e=a?this.newInputName:this.oldInputName;if(a=a?this.newCoordinate:this.oldCoordinate,d){var f=b.getBlockById(d);if(!f)return void console.warn("Can't connect to non-existent block: "+d)}if(c.getParent()&&c.unplug(),a)e=c.getRelativeToSurfaceXY(),c.moveBy(a.x-e.x,a.y-e.y,this.reason);else{let a,d;(!(b=c.outputConnection)||c.previousConnection&&c.previousConnection.isConnected())&&(b=c.previousConnection),c=null==(d=b)?void 0:d.type,e?(c=f.getInput(e))&&(a=c.connection):c===mU.PREVIOUS_STATEMENT&&(a=f.nextConnection),a&&b?b.connect(a):console.warn("Can't connect to non-existent input: "+e)}}else console.warn("Can't move non-existent block: "+this.blockId)}};ai(F.EVENT,gB.BLOCK_MOVE,mM);var mN,mO,mP,mQ,mR,mS,mT,mU,mV,mW,mX,mY,mZ=class extends g${constructor(a,b,c){super(a?a.workspace.id:void 0),this.type=gB.BUBBLE_OPEN,a&&(this.blockId=a.id,this.isOpen=b,this.bubbleType=c)}toJson(){let a=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return a.isOpen=this.isOpen,a.bubbleType=this.bubbleType,a.blockId=this.blockId||"",a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new mZ)).isOpen=a.isOpen,b.bubbleType=a.bubbleType,b.blockId=a.blockId,b}};(b=mY||(mY={})).MUTATOR="mutator",b.COMMENT="comment",b.WARNING="warning",ai(F.EVENT,gB.BUBBLE_OPEN,mZ);var m$={};m$.BubbleOpen=mZ,m$.BubbleType=mY;var m_=class extends gZ{constructor(a){super(),this.isBlank=!a,a&&(this.commentId=a.id,this.workspaceId=a.workspace.id,this.group=B.getGroup$$module$build$src$core$events$utils(),this.recordUndo=aO())}toJson(){let a=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return a.commentId=this.commentId,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m_)).commentId=a.commentId,b}static CommentCreateDeleteHelper(a,b){let c=a.getEventWorkspace_();if(b){if(!a.json)throw Error("Encountered a comment event without proper json");bZ(a.json,c)}else{if(!a.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(b=c.getCommentById(a.commentId))?b.dispose():console.warn("Can't delete non-existent comment: "+a.commentId)}}},m0=class extends m_{constructor(a,b,c){super(a),this.type=gB.COMMENT_CHANGE,a&&(this.oldContents_=void 0===b?"":b,this.newContents_=void 0===c?"":c)}toJson(){let a=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return a.oldContents=this.oldContents_,a.newContents=this.newContents_,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m0)).oldContents_=a.oldContents,b.newContents_=a.newContents,b}isNull(){return this.oldContents_===this.newContents_}run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(b=b.getCommentById(this.commentId)){var c=a?this.newContents_:this.oldContents_;if(void 0===c){if(a)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}b.setText(c)}else console.warn("Can't change non-existent comment: "+this.commentId)}};ai(F.EVENT,gB.COMMENT_CHANGE,m0);var m1=class extends m_{constructor(a,b){super(a),this.newCollapsed=b,this.type=gB.COMMENT_COLLAPSE}toJson(){let a=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return a.newCollapsed=this.newCollapsed,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m1)).newCollapsed=a.newCollapsed,b}run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(b=b.getCommentById(this.commentId))?b.setCollapsed(a?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};ai(F.EVENT,gB.COMMENT_COLLAPSE,m1);var m2=class extends m_{constructor(a){super(a),this.type=gB.COMMENT_CREATE,a&&(this.xml=eh(a),this.json=bY(a,{addCoordinates:!0}))}toJson(){let a=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return a.xml=eo(this.xml),a.json=this.json,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m2)).xml=B.textToDom$$module$build$src$core$utils$xml(a.xml),b.json=a.json,b}run(a){m_.CommentCreateDeleteHelper(this,a)}};ai(F.EVENT,gB.COMMENT_CREATE,m2);var m3=class extends m_{constructor(a){super(a),this.type=gB.COMMENT_DELETE,a&&(this.xml=eh(a),this.json=bY(a,{addCoordinates:!0}))}run(a){m_.CommentCreateDeleteHelper(this,!a)}toJson(){let a=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return a.xml=eo(this.xml),a.json=this.json,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m3)).xml=B.textToDom$$module$build$src$core$utils$xml(a.xml),b.json=a.json,b}};ai(F.EVENT,gB.COMMENT_DELETE,m3);var m4=class extends g${constructor(a,b){super(a?a.workspace.id:void 0),this.type=gB.COMMENT_DRAG,a&&(this.commentId=a.id,this.isStart=b)}toJson(){let a=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return a.isStart=this.isStart,a.commentId=this.commentId,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m4)).isStart=a.isStart,b.commentId=a.commentId,b}};ai(F.EVENT,gB.COMMENT_DRAG,m4);var m5=class extends m_{constructor(a){super(a),this.type=gB.COMMENT_MOVE,a&&(this.comment_=a,this.oldCoordinate_=a.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(a){this.reason=a}setOldCoordinate(a){this.oldCoordinate_=a}toJson(){let a=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return a.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,a.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),a}static fromJson(a,b,c){return b=super.fromJson(a,b,null!=c?c:new m5),c=a.oldCoordinate.split(","),b.oldCoordinate_=new g9(Number(c[0]),Number(c[1])),c=a.newCoordinate.split(","),b.newCoordinate_=new g9(Number(c[0]),Number(c[1])),b}isNull(){return g9.equals(this.oldCoordinate_,this.newCoordinate_)}run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(b=b.getCommentById(this.commentId)){if(!(a=a?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");b.moveTo(a)}else console.warn("Can't move non-existent comment: "+this.commentId)}};ai(F.EVENT,gB.COMMENT_MOVE,m5);var m6=class extends m_{constructor(a){super(a),this.type=gB.COMMENT_RESIZE,a&&(this.oldSize=a.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var a=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(a=a.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=a.getSize()}toJson(){let a=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return a.oldWidth=Math.round(this.oldSize.width),a.oldHeight=Math.round(this.oldSize.height),a.newWidth=Math.round(this.newSize.width),a.newHeight=Math.round(this.newSize.height),a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m6)).oldSize=new hc(a.oldWidth,a.oldHeight),b.newSize=new hc(a.newWidth,a.newHeight),b}isNull(){return hc.equals(this.oldSize,this.newSize)}run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(b=b.getCommentById(this.commentId)){if(!(a=a?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");b.setSize(a)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};ai(F.EVENT,gB.COMMENT_RESIZE,m6);var m7=class extends g${constructor(a,b,c){super(c),this.type=gB.TOOLBOX_ITEM_SELECT,this.oldItem=null!=a?a:void 0,this.newItem=null!=b?b:void 0}toJson(){let a=super.toJson();return a.oldItem=this.oldItem,a.newItem=this.newItem,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m7)).oldItem=a.oldItem,b.newItem=a.newItem,b}};ai(F.EVENT,gB.TOOLBOX_ITEM_SELECT,m7);var m8=class extends lR{constructor(a,b,c){super(a),this.oldType=b,this.newType=c,this.type=gB.VAR_TYPE_CHANGE}toJson(){let a=super.toJson();if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");return a.oldType=this.oldType,a.newType=this.newType,a}static fromJson(a,b,c){return(b=super.fromJson(a,b,null!=c?c:new m8)).oldType=a.oldType,b.newType=a.newType,b}run(a){let b=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");let c=b.getVariableMap().getVariableById(this.varId);c&&(a?b.getVariableMap().changeVariableType(c,this.newType):b.getVariableMap().changeVariableType(c,this.oldType))}};ai(F.EVENT,gB.VAR_TYPE_CHANGE,m8);var m9=class extends gZ{constructor(a){super(),this.isBlank=!0,this.recordUndo=!1,this.type=gB.FINISHED_LOADING,this.isBlank=!!a,a&&(this.workspaceId=a.id)}};ai(F.EVENT,gB.FINISHED_LOADING,m9),B.BLOCK_CHANGE$$module$build$src$core$events$events=gB.BLOCK_CHANGE,B.BLOCK_CREATE$$module$build$src$core$events$events=gB.BLOCK_CREATE,B.BLOCK_DELETE$$module$build$src$core$events$events=gB.BLOCK_DELETE,c=gB.BLOCK_DRAG,B.BLOCK_MOVE$$module$build$src$core$events$events=gB.BLOCK_MOVE,d=gB.BLOCK_FIELD_INTERMEDIATE_CHANGE,e=gB.BUBBLE_OPEN,f=gB.BLOCK_CHANGE,g=gB.CLICK,h=gB.COMMENT_CHANGE,i=gB.COMMENT_CREATE,j=gB.COMMENT_DELETE,k=gB.COMMENT_MOVE,l=gB.COMMENT_RESIZE,m=gB.COMMENT_DRAG,n=gB.BLOCK_CREATE,o=gB.BLOCK_DELETE,p=gB.FINISHED_LOADING,q=gB.BLOCK_MOVE,r=gB.SELECTED,s=gB.THEME_CHANGE,t=gB.TOOLBOX_ITEM_SELECT,u=gB.TRASHCAN_OPEN,v=gB.UI,w=gB.VAR_CREATE,x=gB.VAR_DELETE,y=gB.VAR_RENAME,z=gB.VIEWPORT_CHANGE,(A={}).Abstract=gZ,A.BLOCK_CHANGE=B.BLOCK_CHANGE$$module$build$src$core$events$events,A.BLOCK_CREATE=B.BLOCK_CREATE$$module$build$src$core$events$events,A.BLOCK_DELETE=B.BLOCK_DELETE$$module$build$src$core$events$events,A.BLOCK_DRAG=c,A.BLOCK_FIELD_INTERMEDIATE_CHANGE=d,A.BLOCK_MOVE=B.BLOCK_MOVE$$module$build$src$core$events$events,A.BUBBLE_OPEN=e,A.BUMP_EVENTS=W,A.BlockBase=iy,A.BlockChange=iz,A.BlockCreate=jT,A.BlockDelete=kf,A.BlockDrag=mK,A.BlockFieldIntermediateChange=mL,A.BlockMove=mM,A.BubbleOpen=mZ,A.BubbleType=mY,A.CHANGE=f,A.CLICK=g,A.COMMENT_CHANGE=h,A.COMMENT_CREATE=i,A.COMMENT_DELETE=j,A.COMMENT_DRAG=m,A.COMMENT_MOVE=k,A.COMMENT_RESIZE=l,A.CREATE=n,A.Click=g_,A.ClickTarget=gY,A.CommentBase=m_,A.CommentChange=m0,A.CommentCollapse=m1,A.CommentCreate=m2,A.CommentDelete=m3,A.CommentDrag=m4,A.CommentMove=m5,A.CommentResize=m6,A.DELETE=o,A.FINISHED_LOADING=p,A.FinishedLoading=m9,A.MOVE=q,A.SELECTED=r,A.Selected=ke,A.THEME_CHANGE=s,A.TOOLBOX_ITEM_SELECT=t,A.TRASHCAN_OPEN=u,A.ThemeChange=jV,A.ToolboxItemSelect=m7,A.TrashcanOpen=lX,A.UI=v,A.UiBase=g$,A.VAR_CREATE=w,A.VAR_DELETE=x,A.VAR_RENAME=y,A.VIEWPORT_CHANGE=z,A.VarBase=lR,A.VarCreate=lS,A.VarDelete=lU,A.VarRename=lV,A.VarTypeChange=m8,A.ViewportChange=jW,A.clearPendingUndo=aT,A.disable=B.disable$$module$build$src$core$events$utils,A.disableOrphans=aY,A.enable=B.enable$$module$build$src$core$events$utils,A.filter=aS,A.fire=aP,A.fromJson=aW,A.get=aX,A.getDescendantIds=aV,A.getGroup=B.getGroup$$module$build$src$core$events$utils,A.getRecordUndo=aO,A.isEnabled=aU,A.setGroup=B.setGroup$$module$build$src$core$events$utils,A.setRecordUndo=B.setRecordUndo$$module$build$src$core$events$utils;var na={};na.BottomRow=ms,na.ConstantProvider=mo,na.Drawer=mp,na.PathObject=mx,na.RenderInfo=mw,na.Renderer=my,na.RightConnectionShape=mu,na.StatementInput=mt,na.TopRow=mv,gq();var nb={};nb.registerCleanup=f6,nb.registerCollapse=f8,nb.registerCollapseExpandBlock=gi,nb.registerComment=gg,nb.registerCommentCreate=go,nb.registerCommentDelete=gm,nb.registerCommentDuplicate=gn,nb.registerCommentOptions=function(){gn(),gm(),go()},nb.registerDefaultOptions=gq,nb.registerDelete=gk,nb.registerDeleteAll=gd,nb.registerDisable=gj,nb.registerDuplicate=gf,nb.registerExpand=f9,nb.registerHelp=gl,nb.registerInline=gh,nb.registerRedo=f5,nb.registerUndo=f4;var nc="button",nd=class{load(a,b){return(a=new kK(b.getWorkspace(),b.targetWorkspace,a,!1)).show(),new kH(a,nc)}gapForItem(a,b){return b}disposeItem(a){(a=a.getElement())instanceof kK&&a.dispose()}getType(){return nc}};ai(F.FLYOUT_INFLATER,nc,nd);var ne={};ne.Bubble=j5,ne.MiniWorkspaceBubble=j6,ne.TextBubble=kC,ne.TextInputBubble=kc;var nf="block",ng=class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(a,b){return this.setFlyout(b),(a=this.createBlock(a,b.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(a):this.permanentlyDisabledBlocks.add(a),a.getDescendants(!1).forEach(a=>a.isInFlyout=!0),this.addBlockListeners(a),new kH(a,nf)}createBlock(a,b){return a.blockxml?(a="string"==typeof a.blockxml?B.textToDom$$module$build$src$core$utils$xml(a.blockxml):a.blockxml,b=eq(a,b)):(void 0===a.enabled&&(a.enabled="true"!==a.disabled&&!0!==a.disabled),void 0===a.disabledReasons&&!1===a.enabled&&(a.disabledReasons=[hW]),"x"in a&&delete a.x,"y"in a&&delete a.y,b=cO(a,b)),b}gapForItem(a,b){let c;return a.gap?c=parseInt(String(a.gap)):a.blockxml&&(c=parseInt((a="string"==typeof a.blockxml?B.textToDom$$module$build$src$core$utils$xml(a.blockxml):a.blockxml).getAttribute("gap"))),!c||isNaN(c)?b:c}disposeItem(a){(a=a.getElement())instanceof kE&&(this.removeListeners(a.id),a.dispose(!1,!1))}removeListeners(a){let b;(null!=(b=this.listeners.get(a))?b:[]).forEach(a=>az(a)),this.listeners.delete(a)}setFlyout(a){if(this.flyout!==a){var b;if(this.flyout){let a;null==(a=this.flyout.targetWorkspace)||a.removeChangeListener(this.capacityWrapper)}this.flyout=a,null==(b=this.flyout.targetWorkspace)||b.addChangeListener(this.capacityWrapper)}}updateStateBasedOnCapacity(a){let b,c,d=null==(b=this.flyout)||null==(c=b.targetWorkspace)?void 0:c.isCapacityAvailable(bo(a));for(;a;)a.setDisabledReason(!d,"WORKSPACE_AT_BLOCK_CAPACITY"),a=a.getNextBlock()}addBlockListeners(a){let b=[];b.push(ax(a.getSvgRoot(),"pointerdown",a,b=>{let c,d,e=null==(c=this.flyout)||null==(d=c.targetWorkspace)?void 0:d.getGesture(b);e&&this.flyout&&(e.setStartBlock(a),e.handleFlyoutStart(b,this.flyout))})),b.push(ay(a.getSvgRoot(),"pointermove",null,()=>{let b,c;(null==(b=this.flyout)||null==(c=b.targetWorkspace)?0:c.isDragging())||a.addSelect()})),b.push(ay(a.getSvgRoot(),"pointerleave",null,()=>{let b,c;(null==(b=this.flyout)||null==(c=b.targetWorkspace)?0:c.isDragging())||a.removeSelect()})),this.listeners.set(a.id,b)}filterFlyoutBasedOnCapacity(a){!this.flyout||a&&a.type!==gB.BLOCK_CREATE&&a.type!==gB.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(a=>{this.permanentlyDisabledBlocks.has(a)||this.updateStateBasedOnCapacity(a)})}getType(){return nf}};ai(F.FLYOUT_INFLATER,nf,ng);var nh=class extends lC{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(a){return super.getCSS_(a).concat([`${a} .blocklyInsertionMarker>.blocklyPathLight,`,`${a} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},ni=class{constructor(a){this.inlineSteps_=this.steps_="",this.info_=a,this.RTL_=this.info_.RTL,a=a.getRenderer(),this.constants_=a.getConstants(),this.highlightConstants_=a.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(a){this.steps_+=eR(a.xPos,this.info_.startY);for(let b=0,c;c=a.elements[b];b++)lg.isLeftSquareCorner(c)?this.steps_+=this.highlightConstants_.START_POINT:lg.isLeftRoundedCorner(c)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):lg.isPreviousConnection(c)?this.steps_+=this.notchPaths_.pathLeft:lg.isHat(c)?this.steps_+=this.startPaths_.path(this.RTL_):lg.isSpacer(c)&&0!==c.width&&(this.steps_+=eU("H",c.xPos+c.width-this.highlightOffset));this.steps_+=eU("H",a.xPos+a.width-this.highlightOffset)}drawJaggedEdge_(a){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+eU("v",a.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(a){let b=a.getLastInput();if(this.RTL_){let c=a.height-b.connectionHeight;this.steps_+=eQ(b.xPos+b.width-this.highlightOffset,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+eU("v",c)}else this.steps_+=eQ(b.xPos+b.width,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(a){let b=a.getLastInput();if(b)if(this.RTL_){let c=a.height-2*this.insideCornerPaths_.height;this.steps_+=eQ(b.xPos,a.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+eU("v",c)+this.insideCornerPaths_.pathBottom(this.RTL_)+eS(a.width-b.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=eQ(b.xPos,a.yPos+a.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+eS(a.width-b.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(a){let b=a.xPos+a.width-this.highlightOffset;a instanceof ly&&a.followsStatement&&(this.steps_+=eU("H",b)),this.RTL_&&(this.steps_+=eU("H",b),a.height>this.highlightOffset&&(this.steps_+=eU("V",a.yPos+a.height-this.highlightOffset)))}drawBottomRow(a){if(this.RTL_)this.steps_+=eU("V",a.baseline-this.highlightOffset);else{let b=this.info_.bottomRow.elements[0];lg.isLeftSquareCorner(b)?this.steps_+=eQ(a.xPos+this.highlightOffset,a.baseline-this.highlightOffset):lg.isLeftRoundedCorner(b)&&(this.steps_+=eQ(a.xPos,a.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var a=this.info_.outputConnection;a&&(a=a.connectionOffsetY+a.height,this.RTL_?this.steps_+=eQ(this.info_.startX,a):(this.steps_+=eQ(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=eU("V",a)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(a=this.info_.topRow,lg.isLeftRoundedCorner(a.elements[0])?this.steps_+=eU("V",this.outsideCornerPaths_.height):this.steps_+=eU("V",a.capline+this.highlightOffset))}drawInlineInput(a){let b=this.highlightOffset,c=a.xPos+a.connectionWidth;var d=a.centerline-a.height/2;let e=a.width-a.connectionWidth,f=d+b;this.RTL_?(d=a.connectionOffsetY-b,a=a.height-(a.connectionOffsetY+a.connectionHeight)+b,this.inlineSteps_+=eQ(c-b,f)+eU("v",d)+this.puzzleTabPaths_.pathDown(this.RTL_)+eU("v",a)+eU("h",e)):this.inlineSteps_+=eQ(a.xPos+a.width+b,f)+eU("v",a.height)+eU("h",-e)+eQ(c,d+a.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},nj=class extends lE{constructor(a,b){super(a,b),this.highlighter_=new ni(b)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();let a=this.block_.pathObject;a.setPath(this.outlinePath_+"\n"+this.inlinePath_),a.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&a.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(a){this.highlighter_.drawJaggedEdge_(a),super.drawJaggedEdge_(a)}drawValueInput_(a){this.highlighter_.drawValueInput(a),super.drawValueInput_(a)}drawStatementInput_(a){this.highlighter_.drawStatementInput(a),super.drawStatementInput_(a)}drawRightSideRow_(a){this.highlighter_.drawRightSideRow(a),this.outlinePath_+=eU("H",a.xPos+a.width)+eU("V",a.yPos+a.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(a){this.highlighter_.drawInlineInput(a),super.drawInlineInput_(a)}positionInlineInputConnection_(a){let b=a.centerline-a.height/2;if(a.connectionModel){let c=a.xPos+a.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1),a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(a){let b=a.getLastInput();if(null==b?0:b.connectionModel){let c=a.xPos+a.statementEdge+b.notchOffset;c=this.info_.RTL?-1*c:c+this.constants_.DARK_PATH_OFFSET,b.connectionModel.setOffsetInBlock(c,a.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(a){let b=a.getLastInput();if(b&&b.connectionModel){let c=a.xPos+a.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1),b.connectionModel.setOffsetInBlock(c,a.yPos)}}positionNextConnection_(){let a=this.info_.bottomRow;if(a.connection){let b=a.connection,c=b.xPos;b.connectionModel.setOffsetInBlock((this.info_.RTL?-c:c)+this.constants_.DARK_PATH_OFFSET/2,a.baseline+this.constants_.DARK_PATH_OFFSET)}}},nk=class{constructor(a){this.OFFSET=.5,this.constantProvider=a,this.START_POINT=eR(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){let a=this.constantProvider.CORNER_RADIUS,b=this.OFFSET,c=(1-Math.SQRT1_2)*(a+b)-b,d=eR(c,c)+eV("a","0 0,0",a,eO(-c-b,a-c)),e=eV("a","0 0,0",a+b,eO(a+b,a+b)),f=eR(c,-c)+eV("a","0 0,0",a+b,eO(a-c,c+b));return{width:a+b,height:a,pathTop:a=>a?d:"",pathBottom:a=>a?e:f}}makeOutsideCorner(){let a=this.constantProvider.CORNER_RADIUS,b=this.OFFSET,c=(1-Math.SQRT1_2)*(a-b)+b,d=eR(c,c)+eV("a","0 0,1",a-b,eO(a-c,-c+b)),e=eR(b,a)+eV("a","0 0,1",a-b,eO(a,-a+b)),f=-c,g=eR(c,f)+eV("a","0 0,1",a-b,eO(-c+b,-f-a));return{height:a,topLeft:a=>a?d:e,bottomLeft:()=>g}}makePuzzleTab(){let a=this.constantProvider.TAB_WIDTH,b=this.constantProvider.TAB_HEIGHT,c=eR(-2,-b+2.5+.9)+eS(-.45*a,-2.1),d=eU("v",2.5)+eR(-(.97*a),2.5)+eP("q",[eO(-(.05*a),10),eO(.3*a,9.5)])+eR(.67*a,-1.9)+eU("v",2.5),e=eU("v",-1.5)+eR(-.92*a,-.5)+eP("q",[eO(-.19*a,-5.5),eO(0,-11)])+eR(.92*a,1),f=eR(-5,b-.7)+eS(.46*a,-2.1);return{width:a,height:b,pathUp:a=>a?c:e,pathDown:a=>a?d:f}}makeNotch(){return{pathLeft:eU("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:eS(5.1,2.6)+eR(-10.2,6.8)+eS(5.1,2.6),height:12,width:10.2}}makeStartHat(){let a=this.constantProvider.START_HAT.height,b=eR(25,-8.7)+eP("c",[eO(29.7,-6.2),eO(57.2,-.5),eO(75,8.7)]),c=eP("c",[eO(17.8,-9.2),eO(45.3,-14.9),eO(75,-8.7)])+eQ(100.5,a+.5);return{path:a=>a?b:c}}},nl=class extends lr{constructor(a,b){super(a,b),this.constants_=a,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},nm=class extends lA{constructor(a,b){super(a,b),this.constants_=a,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},nn=class extends lF{constructor(a,b){super(a,b),this.renderer_=a}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof kt||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(a,b){this.isInline&&a instanceof B.ValueInput$$module$build$src$core$inputs$value_input?(b.elements.push(new nl(this.constants_,a)),b.hasInlineInput=!0):a instanceof kt?(b.elements.push(new nm(this.constants_,a)),b.hasStatement=!0):a instanceof B.ValueInput$$module$build$src$core$inputs$value_input?(b.elements.push(new lm(this.constants_,a)),b.hasExternalInput=!0):(a instanceof kr||a instanceof ks)&&(b.minHeight=Math.max(b.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0),this.isInline||null!==b.align||(b.align=a.align)}addElemSpacing_(){let a=!1;for(let b=0,c;c=this.rows[b];b++)c.hasExternalInput&&(a=!0);for(let c=0,d;d=this.rows[c];c++){var b=d.elements;if(d.elements=[],d.startsWithElemSpacer()&&d.elements.push(new lq(this.constants_,this.getInRowSpacing_(null,b[0]))),b.length){for(let a=0;a<b.length-1;a++){d.elements.push(b[a]);let c=this.getInRowSpacing_(b[a],b[a+1]);d.elements.push(new lq(this.constants_,c))}d.elements.push(b[b.length-1]),d.endsWithElemSpacer()&&(b=this.getInRowSpacing_(b[b.length-1],null),a&&d.hasDummyInput&&(b+=this.constants_.TAB_WIDTH),d.elements.push(new lq(this.constants_,b)))}}}getInRowSpacing_(a,b){if(!a)return b&&lg.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&lg.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&lg.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!lg.isInput(a)&&(!b||lg.isStatementInput(b)))return lg.isField(a)&&a.isEditable?0===a.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:lg.isIcon(a)?2*this.constants_.LARGE_PADDING+1:lg.isHat(a)?this.constants_.NO_PADDING:lg.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:lg.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:lg.isJaggedEdge(a)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(lg.isInput(a)&&!b){if(lg.isExternalInput(a))return this.constants_.NO_PADDING;if(lg.isInlineInput(a))return this.constants_.LARGE_PADDING;if(lg.isStatementInput(a))return this.constants_.NO_PADDING}if(!lg.isInput(a)&&b&&lg.isInput(b)){if(lg.isField(a)&&a.isEditable){if(lg.isInlineInput(b)||lg.isExternalInput(b))return this.constants_.SMALL_PADDING}else{if(lg.isInlineInput(b)||lg.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;if(lg.isStatementInput(b))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(lg.isIcon(a)&&b&&!lg.isInput(b))return this.constants_.LARGE_PADDING;if(lg.isInlineInput(a)&&b&&lg.isField(b))return b.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(lg.isLeftSquareCorner(a)&&b){if(lg.isHat(b))return this.constants_.NO_PADDING;if(lg.isPreviousConnection(b))return b.notchOffset;if(lg.isNextConnection(b))return b.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(lg.isLeftRoundedCorner(a)&&b){if(lg.isPreviousConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS;if(lg.isNextConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return lg.isField(a)&&b&&lg.isField(b)&&a.isEditable===b.isEditable?0===a.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:b&&lg.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(a,b){return lg.isTopRow(a)&&lg.isBottomRow(b)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:lg.isTopRow(a)||lg.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||!a.hasStatement&&b.hasDummyInput||a.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(a,b){if(lg.isSpacer(b))return a.yPos+b.height/2;if(lg.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,lg.isNextConnection(b)?a+b.height/2:a-b.height/2;if(lg.isTopRow(a))return lg.isHat(b)?a.capline-b.height/2:a.capline+b.height/2;let c=a.yPos;return lg.isField(b)||lg.isIcon(b)?(c+=b.height/2,(a.hasInlineInput||a.hasStatement)&&b.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=a.height&&(c+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):c=lg.isInlineInput(b)?c+b.height/2:c+a.height/2,c}alignRowElements_(){if(this.isInline){var a=0,b=new WeakMap,c=null;for(let d=this.rows.length-1,e;e=this.rows[d];d--)b.set(e,a),lg.isInputRow(e)&&(e.hasStatement&&this.alignStatementRow_(e),c&&c.hasStatement&&e.width<c.width?b.set(e,c.width):a=e.hasStatement?e.width:Math.max(a,e.width),c=e);a=0;for(let d=0,e;e=this.rows[d];d++)e.hasStatement?a=this.getDesiredRowWidth_(e):lg.isSpacer(e)?e.width=Math.max(a,b.get(e)):(c=e.width,(a=Math.max(a,b.get(e))-c)>0&&this.addAlignmentPadding_(e,a),a=e.width)}else super.alignRowElements_()}getDesiredRowWidth_(a){return this.isInline&&a.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(a)}finalize_(){let a=0,b=0;for(let d=0,e;e=this.rows[d];d++){e.yPos=b,e.xPos=this.startX,b+=e.height,a=Math.max(a,e.widthWithConnectedBlocks);var c=b-this.topRow.ascenderHeight;e===this.bottomRow&&c<this.constants_.MIN_BLOCK_HEIGHT&&(c=this.constants_.MIN_BLOCK_HEIGHT-c,this.bottomRow.height+=c,b+=c),this.recordElemPositions_(e)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&(a=Math.max(a,c.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=b-this.bottomRow.descenderHeight,this.widthWithChildren=a+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=b+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},no=class extends lG{constructor(a,b,c){super(a,b,c),this.constants=c,this.colourDark="#000000",this.svgPathDark=aZ(ha.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=aZ(ha.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(a){this.svgPath.setAttribute("d",a),this.svgPathDark.setAttribute("d",a)}setHighlightPath(a){this.svgPathLight.setAttribute("d",a)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(a){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(a),this.svgPath.setAttribute("stroke","none")}setStyle(a){this.style=a,this.colourDark=dQ("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(a){super.updateHighlighted(a),this.svgPathLight.style.display=a?"none":"inline"}updateShadow_(a){if(a){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(a){super.updateDisabled_(a),a&&this.svgPath.setAttribute("stroke","none")}},np=class extends lH{constructor(a){super(a),this.highlightConstants=null}init(a,b){super.init(a,b),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(a,b,c){super.refreshDom(a,b,c),this.getHighlightConstants().init()}makeConstants_(){return new nh}makeRenderInfo_(a){return new nn(this,a)}makeDrawer_(a,b){return new nj(a,b)}makePathObject(a,b){return new no(a,b,this.getConstants())}makeHighlightConstants_(){return new nk(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};fy("geras",np);var nq={};nq.ConstantProvider=nh,nq.Drawer=nj,nq.HighlightConstantProvider=nk,nq.Highlighter=ni,nq.InlineInput=nl,nq.PathObject=no,nq.RenderInfo=nn,nq.Renderer=np,nq.StatementInput=nm;var nr=class extends lF{constructor(a,b){super(a,b)}getRenderer(){return this.renderer_}addElemSpacing_(){let a=!1;for(var b=0;b<this.rows.length;b++)if(this.rows[b].hasExternalInput){a=!0;break}for(b=0;b<this.rows.length;b++){let d=this.rows[b];var c=d.elements;if(d.elements=[],d.startsWithElemSpacer()&&d.elements.push(new lq(this.constants_,this.getInRowSpacing_(null,c[0]))),c.length){for(let a=0;a<c.length-1;a++){d.elements.push(c[a]);let b=this.getInRowSpacing_(c[a],c[a+1]);d.elements.push(new lq(this.constants_,b))}d.elements.push(c[c.length-1]),d.endsWithElemSpacer()&&(c=this.getInRowSpacing_(c[c.length-1],null),a&&d.hasDummyInput&&(c+=this.constants_.TAB_WIDTH),d.elements.push(new lq(this.constants_,c)))}}}getInRowSpacing_(a,b){if(!a)return b&&lg.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&lg.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&lg.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!lg.isInput(a)&&!b)return lg.isField(a)&&a.isEditable?0===a.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:lg.isIcon(a)?2*this.constants_.LARGE_PADDING+1:lg.isHat(a)?this.constants_.NO_PADDING:lg.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:lg.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:lg.isJaggedEdge(a)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(lg.isInput(a)&&!b){if(lg.isExternalInput(a))return this.constants_.NO_PADDING;if(lg.isInlineInput(a))return this.constants_.LARGE_PADDING;if(lg.isStatementInput(a))return this.constants_.NO_PADDING}if(!lg.isInput(a)&&b&&lg.isInput(b)){if(lg.isField(a)&&a.isEditable){if(lg.isInlineInput(b)||lg.isExternalInput(b))return this.constants_.SMALL_PADDING}else{if(lg.isInlineInput(b)||lg.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;if(lg.isStatementInput(b))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(lg.isIcon(a)&&b&&!lg.isInput(b))return this.constants_.LARGE_PADDING;if(lg.isInlineInput(a)&&b&&lg.isField(b))return b.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(lg.isLeftSquareCorner(a)&&b){if(lg.isHat(b))return this.constants_.NO_PADDING;if(lg.isPreviousConnection(b)||lg.isNextConnection(b))return b.notchOffset}return lg.isLeftRoundedCorner(a)&&b?b.notchOffset-this.constants_.CORNER_RADIUS:lg.isField(a)&&b&&lg.isField(b)&&a.isEditable===b.isEditable?0===a.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:b&&lg.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(a,b){return lg.isTopRow(a)&&lg.isBottomRow(b)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:lg.isTopRow(a)||lg.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||a.hasDummyInput||b.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(a,b){if(lg.isSpacer(b))return a.yPos+b.height/2;if(lg.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,lg.isNextConnection(b)?a+b.height/2:a-b.height/2;if(lg.isTopRow(a))return lg.isHat(b)?a.capline-b.height/2:a.capline+b.height/2;let c=a.yPos;return lg.isField(b)&&a.hasStatement?c+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+b.height/2):c+a.height/2}finalize_(){let a=0,b=0;for(var c=0;c<this.rows.length;c++){let e=this.rows[c];e.yPos=b,e.xPos=this.startX,b+=e.height,a=Math.max(a,e.widthWithConnectedBlocks);var d=b-this.topRow.ascenderHeight;e===this.bottomRow&&d<this.constants_.MIN_BLOCK_HEIGHT&&(d=this.constants_.MIN_BLOCK_HEIGHT-d,this.bottomRow.height+=d,b+=d),this.recordElemPositions_(e)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&(a=Math.max(a,c.getHeightWidth().width)),this.bottomRow.baseline=b-this.bottomRow.descenderHeight,this.widthWithChildren=a+this.startX,this.height=b,this.startY=this.topRow.capline}},ns=class extends lH{constructor(a){super(a)}makeRenderInfo_(a){return new nr(this,a)}};fy("thrasos",ns);var nt={};nt.RenderInfo=nr,nt.Renderer=ns;var nu=new j1("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),nv=class{constructor(a,b,c){this.id_=a.toolboxitemid||aE(),this.level_=(this.parent_=c||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=a,this.parentToolbox_=b,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(a){}getFocusableElement(){let a=this.getDiv();if(!a)throw Error("Trying to access toolbox item before DOM is initialized.");if(!(a instanceof HTMLElement))throw Error("Toolbox item div is unexpectedly not an HTML element.");return a}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},nw=class extends nv{constructor(a,b,c){super(a,b,c),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(a){if("custom"in a)this.flyoutItems_=a.custom;else if(a=a.contents)for(let b=0;b<a.length;b++){let c=a[b];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(c)}}parseCategoryDef_(a){this.name_="name"in a?dU(a.name):"",this.colour_=this.getColour_(a),Object.assign(this.cssConfig_,a.cssconfig||a.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),b1(this.htmlDiv_,hN.TREEITEM),b2(this.htmlDiv_,iF.SELECTED,!1),b2(this.htmlDiv_,iF.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),b1(this.iconDom_,hN.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);let a=this.labelDom_.getAttribute("id");return a&&b2(this.htmlDiv_,iF.LABELLEDBY,a),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){let a=document.createElement("div");a.tabIndex=-1,a.id=this.getId();let b=this.cssConfig_.container;return b&&a$(a,b),a}createRowContainer_(){let a=document.createElement("div");var b=this.cssConfig_.row;return b&&a$(a,b),b=`${nw.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?a.style.paddingRight=b:a.style.paddingLeft=b,a}createRowContentsContainer_(){let a=document.createElement("div"),b=this.cssConfig_.rowcontentcontainer;return b&&a$(a,b),a}createIconDom_(){let a=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){let b=this.cssConfig_.icon;b&&a$(a,b)}return a.style.display="inline-block",a}createLabelDom_(a){let b=document.createElement("span");return b.setAttribute("id",this.getId()+".label"),b.textContent=a,(a=this.cssConfig_.label)&&a$(b,a),b}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(a){a&&(a=nw.borderWidth+"px solid "+(a||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=a:this.rowDiv_.style.borderLeft=a)}getColour_(a){let b=a.categorystyle||a.categoryStyle;if((a=a.colour)&&b)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(b)return this.getColourfromStyle(b);if(a)return this.parseColour(a)}return""}getColourfromStyle(a){var b=this.workspace_.getTheme();if(a&&b){if((b=b.categoryStyles[a])&&b.colour)return this.parseColour(b.colour);console.warn('Style "'+a+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(a){if(null==(a=dU(a))||""===a)return"";var b=Number(a);return isNaN(b)?(b=dM(a))?b:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+a),""):dR(b)}openIcon_(a){if(a){var b=this.cssConfig_.closedicon;b&&a_(a,b),(b=this.cssConfig_.openicon)&&a$(a,b)}}closeIcon_(a){if(a){var b=this.cssConfig_.openicon;b&&a_(a,b),(b=this.cssConfig_.closedicon)&&a$(a,b)}}setVisible_(a){this.htmlDiv_.style.display=a?"block":"none",this.isHidden_=!a,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let a=this;for(;a.getParent();)if(!(a=a.getParent()).isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(a){}setSelected(a){if(this.rowDiv_){var b=this.cssConfig_.selected;if(a){let a=this.parseColour(nw.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||a,b&&a$(this.rowDiv_,b)}else this.rowDiv_.style.backgroundColor="",b&&a0(this.rowDiv_,b);b2(this.htmlDiv_,iF.SELECTED,a)}}setDisabled(a){this.isDisabled_=a,this.getDiv().setAttribute("disabled",`${a}`),a?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(a){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof a?{kind:this.toolboxItemDef_.kind,custom:a,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:bN(a),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){a2(this.htmlDiv_)}};nw.registrationName="category",nw.nestedPadding=19,nw.borderWidth=8,nw.defaultBackgroundColour="#57e",bt('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),ai(F.TOOLBOX_ITEM,nw.registrationName,nw);var nx=class extends nv{constructor(a,b){super(a,b),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,a.cssconfig||a.cssConfig)}init(){this.createDom_()}createDom_(){let a=document.createElement("div");a.tabIndex=-1,a.id=this.getId();let b=this.cssConfig_.container;return b&&a$(a,b),this.htmlDiv=a}getDiv(){return this.htmlDiv}dispose(){a2(this.htmlDiv)}};nx.registrationName="sep",bt('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),ai(F.TOOLBOX_ITEM,nx.registrationName,nx);var ny=class extends nw{constructor(a,b,c){super(a,b,c),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){let a=super.makeDefaultCssConfig_();return a.contents="blocklyToolboxCategoryGroup",a}parseContents_(a){if("custom"in a)this.flyoutItems_=a.custom;else{let b=a.contents;if(b){this.flyoutItems_=[],a=!0;for(let c=0;c<b.length;c++){let d=b[c];!am(F.TOOLBOX_ITEM,d.kind)||d.kind.toLowerCase()===nx.registrationName&&a?(this.flyoutItems_.push(d),a=!0):(this.createToolboxItem(d),a=!1)}}}}createToolboxItem(a){let b=a.kind;"CATEGORY"===b.toUpperCase()&&bP(a)&&(b=ny.registrationName),a=new(an(F.TOOLBOX_ITEM,b))(a,this.parentToolbox_,this),this.toolboxItems_.push(a)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();let a=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(a),b1(this.subcategoriesDiv_,hN.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),b2(this.htmlDiv_,iF.EXPANDED,!1),this.htmlDiv_}createIconDom_(){let a=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){let b=this.cssConfig_.icon;b&&a$(a,b),a.style.visibility="visible"}return a.style.display="inline-block",a}createSubCategoriesDom_(a){let b=document.createElement("div");b.style.display="none";var c=this.cssConfig_.contents;for(c&&a$(b,c),c=0;c<a.length;c++){let d=a[c];d.init();let e=d.getDiv();if(b.appendChild(e),d.getClickTarget){let a;null==(a=d.getClickTarget())||a.setAttribute("id",d.getId())}}return b}setExpanded(a){if(this.expanded_!==a){if(this.expanded_=a)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let a;null==(a=this.parentToolbox_.getFlyout())||a.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}b2(this.htmlDiv_,iF.EXPANDED,a),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(a){this.htmlDiv_.style.display=a?"block":"none";let b=this.getChildToolboxItems();for(let c=0;c<b.length;c++)b[c].setVisible_(a);this.isHidden_=!a,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(a){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};ny.registrationName="collapsibleCategory",ai(F.TOOLBOX_ITEM,ny.registrationName,ny);var nz=class extends kG{constructor(a){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=a,this.toolboxDef_=a.options.languageTree||{contents:[]},this.horizontalLayout=a.options.horizontalLayout,this.RTL=a.options.RTL,this.toolboxPosition=a.options.toolboxPosition}onShortcut(a){return!1}init(){var a=this.workspace_;let b=a.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_);let c=this.flyout.createDom("svg");a$(c,"blocklyToolboxFlyout"),a3(c,b),this.setVisible(!0),this.flyout.init(a),this.render(this.toolboxDef_),(a=a.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),a.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:g3.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[g3.Capability.AUTOHIDEABLE,g3.Capability.DELETE_AREA,g3.Capability.DRAG_TARGET]}),B.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(a){a=a.getParentSvg();let b=this.createContainer_();return b.id=aE(),this.contentsDiv_=this.createContentsContainer_(),b1(this.contentsDiv_,hN.TREE),b.appendChild(this.contentsDiv_),a.parentNode.insertBefore(b,a),this.attachEvents_(b,this.contentsDiv_),b}createContainer_(){let a=document.createElement("div");return a.setAttribute("layout",this.isHorizontal()?"h":"v"),a$(a,"blocklyToolbox"),a.setAttribute("dir",this.RTL?"RTL":"LTR"),a}createContentsContainer_(){let a=document.createElement("div");return a$(a,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(a.style.flexDirection="row"),a}attachEvents_(a,b){a=ax(a,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(a),b=ax(b,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(b)}onClick_(a){if(aB(a)||a.target===this.HtmlDiv)bh().hideChaff(!1);else{var b=a.target.getAttribute("id");b&&(b=this.getToolboxItemById(b)).isSelectable()&&(this.setSelectedItem(b),b.onClick(a)),bh().hideChaff(!0)}at()}onKeyDown_(a){let b=!1;switch(a.key){case"ArrowDown":b=this.selectNext();break;case"ArrowUp":b=this.selectPrevious();break;case"ArrowLeft":b=this.selectParent();break;case"ArrowRight":b=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),b=!0);break;default:b=!1}!b&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(b=this.selectedItem_.onKeyDown(a)),b&&a.preventDefault()}createFlyout_(){let a=this.workspace_,b=a.copyOptionsForFlyout();return b.toolboxPosition=a.options.toolboxPosition,new(a.horizontalLayout?aq(F.FLYOUTS_HORIZONTAL_TOOLBOX,a.options,!0):aq(F.FLYOUTS_VERTICAL_TOOLBOX,a.options,!0))(b)}render(a){this.toolboxDef_=a,this.contents.forEach(a=>a.dispose()),this.contents.clear(),this.renderContents_(a.contents),this.position(),this.handleToolboxItemResize()}renderContents_(a){let b=document.createDocumentFragment();for(let c=0;c<a.length;c++)this.createToolboxItem(a[c],b);this.contentsDiv_.appendChild(b)}createToolboxItem(a,b){var c=a.kind;"CATEGORY"===c.toUpperCase()&&bP(a)&&(c=ny.registrationName),(c=an(F.TOOLBOX_ITEM,c.toLowerCase()))&&((a=new c(a,this)).init(),this.addToolboxItem_(a),(c=a.getDiv())&&b.appendChild(c),a.getClickTarget()&&a.getClickTarget().setAttribute("id",a.getId()))}addToolboxItem_(a){if(this.contents.set(a.getId(),a),a.isCollapsible()){a=a.getChildToolboxItems();for(let b=0;b<a.length;b++)this.addToolboxItem_(a[b])}}getToolboxItems(){return[...this.contents.values()]}addStyle(a){a&&this.HtmlDiv&&a$(this.HtmlDiv,a)}removeStyle(a){a&&this.HtmlDiv&&a0(this.HtmlDiv,a)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var a=this.HtmlDiv.getBoundingClientRect();let b=a.top,c=b+a.height,d=a.left;return a=d+a.width,this.toolboxPosition===ht.TOP?new hb(-1e7,c,-1e7,1e7):this.toolboxPosition===ht.BOTTOM?new hb(b,1e7,-1e7,1e7):this.toolboxPosition===ht.LEFT?new hb(-1e7,1e7,-1e7,a):new hb(-1e7,1e7,d,1e7)}wouldDelete(a){return a instanceof kE?this.updateWouldDelete_(!a.getParent()&&a.isDeletable()):this.updateWouldDelete_(fb(a)&&a.isDeletable()),this.wouldDelete_}onDragEnter(a){this.updateCursorDeleteStyle_(!0)}onDragExit(a){this.updateCursorDeleteStyle_(!1)}onDrop(a){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(a){a!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=a,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(a){let b=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";a?this.addStyle(b):this.removeStyle(b)}getToolboxItemById(a){return this.contents.get(a)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){let a=this.workspace_.getMetrics(),b=this.HtmlDiv;b&&(this.horizontalLayout?(b.style.left="0",b.style.height="auto",b.style.width="100%",this.height_=b.offsetHeight,this.width_=a.viewWidth,this.toolboxPosition===ht.TOP?b.style.top="0":b.style.bottom="0"):(this.toolboxPosition===ht.RIGHT?b.style.right="0":b.style.left="0",b.style.height="100%",this.width_=b.offsetWidth,this.height_=a.viewHeight),this.flyout.position())}handleToolboxItemResize(){let a=this.workspace_;var b=this.HtmlDiv.getBoundingClientRect();let c=this.getFlyout(),d=this.toolboxPosition===ht.LEFT?a.scrollX+b.width+((null==c?0:c.isVisible())?c.getWidth():0):a.scrollX;b=this.toolboxPosition===ht.TOP?a.scrollY+b.height+((null==c?0:c.isVisible())?c.getHeight():0):a.scrollY,a.translate(d,b),bn(a)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(a=>{a.refreshTheme&&a.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(a){this.isVisible_!==a&&(this.HtmlDiv.style.display=a?"block":"none",this.isVisible_=a,this.workspace_.recordDragTargets())}autoHide(a){!a&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(a){let b=this.selectedItem_;(a||b)&&(!a||a.isSelectable())&&(this.shouldDeselectItem_(b,a)&&null!==b&&this.deselectItem_(b),this.shouldSelectItem_(b,a)&&null!==a&&this.selectItem_(b,a),this.updateFlyout_(b,a),this.fireSelectEvent(b,a))}shouldDeselectItem_(a,b){return null!==a&&(!a.isCollapsible()||a!==b)}shouldSelectItem_(a,b){return null!==b&&b!==a}deselectItem_(a){this.selectedItem_=null,this.previouslySelectedItem_=a,a.setSelected(!1),b2(this.contentsDiv_,iF.ACTIVEDESCENDANT,"")}selectItem_(a,b){this.selectedItem_=b,this.previouslySelectedItem_=a,b.setSelected(!0),b2(this.contentsDiv_,iF.ACTIVEDESCENDANT,b.getId())}selectItemByPosition(a){(a=this.getToolboxItems()[a])&&this.setSelectedItem(a)}updateFlyout_(a,b){b&&(a!==b||b.isCollapsible())&&b.getContents().length?(this.flyout.show(b.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(a,b){let c=a&&a.getName(),d=b&&b.getName();a===b&&(d=null),aP(a=new(aX(gB.TOOLBOX_ITEM_SELECT))(c,d,this.workspace_.id))}selectParent(){return!!this.selectedItem_&&(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):!!(this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable())&&(this.setSelectedItem(this.selectedItem_.getParent()),!0))}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;let a=this.selectedItem_;return a.isExpanded()?this.selectNext():a.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;let a=[...this.contents.values()],b=a.indexOf(this.selectedItem_)+1;if(b>-1&&b<a.length){let c=a[b];for(;c&&!c.isSelectable();)c=a[++b];if(c&&c.isSelectable())return this.setSelectedItem(c),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;let a=[...this.contents.values()],b=a.indexOf(this.selectedItem_)-1;if(b>-1&&b<a.length){let c=a[b];for(;c&&!c.isSelectable();)c=a[--b];if(c&&c.isSelectable())return this.setSelectedItem(c),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(a=>a.dispose());for(let a=0;a<this.boundEvents_.length;a++)az(this.boundEvents_[a]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),a2(this.HtmlDiv)),B.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(!this.HtmlDiv)throw Error("Toolbox DOM has not yet been created.");return this.HtmlDiv}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(a){if(!a||a===this){let a;return null!=(a=this.getToolboxItems().find(a=>a.isSelectable()))?a:null}return null}getNestedTrees(){return[]}lookUpFocusableNode(a){return this.getToolboxItemById(a)}onTreeFocus(a,b){a!==this?this.getSelectedItem()!==a&&this.setSelectedItem(a):this.clearSelection()}onTreeBlur(a){let b;a&&a===(null==(b=this.flyout)?void 0:b.getWorkspace())||this.autoHide(!1)}};bt('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  box-sizing: border-box;\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),ai(F.TOOLBOX,E,nz);var nA=mU.INPUT_VALUE,nB=mU.OUTPUT_VALUE,nC=mU.NEXT_STATEMENT,nD=mU.PREVIOUS_STATEMENT,nE=ht.TOP,nF=ht.BOTTOM,nG=ht.LEFT,nH=ht.RIGHT;lN.prototype.newBlock=function(a,b){return new ku(this,a,b)},lP.prototype.newBlock=function(a,b){return new kE(this,a,b)},lN.prototype.newComment=function(a){return new jQ(this,a)},lP.prototype.newComment=function(a){return new jR(this,a)},lP.newTrashcan=function(a){return new lY(a)},j6.prototype.newWorkspaceSvg=function(a){return new lP(a)},B.Names$$module$build$src$core$names.prototype.populateProcedures=function(a){a=(a=fj(a))[0].concat(a[1]);for(let b=0;b<a.length;b++)this.getName(a[b][0],B.Names$$module$build$src$core$names.NameType.PROCEDURE)};var nI={};return nI.Block=ku,nI.BlockFlyoutInflater=ng,nI.BlockNavigationPolicy=kQ,nI.BlockSvg=kE,nI.Blocks=H,nI.ButtonFlyoutInflater=nd,nI.COLLAPSED_FIELD_NAME=hV,nI.COLLAPSED_INPUT_NAME=hU,nI.COLLAPSE_CHARS=30,nI.CodeGenerator=B.CodeGenerator$$module$build$src$core$generator,nI.CollapsibleToolboxCategory=ny,nI.ComponentManager=g3,nI.Connection=kg,nI.ConnectionChecker=lM,nI.ConnectionDB=kd,nI.ConnectionNavigationPolicy=kU,nI.ConnectionType=mU,nI.ContextMenu=jB,nI.ContextMenuItems=nb,nI.ContextMenuRegistry=jC,nI.Css=g8,nI.DELETE_VARIABLE_ID=km,nI.DeleteArea=kG,nI.DragTarget=kF,nI.DropDownDiv=i$,nI.Events=A,nI.Extensions=j9,nI.Field=jm,nI.FieldCheckbox=mH,nI.FieldDropdown=jZ,nI.FieldImage=mq,nI.FieldLabel=kj,nI.FieldLabelSerializable=mG,nI.FieldNavigationPolicy=kV,nI.FieldNumber=mF,nI.FieldTextInput=B.FieldTextInput$$module$build$src$core$field_textinput,nI.FieldVariable=mE,nI.Flyout=k3,nI.FlyoutButton=kK,nI.FlyoutButtonNavigationPolicy=kL,nI.FlyoutItem=kH,nI.FlyoutMetricsManager=kJ,nI.FlyoutNavigationPolicy=kM,nI.FlyoutNavigator=k0,nI.FlyoutSeparator=kN,nI.FlyoutSeparatorNavigationPolicy=kO,nI.FocusManager=gM,nI.FocusableTreeTraverser=gK,nI.Generator=B.CodeGenerator$$module$build$src$core$generator,nI.Gesture=k8,nI.Grid=k9,nI.HorizontalFlyout=mD,nI.INPUT_VALUE=nA,nI.Input=kq,nI.InsertionMarkerPreviewer=mz,nI.KeyboardNavigationController=k4,nI.LabelFlyoutInflater=mn,nI.LineCursor=lc,nI.Marker=lb,nI.MarkerManager=ld,nI.Menu=hS,nI.MenuItem=hR,nI.MetricsManager=kI,nI.Msg=B.Msg$$module$build$src$core$msg,nI.NEXT_STATEMENT=nC,nI.Names=B.Names$$module$build$src$core$names,nI.Navigator=k_,nI.OPPOSITE_TYPE=kk,nI.OUTPUT_VALUE=nB,nI.Options=j3,nI.PREVIOUS_STATEMENT=nD,nI.PROCEDURE_CATEGORY_NAME=mV,nI.Procedures=mW,nI.RENAME_VARIABLE_ID=kl,nI.RenderedConnection=kn,nI.Scrollbar=hi,nI.ScrollbarPair=k1,nI.SeparatorFlyoutInflater=k2,nI.ShortcutItems=mg,nI.ShortcutRegistry=gP,nI.TOOLBOX_AT_BOTTOM=nF,nI.TOOLBOX_AT_LEFT=nG,nI.TOOLBOX_AT_RIGHT=nH,nI.TOOLBOX_AT_TOP=nE,nI.Theme=j1,nI.ThemeManager=lJ,nI.Themes={Classic:j2,Zelos:nu},nI.Toast=h5,nI.Toolbox=nz,nI.ToolboxCategory=nw,nI.ToolboxItem=nv,nI.ToolboxSeparator=nx,nI.Tooltip=jg,nI.Touch=N,nI.Trashcan=lY,nI.UnattachedFieldError=jn,nI.VARIABLE_CATEGORY_NAME=ij,nI.VARIABLE_DYNAMIC_CATEGORY_NAME=lK,nI.VERSION="12.3.1",nI.VariableMap=lW,nI.VariableModel=lT,nI.Variables=im,nI.VariablesDynamic=lL,nI.VerticalFlyout=mC,nI.WidgetDiv=jx,nI.Workspace=lN,nI.WorkspaceAudio=lO,nI.WorkspaceDragger=k7,nI.WorkspaceNavigationPolicy=k$,nI.WorkspaceSvg=lP,nI.Xml=jS,nI.ZoomControls=hA,nI.blockAnimations=kx,nI.blockRendering=lI,nI.browserEvents=V,nI.bubbles=ne,nI.bumpObjects=kA,nI.clipboard=me,nI.comments=mf,nI.common=gX,nI.config=B.config$$module$build$src$core$config,nI.constants={COLLAPSED_FIELD_NAME:hV,COLLAPSED_INPUT_NAME:hU,MANUALLY_DISABLED:hW},nI.defineBlocksWithJsonArray=bq,nI.dialog=ie,nI.dragging=mJ,nI.fieldRegistry=jY,nI.geras=nq,nI.getFocusManager=B.getFocusManager$$module$build$src$core$focus_manager,nI.getMainWorkspace=bh,nI.getSelected=bj,nI.hasBubble=c_,nI.hideChaff=function(a){bh().hideChaff(a)},nI.icons=le,nI.inject=function(a,b){var c;let d=null;if(d="string"==typeof a?document.getElementById(a)||document.querySelector(a):a,!document.contains(d)&&document!==(null==(c=d)?void 0:c.ownerDocument))throw Error("Error: container is not in current document");a=new j3(b||{}),a$(c=document.createElement("div"),"injectionDiv"),(null==b?0:b.rtl)&&a$(c,"blocklyRTL"),d.appendChild(c),b=f$(c,a);let e=f_(c,b,a);return f0(e),bi(e),bn(e),c.addEventListener("focusin",function(){bi(e)}),ax(c,"keydown",null,br),e},nI.inputs=mA,nI.isCopyable=fN,nI.isDeletable=fb,nI.isDraggable=fg,nI.isIcon=eZ,nI.isObservable=fi,nI.isPaster=function(a){return a&&"function"==typeof a.paste},nI.isRenderedElement=function(a){return a&&"function"==typeof a.getSvgRoot},nI.isSelectable=bb,nI.isSerializable=b3,nI.isVariableBackedParameterModel=ci,nI.keyboardNavigationController=k5,nI.layers={BLOCK:50,BUBBLE:100},nI.navigateBlock=fe,nI.navigateStacks=fd,nI.procedures=mW,nI.registry=G,nI.renderManagement=h1,nI.serialization={blocks:iw,exceptions:iu,priorities:{BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25},procedures:mi,registry:hB,variables:mk,workspaceComments:hD,workspaces:ml},nI.setLocale=iG,nI.setParentContainer=bm,nI.svgResize=bn,nI.thrasos=nt,nI.uiPosition=hy,nI.utils=kb,nI.zelos=na,nI.__namespace__=B,nI})},99037,(a,b,c)=>{"use strict";let d=a.r(46179),{JSDOM:e}=a.r(49892);if("object"!=typeof globalThis.document){let{window:a}=new e("<!DOCTYPE html>");d.utils.xml.injectDependencies(a)}b.exports=d},17083,(a,b,c)=>{!function(c,d){if("function"==typeof define&&define.amd){let b;void 0!==(b=d())&&a.v(b)}else b.exports=d()}(a.e,function(){"use strict";var a=a||{Msg:Object.create(null)};return a.Msg.ADD_COMMENT="Add Comment",a.Msg.ALT_KEY="Alt",a.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",a.Msg.CHANGE_VALUE_TITLE="Change value:",a.Msg.CHROME_OS="ChromeOS",a.Msg.CLEAN_UP="Clean up Blocks",a.Msg.CLOSE="Close",a.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",a.Msg.COLLAPSE_ALL="Collapse Blocks",a.Msg.COLLAPSE_BLOCK="Collapse Block",a.Msg.COLOUR_BLEND_COLOUR1="colour 1",a.Msg.COLOUR_BLEND_COLOUR2="colour 2",a.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",a.Msg.COLOUR_BLEND_RATIO="ratio",a.Msg.COLOUR_BLEND_TITLE="blend",a.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",a.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",a.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",a.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",a.Msg.COLOUR_RANDOM_TITLE="random colour",a.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",a.Msg.COLOUR_RGB_BLUE="blue",a.Msg.COLOUR_RGB_GREEN="green",a.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",a.Msg.COLOUR_RGB_RED="red",a.Msg.COLOUR_RGB_TITLE="colour with",a.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",a.Msg.COMMAND_KEY=" Command",a.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",a.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",a.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",a.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",a.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",a.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",a.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",a.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",a.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",a.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",a.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",a.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",a.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",a.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",a.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",a.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",a.Msg.CONTROLS_IF_MSG_ELSE="else",a.Msg.CONTROLS_IF_MSG_ELSEIF="else if",a.Msg.CONTROLS_IF_MSG_IF="if",a.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",a.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",a.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",a.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",a.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",a.Msg.CONTROLS_REPEAT_INPUT_DO="do",a.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",a.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",a.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",a.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",a.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",a.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",a.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",a.Msg.CONTROL_KEY="Ctrl",a.Msg.COPY_SHORTCUT="Copy",a.Msg.CUT_SHORTCUT="Cut",a.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",a.Msg.DELETE_BLOCK="Delete Block",a.Msg.DELETE_VARIABLE="Delete the '%1' variable",a.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",a.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",a.Msg.DIALOG_CANCEL="Cancel",a.Msg.DIALOG_OK="OK",a.Msg.DISABLE_BLOCK="Disable Block",a.Msg.DUPLICATE_BLOCK="Duplicate",a.Msg.DUPLICATE_COMMENT="Duplicate Comment",a.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",a.Msg.ENABLE_BLOCK="Enable Block",a.Msg.EXPAND_ALL="Expand Blocks",a.Msg.EXPAND_BLOCK="Expand Block",a.Msg.EXTERNAL_INPUTS="External Inputs",a.Msg.HELP="Help",a.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",a.Msg.INLINE_INPUTS="Inline Inputs",a.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",a.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",a.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",a.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",a.Msg.LINUX="Linux",a.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",a.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",a.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",a.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",a.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",a.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",a.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",a.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",a.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",a.Msg.LISTS_GET_INDEX_FIRST="first",a.Msg.LISTS_GET_INDEX_FROM_END="# from end",a.Msg.LISTS_GET_INDEX_FROM_START="#",a.Msg.LISTS_GET_INDEX_GET="get",a.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",a.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",a.Msg.LISTS_GET_INDEX_LAST="last",a.Msg.LISTS_GET_INDEX_RANDOM="random",a.Msg.LISTS_GET_INDEX_REMOVE="remove",a.Msg.LISTS_GET_INDEX_TAIL="",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",a.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",a.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",a.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",a.Msg.LISTS_GET_SUBLIST_END_LAST="to last",a.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",a.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",a.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",a.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",a.Msg.LISTS_GET_SUBLIST_TAIL="",a.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",a.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",a.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",a.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",a.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",a.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",a.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",a.Msg.LISTS_INLIST="in list",a.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",a.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",a.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",a.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",a.Msg.LISTS_LENGTH_TITLE="length of %1",a.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",a.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",a.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",a.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",a.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",a.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",a.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",a.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",a.Msg.LISTS_SET_INDEX_INPUT_TO="as",a.Msg.LISTS_SET_INDEX_INSERT="insert at",a.Msg.LISTS_SET_INDEX_SET="set",a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",a.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",a.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",a.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",a.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",a.Msg.LISTS_SORT_ORDER_DESCENDING="descending",a.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",a.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",a.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",a.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",a.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",a.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",a.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",a.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",a.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",a.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",a.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",a.Msg.LOGIC_BOOLEAN_FALSE="false",a.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",a.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",a.Msg.LOGIC_BOOLEAN_TRUE="true",a.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",a.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",a.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",a.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",a.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",a.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",a.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",a.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",a.Msg.LOGIC_NEGATE_TITLE="not %1",a.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",a.Msg.LOGIC_NULL="null",a.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",a.Msg.LOGIC_NULL_TOOLTIP="Returns null.",a.Msg.LOGIC_OPERATION_AND="and",a.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",a.Msg.LOGIC_OPERATION_OR="or",a.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",a.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",a.Msg.LOGIC_TERNARY_CONDITION="test",a.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",a.Msg.LOGIC_TERNARY_IF_FALSE="if false",a.Msg.LOGIC_TERNARY_IF_TRUE="if true",a.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",a.Msg.MAC_OS="macOS",a.Msg.MATH_ADDITION_SYMBOL="+",a.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",a.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",a.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",a.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",a.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",a.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",a.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",a.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",a.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",a.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",a.Msg.MATH_CHANGE_TITLE="change %1 by %2",a.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",a.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",a.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",a.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",a.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",a.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",a.Msg.MATH_DIVISION_SYMBOL="",a.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",a.Msg.MATH_IS_EVEN="is even",a.Msg.MATH_IS_NEGATIVE="is negative",a.Msg.MATH_IS_ODD="is odd",a.Msg.MATH_IS_POSITIVE="is positive",a.Msg.MATH_IS_PRIME="is prime",a.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",a.Msg.MATH_IS_WHOLE="is whole",a.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",a.Msg.MATH_MODULO_TITLE="remainder of %1  %2",a.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",a.Msg.MATH_MULTIPLICATION_SYMBOL="",a.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",a.Msg.MATH_NUMBER_TOOLTIP="A number.",a.Msg.MATH_ONLIST_HELPURL="",a.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",a.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",a.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",a.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",a.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",a.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",a.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",a.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",a.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",a.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",a.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",a.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",a.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",a.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",a.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",a.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",a.Msg.MATH_POWER_SYMBOL="^",a.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",a.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",a.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",a.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",a.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",a.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",a.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",a.Msg.MATH_ROUND_OPERATOR_ROUND="round",a.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",a.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",a.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",a.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",a.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",a.Msg.MATH_SINGLE_OP_ROOT="square root",a.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",a.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",a.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",a.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",a.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",a.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",a.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",a.Msg.MATH_SUBTRACTION_SYMBOL="-",a.Msg.MATH_TRIG_ACOS="acos",a.Msg.MATH_TRIG_ASIN="asin",a.Msg.MATH_TRIG_ATAN="atan",a.Msg.MATH_TRIG_COS="cos",a.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",a.Msg.MATH_TRIG_SIN="sin",a.Msg.MATH_TRIG_TAN="tan",a.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",a.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",a.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",a.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",a.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",a.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",a.Msg.MOVE_BLOCK="Move Block",a.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",a.Msg.NEW_NUMBER_VARIABLE="Create number variable...",a.Msg.NEW_STRING_VARIABLE="Create string variable...",a.Msg.NEW_VARIABLE="Create variable...",a.Msg.NEW_VARIABLE_TITLE="New variable name:",a.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",a.Msg.OPTION_KEY=" Option",a.Msg.ORDINAL_NUMBER_SUFFIX="",a.Msg.PASTE_SHORTCUT="Paste",a.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",a.Msg.PROCEDURES_BEFORE_PARAMS="with:",a.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",a.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",a.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",a.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",a.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",a.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",a.Msg.PROCEDURES_CREATE_DO="Create '%1'",a.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",a.Msg.PROCEDURES_DEFNORETURN_DO="",a.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",a.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",a.Msg.PROCEDURES_DEFNORETURN_TITLE="to",a.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",a.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",a.Msg.PROCEDURES_DEFRETURN_RETURN="return",a.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",a.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",a.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",a.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",a.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",a.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",a.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",a.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",a.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",a.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",a.Msg.REDO="Redo",a.Msg.REMOVE_COMMENT="Remove Comment",a.Msg.RENAME_VARIABLE="Rename variable...",a.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",a.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",a.Msg.SHORTCUTS_EDITING="Editing",a.Msg.SHORTCUTS_GENERAL="General",a.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",a.Msg.TEXT_APPEND_TITLE="to %1 append text %2",a.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",a.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",a.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",a.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",a.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",a.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",a.Msg.TEXT_CHARAT_FIRST="get first letter",a.Msg.TEXT_CHARAT_FROM_END="get letter # from end",a.Msg.TEXT_CHARAT_FROM_START="get letter #",a.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",a.Msg.TEXT_CHARAT_LAST="get last letter",a.Msg.TEXT_CHARAT_RANDOM="get random letter",a.Msg.TEXT_CHARAT_TAIL="",a.Msg.TEXT_CHARAT_TITLE="in text %1 %2",a.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",a.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",a.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",a.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",a.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",a.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",a.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",a.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",a.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",a.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",a.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",a.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",a.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",a.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",a.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",a.Msg.TEXT_GET_SUBSTRING_TAIL="",a.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",a.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",a.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",a.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",a.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",a.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",a.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",a.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",a.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",a.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",a.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",a.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",a.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",a.Msg.TEXT_LENGTH_TITLE="length of %1",a.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",a.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",a.Msg.TEXT_PRINT_TITLE="print %1",a.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",a.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",a.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",a.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",a.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",a.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",a.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",a.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",a.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",a.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",a.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",a.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",a.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",a.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",a.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",a.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",a.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",a.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",a.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",a.Msg.TODAY="Today",a.Msg.UNDO="Undo",a.Msg.UNKNOWN="Unknown",a.Msg.UNNAMED_KEY="unnamed",a.Msg.VARIABLES_DEFAULT_NAME="item",a.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",a.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",a.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",a.Msg.VARIABLES_SET="set %1 to %2",a.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",a.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",a.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",a.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",a.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",a.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",a.Msg.WINDOWS="Windows",a.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",a.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",a.Msg.CONTROLS_FOREACH_INPUT_DO=a.Msg.CONTROLS_REPEAT_INPUT_DO,a.Msg.CONTROLS_FOR_INPUT_DO=a.Msg.CONTROLS_REPEAT_INPUT_DO,a.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=a.Msg.CONTROLS_IF_MSG_ELSEIF,a.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=a.Msg.CONTROLS_IF_MSG_ELSE,a.Msg.CONTROLS_IF_IF_TITLE_IF=a.Msg.CONTROLS_IF_MSG_IF,a.Msg.CONTROLS_IF_MSG_THEN=a.Msg.CONTROLS_REPEAT_INPUT_DO,a.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=a.Msg.CONTROLS_REPEAT_INPUT_DO,a.Msg.LISTS_CREATE_WITH_ITEM_TITLE=a.Msg.VARIABLES_DEFAULT_NAME,a.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=a.Msg.LISTS_INLIST,a.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=a.Msg.LISTS_INLIST,a.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=a.Msg.LISTS_INLIST,a.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=a.Msg.LISTS_INLIST,a.Msg.MATH_CHANGE_TITLE_ITEM=a.Msg.VARIABLES_DEFAULT_NAME,a.Msg.PROCEDURES_DEFRETURN_COMMENT=a.Msg.PROCEDURES_DEFNORETURN_COMMENT,a.Msg.PROCEDURES_DEFRETURN_DO=a.Msg.PROCEDURES_DEFNORETURN_DO,a.Msg.PROCEDURES_DEFRETURN_PROCEDURE=a.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,a.Msg.PROCEDURES_DEFRETURN_TITLE=a.Msg.PROCEDURES_DEFNORETURN_TITLE,a.Msg.TEXT_APPEND_VARIABLE=a.Msg.VARIABLES_DEFAULT_NAME,a.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=a.Msg.VARIABLES_DEFAULT_NAME,a.Msg.COLOUR_HUE="20",a.Msg.LISTS_HUE="260",a.Msg.LOGIC_HUE="210",a.Msg.LOOPS_HUE="120",a.Msg.MATH_HUE="230",a.Msg.PROCEDURES_HUE="290",a.Msg.TEXTS_HUE="160",a.Msg.VARIABLES_DYNAMIC_HUE="310",a.Msg.VARIABLES_HUE="330",a.Msg})},51623,(a,b,c)=>{!function(c,d){if("function"==typeof define&&define.amd){let b;void 0!==(b=d(a.r(46179)))&&a.v(b)}else b.exports=d(a.r(46179))}(a.e,function(a){var b=a.__namespace__,c=b.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]);b.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",{customContextMenu:function(a){if(this.isInFlyout){var c,d;("variables_get_dynamic"===this.type||"variables_get_reporter_dynamic"===this.type)&&(f={text:b.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:(c=this,function(){let a=c.workspace,d=c.getField("VAR").getVariable();b.renameVariable$$module$build$src$core$variables(a,d)})},g=this.getField("VAR").getText(),g={text:b.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",g),enabled:!0,callback:(d=this,function(){let a=d.getField("VAR").getVariable();a&&b.deleteVariable$$module$build$src$core$variables(a.getWorkspace(),a,d)})},a.unshift(f),a.unshift(g))}else{if("variables_get_dynamic"===this.type)var e="variables_set_dynamic",f=b.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else e="variables_get_dynamic",f=b.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var g=this.getField("VAR");e={type:e,fields:{VAR:g.saveState(!0)}},a.push({enabled:this.workspace.remainingCapacity()>0,text:f.replace("%1",g.getText()),callback:b.callbackFactory$$module$build$src$core$contextmenu(this,e)})}},onchange:function(a){a=this.getFieldValue("VAR"),a=b.getVariable$$module$build$src$core$variables(this.workspace,a),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(a.getType()):this.getInput("VALUE").connection.setCheck(a.getType())}}),b.defineBlocks$$module$build$src$core$common(c);var d=b.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]);b.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",{customContextMenu:function(a){if(this.isInFlyout){var c,d;("variables_get"===this.type||"variables_get_reporter"===this.type)&&(f={text:b.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:(c=this,function(){let a=c.workspace,d=c.getField("VAR").getVariable();b.renameVariable$$module$build$src$core$variables(a,d)})},g=this.getField("VAR").getText(),g={text:b.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",g),enabled:!0,callback:(d=this,function(){let a=d.getField("VAR").getVariable();a&&b.deleteVariable$$module$build$src$core$variables(a.getWorkspace(),a,d)})},a.unshift(f),a.unshift(g))}else{if("variables_get"===this.type)var e="variables_set",f=b.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else e="variables_get",f=b.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var g=this.getField("VAR");e={type:e,fields:{VAR:g.saveState(!0)}},a.push({enabled:this.workspace.remainingCapacity()>0,text:f.replace("%1",g.getText()),callback:b.callbackFactory$$module$build$src$core$contextmenu(this,e)})}}}),b.defineBlocks$$module$build$src$core$common(d);var e=b.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]);e.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);let a=a=>{let c=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+a]});return c.setValidator(function(b){let c=this.getValue();(b="FROM_START"===b||"FROM_END"===b)!=("FROM_START"===c||"FROM_END"===c)&&this.getSourceBlock().updateAt_(a,b)}),c};this.appendDummyInput("WHERE1_INPUT").appendField(a(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(a(2),"WHERE2"),this.appendDummyInput("AT2"),b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");var c=this.getInput("AT1")instanceof b.ValueInput$$module$build$src$core$inputs$value_input;return a.setAttribute("at1",`${c}`),c=this.getInput("AT2")instanceof b.ValueInput$$module$build$src$core$inputs$value_input,a.setAttribute("at2",`${c}`),a},domToMutation:function(a){let b="true"===a.getAttribute("at1");a="true"===a.getAttribute("at2"),this.updateAt_(1,b),this.updateAt_(2,a)},updateAt_:function(a,c){this.removeInput("AT"+a),this.removeInput("ORDINAL"+a,!0),c?(this.appendValueInput("AT"+a).setCheck("Number"),b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+a).appendField(b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+a),2===a&&b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(b.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===a&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"))}},e.text_changeCase={init:function(){let a=[[b.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[b.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[b.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(b.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:a}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(b.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},e.text_trim={init:function(){let a=[[b.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[b.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[b.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(b.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:a}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(b.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},e.text_print={init:function(){this.jsonInit({message0:b.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:b.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:b.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var f={updateType_:function(a){this.outputConnection.setCheck("NUMBER"===a?"Number":"String")},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");return a.setAttribute("type",this.getFieldValue("TYPE")),a},domToMutation:function(a){this.updateType_(a.getAttribute("type"))}};e.text_prompt_ext=Object.assign({},f,{init:function(){var a=[[b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(b.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:a})).setValidator(a=>{this.updateType_(a)}),this.appendValueInput("TEXT").appendField(a,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),e.text_prompt=Object.assign({},f,{init:function(){this.mixin(g);var a=[[b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(b.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:a})).setValidator(a=>{this.updateType_(a)}),this.appendDummyInput().appendField(a,"TYPE").appendField(this.newQuote_(!0)).appendField(b.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:b.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),e.text_count={init:function(){this.jsonInit({message0:b.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:b.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:b.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},e.text_replace={init:function(){this.jsonInit({message0:b.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:b.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:b.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},e.text_reverse={init:function(){this.jsonInit({message0:b.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:b.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:b.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var g={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(a){for(let b=0,c;c=this.inputList[b];b++)for(let b=0,d;d=c.fieldRow[b];b++)if(a===d.name){c.insertFieldAt(b,this.newQuote_(!0)),c.insertFieldAt(b+2,this.newQuote_(!1));return}console.warn('field named "'+a+'" not found in '+this.toDevString())},newQuote_:function(a){return a=this.RTL?!a:a,b.fromJson$$module$build$src$core$field_registry({type:"field_image",src:a?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:a?"":""})}};b.register$$module$build$src$core$extensions("text_append_tooltip",b.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),b.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>b.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),b.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(g),this.quoteField_("TEXT")}),b.registerMixin$$module$build$src$core$extensions("quote_image_mixin",g),b.registerMutator$$module$build$src$core$extensions("text_join_mutator",{itemCount_:0,mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");return a.setAttribute("items",`${this.itemCount_}`),a},domToMutation:function(a){this.itemCount_=parseInt(a.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(a){this.itemCount_=a.itemCount,this.updateShape_()},decompose:function(a){let b=a.newBlock("text_create_join_container");b.initSvg();let c=b.getInput("STACK").connection;for(let b=0;b<this.itemCount_;b++){let b=a.newBlock("text_create_join_item");b.initSvg(),c.connect(b.previousConnection),c=b.nextConnection}return b},compose:function(a){var b=a.getInputTargetBlock("STACK");for(a=[];b;)b.isInsertionMarker()||a.push(b.valueConnection_),b=b.getNextBlock();for(b=0;b<this.itemCount_;b++){let c=this.getInput("ADD"+b).connection.targetConnection;c&&!a.includes(c)&&c.disconnect()}for(this.itemCount_=a.length,this.updateShape_(),b=0;b<this.itemCount_;b++){let c;null==(c=a[b])||c.reconnect(this,"ADD"+b)}},saveConnections:function(a){a=a.getInputTargetBlock("STACK");let b=0;for(;a;){if(a.isInsertionMarker()){a=a.getNextBlock();continue}let c=this.getInput("ADD"+b);a.valueConnection_=c&&c.connection.targetConnection,a=a.getNextBlock(),b++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var a=0;a<this.itemCount_;a++)if(!this.getInput("ADD"+a)){let c=this.appendValueInput("ADD"+a).setAlign(b.Align$$module$build$src$core$inputs$align.RIGHT);0===a&&c.appendField(b.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(a=this.itemCount_;this.getInput("ADD"+a);a++)this.removeInput("ADD"+a)}},function(){this.mixin(g),this.itemCount_=2,this.updateShape_(),this.setMutator(new b.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),b.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",{isAt_:!1,mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");return a.setAttribute("at",`${this.isAt_}`),a},domToMutation:function(a){a="false"!==a.getAttribute("at"),this.updateAt_(a)},updateAt_:function(a){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),a&&(this.appendValueInput("AT").setCheck("Number"),b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),b.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(b.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=a}},function(){this.getField("WHERE").setValidator(function(a){a="FROM_START"===a||"FROM_END"===a;let b=this.getSourceBlock();a!==b.isAt_&&b.updateAt_(a)}),this.updateAt_(!0),this.setTooltip(()=>{var a=this.getFieldValue("WHERE");let c=b.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===a||"FROM_END"===a)&&(a="FROM_START"===a?b.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:b.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(c+="  "+a.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),c})}),b.defineBlocks$$module$build$src$core$common(e);var h={},i={setStatements_:function(a){this.hasStatements_!==a&&(a?(this.appendStatementInput("STACK").appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=a)},updateParams_:function(){let a="";this.arguments_.length&&(a=b.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),b.disable$$module$build$src$core$events$utils();try{this.setFieldValue(a,"PARAMS")}finally{b.enable$$module$build$src$core$events$utils()}},mutationToDom:function(a){let c=b.createElement$$module$build$src$core$utils$xml("mutation");a&&c.setAttribute("name",this.getFieldValue("NAME"));for(let d=0;d<this.argumentVarModels_.length;d++){let e=b.createElement$$module$build$src$core$utils$xml("arg"),f=this.argumentVarModels_[d];e.setAttribute("name",f.getName()),e.setAttribute("varid",f.getId()),a&&this.paramIds_&&e.setAttribute("paramId",this.paramIds_[d]),c.appendChild(e)}return this.hasStatements_||c.setAttribute("statements","false"),c},domToMutation:function(a){this.arguments_=[],this.argumentVarModels_=[];for(let d=0,e;e=a.childNodes[d];d++)if("arg"===e.nodeName.toLowerCase()){var c=e;let a=c.getAttribute("name");c=c.getAttribute("varid")||c.getAttribute("varId"),this.arguments_.push(a),null!==(c=b.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,c,a,""))?this.argumentVarModels_.push(c):console.log(`Failed to create a variable named "${a}", ignoring.`)}this.updateParams_(),b.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==a.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;let a=Object.create(null);if(this.argumentVarModels_.length){a.params=[];for(let b=0;b<this.argumentVarModels_.length;b++)a.params.push({name:this.argumentVarModels_[b].getName(),id:this.argumentVarModels_[b].getId()})}return this.hasStatements_||(a.hasStatements=!1),a},loadExtraState:function(a){if(this.arguments_=[],this.argumentVarModels_=[],a.params)for(let d=0;d<a.params.length;d++){var c=a.params[d];c=b.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,c.id,c.name,""),this.arguments_.push(c.getName()),this.argumentVarModels_.push(c)}this.updateParams_(),b.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==a.hasStatements)},decompose:function(a){let c=b.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","procedures_mutatorcontainer");var d=b.createElement$$module$build$src$core$utils$xml("statement");d.setAttribute("name","STACK"),c.appendChild(d);for(let a=0;a<this.arguments_.length;a++){let c=b.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","procedures_mutatorarg");var e=b.createElement$$module$build$src$core$utils$xml("field");e.setAttribute("name","NAME");let f=b.createTextNode$$module$build$src$core$utils$xml(this.arguments_[a]);e.appendChild(f),c.appendChild(e),e=b.createElement$$module$build$src$core$utils$xml("next"),c.appendChild(e),d.appendChild(c),d=e}return a=b.domToBlock$$module$build$src$core$xml(c,a),"procedures_defreturn"===this.type?a.setFieldValue(this.hasStatements_,"STATEMENTS"):a.removeInput("STATEMENT_INPUT"),b.mutateCallers$$module$build$src$core$procedures(this),a},compose:function(a){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let c=a.getInputTargetBlock("STACK");for(;c&&!c.isInsertionMarker();){var d,e=c.getFieldValue("NAME");this.arguments_.push(e),e=this.workspace.getVariable(e,""),this.argumentVarModels_.push(e),this.paramIds_.push(c.id),c=c.nextConnection&&c.nextConnection.targetBlock()}this.updateParams_(),b.mutateCallers$$module$build$src$core$procedures(this),null!==(a=a.getFieldValue("STATEMENTS"))&&(a="TRUE"===a,this.hasStatements_!==a)&&(a?(this.setStatements_(!0),null==(d=this.statementConnection_)||d.reconnect(this,"STACK"),this.statementConnection_=null):(d=this.getInput("STACK").connection,(this.statementConnection_=d.targetConnection)&&((d=d.targetBlock()).unplug(),d.bumpNeighbours()),this.setStatements_(!1)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(a,c){var d=this.workspace.getVariableById(a);if(""===d.getType()){d=d.getName(),c=this.workspace.getVariableById(c);var e=!1;for(let b=0;b<this.argumentVarModels_.length;b++)this.argumentVarModels_[b].getId()===a&&(this.arguments_[b]=c.getName(),this.argumentVarModels_[b]=c,e=!0);e&&(this.displayRenamedVar_(d,c.getName()),b.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(a){let c=a.getName(),d=!1,e;for(let b=0;b<this.argumentVarModels_.length;b++)this.argumentVarModels_[b].getId()===a.getId()&&(e=this.arguments_[b],this.arguments_[b]=c,d=!0);d&&(this.displayRenamedVar_(e,c),b.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(a,c){this.updateParams_();var d=this.getIcon(b.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(d&&d.bubbleIsVisible()){d=d.getWorkspace().getAllBlocks(!1);for(let e=0,f;f=d[e];e++)"procedures_mutatorarg"===f.type&&b.Names$$module$build$src$core$names.equals(a,f.getFieldValue("NAME"))&&f.setFieldValue(c,"NAME")}},customContextMenu:function(a){if(!this.isInFlyout){var c=this.getFieldValue("NAME"),d={type:this.callType_,extraState:{name:c,params:this.arguments_}};if(a.push({enabled:!0,text:b.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",c),callback:b.callbackFactory$$module$build$src$core$contextmenu(this,d)}),!this.isCollapsed())for(c=0;c<this.argumentVarModels_.length;c++){let e={type:"variables_get",fields:{VAR:{name:(d=this.argumentVarModels_[c]).getName(),id:d.getId(),type:d.getType()}}};a.push({enabled:!0,text:b.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",d.getName()),callback:b.callbackFactory$$module$build$src$core$contextmenu(this,e)})}}}};h.procedures_defnoreturn=Object.assign({},i,{init:function(){var a=b.findLegalName$$module$build$src$core$procedures("",this);(a=b.fromJson$$module$build$src$core$field_registry({type:"field_input",text:a})).setValidator(b.rename$$module$build$src$core$procedures),a.setSpellcheck(!1),this.appendDummyInput().appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(a,"NAME").appendField("","PARAMS"),this.setMutator(new b.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&b.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),h.procedures_defreturn=Object.assign({},i,{init:function(){var a=b.findLegalName$$module$build$src$core$procedures("",this);(a=b.fromJson$$module$build$src$core$field_registry({type:"field_input",text:a})).setValidator(b.rename$$module$build$src$core$procedures),a.setSpellcheck(!1),this.appendDummyInput().appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(a,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(b.Align$$module$build$src$core$inputs$align.RIGHT).appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new b.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),h.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(b.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(b.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};var j=class extends b.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(a){super.showEditor_(a),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(a){super.onFinishEditing_(a),this.editingInteractively=!1}};h.procedures_mutatorarg={init:function(){let a=new j(b.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(a,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(b.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(a){var b=this.getSourceBlock();let c=b.workspace.getRootWorkspace();if(!(a=a.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;let d=(b.workspace.targetWorkspace||b.workspace).getAllBlocks(!1),e=a.toLowerCase();for(let a=0;a<d.length;a++){if(d[a].id===this.getSourceBlock().id)continue;let b=d[a].getFieldValue("NAME");if(b&&b.toLowerCase()===e)return null}return b.isInFlyout||((b=c.getVariable(a,""))&&b.getName()!==a&&c.renameVariableById(b.getId(),a),b||(this.editingInteractively?this.editingVariable?c.renameVariableById(this.editingVariable.getId(),a):this.editingVariable=c.createVariable(a,""):c.createVariable(a,""))),a}};var k="DISABLED_PROCEDURE_DEFINITION",l={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(a,c){b.Names$$module$build$src$core$names.equals(a,this.getProcedureCall())&&(this.setFieldValue(c,"NAME"),this.setTooltip((this.outputConnection?b.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:b.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",c)))},setProcedureParameters_:function(a,c){var d=b.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((d=(d=d&&d.getIcon(b.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&d.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),a.join("\n")===this.arguments_.join("\n"))this.quarkIds_=c;else{if(c.length!==a.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let a=0;a<this.arguments_.length;a++){var e=this.getInput("ARG"+a);e&&(e=e.connection.targetConnection,this.quarkConnections_[this.quarkIds_[a]]=e,d&&e&&!c.includes(this.quarkIds_[a])&&(e.disconnect(),e.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(a),this.argumentVarModels_=[],a=0;a<this.arguments_.length;a++)d=b.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[a],""),this.argumentVarModels_.push(d);if(this.updateShape_(),this.quarkIds_=c){for(c=0;c<this.arguments_.length;c++)if((a=this.quarkIds_[c])in this.quarkConnections_){let b;(null==(b=this.quarkConnections_[a])?0:b.reconnect(this,"ARG"+c))||delete this.quarkConnections_[a]}}}},updateShape_:function(){for(var a=0;a<this.arguments_.length;a++){var c=this.getField("ARGNAME"+a);if(c){b.disable$$module$build$src$core$events$utils();try{c.setValue(this.arguments_[a])}finally{b.enable$$module$build$src$core$events$utils()}}else c=b.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[a]}),this.appendValueInput("ARG"+a).setAlign(b.Align$$module$build$src$core$inputs$align.RIGHT).appendField(c,"ARGNAME"+a)}for(a=this.arguments_.length;this.getInput("ARG"+a);a++)this.removeInput("ARG"+a);(a=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||a.appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&a.removeField("WITH"))},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");a.setAttribute("name",this.getProcedureCall());for(let c=0;c<this.arguments_.length;c++){let d=b.createElement$$module$build$src$core$utils$xml("arg");d.setAttribute("name",this.arguments_[c]),a.appendChild(d)}return a},domToMutation:function(a){var b=a.getAttribute("name");this.renameProcedure(this.getProcedureCall(),b),b=[];let c=[];for(let d=0,e;e=a.childNodes[d];d++)"arg"===e.nodeName.toLowerCase()&&(b.push(e.getAttribute("name")),c.push(e.getAttribute("paramId")));this.setProcedureParameters_(b,c)},saveExtraState:function(){let a=Object.create(null);return a.name=this.getProcedureCall(),this.arguments_.length&&(a.params=this.arguments_),a},loadExtraState:function(a){if(this.renameProcedure(this.getProcedureCall(),a.name),a=a.params){let b=[];b.length=a.length,b.fill(null),this.setProcedureParameters_(a,b)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(a){if(this.workspace&&!this.workspace.isFlyout&&a.recordUndo)if(a.type===b.BLOCK_CREATE$$module$build$src$core$events$events&&a.ids.includes(this.id)){var c=this.getProcedureCall(),d=b.getDefinition$$module$build$src$core$procedures(c,this.workspace);if(d&&(d.type!==this.defType_||JSON.stringify(d.getVars())!==JSON.stringify(this.arguments_))&&(d=null),d)d.isEnabled()||(this.setDisabledReason(!0,k),this.setWarningText(b.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",c)));else{b.setGroup$$module$build$src$core$events$utils(a.group),a=b.createElement$$module$build$src$core$utils$xml("xml"),(c=b.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var e=(d=this.getRelativeToSurfaceXY()).y+2*b.config$$module$build$src$core$config.snapRadius;c.setAttribute("x",`${d.x+b.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),c.setAttribute("y",`${e}`),d=this.mutationToDom(),c.appendChild(d),(d=b.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),e=this.getProcedureCall();let f=b.findLegalName$$module$build$src$core$procedures(e,this);e!==f&&this.renameProcedure(e,f),d.appendChild(b.createTextNode$$module$build$src$core$utils$xml(e)),c.appendChild(d),a.appendChild(c),b.domToWorkspace$$module$build$src$core$xml(a,this.workspace),b.setGroup$$module$build$src$core$events$utils(!1)}}else a.type===b.BLOCK_DELETE$$module$build$src$core$events$events?(c=this.getProcedureCall(),b.getDefinition$$module$build$src$core$procedures(c,this.workspace)||(b.setGroup$$module$build$src$core$events$utils(a.group),this.dispose(!0),b.setGroup$$module$build$src$core$events$utils(!1))):a.type===b.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===a.element&&(c=this.getProcedureCall(),(e=b.getDefinition$$module$build$src$core$procedures(c,this.workspace))&&e.id===a.blockId&&((d=b.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),b.setGroup$$module$build$src$core$events$utils(a.group),a=e.isEnabled(),this.setDisabledReason(!a,k),this.setWarningText(a?null:b.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",c)),b.setGroup$$module$build$src$core$events$utils(d)))},customContextMenu:function(a){if(this.workspace.isMovable()){var c=this.getProcedureCall(),d=this.workspace;a.push({enabled:!0,text:b.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){let a=b.getDefinition$$module$build$src$core$procedures(c,d);a&&(d.centerOnBlock(a.id),b.getFocusManager$$module$build$src$core$focus_manager().focusNode(a))}})}}};h.procedures_callnoreturn=Object.assign({},l,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(b.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),h.procedures_callreturn=Object.assign({},l,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(b.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"}),h.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(b.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(b.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(b.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");return a.setAttribute("value",String(Number(this.hasReturnValue_))),a},domToMutation:function(a){this.hasReturnValue_="1"===a.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(a){if(!(this.workspace.isDragging&&this.workspace.isDragging()||a.type!==b.BLOCK_MOVE$$module$build$src$core$events$events&&a.type!==b.BLOCK_CREATE$$module$build$src$core$events$events)){a=!1;var c=this;do{if(this.FUNCTION_TYPES.includes(c.type)){a=!0;break}c=c.getSurroundParent()}while(c)if(a?("procedures_defnoreturn"===c.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==c.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(b.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(b.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{b.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!a,"UNPARENTED_IFRETURN")}finally{b.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},b.defineBlocks$$module$build$src$core$common(h);var m=b.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);b.register$$module$build$src$core$extensions("math_op_tooltip",b.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"})),b.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",{mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation"),c="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return a.setAttribute("divisor_input",String(c)),a},domToMutation:function(a){a="true"===a.getAttribute("divisor_input"),this.updateShape_(a)},updateShape_:function(a){let b=this.getInput("DIVISOR");a?b||this.appendValueInput("DIVISOR").setCheck("Number"):b&&this.removeInput("DIVISOR")}},function(){this.getField("PROPERTY").setValidator(function(a){a="DIVISIBLE_BY"===a,this.getSourceBlock().updateShape_(a)})}),b.register$$module$build$src$core$extensions("math_change_tooltip",b.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),b.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",{updateType_:function(a){"MODE"===a?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");return a.setAttribute("op",this.getFieldValue("OP")),a},domToMutation:function(a){if(null===(a=a.getAttribute("op")))throw TypeError("xmlElement had no op attribute");this.updateType_(a)}},function(){this.getField("OP").setValidator((function(a){this.updateType_(a)}).bind(this))}),b.defineBlocks$$module$build$src$core$common(m);var n=b.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);b.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",b.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),b.register$$module$build$src$core$extensions("controls_flow_tooltip",b.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"})),b.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",{customContextMenu:function(a){if(!this.isInFlyout){var c=this.getField("VAR"),d=c.getVariable().getName();this.isCollapsed()||null===d||(c={type:"variables_get",fields:{VAR:c.saveState(!0)}},a.push({enabled:!0,text:b.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",d),callback:b.callbackFactory$$module$build$src$core$contextmenu(this,c)}))}}}),b.register$$module$build$src$core$extensions("controls_for_tooltip",b.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),b.register$$module$build$src$core$extensions("controls_forEach_tooltip",b.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var o=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]);b.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",{getSurroundLoop:function(){let a=this;do{if(o.has(a.type))return a;a=a.getSurroundParent()}while(a)return null},onchange:function(a){let c=this.workspace;if(c.isDragging&&!c.isDragging()&&(a.type===b.BLOCK_MOVE$$module$build$src$core$events$events||a.type===b.BLOCK_CREATE$$module$build$src$core$events$events)&&(a=!!this.getSurroundLoop(),this.setWarningText(a?null:b.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{b.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!a,"CONTROL_FLOW_NOT_IN_LOOP")}finally{b.setRecordUndo$$module$build$src$core$events$utils(!0)}}}),b.defineBlocks$$module$build$src$core$common(n);var p=b.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);b.register$$module$build$src$core$extensions("logic_op_tooltip",b.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"})),b.registerMutator$$module$build$src$core$extensions("controls_if_mutator",{elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;let a=b.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&a.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&a.setAttribute("else","1"),a},domToMutation:function(a){this.elseifCount_=parseInt(a.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(a.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;let a=Object.create(null);return this.elseifCount_&&(a.elseIfCount=this.elseifCount_),this.elseCount_&&(a.hasElse=!0),a},loadExtraState:function(a){this.elseifCount_=a.elseIfCount||0,this.elseCount_=+!!a.hasElse,this.updateShape_()},decompose:function(a){let b=a.newBlock("controls_if_if");b.initSvg();let c=b.nextConnection;for(let b=1;b<=this.elseifCount_;b++){let b=a.newBlock("controls_if_elseif");b.initSvg(),c.connect(b.previousConnection),c=b.nextConnection}return this.elseCount_&&((a=a.newBlock("controls_if_else")).initSvg(),c.connect(a.previousConnection)),b},compose:function(a){a=a.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;let b=[null],c=[null],d=null;for(;a;){if(!a.isInsertionMarker())switch(a.type){case"controls_if_elseif":this.elseifCount_++,b.push(a.valueConnection_),c.push(a.statementConnection_);break;case"controls_if_else":this.elseCount_++,d=a.statementConnection_;break;default:throw TypeError("Unknown block type: "+a.type)}a=a.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(b,c,d)},saveConnections:function(a){a=a.nextConnection.targetBlock();let b=1;for(;a;){if(!a.isInsertionMarker())switch(a.type){case"controls_if_elseif":var c=this.getInput("IF"+b);let d=this.getInput("DO"+b);a.valueConnection_=c&&c.connection.targetConnection,a.statementConnection_=d&&d.connection.targetConnection,b++;break;case"controls_if_else":c=this.getInput("ELSE"),a.statementConnection_=c&&c.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+a.type)}a=a.getNextBlock()}},rebuildShape_:function(){let a=[null],b=[null],c=null;this.getInput("ELSE")&&(c=this.getInput("ELSE").connection.targetConnection);for(let c=1;this.getInput("IF"+c);c++){let d=this.getInput("IF"+c),e=this.getInput("DO"+c);a.push(d.connection.targetConnection),b.push(e.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(a,b,c)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var a=1;this.getInput("IF"+a);a++)this.removeInput("IF"+a),this.removeInput("DO"+a);for(a=1;a<=this.elseifCount_;a++)this.appendValueInput("IF"+a).setCheck("Boolean").appendField(b.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+a).appendField(b.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(b.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(a,b,c){for(let c=1;c<=this.elseifCount_;c++){let d,e;null==(d=a[c])||d.reconnect(this,"IF"+c),null==(e=b[c])||e.reconnect(this,"DO"+c)}null==c||c.reconnect(this,"ELSE")}},null,["controls_if_elseif","controls_if_else"]),b.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip((function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?b.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?b.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?b.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":b.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}).bind(this))});var q={onchange:function(a){this.prevBlocks_||(this.prevBlocks_=[null,null]);var c=this.getInputTargetBlock("A");let d=this.getInputTargetBlock("B");c&&d&&!this.workspace.connectionChecker.doTypeChecks(c.outputConnection,d.outputConnection)&&(b.setGroup$$module$build$src$core$events$utils(a.group),(a=this.prevBlocks_[0])!==c&&(c.unplug(),!a||a.isDisposed()||a.isShadow()||this.getInput("A").connection.connect(a.outputConnection)),(c=this.prevBlocks_[1])!==d&&(d.unplug(),!c||c.isDisposed()||c.isShadow()||this.getInput("B").connection.connect(c.outputConnection)),this.bumpNeighbours(),b.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};b.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin(q)}),b.registerMixin$$module$build$src$core$extensions("logic_ternary",{prevParentConnection_:null,onchange:function(a){let c=this.getInputTargetBlock("THEN"),d=this.getInputTargetBlock("ELSE"),e=this.outputConnection.targetConnection;if((c||d)&&e)for(let f=0;f<2;f++){let g=1===f?c:d;g&&!g.workspace.connectionChecker.doTypeChecks(g.outputConnection,e)&&(b.setGroup$$module$build$src$core$events$utils(a.group),e===this.prevParentConnection_?(this.unplug(),e.getSourceBlock().bumpNeighbours()):(g.unplug(),g.bumpNeighbours()),b.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=e}}),b.defineBlocks$$module$build$src$core$common(p);var r=b.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]);r.lists_create_with={init:function(){this.setHelpUrl(b.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new b.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(b.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");return a.setAttribute("items",String(this.itemCount_)),a},domToMutation:function(a){if(!(a=a.getAttribute("items")))throw TypeError("element did not have items");this.itemCount_=parseInt(a,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(a){this.itemCount_=a.itemCount,this.updateShape_()},decompose:function(a){let b=a.newBlock("lists_create_with_container");b.initSvg();let c=b.getInput("STACK").connection;for(let b=0;b<this.itemCount_;b++){let b=a.newBlock("lists_create_with_item");if(b.initSvg(),!b.previousConnection)throw Error("itemBlock has no previousConnection");c.connect(b.previousConnection),c=b.nextConnection}return b},compose:function(a){var b=a.getInputTargetBlock("STACK");for(a=[];b;)b.isInsertionMarker()||a.push(b.valueConnection_),b=b.getNextBlock();for(b=0;b<this.itemCount_;b++){let c=this.getInput("ADD"+b).connection.targetConnection;c&&!a.includes(c)&&c.disconnect()}for(this.itemCount_=a.length,this.updateShape_(),b=0;b<this.itemCount_;b++){let c;null==(c=a[b])||c.reconnect(this,"ADD"+b)}},saveConnections:function(a){a=a.getInputTargetBlock("STACK");let b=0;for(;a;){if(a.isInsertionMarker()){a=a.getNextBlock();continue}let c=this.getInput("ADD"+b);a.valueConnection_=null==c?void 0:c.connection.targetConnection,a=a.getNextBlock(),b++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(b.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var a=0;a<this.itemCount_;a++)if(!this.getInput("ADD"+a)){let c=this.appendValueInput("ADD"+a).setAlign(b.Align$$module$build$src$core$inputs$align.RIGHT);0===a&&c.appendField(b.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(a=this.itemCount_;this.getInput("ADD"+a);a++)this.removeInput("ADD"+a)}},r.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(b.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(b.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},r.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(b.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(b.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},r.lists_indexOf={init:function(){var a=[[b.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[b.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(b.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(b.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:a})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(a,"END"),this.setInputsInline(!0),this.setTooltip(()=>b.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}},r.lists_getIndex={init:function(){var a=[[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:a})).setValidator(function(a){a="REMOVE"===a,this.getSourceBlock().updateStatement_(a)}),this.appendValueInput("VALUE").setCheck("Array").appendField(b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(a,"MODE").appendField("","SPACE"),(a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(a){let b=this.getValue();(a="FROM_START"===a||"FROM_END"===a)!=("FROM_START"===b||"FROM_END"===b)&&this.getSourceBlock().updateAt_(a)}),this.appendDummyInput().appendField(a,"WHERE"),this.appendDummyInput("AT"),b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{let a=this.getFieldValue("MODE"),c=this.getFieldValue("WHERE"),d="";switch(a+" "+c){case"GET FROM_START":case"GET FROM_END":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":d=b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"===c||"FROM_END"===c)&&(d+="  "+("FROM_START"===c?b.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:b.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),d})},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");a.setAttribute("statement",String(!this.outputConnection));let c=this.getInput("AT")instanceof b.ValueInput$$module$build$src$core$inputs$value_input;return a.setAttribute("at",String(c)),a},domToMutation:function(a){let b="true"===a.getAttribute("statement");this.updateStatement_(b),a="false"!==a.getAttribute("at"),this.updateAt_(a)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(a){a.isStatement?this.updateStatement_(!0):"string"==typeof a&&this.domToMutation(b.textToDom$$module$build$src$core$utils$xml(a))},updateStatement_:function(a){!this.outputConnection!==a&&(this.unplug(!0,!0),a?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(a){this.removeInput("AT"),this.removeInput("ORDINAL",!0),a?(this.appendValueInput("AT").setCheck("Number"),b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},r.lists_setIndex={init:function(){var a=[[b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[b.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:a}),this.appendDummyInput().appendField(a,"MODE").appendField("","SPACE"),(a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(a){let b=this.getValue();(a="FROM_START"===a||"FROM_END"===a)!=("FROM_START"===b||"FROM_END"===b)&&this.getSourceBlock().updateAt_(a)}),this.appendDummyInput().appendField(a,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{let a=this.getFieldValue("MODE"),c=this.getFieldValue("WHERE"),d="";switch(a+" "+c){case"SET FROM_START":case"SET FROM_END":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":d=b.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"===c||"FROM_END"===c)&&(d+="  "+b.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),d})},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation"),c=this.getInput("AT")instanceof b.ValueInput$$module$build$src$core$inputs$value_input;return a.setAttribute("at",String(c)),a},domToMutation:function(a){a="false"!==a.getAttribute("at"),this.updateAt_(a)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(a){this.removeInput("AT"),this.removeInput("ORDINAL",!0),a?(this.appendValueInput("AT").setCheck("Number"),b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}},r.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);let a=a=>{let c=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+a]});return c.setValidator(function(b){let c=this.getValue();(b="FROM_START"===b||"FROM_END"===b)!=("FROM_START"===c||"FROM_END"===c)&&this.getSourceBlock().updateAt_(a,b)}),c};this.appendDummyInput("WHERE1_INPUT").appendField(a(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(a(2),"WHERE2"),this.appendDummyInput("AT2"),b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");var c=this.getInput("AT1")instanceof b.ValueInput$$module$build$src$core$inputs$value_input;return a.setAttribute("at1",String(c)),c=this.getInput("AT2")instanceof b.ValueInput$$module$build$src$core$inputs$value_input,a.setAttribute("at2",String(c)),a},domToMutation:function(a){let b="true"===a.getAttribute("at1");a="true"===a.getAttribute("at2"),this.updateAt_(1,b),this.updateAt_(2,a)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(a,c){this.removeInput("AT"+a),this.removeInput("ORDINAL"+a,!0),c?(this.appendValueInput("AT"+a).setCheck("Number"),b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+a).appendField(b.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+a),1===a&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")),b.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},r.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},r.lists_split={init:function(){let a=b.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[b.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[b.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!a)throw Error("field_dropdown not found");a.setValidator(a=>{this.updateType_(a)}),this.setHelpUrl(b.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(a,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(b.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{let a=this.getFieldValue("MODE");if("SPLIT"===a)return b.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===a)return b.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+a)})},updateType_:function(a){if(this.getFieldValue("MODE")!==a){let a=this.getInput("INPUT").connection;a.setShadowDom(null);let b=a.targetBlock();b&&(a.disconnect(),b.isShadow()?b.dispose(!1):this.bumpNeighbours())}"SPLIT"===a?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){let a=b.createElement$$module$build$src$core$utils$xml("mutation");return a.setAttribute("mode",this.getFieldValue("MODE")),a},domToMutation:function(a){this.updateType_(a.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(a){this.updateType_(a.mode)}},b.defineBlocks$$module$build$src$core$common(r);var s={blocks:Object.assign({},r,p,n,m,h,e,d,c),lists:{blocks:r},logic:{blocks:p},loops:{blocks:n,loopTypes:o},math:{blocks:m},procedures:{blocks:h},texts:{blocks:e},variables:{blocks:d},variablesDynamic:{blocks:c}};return s.__namespace__=b,s})},12329,(a,b,c)=>{!function(c,d){if("function"==typeof define&&define.amd){let b;void 0!==(b=d(a.r(99037),a.r(17083),a.r(51623)))&&a.v(b)}else b.exports=d(a.r(99037),a.r(17083),a.r(51623))}(a.e,function(a,b,c){return a.setLocale(b),a})},77930,a=>{"use strict";var b,c=a.i(61786),d=a.i(30859);let e={className:d.default.className,style:{fontFamily:"'Oxanium', 'Oxanium Fallback'",fontStyle:"normal"}};null!=d.default.variable&&(e.variable=d.default.variable);var f=a.i(14079);let g={className:f.default.className,style:{fontFamily:"'Fira Code', 'Fira Code Fallback'",fontStyle:"normal"}};null!=f.default.variable&&(g.variable=f.default.variable);var h=a.i(53549),i=a.i(99037);i.Msg.ARRAY_CREATE_EMPTY_TITLE="empty!",i.Msg.tab_create="create element block for array %1'",i.Msg.tab_create_fix="create block 'set element in array %1 to'",i.Msg.ARRAY_CREATE_WITH="set with",i.Msg.ARRAY_taille="size",i.Msg.ARRAY_contenu="contain",i.Msg.ARRAY_dim="size of ",i.Msg.ARRAY_index="index",i.Msg._AT="to",i.Msg.ARRAY_CREATE_WITH="created with",i.Msg.ARRAY_CREATE_WITH_CONTAINER_TITLE_ADD="array",i.Msg.ARRAY_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this array block.",i.Msg.ARRAY_CREATE_WITH_HELPURL="",i.Msg.ARRAY_CREATE_WITH_INPUT_WITH="an array",i.Msg.ARRAY_CREATE_WITH_ITEM_TITLE="item",i.Msg.ARRAY_CREATE_WITH_ITEM_TOOLTIP="Add an item to the array.",i.Msg.ARRAY_CREATE_WITH_TOOLTIP="Create a array with any number of items.",i.Msg.ARRAY_GETINDEX_AT="get index",i.Msg.ARRAY_GETINDEX_AT1="get index",i.Msg.ARRAY_GETINDEX_AT2="index",i.Msg.ARRAY_GETINDEX_HELPURL="",i.Msg.ARRAY_GETINDEX_ITEM="in Array",i.Msg.ARRAY_GETINDEX_TOOLTIP="",i.Msg.ARRAY_GETINDEX_TOOLTIP1="retourne la valeur stocke dans la liste ou tableau",i.Msg.ARRAY_GETINDEX_TOOLTIP2="cr une liste ou tableau du type slectionn",i.Msg.ARRAY_GETINDEX_TOOLTIP3="fixe un (ou plusieurs) lment(s) de la liste ou tableau  la (aux) valeur(s) indique(s)",i.Msg.ARRAY_CREATE="define ",i.Msg.ARRAY_TAILLE="size",i.Msg.ARRAY_CONTIENT="with",i.Msg.ARRAY_LIST="list",i.Msg.ARRAY_ARRAY="array",i.Msg.ARRAY_fixe="change element at position",i.Msg.ARRAY_DECLARE_NAME="create array",i.Msg.ARRAY_DECLARE_TYPE="type",i.Msg.ARRAY_DECLARE_SIZE="number of elements",i.Msg.ARRAY_DECLARE_TOOLTIP="create an array of specific type and number of elements",i.Msg.ARRAY_MODIFY_INDICE="set element nb",i.Msg.ARRAY_MODIFY_NAME="in array",i.Msg.ARRAY_MODIFY_VALUE="value",i.Msg.ARRAY_MODIFY_TOOLTIP="set a specific value to an elemnt of an array",i.Msg.CONTROLS_SWITCH_CASEBREAK_TOOLTIP="Add a condition to the case block.",i.Msg.CONTROLS_SWITCH_DEFAULT_TOOLTIP="Add a final, catch-all condition to the if block.",i.Msg.CONTROLS_SWITCH_HELPURL="https://en.wikipedia.org/wiki/Switch_statement",i.Msg.CONTROLS_SWITCH_SWITCH_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",i.Msg.CONTROLS_SWITCH_VAR_TITLE="Switch (",i.Msg.CONTROLS_SWITCH_VAR_TAIL=")",i.Msg.CONTROLS_SWITCH_MSG_DEFAULT="default",i.Msg.CONTROLS_SWITCH_MSG_CASEBREAK="case",i.Msg.CONTROLS_SWITCH_MSG_SWITCHVAR="Switch (var)",i.Msg.CONTROLS_SWITCH_MSG_DO="do",i.Msg.CONTROLS_SWITCH_TOOLTIP_1="If a value is true, then do some statements.",i.Msg.CONTROLS_SWITCH_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",i.Msg.CONTROLS_SWITCH_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",i.Msg.CONTROLS_SWITCH_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",i.Msg.CONTROLS_SWITCH_VAR_TOOLTIP="Drag from the left into here to add",i.Msg.CONTROLS_SWITCH_CASEBREAK_TOOLTIP="Add additional case break do",i.Msg.CONTROLS_SWITCH_DEFAULT_TOOLTIP="Add optional default action",i.Msg.TEXT_CHAR_TOOLTIP="character value that takes up 1 byte of memory",i.Msg.TEXT_CHAR_HELPURL="https://www.arduino.cc/reference/en/language/variables/data-types/string/",i.Msg.TEXT_COMPARE_STRING_HELPURL="",i.Msg.TEXT_COMPARE_STRING_TEXT="Comparison of the two chains: ",i.Msg.TEXT_COMPARE_STRING_TEXT2=" = ",i.Msg.TEXT_COMPARE_STRING_TOOLTIP="Lets you know if two strings are identical or not.",i.Msg.TEXT_LENGTH_TITLE="length of %1",i.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",i.Msg.PROCEDURES_DEFRETURN_FUNCTION="for function",i.Msg.PROCEDURES_DEFRETURN_TYPE="type",i.Msg.VARIABLES_AS="as",i.Msg.VARIABLES_SET_CONST="constant",i.Msg.VARIABLES_SET_CONST_AT="set",i.Msg.VARIABLES_SET_CONST_TOOLTIP="set a variable to non modifiable value",i.Msg.VARIABLES_SET_CONST_HELPURL="https://www.arduino.cc/reference/en/language/variables/variable-scope-qualifiers/const/",i.Msg.ARD_TYPE_ARRAY="Array",i.Msg.ARD_TYPE_BOOL="Boolean",i.Msg.ARD_TYPE_CHAR="Character",i.Msg.ARD_TYPE_ARRAY_CHAR="Character array",i.Msg.ARD_TYPE_CHILDBLOCKMISSING="ChildBlockMissing",i.Msg.ARD_TYPE_DECIMAL="Decimal",i.Msg.ARD_TYPE_LONG="Large Number",i.Msg.ARD_TYPE_NULL="Null",i.Msg.ARD_TYPE_NUMBER="Number",i.Msg.ARD_TYPE_SHORT="Short Number (byte)",i.Msg.ARD_TYPE_TEXT="Text",i.Msg.ARD_TYPE_UNDEF="Undefined",i.Msg.ARD_TYPE_UNS_NUMBER="Unsigned number",i.Msg.ARD_TYPE_UNS_LONG="Unsigned Long Number",i.Msg.ARD_TYPE_VOLATILE="Volatile integer",i.Msg.FIELDDROPDOWN=[["HIGH","HIGH"],["LOW","LOW"]],i.Msg.FIELDDROPDOWN_ONOFF=[["ON","ON"],["OFF","OFF"]],i.Msg.FIELDDROPDOWN_0_1=[["HAUT","HIGH"],["BAS","LOW"]],i.Msg.ligne=[["1","1"],["2","2"]],i.Msg.colonne=[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["14","14"],["14","14"],["15","15"],["16","16"]],i.Msg.FIELDDROPDOWN_av_ar=[["avant","HIGH"],["arrire","LOW"]],i.Msg.INOUT_HIGH_LEVEL="1 -> HIGH",i.Msg.INOUT_LOW_LEVEL="0 -> low",i.Msg.WII_JOY_DROPDOWN=[["horizontal","H"],["vertical","V"]],i.Msg.WII_ACCEL_DROPDOWN=[["X","X"],["Y","Y"],["Z","Z"]],i.Msg.WII_ACCEL_BUTTON=[["C","C"],["Z","Z"]],i.Msg.WII_ACCEL_BUTTON_STATE=[["pressed","PRESSED"],["released","RELEASED"]],i.Msg.COMPONENT_WARN="A %1 configuration block with the same '%2' name must be added to use this block!",i.Msg.SOFTSERIAL_COMPONENT="softserial",i.Msg.STEPPER_COMPONENT="stepper",i.Msg.NEOPIXEL_COMPONENT="Neopixel",i.Msg.SERVO_COMPONENT="servomotor",i.Msg.SERVO_DEFAULT_NAME="SERVO",i.Msg.SHARP_IR_COMPONENT="Sharp IR",i.Msg.NEW_INSTANCE="New Instance",i.Msg.RENAME_INSTANCE="Rename Instance",i.Msg.NEW_INSTANCE_TITLE="New Instance Name:",i.Msg.RENAME_INSTANCE_TITLE='Rename all "%1" instances to:',i.Msg.ARDUINO_BASE_DELAY_HELPURL="http://arduino.cc/en/Reference/delay",i.Msg.ARDUINO_BASE_DELAY_DELAY_TIME="delay (in ms)",i.Msg.ARDUINO_BASE_DELAY_DELAY_TIME_SEC="delay (in s)",i.Msg.ARDUINO_BASE_DELAY_TOOLTIP="specify the pause time in milliseconds",i.Msg.ARDUINO_BASE_SETUP="Setup",i.Msg.ARDUINO_BASE_SETUP_HELPURL="https://www.arduino.cc/en/Reference/Setup",i.Msg.ARDUINO_BASE_LOOP="Arduino loop forever:",i.Msg.ARDUINO_BASE_SETUP_LOOP_HELPURL="https://www.arduino.cc/en/Reference/Loop",i.Msg.ARDUINO_SINCE_PROGRAM_STARTED_HELPURL="https://www.arduino.cc/en/Reference/Millis",i.Msg.ARDUINO_SINCE_PROGRAM_STARTED="time (in ms) since program started",i.Msg.ARDUINO_SINCE_PROGRAM_STARTED_SEC="time (in s) since program started",i.Msg.ARDUINO_SINCE_PROGRAM_STARTED_TOOLTIP="Number of milliseconds since the program started (unsigned long)",i.Msg.ARDUINO_BETWEEN="random number between",i.Msg.ARDUINO_BETWEEN_AND="and",i.Msg.ARDUINO_BASE_MAP_HELPURL="http://arduino.cc/en/Reference/map",i.Msg.ARDUINO_BASE_MAP_NUM="to the transposed ",i.Msg.ARDUINO_BASE_MAP_DMAX="over a range of [0-",i.Msg.ARDUINO_BASE_MAP_TOOLTIP="transfer a value on a scale from 0 to 1023 to another scale",i.Msg.ARDUINO_BASE_CODE="Coding",i.Msg.ARDUINO_BASE_COMMENT_HELPURL="https://www.arduino.cc/reference/en/language/structure/further-syntax/blockcomment/",i.Msg.ARDUINO_BASE_COMMENT_TEXT="comment",i.Msg.ARDUINO_BASE_CONST="define",i.Msg.ARDUINO_BASE_DEFINE_HELPURL="https://www.arduino.cc/en/Reference/Define",i.Msg.ARDUINO_BASE_DEFINE="Define",i.Msg.ARDUINO_BASE_DEFINE_TOOLTIP="Define constants & librairies",i.Msg.ARDUINO_BASE_DEFINE_CONST_HELPURL="https://www.arduino.cc/en/Reference/Define",i.Msg.ARDUINO_BASE_DEFINE_CONST_INPUT1="define variable",i.Msg.ARDUINO_BASE_DEFINE_CONST_INPUT2="as",i.Msg.ARDUINO_BASE_DEFINE_CONST_TOOLTIP="allows the programmer to give a name to a constant value before the program is compiled",i.Msg.ARDUINO_BASE_END="wait forever (END of program)",i.Msg.ARDUINO_BASE_BEGIN_TOOLTIP="help to show start and end of a program",i.Msg.ARDUINO_BASE_BEGIN="START program",i.Msg.ARDUINO_BASE_TEMPO1="when",i.Msg.ARDUINO_BASE_TEMPO2="elapsed",i.Msg.ARDUINO_BASE_TEMPO_TIME=[["microsecondes","us"],["millisecondes","ms"],["secondes","s"]],i.Msg.ARDUINO_BASE_TEMPO_TOOLTIP="Verify if interval of time is elapsed, if so do instructions.",i.Msg.ARDUINO_BASE_TEMPO_HELPURL="http://www.mon-club-elec.fr/pmwiki_reference_arduino/pmwiki.php?n=Main.ExempleBlinkWithoutDelay",i.Msg.ARDUINO_BASE_TOGGLE="toggle PIN state",i.Msg.ARDUINO_BASE_TOGGLE_TOOLTIP="Toggle :\nwrite logic state 0 if was 1, or 1 if was 1, on PIN#",i.Msg.ARDUINO_BASE_INCLUDE_FILE_TEXT="Inclure un fichier",i.Msg.ARDUINO_BASE_INCLUDE_FILE_NAME="Nom du fichier",i.Msg.ARDUINO_BASE_INCLUDE_FILE_TOOLTIP="Permet d'inclure un fichier contenu dans le repertoire de travail",i.Msg.ARDUINO_BASE_INCLUDE_FILE_HELPURL="https://www.arduino.cc/reference/en/language/structure/further-syntax/include/",i.Msg.ARDUINO_BASE_INCLUDE_LIB_TEXT="include librarie",i.Msg.ARDUINO_BASE_INCLUDE_LIB_TOOLTIP=" include outside libraries in your sketch",i.Msg.ARDUINO_CONSTRAIN="constrain",i.Msg.ARDUINO_CONSTRAIN_X=" number",i.Msg.ARDUINO_CONSTRAIN_A="from A = ",i.Msg.ARDUINO_CONSTRAIN_B="to B = ",i.Msg.ARDUINO_CONSTRAIN_HELPURL="http://arduino.cc/en/Reference/Constrain",i.Msg.ARDUINO_CONSTRAIN_TOOLTIP="Constrains a number to be within a range.",i.Msg.ARDUINO_INOUT_BUILDIN_LED_HELPURL="http://arduino.cc/en/Reference/DigitalWrite",i.Msg.ARDUINO_INOUT_BUILDIN_LED_INPUT="put the LEDs on the card to logic",i.Msg.ARDUINO_INOUT_BUILDIN_LED_TOOLTIP="off or turn on the LED on the Arduino board",i.Msg.ARDUINO_INOUT_DIGITAL_WRITE_HELPURL="http://arduino.cc/en/Reference/DigitalWrite",i.Msg.ARDUINO_INOUT_DIGITAL_WRITE_INPUT1="put the pin Digital",i.Msg.ARDUINO_INOUT_DIGITAL_WRITE_INPUT2="to logic state",i.Msg.ARDUINO_INOUT_DIGITAL_WRITE_TOOLTIP="write a 0 or 1 state numeric on a specific output",i.Msg.ARDUINO_INOUT_DIGITAL_READ_HELPURL="http://arduino.cc/en/Reference/DigitalRead",i.Msg.ARDUINO_INOUT_DIGITAL_READ_INPUT="the logic state of the digital pin",i.Msg.ARDUINO_INOUT_DIGITAL_READ_TOOLTIP="reading the digital state 0 or 1 of the digital pin",i.Msg.ARDUINO_INOUT_DIGITAL_READ_PULL_UP="pull up",i.Msg.ARDUINO_INOUT_DIGITAL_READ_PULL_UP_TOOLTIP="reading the digital state 0 or 1 of the digital pin\npull-up option to check",i.Msg.ARDUINO_INOUT_PWM_WRITE_HELPURL="http://arduino.cc/en/Reference/AnalogWrite",i.Msg.ARDUINO_INOUT_PWM_WRITE_INPUT1="write on pin PWM~",i.Msg.ARDUINO_INOUT_PWM_WRITE_INPUT2="value",i.Msg.ARDUINO_INOUT_PWM_WRITE_TOOLTIP="send a value between 0 and 255 on a specific output \nWARNING verify the No. on the board !",i.Msg.ARDUINO_INOUT_ANALOG_WRITE_HELPURL="http://arduino.cc/en/Reference/AnalogWrite",i.Msg.ARDUINO_INOUT_ANALOG_WRITE_INPUT1="write about Analog pin",i.Msg.ARDUINO_INOUT_ANALOG_WRITE_INPUT2="value",i.Msg.ARDUINO_INOUT_ANALOG_WRITE_TOOLTIP="send a value between 0 and 255 on a specific output",i.Msg.ARDUINO_TONE_HELPURL="http://arduino.cc/en/Reference/AnalogWrite",i.Msg.ARDUINO_TONE_INPUT1="emits sound on the pin",i.Msg.ARDUINO_TONE_INPUT2="on frequency (Hz)",i.Msg.ARDUINO_TONE_INPUT3="for a time (ms)",i.Msg.ARDUINO_TONE_TOOLTIP="emits sound on the selected pin",i.Msg.ARDUINO_NOTONE_HELPURL="http://arduino.cc/en/Reference/AnalogWrite",i.Msg.ARDUINO_NOTONE_INPUT="stop sound on the pin",i.Msg.ARDUINO_NOTONE_TOOLTIP="mutes the sound on the selected pin",i.Msg.ARDUINO_INOUT_ANALOG_READ_HELPURL="http://arduino.cc/en/Reference/AnalogRead",i.Msg.ARDUINO_INOUT_ANALOG_READ_INPUT="read value on the analog input",i.Msg.ARDUINO_INOUT_ANALOG_READ_TOOLTIP="returns a value between 0 and 1023",i.Msg.ARDUINO_INOUT_ONOFF_HELPURL="http://arduino.cc/en/Reference/Constants",i.Msg.ARDUINO_INOUT_STATE="state",i.Msg.ARDUINO_INOUT_ANGLE="angle",i.Msg.ARDUINO_INOUT_ANGLE_TOOLTIP="angle entre 0 et 360",i.Msg.ARDUINO_INOUT_ANGLE_HELPURL="https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/angle",i.Msg.ARDUINO_PULSEIN="PulseIn (s) pin#",i.Msg.ARDUINO_PULSEIN_TIMEOUT="timeout (s) ",i.Msg.ARDUINO_SERVO_MOVE_HELPURL="http://www.arduino.cc/playground/ComponentLib/servo",i.Msg.ARDUINO_SERVO_MOVE_INPUT1="Rotate the Servo motor",i.Msg.ARDUINO_SERVO_MOVE_IMAGE="images/a991.jpg",i.Msg.ARDUINO_SERVO_MOVE_INPUT2="on the pin",i.Msg.ARDUINO_SERVO_MOVE_DEGREE="an angle (0~180) of",i.Msg.ARDUINO_SERVO_MOVE_DELAY_TIME="during a period (ms)",i.Msg.ARDUINO_SERVO_MOVE_TOOLTIP="rotation possible between 0 ~ 180 degrees",i.Msg.ARDUINO_SERVO_READ_DEGREES_HELPURL="http://www.arduino.cc/playground/ComponentLib/servo",i.Msg.ARDUINO_SERVO_READ_DEGREES_INPUT1="the angle of the servo motor",i.Msg.ARDUINO_SERVO_READ_DEGREES_IMAGE="images/a991.jpg",i.Msg.ARDUINO_SERVO_READ_DEGREES_INPUT2="connected on the pin",i.Msg.ARDUINO_SERVO_READ_DEGREES_TOOLTIP="returns the number of degrees the last rotation",i.Msg.ARDUINO_SERVO_ROT_CONTINUE_HELPURL="https://www.arduino.cc/en/Reference/ServoWrite",i.Msg.ARDUINO_SERVO_ROT_CONTINUE_TEXT="turn continuous servomotor",i.Msg.ARDUINO_SERVO_ROT_CONTINUE_INPUT1="PIN#",i.Msg.ARDUINO_SERVO_ROT_CONTINUE_INPUT2="speed [0~180]",i.Msg.ARDUINO_SERVO_ROT_CONTINUE_INPUT3="speed [0~90]",i.Msg.ARDUINO_SERVO_ROT_CONTINUE_INPUT4="direction",i.Msg.ARDUINO_SERVO_ROT_CONTINUE_TOOLTIP="degrees for power : 0 -> max on left | 90 -> stop | 180 -> max on right",i.Msg.ARDUINO_SERVO_PIN="PIN#",i.Msg.ARDUINO_SERVO_ATTACH1="Attach Servomotor",i.Msg.ARDUINO_SERVO_ATTACH2="Assign Name",i.Msg.ARDUINO_SERVO_ATTACHED="Servomotor attached?",i.Msg.ARDUINO_SERVO_DETACH="Detach Servomotor",i.Msg.ARDUINO_SERIAL_PRINT_HELPURL="http://www.arduino.cc/en/Serial/Print",i.Msg.ARDUINO_SERIAL_PRINT_CONTENT="send the data to the serial port:",i.Msg.ARDUINO_SERIAL_PRINTLN_CONTENT="print new line data on serial port:",i.Msg.ARDUINO_SERIAL_PRINT_TAB_CONTENT="print with tab data on serial port:",i.Msg.ARDUINO_SERIAL_PRINT_TOOLTIP="sends data over the serial port for sruvaillance by the monitor in ASCII",i.Msg.ARDUINO_SERIAL_PRINT_VAR_TEXT="print text on serial port :",i.Msg.ARDUINO_SERIAL_PRINT_VAR_NUMBER="with this following number :",i.Msg.ARDUINO_SERIAL_PRINT_VAR_NEW_LINE="and go to a new line ?",i.Msg.ARDUINO_SERIAL_PRINT_MULTI_NUMBER="Afficher sur le port Srie :",i.Msg.ARDUINO_SERIAL_PRINT_MULTI_NEWLINE="Nouvelle ligne?",i.Msg.ARDUINO_SERIAL_PRINT_MULTI_FIELDDROPDOWN=[["oui","true"],["non","false"]],i.Msg.LKL_ATTACHINTERRUPT_PIN="attachInterrupt pin#",i.Msg.LKL_DETACHINTERRUPT_PIN="detachInterrupt pin#",i.Msg.LKL_TOOLTIP_INOUT_ATTACHINTERRUPT="Attachs interrupt to a specific Port",i.Msg.LKL_TOOLTIP_INOUT_DETACHINTERRUPT="Detachs interrupt to a specific Port",i.Msg.LKL_MODE="mode",i.Msg.LKL_DROPDOWN=[["RISING","RISING"],["FALLING","FALLING"],["CHANGE","CHANGE"],["LOW","LOW"]],i.Msg.Serial_Init="Serial communication init speed",i.Msg.Serial_Print="Serial Print console",i.Msg.Serial_Write="Serial write",i.Msg.Serial_write_out="Write",i.Msg.Serial_Print_Format="Print  Format",i.Msg.Serial_Print_ForDecimal="decimal",i.Msg.Serial_Print_ForHexa="hexadecimal",i.Msg.Serial_Print_ForBin="binary",i.Msg.Serial_Print_ForOct="octal",i.Msg.Serial_read="Serial Read",i.Msg.Serial_avai="Serial Available?",i.Msg.Serial_flush="Serial flush",i.Msg.Serial_line="line break",i.Msg.Serial_line_tooltip="insert a line break in serial monitor",i.Msg.ARDUINO_SERIAL_READSTRINGUNTIL_HELPURL="https://www.arduino.cc/en/Serial/ReadStringUntil",i.Msg.ARDUINO_SERIAL_READSTRINGUNTIL_CONTENT="String read until",i.Msg.ARDUINO_SERIAL_READSTRINGUNTIL_TOOLTIP="reads characters from the serial buffer into a string",i.Msg.SSERIAL_DEFAULT_NAME="SoftSerial",i.Msg.SSERIAL_Init="INIT",i.Msg.SSERIAL_SPEED="speed",i.Msg.SSERIAL_TX="TX#",i.Msg.SSERIAL_RX="RX#",i.Msg.SSERIAL_Read="SoftwareSerial Read",i.Msg.SSERIAL_Print="SoftwareSerial Print",i.Msg.SSERIAL_Write="SoftwareSerial Write",i.Msg.SSERIAL_Avai="SoftwareSerial Available?",i.Msg.ARDUINO_VAR_DECLARE="Declare",i.Msg.ARDUINO_VAR_AS="as",i.Msg.ARDUINO_VAR_VAL="value",i.Msg.CONV_tochar="Convert to char ",i.Msg.CONV_tobyte="Convert to Byte ",i.Msg.CONV_toint="Convert to Int ",i.Msg.CONV_tofloat="Convert to Float ",i.Msg.CONV_toString="Convert to String ",i.Msg.CONVERSION_MAP_HELPURL="https://www.arduino.cc/en/Reference/Map",i.Msg.CONVERSION_MAP_NUM="re-maps value",i.Msg.CONVERSION_MAP_IN_MIN="from low",i.Msg.CONVERSION_MAP_IN_MAX="and from Max",i.Msg.CONVERSION_MAP_OUT_MIN="to low",i.Msg.CONVERSION_MAP_OUT_MAX="and to Max",i.Msg.CONVERSION_MAP_TOOLTIP="re-maps a number from one range to another",i.Msg.ARD_ANALOGREAD="read analog pin#",i.Msg.ARD_ANALOGREAD_TIP="Return value between 0 and 1024",i.Msg.ARD_ANALOGWRITE="set analog pin#",i.Msg.ARD_ANALOGWRITE_TIP="Write analog value between 0 and 255 to a specific PWM Port",i.Msg.ARD_BUILTIN_LED="set built-in LED",i.Msg.ARD_BUILTIN_LED_TIP="Light on or off for the built-in LED of the Arduino",i.Msg.ARD_COMPONENT_WARN1="A %1 configuration block with the same %2 name must be added to use this block!",i.Msg.ARD_DEFINE="Define",i.Msg.ARD_DIGITALREAD="read digital pin#",i.Msg.ARD_DIGITALREAD_TIP="Read digital value on a pin: HIGH or LOW",i.Msg.ARD_DIGITALWRITE="set digitial pin#",i.Msg.ARD_DIGITALWRITE_TIP="Write digital value HIGH or LOW to a specific Port",i.Msg.ARD_FUN_RUN_LOOP="Arduino loop forever:",i.Msg.ARD_FUN_RUN_SETUP="Arduino run first:",i.Msg.ARD_FUN_RUN_TIP="Defines the Arduino setup() and loop() functions.",i.Msg.ARD_HIGH="HIGH",i.Msg.ARD_HIGHLOW_TIP="Set a pin state logic High or Low.",i.Msg.ARD_LOW="LOW",i.Msg.ARD_MAP="Map",i.Msg.ARD_MAP_TIP="Re-maps a number from [0-1024] to another.",i.Msg.ARD_MAP_VAL="value to [0-",i.Msg.ARD_NOTONE="Turn off tone on pin #",i.Msg.ARD_NOTONE_PIN="No tone PIN#",i.Msg.ARD_NOTONE_PIN_TIP="Stop generating a tone on a pin",i.Msg.ARD_NOTONE_TIP="Turns the tone off on the selected pin",i.Msg.ARD_PIN_WARN1="Pin %1 is needed for %2 as pin %3. Already used as %4.",i.Msg.ARD_PULSETIMEOUT_TIP="Measures the duration of a pulse on the selected pin, if it is within the time-out in microseconds.",i.Msg.ARD_PULSE_READ="measure %1 pulse on pin #%2",i.Msg.ARD_PULSE_READ_TIMEOUT="measure %1 pulse on pin #%2 (timeout after %3 s)",i.Msg.ARD_PULSE_TIP="Measures the duration of a pulse on the selected pin.",i.Msg.ARD_SERIAL_BPS="bps",i.Msg.ARD_SERIAL_PRINT="print",i.Msg.ARD_SERIAL_PRINT_NEWLINE="add new line",i.Msg.ARD_SERIAL_PRINT_TIP="Prints data to the console/serial port as human-readable ASCII text.",i.Msg.ARD_SERIAL_PRINT_WARN="A setup block for %1 must be added to the workspace to use this block!",i.Msg.ARD_SERIAL_SETUP="Setup",i.Msg.ARD_SERIAL_SETUP_TIP="Selects the speed for a specific Serial peripheral",i.Msg.ARD_SERIAL_SPEED=":  speed to",i.Msg.ARD_SERVO_READ="read SERVO from PIN#",i.Msg.ARD_SERVO_READ_TIP="Read a Servo angle",i.Msg.ARD_SERVO_WRITE="set SERVO from Pin",i.Msg.ARD_SERVO_WRITE_DEG_180="Degrees (0~180)",i.Msg.ARD_SERVO_WRITE_TIP="Set a Servo to an specified angle",i.Msg.ARD_SERVO_WRITE_TO="to",i.Msg.ARD_SETTONE="Set tone on pin #",i.Msg.ARD_SPI_SETUP="Setup",i.Msg.ARD_SPI_SETUP_CONF="configuration:",i.Msg.ARD_SPI_SETUP_DIVIDE="clock divide",i.Msg.ARD_SPI_SETUP_LSBFIRST="LSBFIRST",i.Msg.ARD_SPI_SETUP_MODE="SPI mode (idle - edge)",i.Msg.ARD_SPI_SETUP_MODE0="0 (Low - Falling)",i.Msg.ARD_SPI_SETUP_MODE1="1 (Low - Rising)",i.Msg.ARD_SPI_SETUP_MODE2="2 (High - Falling)",i.Msg.ARD_SPI_SETUP_MODE3="3 (High - Rising)",i.Msg.ARD_SPI_SETUP_MSBFIRST="MSBFIRST",i.Msg.ARD_SPI_SETUP_SHIFT="data shift",i.Msg.ARD_SPI_SETUP_TIP="Configures the SPI peripheral.",i.Msg.ARD_SPI_TRANSRETURN_TIP="Send a SPI message to an specified slave device and get data back.",i.Msg.ARD_SPI_TRANS_NONE="none",i.Msg.ARD_SPI_TRANS_SLAVE="to slave pin",i.Msg.ARD_SPI_TRANS_TIP="Send a SPI message to an specified slave device.",i.Msg.ARD_SPI_TRANS_VAL="transfer",i.Msg.ARD_SPI_TRANS_WARN1="A setup block for %1 must be added to the workspace to use this block!",i.Msg.ARD_SPI_TRANS_WARN2="Old pin value %1 is no longer available.",i.Msg.ARD_STEPPER_COMPONENT="stepper",i.Msg.ARD_STEPPER_DEFAULT_NAME="MyStepper",i.Msg.ARD_STEPPER_FOUR_PINS="4",i.Msg.ARD_STEPPER_MOTOR="stepper motor:",i.Msg.ARD_STEPPER_NUMBER_OF_PINS="Number of pins",i.Msg.ARD_STEPPER_PIN1="pin1#",i.Msg.ARD_STEPPER_PIN2="pin2#",i.Msg.ARD_STEPPER_PIN3="pin3#",i.Msg.ARD_STEPPER_PIN4="pin4#",i.Msg.ARD_STEPPER_REVOLVS="how many steps per revolution",i.Msg.ARD_STEPPER_SETUP="Setup stepper motor",i.Msg.ARD_STEPPER_SETUP_TIP="Configures a stepper motor pinout and other settings.",i.Msg.ARD_STEPPER_SPEED="set speed (rpm) to",i.Msg.ARD_STEPPER_STEP="move stepper",i.Msg.ARD_STEPPER_STEPS="steps",i.Msg.ARD_STEPPER_STEP_TIP="Turns the stepper motor a specific number of steps.",i.Msg.ARD_STEPPER_TWO_PINS="2",i.Msg.ARD_TIME_DELAY="wait",i.Msg.ARD_TIME_DELAY_MICROS="microseconds",i.Msg.ARD_TIME_DELAY_MICRO_TIP="Wait specific time in microseconds",i.Msg.ARD_TIME_DELAY_TIP="Wait specific time in milliseconds",i.Msg.ARD_TIME_INF="wait forever (end program)",i.Msg.ARD_TIME_INF_TIP="Wait indefinitely, stopping the program.",i.Msg.ARD_TIME_MICROS="current elapsed Time (microseconds)",i.Msg.ARD_TIME_MICROS_TIP="Returns the number of microseconds since the Arduino board began running the current program. Has to be stored in a positive long integer",i.Msg.ARD_TIME_MILLIS="current elapsed Time (milliseconds)",i.Msg.ARD_TIME_MILLIS_TIP="Returns the number of milliseconds since the Arduino board began running the current program. Has to be stored in a positive long integer",i.Msg.ARD_TIME_MS="milliseconds",i.Msg.ARD_TONEFREQ="at frequency",i.Msg.ARD_TONE_FREQ="frequency",i.Msg.ARD_TONE_PIN="Tone PIN#",i.Msg.ARD_TONE_PIN_TIP="Generate audio tones on a pin",i.Msg.ARD_TONE_TIP="Sets tone on pin to specified frequency within range 31 - 65535",i.Msg.ARD_TONE_WARNING="Frequency must be in range 31 - 65535",i.Msg.ARD_TYPE_ARRAY="Array",i.Msg.ARD_TYPE_BOOL="Boolean",i.Msg.ARD_TYPE_CHAR="Character",i.Msg.ARD_TYPE_CHILDBLOCKMISSING="ChildBlockMissing",i.Msg.ARD_TYPE_DECIMAL="Decimal",i.Msg.ARD_TYPE_LONG="Large Number",i.Msg.ARD_TYPE_NULL="Null",i.Msg.ARD_TYPE_NUMBER="Number",i.Msg.ARD_TYPE_SHORT="Short Number",i.Msg.ARD_TYPE_TEXT="Text",i.Msg.ARD_TYPE_UNDEF="Undefined",i.Msg.ARD_VAR_AS="as",i.Msg.ARD_VAR_AS_TIP="Sets a value to a specific type",i.Msg.ARD_WRITE_TO="to",i.Msg.NEW_INSTANCE="New instance...",i.Msg.NEW_INSTANCE_TITLE="New instance name:",i.Msg.RENAME_INSTANCE="Rename instance...",i.Msg.RENAME_INSTANCE_TITLE="Rename all '%1' instances to:",i.Msg.ARDUINO_INOUT_DIGITAL_MODE_HELPURL="https://www.arduino.cc/en/Reference/PinMode",i.Msg.ARDUINO_INOUT_DIGITAL_MODE_INPUT1="Set Pin Mode for pin",i.Msg.ARDUINO_INOUT_DIGITAL_MODE_INPUT2="to",i.Msg.ARDUINO_INOUT_DIGITAL_MODE_DROPDOWN=[["INPUT","INPUT"],["OUTPUT","OUTPUT"],["INPUT_PULLUP","INPUT_PULLUP"]],i.Msg.ARDUINO_INOUT_DIGITAL_MODE_TOOLTIP="Configures the specified pin to behave either as an input or an output";var j=class{constructor(a){this.typeId=a.typeId,this.typeMsgName=a.typeMsgName,this.compatibleTypes=a.compatibleTypes||[]}get typeName(){return this.typeMsgName}addCompatibleTypes(a){this.compatibleTypes.push(...a)}},k={CONST_NUMBER:new j({typeId:"Const Number",typeMsgName:"NUMBER"}),CHARACTER:new j({typeId:"Character",typeMsgName:"CHAR"}),TEXT:new j({typeId:"Text",typeMsgName:"TEXT"}),BOOLEAN:new j({typeId:"Boolean",typeMsgName:"BOOL"}),SHORT_NUMBER:new j({typeId:"Short Number",typeMsgName:"SHORT"}),NUMBER:new j({typeId:"Number",typeMsgName:"NUMBER"}),UNS_NUMBER:new j({typeId:"Unsigned number",typeMsgName:"UNS_NUMBER"}),VOLATIL_NUMBER:new j({typeId:"Volatil Number",typeMsgName:"VOLATILE"}),LARGE_NUMBER:new j({typeId:"Large Number",typeMsgName:"LONG"}),LARGE_UNS_NUMBER:new j({typeId:"Unsigned Large Number",typeMsgName:"UNS_LONG"}),DECIMAL:new j({typeId:"Decimal",typeMsgName:"DECIMAL"}),ARRAY:new j({typeId:"Array",typeMsgName:"ARRAY"}),NULL:new j({typeId:"Null",typeMsgName:"NULL"}),UNDEF:new j({typeId:"Undefined",typeMsgName:"UNDEF"}),CHILD_BLOCK_MISSING:new j({typeId:"ChildBlockMissing",typeMsgName:"CHILDBLOCKMISSING"})};function l(){let a=[],b=["UNDEF","CHILD_BLOCK_MISSING","NULL","ARRAY"];for(let[c,d]of Object.entries(k))!b.includes(c)&&d instanceof j&&a.push([d.typeName,c]);return a}k.TEXT.addCompatibleTypes([k.CHARACTER]),k.UNS_NUMBER.addCompatibleTypes([k.SHORT_NUMBER,k.NUMBER]),k.LARGE_UNS_NUMBER.addCompatibleTypes([k.SHORT_NUMBER,k.NUMBER,k.LARGE_NUMBER]),k.NUMBER.addCompatibleTypes([k.BOOLEAN,k.SHORT_NUMBER,k.LARGE_NUMBER,k.DECIMAL]),k.CONST_NUMBER.addCompatibleTypes([k.BOOLEAN,k.SHORT_NUMBER,k.LARGE_NUMBER,k.DECIMAL]),k.UNS_NUMBER.addCompatibleTypes([k.BOOLEAN,k.SHORT_NUMBER,k.NUMBER,k.DECIMAL]),k.SHORT_NUMBER.addCompatibleTypes([k.BOOLEAN,k.NUMBER,k.DECIMAL]),k.LARGE_NUMBER.addCompatibleTypes([k.BOOLEAN,k.SHORT_NUMBER,k.UNS_NUMBER,k.NUMBER,k.DECIMAL]),k.LARGE_UNS_NUMBER.addCompatibleTypes([k.BOOLEAN,k.SHORT_NUMBER,k.UNS_NUMBER,k.NUMBER,k.LARGE_NUMBER,k.DECIMAL]),k.VOLATIL_NUMBER.addCompatibleTypes([k.SHORT_NUMBER,k.LARGE_NUMBER,k.UNS_NUMBER,k.NUMBER]),k.DECIMAL.addCompatibleTypes([k.BOOLEAN,k.SHORT_NUMBER,k.NUMBER,k.LARGE_NUMBER]);var m=/^-?\d+$/,n=/^-?[0-9]*[.][0-9]+$/;function o(a){let b,c=a;for(;c&&!c.getBlockType&&c.inputList.length>0&&null!=c.inputList[0].connection;)c=c.inputList[0].connection.targetBlock();if(c===a)b=k.CHILD_BLOCK_MISSING;else if(null===c)b=k.CHILD_BLOCK_MISSING;else{let a=c.getBlockType;b=a?a.call(c):k.NULL}return b}function p(a,b){let c=[];for(let d=a;d<=b;d++)c.push([d.toString(),d.toString()]);return c}function q(a,b){let c=[];for(let d=a;d<=b;d++)c.push([`A${d}`,`A${d}`]);return c}var r=[["300","300"],["600","600"],["1200","1200"],["2400","2400"],["4800","4800"],["9600","9600"],["14400","14400"],["19200","19200"],["28800","28800"],["31250","31250"],["38400","38400"],["57600","57600"],["115200","115200"]],s=[["2 (8MHz)","SPI_CLOCK_DIV2"],["4 (4MHz)","SPI_CLOCK_DIV4"],["8 (2MHz)","SPI_CLOCK_DIV8"],["16 (1MHz)","SPI_CLOCK_DIV16"],["32 (500KHz)","SPI_CLOCK_DIV32"],["64 (250KHz)","SPI_CLOCK_DIV64"],["128 (125KHz)","SPI_CLOCK_DIV128"]],t={name:"Arduino Uno",description:"Arduino Uno standard compatible board",compilerFlag:"arduino:avr:uno",image:"/boards/uno.png",analogPins:q(0,5),digitalPins:[...p(0,13),...q(0,5)],pwmPins:[["3","3"],["5","5"],["6","6"],["9","9"],["10","10"],["11","11"]],serial:[["serial","Serial"]],serialPins:{Serial:[["RX","0"],["TX","1"]]},serialSpeed:r,spi:[["SPI","SPI"]],spiPins:{SPI:[["MOSI","11"],["MISO","12"],["SCK","13"]]},spiClockDivide:s,i2c:[["I2C","Wire"]],i2cPins:{Wire:[["SDA","A4"],["SCL","A5"]]},i2cSpeed:[["100kHz","100000L"],["400kHz","400000L"]],builtinLed:[["BUILTIN_1","13"]],interrupt:[["interrupt0","2"],["interrupt1","3"]],bootloader:"uno"};q(0,7),[...p(0,13),...q(0,7)],t.pwmPins,t.serial,t.serialPins,t.serialSpeed,t.spi,t.spiPins,t.spiClockDivide,t.i2c,t.i2cPins,t.i2cSpeed,t.builtinLed,t.interrupt,q(0,15),[...p(0,53),...q(0,15)],[...p(2,13),...p(44,46)],t.builtinLed,q(0,7),[...p(0,13),...q(0,7)],t.pwmPins,t.serial,t.serialPins,t.serialSpeed,t.spi,t.spiPins,t.spiClockDivide,t.i2c,t.i2cPins,t.i2cSpeed,t.builtinLed,t.interrupt,[...q(0,19)],[...p(0,5),...p(12,19),...p(21,23),...p(25,27),...p(32,33)],p(0,33),p(0,39),t.i2cSpeed;function u(){return t.digitalPins}function v(){return t.analogPins}var w={get AllPins(){return u()},get AllPinsAnalog(){return v()},get analogPins(){return v()},get PwmPins(){return t.pwmPins},get BuiltinLed(){return t.builtinLed},get onlyVar(){return[["",""]]},Boards:{get selected(){return t},refreshBlockFieldDropdown(a,b,c,d){let e,f=a.getField(b);if(f){switch(c){case"AllPins":e=u();break;case"AllPinsAnalog":case"analogPins":e=v();break;case"digitalPins":e=t.digitalPins;break;case"pwmPins":e=t.pwmPins;break;case"builtinLed":e=t.builtinLed;break;case"onlyVar":if(!d){e=[["",""]];break}let a=d.getVariableMap().getVariablesOfType("");e=0===a.length?[["",""]]:a.map(a=>[a.getName(),a.getName()]);break;default:e=[]}e.length>0&&f.menuGenerator_&&(f.menuGenerator_=e)}}}};let{Block:x,BlockFlyoutInflater:y,BlockNavigationPolicy:z,BlockSvg:A,Blocks:B,ButtonFlyoutInflater:C,COLLAPSED_FIELD_NAME:D,COLLAPSED_INPUT_NAME:E,COLLAPSE_CHARS:F,CodeGenerator:G,CollapsibleToolboxCategory:H,ComponentManager:I,Connection:J,ConnectionChecker:K,ConnectionDB:L,ConnectionNavigationPolicy:M,ConnectionType:N,ContextMenu:O,ContextMenuItems:P,ContextMenuRegistry:Q,Css:R,DELETE_VARIABLE_ID:S,DeleteArea:T,DragTarget:U,DropDownDiv:V,Events:W,Extensions:X,Field:Y,FieldCheckbox:Z,FieldDropdown:$,FieldImage:_,FieldLabel:aa,FieldLabelSerializable:ab,FieldNavigationPolicy:ac,FieldNumber:ad,FieldTextInput:ae,FieldVariable:af,Flyout:ag,FlyoutButton:ah,FlyoutButtonNavigationPolicy:ai,FlyoutItem:aj,FlyoutMetricsManager:ak,FlyoutNavigationPolicy:al,FlyoutNavigator:am,FlyoutSeparator:an,FlyoutSeparatorNavigationPolicy:ao,FocusManager:ap,FocusableTreeTraverser:aq,Generator:ar,Gesture:as,Grid:at,HorizontalFlyout:au,INPUT_VALUE:av,Input:aw,InsertionMarkerPreviewer:ax,KeyboardNavigationController:ay,LabelFlyoutInflater:az,LineCursor:aA,Marker:aB,MarkerManager:aC,Menu:aD,MenuItem:aE,MetricsManager:aF,Msg:aG,NEXT_STATEMENT:aH,Names:aI,Navigator:aJ,OPPOSITE_TYPE:aK,OUTPUT_VALUE:aL,Options:aM,PREVIOUS_STATEMENT:aN,PROCEDURE_CATEGORY_NAME:aO,Procedures:aP,RENAME_VARIABLE_ID:aQ,RenderedConnection:aR,Scrollbar:aS,ScrollbarPair:aT,SeparatorFlyoutInflater:aU,ShortcutItems:aV,ShortcutRegistry:aW,TOOLBOX_AT_BOTTOM:aX,TOOLBOX_AT_LEFT:aY,TOOLBOX_AT_RIGHT:aZ,TOOLBOX_AT_TOP:a$,Theme:a_,ThemeManager:a0,Themes:a1,Toast:a2,Toolbox:a3,ToolboxCategory:a4,ToolboxItem:a5,ToolboxSeparator:a6,Tooltip:a7,Touch:a8,Trashcan:a9,UnattachedFieldError:ba,VARIABLE_CATEGORY_NAME:bb,VARIABLE_DYNAMIC_CATEGORY_NAME:bc,VERSION:bd,VariableMap:be,VariableModel:bf,Variables:bg,VariablesDynamic:bh,VerticalFlyout:bi,WidgetDiv:bj,Workspace:bk,WorkspaceAudio:bl,WorkspaceDragger:bm,WorkspaceNavigationPolicy:bn,WorkspaceSvg:bo,Xml:bp,ZoomControls:bq,blockAnimations:br,blockRendering:bs,browserEvents:bt,bubbles:bu,bumpObjects:bv,clipboard:bw,comments:bx,common:by,config:bz,constants:bA,defineBlocksWithJsonArray:bB,dialog:bC,dragging:bD,fieldRegistry:bE,geras:bF,getFocusManager:bG,getMainWorkspace:bH,getSelected:bI,hasBubble:bJ,hideChaff:bK,icons:bL,inject:bM,inputs:bN,isCopyable:bO,isDeletable:bP,isDraggable:bQ,isIcon:bR,isObservable:bS,isPaster:bT,isRenderedElement:bU,isSelectable:bV,isSerializable:bW,isVariableBackedParameterModel:bX,keyboardNavigationController:bY,layers:bZ,navigateBlock:b$,navigateStacks:b_,procedures:b0,registry:b1,renderManagement:b2,serialization:b3,setLocale:b4,setParentContainer:b5,svgResize:b6,thrasos:b7,uiPosition:b8,utils:b9,zelos:ca}=a.i(12329).default;var cb="#59C059",cc="#FFAB19",cd="#6990ca",ce="#774DCB",cf="#FF6680",cg="#ff764c",ch="#00979D",ci="#59C059",cj="#47A8D1",ck="#DC143C",cl="#00CED1";a_.defineTheme("hduino_dark",{name:"hduino_dark",base:a1.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"#252526",toolboxForegroundColour:"#cccccc",flyoutBackgroundColour:"#2d2d2d",flyoutForegroundColour:"#cccccc",flyoutOpacity:.9,scrollbarColour:"#797979",insertionMarkerColour:"#ffffff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0"},fontStyle:{family:"IBM Plex Sans, sans-serif",weight:"normal",size:12},startHats:!0}),a_.defineTheme("hduino_light",{name:"hduino_light",base:a1.Classic,componentStyles:{workspaceBackgroundColour:"#ffffff",toolboxBackgroundColour:"#f3f3f3",toolboxForegroundColour:"#333333",flyoutBackgroundColour:"#f3f3f3",flyoutForegroundColour:"#333333",flyoutOpacity:.5,scrollbarColour:"#cccccc",insertionMarkerColour:"#000000",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#333333"},fontStyle:{family:"IBM Plex Sans, sans-serif",weight:"normal",size:12},startHats:!0});var cm=i;cm.Blocks.logic_boolean={init:function(){this.jsonInit({type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",colour:cb,tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"})},getBlockType:function(){return k.BOOLEAN}},cm.Blocks.logic_operation={init:function(){this.jsonInit({type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",colour:cb,helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]})},getBlockType:function(){return k.BOOLEAN}},cm.Blocks.logic_compare={init:function(){let a=this.RTL?[["=","EQ"],["","NEQ"],[">","LT"],["","LTE"],["<","GT"],["","GTE"]]:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]];this.setHelpUrl(cm.Msg.LOGIC_COMPARE_HELPURL),this.setColour(cb),this.setOutput(!0,"Boolean"),this.appendValueInput("A"),this.appendValueInput("B").appendField(new cm.FieldDropdown(a),"OP"),this.setInputsInline(!0);let b=this;this.setTooltip(function(){let a=b.getFieldValue("OP");return({EQ:cm.Msg.LOGIC_COMPARE_TOOLTIP_EQ,NEQ:cm.Msg.LOGIC_COMPARE_TOOLTIP_NEQ,LT:cm.Msg.LOGIC_COMPARE_TOOLTIP_LT,LTE:cm.Msg.LOGIC_COMPARE_TOOLTIP_LTE,GT:cm.Msg.LOGIC_COMPARE_TOOLTIP_GT,GTE:cm.Msg.LOGIC_COMPARE_TOOLTIP_GTE})[a]}),this.prevBlocks_=[null,null]},getBlockType:function(){return k.BOOLEAN},prevBlocks_:[null,null]},cm.Blocks.logic_negate={init:function(){this.jsonInit({type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",colour:cb,tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"})},getBlockType:function(){return k.BOOLEAN}},cm.Blocks.logic_null={init:function(){this.jsonInit({type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,colour:cb,tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"})}},cm.Blocks.controls_if={init:function(){this.jsonInit({type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,colour:cc,helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]})}},cm.Blocks.controls_repeat_ext={init:function(){this.jsonInit({message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,colour:cc,tooltip:cm.Msg.CONTROLS_REPEAT_TOOLTIP,helpUrl:cm.Msg.CONTROLS_REPEAT_HELPURL})}},cm.Blocks.controls_repeat={init:function(){this.jsonInit({message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,colour:cc,tooltip:cm.Msg.CONTROLS_REPEAT_TOOLTIP,helpUrl:cm.Msg.CONTROLS_REPEAT_HELPURL})}},cm.Blocks.controls_whileUntil={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,colour:cc,helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]})}},cm.Blocks.controls_for={init:function(){this.jsonInit({message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:cc,helpUrl:cm.Msg.CONTROLS_FOR_HELPURL}),this.appendStatementInput("DO").appendField(cm.Msg.CONTROLS_FOR_INPUT_DO);let a=this;this.setTooltip(function(){return cm.Msg.CONTROLS_FOR_TOOLTIP.replace("%1",a.getFieldValue("VAR"))})},getVarType:function(a){return k.NUMBER}},cm.Blocks.controls_flow_statements={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,colour:cc,helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]})}},cm.Blocks.math_number={init:function(){this.setHelpUrl(cm.Msg.MATH_NUMBER_HELPURL),this.setColour(cd),this.appendDummyInput().appendField(new cm.FieldTextInput("0",function(a){let b=parseFloat(a||"0");return isNaN(b)?null:String(b)}),"NUM"),this.setOutput(!0,"Number");let a=this;this.setTooltip(function(){let b=a.getParent();return b&&b.getInputsInline()&&b.tooltip||cm.Msg.MATH_NUMBER_TOOLTIP})},getBlockType:function(){var a=this.getFieldValue("NUM");if(m.test(a)){let b=parseInt(a);return isNaN(b)?k.NULL:b>32767||b<-32768?k.LARGE_NUMBER:k.NUMBER}return n.test(a)?k.DECIMAL:k.NULL}},cm.Blocks.math_arithmetic={init:function(){this.jsonInit({message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",colour:cd,helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]})}},cm.Blocks.math_single={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:cd,helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]})},getBlockType:function(){return k.DECIMAL}},cm.Blocks.math_trig={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:cd,helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]})},getBlockType:function(){return k.DECIMAL}},cm.Blocks.math_constant={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",colour:cd,tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"})}},cm.Blocks.math_number_property={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",colour:cd,tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"})},getBlockType:function(){return k.BOOLEAN}},cm.Blocks.math_change={init:function(){this.jsonInit({message0:cm.Msg.MATH_CHANGE_TITLE,args0:[{type:"field_variable",name:"VAR",variable:cm.Msg.MATH_CHANGE_TITLE_ITEM},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,colour:cg,helpUrl:cm.Msg.MATH_CHANGE_HELPURL})},getVarType:function(a){return k.NUMBER}},cm.Blocks.math_round={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",colour:cd,helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"})},getBlockType:function(){return k.DECIMAL}},cm.Blocks.math_on_list={init:function(){this.jsonInit({message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",colour:cd,helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]})}},cm.Blocks.math_modulo={init:function(){this.jsonInit({message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",colour:cd,tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"})},getBlockType:function(){return k.NUMBER}},cm.Blocks.math_constrain={init:function(){this.jsonInit({message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",colour:cd,tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"})}},cm.Blocks.math_random_int={init:function(){this.jsonInit({message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",colour:cd,tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"})},getBlockType:function(){return k.NUMBER}},cm.Blocks.math_random_float={init:function(){this.jsonInit({message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",colour:cd,tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"})},getBlockType:function(){return k.DECIMAL}},cm.Blocks.math_atan2={init:function(){this.jsonInit({message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",colour:cd,tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"})},getBlockType:function(){return k.DECIMAL}},cm.Blocks.text={init:function(){this.jsonInit({type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",colour:ce,helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]})},getBlockType:function(){return k.TEXT}},cm.Blocks.text_join={init:function(){this.jsonInit({type:"text_join",message0:"",output:"String",colour:ce,helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"})},getBlockType:function(){return k.TEXT}},cm.Blocks.text_create_join_container={init:function(){this.jsonInit({type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],colour:ce,tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1})},getBlockType:function(){return k.TEXT}},cm.Blocks.text_create_join_item={init:function(){this.jsonInit({type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,colour:ce,tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1})},getVarType:function(a){return k.TEXT}},cm.Blocks.text_append={init:function(){this.jsonInit({type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,colour:ce,extensions:["text_append_tooltip"]})},getVarType:function(a){return k.TEXT}},cm.Blocks.text_length={init:function(){this.jsonInit({message0:cm.Msg.TEXT_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",colour:ce,tooltip:cm.Msg.TEXT_LENGTH_TOOLTIP,helpUrl:cm.Msg.TEXT_LENGTH_HELPURL})},getBlockType:function(){return k.NUMBER}},cm.Blocks.text_isEmpty={init:function(){this.jsonInit({message0:cm.Msg.TEXT_ISEMPTY_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",colour:ce,tooltip:cm.Msg.TEXT_ISEMPTY_TOOLTIP,helpUrl:cm.Msg.TEXT_ISEMPTY_HELPURL})},getBlockType:function(){return k.BOOLEAN}},cm.Blocks.text_indexOf={init:function(){let a=[[cm.Msg.TEXT_INDEXOF_OPERATOR_FIRST,"FIRST"],[cm.Msg.TEXT_INDEXOF_OPERATOR_LAST,"LAST"]];this.setHelpUrl(cm.Msg.TEXT_INDEXOF_HELPURL),this.setColour(ce),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("String").appendField(cm.Msg.TEXT_INDEXOF_INPUT_INTEXT),this.appendValueInput("FIND").setCheck("String").appendField(new cm.FieldDropdown(a),"END"),cm.Msg.TEXT_INDEXOF_TAIL&&this.appendDummyInput().appendField(cm.Msg.TEXT_INDEXOF_TAIL),this.setInputsInline(!0);let b=this;this.setTooltip(function(){return cm.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",b.workspace.options.oneBasedIndex?"0":"-1")})}},cm.Blocks.text_charAt={WHERE_OPTIONS:[],init:function(){this.WHERE_OPTIONS=[[cm.Msg.TEXT_CHARAT_FROM_START,"FROM_START"],[cm.Msg.TEXT_CHARAT_FROM_END,"FROM_END"],[cm.Msg.TEXT_CHARAT_FIRST,"FIRST"],[cm.Msg.TEXT_CHARAT_LAST,"LAST"]],this.setHelpUrl(cm.Msg.TEXT_CHARAT_HELPURL),this.setColour(ce),this.setOutput(!0,"String"),this.appendValueInput("VALUE").setCheck("String").appendField(cm.Msg.TEXT_CHARAT_INPUT_INTEXT),this.appendDummyInput("AT"),this.setInputsInline(!0),this.updateAt_(!0);let a=this;this.setTooltip(function(){let b=a.getFieldValue("WHERE"),c=cm.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===b||"FROM_END"===b)&&(c+="  "+("FROM_START"===b?cm.Msg.LISTS_INDEX_FROM_START_TOOLTIP:cm.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",a.workspace.options.oneBasedIndex?"#1":"#0")),c})},mutationToDom:function(){let a=document.createElement("mutation"),b=!!this.getInput("AT").connection;return a.setAttribute("at",String(b)),a},domToMutation:function(a){let b="false"!==a.getAttribute("at");this.updateAt_(b)},updateAt_:function(a){this.removeInput("AT"),this.removeInput("ORDINAL",!0),a?(this.appendValueInput("AT").setCheck("Number"),cm.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(cm.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),cm.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(cm.Msg.TEXT_CHARAT_TAIL));let b=new cm.FieldDropdown(this.WHERE_OPTIONS,function(b){let c="FROM_START"===b||"FROM_END"===b;if(c!==a){let a=this.sourceBlock_;return a.updateAt_(c),a.setFieldValue(b,"WHERE"),null}});this.getInput("AT").appendField(b,"WHERE")}},cm.Blocks.text_getSubstring={WHERE_OPTIONS_1:[],WHERE_OPTIONS_2:[],init:function(){this.WHERE_OPTIONS_1=[[cm.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[cm.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[cm.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[cm.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[cm.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[cm.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(cm.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setColour(ce),this.appendValueInput("STRING").setCheck("String").appendField(cm.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),cm.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(cm.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(cm.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){let a=document.createElement("mutation"),b=!!this.getInput("AT1").connection;a.setAttribute("at1",String(b));let c=!!this.getInput("AT2").connection;return a.setAttribute("at2",String(c)),a},domToMutation:function(a){let b="true"===a.getAttribute("at1"),c="true"===a.getAttribute("at2");this.updateAt_(1,b),this.updateAt_(2,c)},updateAt_:function(a,b){this.removeInput("AT"+a),this.removeInput("ORDINAL"+a,!0),b?(this.appendValueInput("AT"+a).setCheck("Number"),cm.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+a).appendField(cm.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+a),2===a&&cm.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(cm.Msg.TEXT_GET_SUBSTRING_TAIL));let c="WHERE_OPTIONS_"+a,d=new cm.FieldDropdown(this[c],function(c){let d="FROM_START"===c||"FROM_END"===c;if(d!==b){let b=this.sourceBlock_;return b.updateAt_(a,d),b.setFieldValue(c,"WHERE"+a),null}});this.getInput("AT"+a).appendField(d,"WHERE"+a),1===a&&this.moveInputBefore("AT1","AT2")}},cm.Blocks.text_changeCase={init:function(){let a=[[cm.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[cm.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"]];this.setHelpUrl(cm.Msg.TEXT_CHANGECASE_HELPURL),this.setColour(ce),this.appendValueInput("TEXT").setCheck("String").appendField(new cm.FieldDropdown(a),"CASE"),this.setOutput(!0,"String"),this.setTooltip(cm.Msg.TEXT_CHANGECASE_TOOLTIP)}},cm.Blocks.text_trim={init:function(){let a=[[cm.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[cm.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[cm.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(cm.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new cm.FieldDropdown(a),"MODE"),this.setOutput(!0,"String"),this.setTooltip(cm.Msg.TEXT_TRIM_TOOLTIP),this.setColour(ce)}},cm.Blocks.text_print={init:function(){this.jsonInit({message0:cm.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,colour:ce,tooltip:cm.Msg.TEXT_PRINT_TOOLTIP,helpUrl:cm.Msg.TEXT_PRINT_HELPURL})}},cm.Blocks.text_prompt_ext={init:function(){let a=[[cm.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[cm.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(cm.Msg.TEXT_PROMPT_HELPURL),this.setColour(ce);let b=this,c=new cm.FieldDropdown(a,function(a){b.updateType_(a)});this.appendValueInput("TEXT").appendField(c,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"===b.getFieldValue("TYPE")?cm.Msg.TEXT_PROMPT_TOOLTIP_TEXT:cm.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(a){this.outputConnection.setCheck("NUMBER"===a?"Number":"String")},mutationToDom:function(){let a=document.createElement("mutation");return a.setAttribute("type",this.getFieldValue("TYPE")),a},domToMutation:function(a){this.updateType_(a.getAttribute("type"))},getBlockType:function(){return"TEXT"===this.getFieldValue("TYPE")?k.TEXT:k.NUMBER}},cm.Blocks.text_prompt={init:function(){let a=[[cm.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[cm.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],b=this;this.setHelpUrl(cm.Msg.TEXT_PROMPT_HELPURL),this.setColour(ce);let c=new cm.FieldDropdown(a,function(a){b.updateType_(a)});this.appendDummyInput().appendField(c,"TYPE").appendField(this.newQuote_(!0)).appendField(new cm.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"===b.getFieldValue("TYPE")?cm.Msg.TEXT_PROMPT_TOOLTIP_TEXT:cm.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},newQuote_:cm.Blocks.text.newQuote_,updateType_:cm.Blocks.text_prompt_ext.updateType_,mutationToDom:cm.Blocks.text_prompt_ext.mutationToDom,domToMutation:cm.Blocks.text_prompt_ext.domToMutation,getBlockType:function(){return"NUMBER"===this.getFieldValue("TYPE")?k.NUMBER:k.TEXT}};var cn=cm.inputs?.Align||cm.Input?.Align;cm.Blocks.lists_create_empty={init:function(){this.jsonInit({type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",colour:cf,tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"})}},cm.Blocks.lists_repeat={init:function(){this.jsonInit({type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",colour:cf,tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"})}},cm.Blocks.lists_create_with={init:function(){this.setHelpUrl(cm.Msg.LISTS_CREATE_WITH_HELPURL),this.setColour(cf),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new cm.icons.MutatorIcon(["lists_create_with_item"],this)),this.setTooltip(cm.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){let a=cm.utils.xml.createElement("mutation");return a.setAttribute("items",String(this.itemCount_)),a},domToMutation:function(a){this.itemCount_=parseInt(a.getAttribute("items")||"0",10),this.updateShape_()},decompose:function(a){let b=a.newBlock("lists_create_with_container");b.initSvg();let c=b.getInput("STACK").connection;for(let b=0;b<this.itemCount_;b++){let b=a.newBlock("lists_create_with_item");b.initSvg(),c.connect(b.previousConnection),c=b.nextConnection}return b},compose:function(a){let b=a.getInputTargetBlock("STACK"),c=[];for(;b&&!b.isInsertionMarker();)c.push(b.valueConnection_),b=b.nextConnection&&b.nextConnection.targetBlock();for(let a=0;a<this.itemCount_;a++){let b=this.getInput("ADD"+a).connection.targetConnection;b&&-1===c.indexOf(b)&&b.disconnect()}this.itemCount_=c.length,this.updateShape_();for(let a=0;a<this.itemCount_;a++)c[a]?.reconnect(this,"ADD"+a)},saveConnections:function(a){let b=a.getInputTargetBlock("STACK"),c=0;for(;b;){let a=this.getInput("ADD"+c);b.valueConnection_=a&&a.connection.targetConnection,c++,b=b.nextConnection&&b.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(cm.Msg.LISTS_CREATE_EMPTY_TITLE);for(let a=0;a<this.itemCount_;a++)if(!this.getInput("ADD"+a)){let b=this.appendValueInput("ADD"+a).setAlign(cn.RIGHT);0===a&&b.appendField(cm.Msg.LISTS_CREATE_WITH_INPUT_WITH)}let a=this.itemCount_;for(;this.getInput("ADD"+a);)this.removeInput("ADD"+a),a++}},cm.Blocks.lists_isEmpty={init:function(){this.jsonInit({type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",colour:cf,tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"})}},cm.Blocks.lists_length={init:function(){this.jsonInit({type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",colour:cf,tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"})}},cm.Blocks.lists_create_with_item={init:function(){this.setColour(cf),this.appendDummyInput().appendField(cm.Msg.ARRAY_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(cm.Msg.ARRAY_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},cm.Blocks.lists_create_with_container={init:function(){this.setColour(cf),this.appendDummyInput().appendField(cm.Msg.ARRAY_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(cm.Msg.ARRAY_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},cm.Blocks.lists_indexOf={init:function(){let a=[[cm.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[cm.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(cm.Msg.LISTS_INDEX_OF_HELPURL),this.setColour(cf),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(cm.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new cm.FieldDropdown(a),"END"),this.setInputsInline(!0);let b=this;this.setTooltip(function(){return cm.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",b.workspace.options.oneBasedIndex?"0":"-1")})}},cm.Blocks.lists_getIndex={init:function(){let a=[[cm.Msg.LISTS_GET_INDEX_GET,"GET"],[cm.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[cm.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[cm.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[cm.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[cm.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[cm.Msg.LISTS_GET_INDEX_LAST,"LAST"],[cm.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(cm.Msg.LISTS_GET_INDEX_HELPURL),this.setColour(cf);let b=new cm.FieldDropdown(a,function(a){this.getSourceBlock().updateStatement_("REMOVE"===a)});this.appendValueInput("VALUE").setCheck("Array").appendField(cm.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(b,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),cm.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(cm.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);let c=this;this.setTooltip(function(){let a=c.getFieldValue("MODE"),b=c.getFieldValue("WHERE"),d="";switch(a+" "+b){case"GET FROM_START":case"GET FROM_END":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":d=cm.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"===b||"FROM_END"===b)&&(d+="  "+("FROM_START"===b?cm.Msg.LISTS_INDEX_FROM_START_TOOLTIP:cm.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",c.workspace.options.oneBasedIndex?"#1":"#0")),d})},mutationToDom:function(){let a=cm.utils.xml.createElement("mutation"),b=!this.outputConnection;a.setAttribute("statement",String(b));let c=!!this.getInput("AT").connection;return a.setAttribute("at",String(c)),a},domToMutation:function(a){let b="true"===a.getAttribute("statement");this.updateStatement_(b);let c="false"!==a.getAttribute("at");this.updateAt_(c)},updateStatement_:function(a){!this.outputConnection!==a&&(this.unplug(!0),a?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(a){this.removeInput("AT"),this.removeInput("ORDINAL",!0),a?(this.appendValueInput("AT").setCheck("Number"),cm.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(cm.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");let b=new cm.FieldDropdown(this.WHERE_OPTIONS,function(b){let c="FROM_START"===b||"FROM_END"===b;if(c!==a){let a=this.getSourceBlock();return a.updateAt_(c),a.setFieldValue(b,"WHERE"),null}});this.getInput("AT").appendField(b,"WHERE"),cm.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},cm.Blocks.lists_setIndex={init:function(){let a=[[cm.Msg.LISTS_SET_INDEX_SET,"SET"],[cm.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[cm.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[cm.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[cm.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[cm.Msg.LISTS_GET_INDEX_LAST,"LAST"],[cm.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(cm.Msg.LISTS_SET_INDEX_HELPURL),this.setColour(cf),this.appendValueInput("LIST").setCheck("Array").appendField(cm.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new cm.FieldDropdown(a),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(cm.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(cm.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);let b=this;this.setTooltip(function(){let a=b.getFieldValue("MODE"),c=b.getFieldValue("WHERE"),d="";switch(a+" "+c){case"SET FROM_START":case"SET FROM_END":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":d=cm.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"===c||"FROM_END"===c)&&(d+="  "+cm.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",b.workspace.options.oneBasedIndex?"#1":"#0")),d})},mutationToDom:function(){let a=cm.utils.xml.createElement("mutation"),b=!!this.getInput("AT").connection;return a.setAttribute("at",String(b)),a},domToMutation:function(a){let b="false"!==a.getAttribute("at");this.updateAt_(b)},updateAt_:function(a){this.removeInput("AT"),this.removeInput("ORDINAL",!0),a?(this.appendValueInput("AT").setCheck("Number"),cm.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(cm.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");let b=new cm.FieldDropdown(this.WHERE_OPTIONS,function(b){let c="FROM_START"===b||"FROM_END"===b;if(c!==a){let a=this.getSourceBlock();return a.updateAt_(c),a.setFieldValue(b,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(b,"WHERE")}},cm.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[cm.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[cm.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[cm.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[cm.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[cm.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[cm.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(cm.Msg.LISTS_GET_SUBLIST_HELPURL),this.setColour(cf),this.appendValueInput("LIST").setCheck("Array").appendField(cm.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),cm.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(cm.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(cm.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){let a=cm.utils.xml.createElement("mutation"),b=!!this.getInput("AT1").connection;a.setAttribute("at1",String(b));let c=!!this.getInput("AT2").connection;return a.setAttribute("at2",String(c)),a},domToMutation:function(a){let b="true"===a.getAttribute("at1"),c="true"===a.getAttribute("at2");this.updateAt_(1,b),this.updateAt_(2,c)},updateAt_:function(a,b){this.removeInput("AT"+a),this.removeInput("ORDINAL"+a,!0),b?(this.appendValueInput("AT"+a).setCheck("Number"),cm.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+a).appendField(cm.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+a);let c=new cm.FieldDropdown(this["WHERE_OPTIONS_"+a],function(c){let d="FROM_START"===c||"FROM_END"===c;if(d!==b){let b=this.getSourceBlock();return b.updateAt_(a,d),b.setFieldValue(c,"WHERE"+a),null}});this.getInput("AT"+a).appendField(c,"WHERE"+a),1===a&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),cm.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},cm.Blocks.lists_sort={init:function(){this.jsonInit({message0:cm.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[cm.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[cm.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[cm.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[cm.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[cm.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",colour:cf,tooltip:cm.Msg.LISTS_SORT_TOOLTIP,helpUrl:cm.Msg.LISTS_SORT_HELPURL})}},cm.Blocks.lists_split={init:function(){let a=this,b=new cm.FieldDropdown([[cm.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[cm.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(b){a.updateType_(b)});this.setHelpUrl(cm.Msg.LISTS_SPLIT_HELPURL),this.setColour(cf),this.appendValueInput("INPUT").setCheck("String").appendField(b,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(cm.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){let b=a.getFieldValue("MODE");if("SPLIT"===b)return cm.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===b)return cm.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+b)})},updateType_:function(a){if(this.getFieldValue("MODE")!==a){let a=this.getInput("INPUT").connection;a.setShadowDom(null);let b=a.targetBlock();b&&(a.disconnect(),b.isShadow()?b.dispose():this.bumpNeighbours())}"SPLIT"===a?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){let a=cm.utils.xml.createElement("mutation");return a.setAttribute("mode",this.getFieldValue("MODE")),a},domToMutation:function(a){this.updateType_(a.getAttribute("mode")||"SPLIT")}},cm.Blocks.variables_get={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,colour:cg,helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]})},getBlockType:function(){return[k.UNDEF,this.getFieldValue("VAR")]},getVarType:function(){return o(this)}},cm.Blocks.variables_set={init:function(){this.jsonInit({type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"],colour:cg})},getBlockType:function(){return[k.UNDEF,this.getFieldValue("VAR")]},getVarType:function(){return o(this)}},cm.Blocks.variables_set_type={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/HomePage"),this.setColour(cg),this.appendValueInput("VARIABLE_SETTYPE_INPUT"),this.appendDummyInput().appendField(cm.Msg.VARIABLES_AS).appendField(new cm.FieldDropdown(l()),"VARIABLE_SETTYPE_TYPE"),this.setInputsInline(!0),this.setOutput(!0),this.setTooltip("Sets a value to a specific type")},getBlockType:function(){return k[this.getFieldValue("VARIABLE_SETTYPE_TYPE")]}},cm.Blocks.variables_const={init:function(){this.appendValueInput("VALUE").appendField("constant").appendField(new cm.FieldVariable(cm.Msg.VARIABLES_DEFAULT_NAME),"VAR").appendField("set"),this.setColour(cg),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL),this.contextMenuMsg_=cm.Msg.VARIABLES_SET_CREATE_GET},contextMenuType_:"variables_get",customContextMenu:cm.Blocks.variables_get.customContextMenu,getVarType:function(){return o(this)}},cm.Blocks.variables_set_init={init:function(){this.appendValueInput("VALUE").appendField("initialize").appendField(new cm.FieldVariable(cm.Msg.VARIABLES_DEFAULT_NAME),"VAR").appendField(cm.Msg.VARIABLES_AS).appendField(new cm.FieldDropdown(l()),"VARIABLE_SETTYPE_TYPE").appendField("to"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(cg),this.setHelpUrl(cm.Msg.var_set_init_helpurl),this.setTooltip(cm.Msg.var_set_init_tooltip),this.contextMenuMsg_=cm.Msg.VARIABLES_SET_CREATE_GET},contextMenuType_:"variables_get",customContextMenu:cm.Blocks.variables_get.customContextMenu,getVarType:function(){return o(this)}},cm.Blocks.io_VarIN={init:function(){this.appendDummyInput().appendField(cm.Msg.VARIABLES_SET_CONST).appendField("IN").appendField(new cm.FieldVariable(cm.Msg.VARIABLES_DEFAULT_NAME),"VAR").appendField(cm.Msg.ARD_WRITE_TO).appendField(new cm.FieldDropdown(w.AllPins),"PIN"),this.setColour(cg),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.io_VarOut={init:function(){this.appendDummyInput().appendField(cm.Msg.VARIABLES_SET_CONST).appendField("OUT").appendField(new cm.FieldVariable(cm.Msg.VARIABLES_DEFAULT_NAME),"VAR").appendField(cm.Msg.ARD_WRITE_TO).appendField(new cm.FieldDropdown(w.AllPins),"PIN"),this.setColour(cg),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.base_begin={init:function(){this.setColour(ch),this.setHelpUrl(cm.Msg.ARDUINO_BASE_SETUP_HELPURL),this.appendDummyInput("").appendField(cm.Msg.ARDUINO_BASE_BEGIN),this.appendStatementInput("base_begin"),this.setTooltip("Excut seulement dans le 'Setup'")},getArduinoLoopsInstance:function(){return!0}},cm.Blocks.pinmode={init:function(){this.setColour(ch),this.setHelpUrl(cm.Msg.ARDUINO_INOUT_DIGITAL_MODE_HELPURL||"http://arduino.cc/en/Reference/PinMode"),this.appendDummyInput("").appendField(new cm.FieldDropdown([["INPUT","INPUT"],["OUTPUT","OUTPUT"],["INPUT_PULLUP","INPUT_PULLUP"]]),"PINMODE"),this.setOutput(!0,"Null"),this.setTooltip(cm.Msg.ARDUINO_INOUT_DIGITAL_MODE_TOOLTIP||"Set the pin mode")}},cm.Blocks.base_define_name={init:function(){this.setHelpUrl(cm.Msg.TEXT_TEXT_HELPURL),this.setColour(ch),this.appendDummyInput().appendField(new cm.FieldTextInput(""),"NAME"),this.setOutput(!0,"Null");let a=this;this.setTooltip(function(){let b=a.getParent();return b&&b.getInputsInline()&&b.tooltip||cm.Msg.TEXT_TEXT_TOOLTIP})}},cm.Blocks.base_define={init:function(){this.setHelpUrl(cm.Msg.ARDUINO_BASE_DEFINE_CONST_HELPURL),this.setColour(ch),this.appendValueInput("NAME").setCheck("Null").setAlign(cm.inputs.Align.RIGHT).appendField(cm.Msg.ARDUINO_BASE_DEFINE_CONST_INPUT1),this.appendDummyInput().appendField(" Pin ").appendField(new cm.FieldDropdown([["0","0"]]),"PIN"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_BASE_DEFINE_CONST_TOOLTIP)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","digitalPins",a)}},cm.Blocks.base_setup={init:function(){this.setColour(ch),this.setHelpUrl(cm.Msg.ARDUINO_BASE_SETUP_HELPURL),this.appendDummyInput("").appendField(cm.Msg.ARDUINO_BASE_SETUP),this.appendStatementInput("DO"),this.setTooltip("Excut seulement dans le 'Setup'")},getArduinoLoopsInstance:function(){return!0}},cm.Blocks.base_setup_loop={init:function(){this.appendDummyInput().appendField(cm.Msg.ARDUINO_BASE_SETUP),this.appendStatementInput("SETUP_FUNC"),this.appendDummyInput().appendField(cm.Msg.ARDUINO_BASE_LOOP),this.appendStatementInput("LOOP_FUNC"),this.setInputsInline(!1),this.setColour(ch),this.setTooltip("Dfinis le 'setup()' et le 'loop()'"),this.setHelpUrl("https://arduino.cc/en/Reference/Loop"),this.contextMenu=!1},getArduinoLoopsInstance:function(){return!0}},cm.Blocks.base_loop={init:function(){this.setColour(ch),this.setHelpUrl(cm.Msg.ARDUINO_BASE_SETUP_LOOP_HELPURL),this.appendDummyInput().appendField(cm.Msg.ARDUINO_BASE_LOOP),this.appendStatementInput("LOOP_FUNC"),this.setInputsInline(!1),this.setTooltip("Excut seulement dans le 'Loop'"),this.contextMenu=!1},getArduinoLoopsInstance:function(){return!0}},cm.Blocks.base_define_bloc={init:function(){this.setColour(ch),this.setHelpUrl(cm.Msg.ARDUINO_BASE_DEFINE_HELPURL),this.appendDummyInput("").appendField(cm.Msg.ARDUINO_BASE_DEFINE),this.appendStatementInput("DO").appendField(cm.Msg.CONTROLS_REPEAT_INPUT_DO),this.setTooltip(cm.Msg.ARDUINO_BASE_DEFINE_TOOLTIP)}},cm.Blocks.base_code={init:function(){this.setHelpUrl(cm.Msg.TEXT_TEXT_HELPURL),this.setColour(ch),this.appendDummyInput().appendField(cm.Msg.ARDUINO_BASE_CODE).appendField(new cm.FieldTextInput(""),"TEXT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.TEXT_TEXT_TOOLTIP)}},cm.Blocks.base_comment={init:function(){this.setHelpUrl(cm.Msg.ARDUINO_BASE_COMMENT_HELPURL),this.setColour(ch),this.appendDummyInput().appendField(cm.Msg.ARDUINO_BASE_COMMENT_TEXT).appendField(new cm.FieldTextInput(""),"TEXT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.TEXT_TEXT_TOOLTIP)}},cm.Blocks.base_end={init:function(){this.setHelpUrl(""),this.setColour(ch),this.appendDummyInput().appendField(cm.Msg.ARDUINO_BASE_END),this.setPreviousStatement(!0,null),this.setTooltip(cm.Msg.END_TOOLTIP)}},cm.Blocks.io_digitalwrite_Var={init:function(){this.jsonInit({type:"io_digitalwrite_Var",message0:"set digital %1 to %2",args0:[{type:"input_value",name:"VAR"},{type:"field_dropdown",name:"STATE",options:[["ON","HIGH"],["OFF","LOW"]]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:ch,tooltip:"",helpUrl:""})},getBlockType:function(){return k.NUMBER}},cm.Blocks.io_digitalwrite={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/DigitalWrite"),this.setColour(ch),this.appendValueInput("STATE").appendField(cm.Msg.ARD_DIGITALWRITE).appendField(new cm.FieldDropdown(w.AllPins),"PIN").appendField(cm.Msg.ARD_WRITE_TO).setCheck("Boolean"),this.setInputsInline(!1),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARD_DIGITALWRITE_TIP)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)}},cm.Blocks.io_digitalreadVar={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/DigitalRead"),this.setColour(ch),this.appendDummyInput().appendField("read digital pin ").appendField(new cm.FieldVariable("item"),"VAR"),this.setOutput(!0,"Boolean"),this.setTooltip(cm.Msg.ARD_DIGITALREAD_TIP)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","digitalPins",a)}},cm.Blocks.io_digitalread={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/DigitalRead"),this.setColour(ch),this.appendDummyInput().appendField(cm.Msg.ARD_DIGITALREAD).appendField(new cm.FieldDropdown(w.AllPins),"PIN"),this.setOutput(!0,"Boolean"),this.setTooltip(cm.Msg.ARD_DIGITALREAD_TIP)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)},getBlockType:function(){return k.NUMBER}},cm.Blocks.io_builtin_led={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/DigitalWrite"),this.setColour(ch),this.appendDummyInput().appendField(cm.Msg.ARD_BUILTIN_LED).appendField(new cm.FieldDropdown(w.BuiltinLed),"BUILT_IN_LED").appendField("to").appendField(new cm.FieldDropdown([["ON","HIGH"],["OFF","LOW"]]),"STATE"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARD_BUILTIN_LED_TIP)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"BUILT_IN_LED","builtinLed",a)},getBlockType:function(){return k.BOOLEAN}},cm.Blocks.io_analogwrite={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/AnalogWrite"),this.setColour(ch),this.appendValueInput("NUM").appendField(cm.Msg.ARD_ANALOGWRITE).appendField(new cm.FieldDropdown(w.PwmPins),"PIN").appendField(cm.Msg.ARD_WRITE_TO).setCheck("Number"),this.setInputsInline(!1),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARD_ANALOGWRITE_TIP)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","pwmPins",a)},getBlockType:function(){return k.NUMBER}},cm.Blocks.io_analogreadVar={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/AnalogRead"),this.setColour(ch),this.appendDummyInput().appendField("read analog ").appendField(new cm.FieldVariable("item"),"VAR"),this.setOutput(!0),this.setTooltip(cm.Msg.ARD_ANALOGREAD_TIP)},getBlockType:function(){return k.NUMBER},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","analogPins",a)}},cm.Blocks.io_analogread={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/AnalogRead"),this.setColour(ch),this.appendDummyInput().appendField(cm.Msg.ARD_ANALOGREAD).appendField(new cm.FieldDropdown(w.AllPinsAnalog),"PIN"),this.setOutput(!0,"Number"),this.setTooltip(cm.Msg.ARD_ANALOGREAD_TIP)},getBlockType:function(){return k.NUMBER},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPinsAnalog",a)}},cm.Blocks.io_highlow={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/Constants"),this.setColour(ch),this.appendDummyInput().appendField(new cm.FieldDropdown([["ON","HIGH"],["OFF","LOW"]]),"STATE"),this.setOutput(!0),this.setTooltip(cm.Msg.ARD_HIGHLOW_TIP)},getBlockType:function(){return k.BOOLEAN}},cm.Blocks.micros={init:function(){this.setColour(cc),this.setHelpUrl(cm.Msg.ARDUINO_SINCE_PROGRAM_STARTED_HELPURL),this.appendDummyInput("").appendField("micros"),this.setOutput(!0,"Number"),this.setTooltip(cm.Msg.ARDUINO_SINCE_PROGRAM_STARTED_TOOLTIP)}},cm.Blocks.millis={init:function(){this.setColour(cc),this.setHelpUrl(cm.Msg.ARDUINO_SINCE_PROGRAM_STARTED_HELPURL),this.appendDummyInput("").appendField("millis"),this.setOutput(!0,"Number"),this.setTooltip(cm.Msg.ARDUINO_SINCE_PROGRAM_STARTED_TOOLTIP)}},cm.Blocks.millis_sec={init:function(){this.setColour(cc),this.setHelpUrl(cm.Msg.ARDUINO_SINCE_PROGRAM_STARTED_HELPURL),this.appendDummyInput("").appendField("secondis"),this.setOutput(!0,"Number"),this.setTooltip(cm.Msg.ARDUINO_SINCE_PROGRAM_STARTED_TOOLTIP)}},cm.Blocks.base_delay={init:function(){this.setColour(cc),this.setHelpUrl(cm.Msg.ARDUINO_BASE_DELAY_HELPURL),this.appendValueInput("DELAY_TIME").appendField(cm.Msg.ARDUINO_BASE_DELAY_DELAY_TIME).setCheck("Number"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_BASE_DELAY_TOOLTIP)}},cm.Blocks.base_delay_sec={init:function(){this.setColour(cc),this.setHelpUrl(cm.Msg.ARDUINO_BASE_DELAY_HELPURL),this.appendValueInput("DELAY_TIME").appendField(cm.Msg.ARDUINO_BASE_DELAY_DELAY_TIME_SEC).setCheck("Number"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_BASE_DELAY_TOOLTIP)}},cm.Blocks.tempo_no_delay={init:function(){this.appendValueInput("DELAY_TIME").setCheck("Number").appendField(cm.Msg.ARDUINO_BASE_TEMPO1||"Every"),this.appendDummyInput().appendField(new cm.FieldDropdown([["microseconds","u"],["milliseconds","m"],["seconds","s"]]),"unite").appendField(cm.Msg.ARDUINO_BASE_TEMPO2||"do"),this.appendStatementInput("branche"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(cc),this.setTooltip(cm.Msg.ARDUINO_BASE_TEMPO_TOOLTIP||"Execute code at regular intervals without blocking"),this.setHelpUrl(cm.Msg.ARDUINO_BASE_TEMPO_HELPURL||"http://arduino.cc/en/Reference/Millis")}},cm.Blocks.io_pulsein={init:function(){this.setColour(cc),this.setHelpUrl("http://arduino.cc/en/Reference/pulseIn"),this.appendDummyInput().appendField(cm.Msg.ARDUINO_PULSEIN||"measure pulse on pin").appendField(new cm.FieldDropdown([["0","0"]]),"PIN").appendField(cm.Msg.ARDUINO_INOUT_STAT||"state").appendField(new cm.FieldDropdown([["HIGH","HIGH"],["LOW","LOW"]]),"STAT"),this.setInputsInline(!0),this.setOutput(!0,"Number"),this.setTooltip("Reads a pulse (either HIGH or LOW) on a pin. Returns the length of the pulse in microseconds.")},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","digitalPins",a)},getBlockType:function(){return k.NUMBER}},cm.Blocks.io_pulsein_timeout={init:function(){this.setColour(cc),this.setHelpUrl("http://arduino.cc/en/Reference/pulseIn"),this.appendDummyInput().appendField(cm.Msg.ARDUINO_PULSEIN||"measure pulse on pin").appendField(new cm.FieldDropdown([["0","0"]]),"PIN").appendField(cm.Msg.ARDUINO_INOUT_STAT||"state").appendField(new cm.FieldDropdown([["HIGH","HIGH"],["LOW","LOW"]]),"STAT"),this.appendValueInput("TIMEOUT").setCheck("Number").appendField(cm.Msg.ARDUINO_PULSEIN_TIMEOUT||"timeout"),this.setInputsInline(!0),this.setOutput(!0,"Number"),this.setTooltip("Reads a pulse (either HIGH or LOW) on a pin with a timeout. Returns the length of the pulse in microseconds.")},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","digitalPins",a)},getBlockType:function(){return k.NUMBER}},cm.Blocks.serial_init={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/serial.png",60,35)).appendField(new cm.FieldDropdown([["Serial","Serial"],["Serial1","Serial1"]]),"SERIAL").appendField(new cm.FieldDropdown([["9600","9600"],["19200","19200"],["57600","57600"],["115200","115200"],["250000","250000"]]),"SPEED"),this.setColour(cl),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.serial_receive={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/serial.png",60,35)).appendField("Data Received ??"),this.setOutput(!0,null),this.setColour(cl),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.serial_receive_byte={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/serial.png",60,35)).appendField("Receive byte"),this.setOutput(!0,null),this.setColour(cl),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.serial_write={init:function(){this.setHelpUrl(cm.Msg.TEXT_APPEND_HELPURL),this.setColour(cl),this.appendValueInput("SERIAL").appendField(new cm.FieldImage("/img/ico/serial.png",60,35)).appendField("Serial Write"),this.setPreviousStatement(!0),this.setNextStatement(!0);let a=this;this.setTooltip(function(){return cm.Msg.TEXT_APPEND_TOOLTIP.replace("%1",a.getFieldValue("VAR"))})},getVarType:function(){return k.TEXT}},cm.Blocks.led_digitalwrite={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/led_ico.png",20,20,"*")).appendField("Set").appendField(new cm.FieldDropdown(w.AllPins),"PIN").appendField("to").appendField(new cm.FieldDropdown([["ON","HIGH"],["OFF","LOW"]]),"STATE"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(""),this.setHelpUrl(""),this.setColour(ci)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)}},cm.Blocks.lcd_i2c_lcdinit={init:function(){this.appendDummyInput().appendField("Init LCD I2C").appendField(new cm.FieldImage("/img/ico/lcd_ico.png",120,50,"*")),this.appendDummyInput().appendField("Size").appendField(new cm.FieldDropdown([["16x2","16x2"],["20x4","20x4"],["16x4","16x4"],["20x2","20x2"],["8x2","8x2"]]),"SIZE").appendField("Address").appendField(new cm.FieldTextInput("0x27"),"ADD").appendField("Cursor").appendField(new cm.FieldCheckbox("FALSE"),"Cr"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(ci),this.setTooltip("Initialize I2C LCD display with common sizes"),this.setHelpUrl("")}},cm.Blocks.lcd_i2c_lcdclear={init:function(){this.setColour(ci),this.setHelpUrl(""),this.appendDummyInput().appendField("Clear Lcd ").appendField(new cm.FieldImage("/img/ico/lcd_ico.png",120,50,"*")),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.TECHNOZONE51_TEXT93)}},cm.Blocks.lcd_i2c_lcdwrite={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/lcd_ico.png",120,50,"*")),this.appendValueInput("TEXT").appendField("Write In").appendField("Col").appendField(new cm.FieldTextInput("0"),"Col").appendField("Row").appendField(new cm.FieldTextInput("0"),"Row"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(ci),this.setTooltip(""),this.setHelpUrl("")}};var co="RENAME_VARIABLE_ID",cp="DELETE_VARIABLE_ID",cq=class a extends cm.FieldVariable{constructor(b,c,d,e){super(b,c,d,e),this.menuGenerator_=a.dropdownCreate}static dropdownCreate(){return cm.FieldVariable.dropdownCreate.call(this).filter(a=>!Array.isArray(a)||a[1]!==co&&a[1]!==cp)}onItemSelected_(a,b){let c=b.getValue();c!==co&&c!==cp&&super.onItemSelected_(a,b)}};cm.Blocks.Ultrasonic={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/ultrason_ico.png",64,45,"*")).appendField("Ultrasonic").appendField(new cq("myUltrasonic"),"VAR"),this.appendDummyInput().appendField(cm.Msg.VARIABLES_SET_CONST).appendField("Trig   to").appendField(new cm.FieldDropdown(w.AllPins),"PIN0"),this.appendDummyInput().appendField(cm.Msg.VARIABLES_SET_CONST).appendField("Echo to").appendField(new cm.FieldDropdown(w.AllPins),"PIN1"),this.setColour(cj),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN0","AllPins",a),w.Boards.refreshBlockFieldDropdown(this,"PIN1","AllPins",a)}},cm.Blocks.Ultrasonic_read={init:function(){this.setHelpUrl("http://arduino.cc/en/Reference/DigitalRead"),this.setColour(cj),this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/ultrason_ico.png",60,45,"*")).appendField("Distance Of").appendField(new cq("myUltrasonic"),"VAR"),this.setOutput(!0,"Number"),this.setTooltip(cm.Msg.ARD_DIGITALREAD_TIP)},getBlockType:function(){return k.NUMBER}},cm.Blocks.SENSOR_dht11={init:function(){this.setColour(cj),this.setHelpUrl(""),this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/DHT11_ico.png",60,45,"*")).appendField(new cm.FieldDropdown([["Humidity","h"],["Temperature","t"]]),"choix").appendField(new cm.FieldDropdown(w.AllPins),"PIN").appendField(cm.Msg.pin),this.setOutput(!0,"Number"),this.setTooltip("returns moisture (from 0 to 100%) temperature (from 0 to 80 degrees Celsius) received by the sensor")},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)}},cm.Blocks.SENSOR_line_follower={init:function(){this.setColour(cj),this.setHelpUrl(cm.Msg.HELPURL),this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/line_follower.png",100,35,"*")).appendField("Line detected At").appendField(new cm.FieldDropdown(w.AllPins),"PIN"),this.setOutput(!0,"Boolean"),this.setTooltip("returns true (false) if a black line is (not) detected")},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)}},cm.Blocks.SENSOR_lm35={init:function(){this.setColour(cj),this.setHelpUrl(""),this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/lm35_ico.png",32,50,"*")).appendField("temperature of ").appendField(new cm.FieldDropdown(w.analogPins),"PIN"),this.setOutput(!0,"Number"),this.setTooltip(cm.Msg.lm35_2)},getBlockType:function(){return k.NUMBER},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","analogPins",a)}},cm.Blocks.SENSOR_light_sensor={init:function(){this.setColour(cj),this.setHelpUrl(""),this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/ldr_ico.png",40,40,"*")).appendField("daylight In ").appendField(new cm.FieldDropdown(w.AllPins),"PIN"),this.setOutput(!0,"Number"),this.setTooltip("returns a value based on brightness: darkness:full light")},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)},getBlockType:function(){return k.NUMBER}},cm.Blocks.SENSOR_PIR={init:function(){this.setColour(cj),this.setHelpUrl(""),this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/pir_ico.png",40,40,"*")).appendField("Motion State In ").appendField(new cm.FieldDropdown(w.AllPins),"PIN"),this.setOutput(!0,"Number"),this.setTooltip("returns true if motion is detected")},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)}},cm.Blocks.RFID_module={init:function(){this.setColour(cj),this.setHelpUrl(cm.Msg.RFID_HELPURL),this.appendDummyInput().setAlign(cm.inputs.Align.LEFT).appendField(cm.Msg.RFID_module_TEXT).appendField(new cm.FieldImage("/img/ico/module_rfid.png",100,50,"*")),this.appendDummyInput().setAlign(cm.inputs.Align.RIGHT).appendField("CS").appendField(new cm.FieldDropdown(w.AllPins),"CS_PIN"),this.appendDummyInput().setAlign(cm.inputs.Align.RIGHT).appendField("RST").appendField(new cm.FieldDropdown(w.AllPins),"RST_PIN"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.RFID_module_TOOLTIP)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"CS_PIN","AllPins",a),w.Boards.refreshBlockFieldDropdown(this,"RST_PIN","AllPins",a)}},cm.Blocks.motor_servo={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/motorServo_ico.png",140,40,"*")),this.appendDummyInput("COMMAND_ROW").appendField(new cm.FieldDropdown([["Init","init"],["Write","write"],["Attach","attach"],["Detach","detach"]],function(a){let b=this.getSourceBlock(),c=b.getField("PIN"),d=b.getField("TO_LABEL");c.setVisible("init"===a),d.setVisible("init"===a);let e=b.getField("ANGLE"),f=b.getField("DEG_LABEL");return e&&e.setVisible("write"===a),f&&f.setVisible("write"===a),a}),"COMMAND").appendField(new cq("myServo"),"VAR").appendField(" To ","TO_LABEL").appendField(new cm.FieldDropdown(w.PwmPins),"PIN").appendField(new cm.FieldNumber(90,0,180),"ANGLE").appendField("deg","DEG_LABEL"),this.getField("ANGLE").setVisible(!1),this.getField("DEG_LABEL").setVisible(!1),this.setColour(ck),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Servo motor: init, write angle, attach, or detach"),this.setHelpUrl(cm.Msg.HELPURL)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","pwmPins",a)}},cm.Blocks.DC_Motor={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/icHBridgeL293D.png",100,45,"*")),this.appendDummyInput("COMMAND_ROW").appendField(new cm.FieldDropdown([["Init","init"],["Forward","Forward"],["Backward","Backward"],["Left","Left"],["Right","Right"],["Stop","Stop"]],function(a){let b=this.getSourceBlock(),c="init"===a,d=b.getInput("MOTOR_A_ROW"),e=b.getInput("MOTOR_B_ROW");return d&&d.setVisible(c),e&&e.setVisible(c),a}),"COMMAND").appendField(new cq("MT"),"VAR"),this.appendDummyInput("MOTOR_A_ROW").appendField("  MA1 ","MA1_LABEL").appendField(new cm.FieldDropdown([["0","0"]]),"PIN0").appendField(" MA2 ","MA2_LABEL").appendField(new cm.FieldDropdown([["1","1"]]),"PIN1"),this.appendDummyInput("MOTOR_B_ROW").appendField("  MB1 ","MB1_LABEL").appendField(new cm.FieldDropdown([["2","2"]]),"PIN2").appendField(" MB2 ","MB2_LABEL").appendField(new cm.FieldDropdown([["3","3"]]),"PIN3"),this.setColour(ck),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("DC Motor: init with pins or control direction"),this.setHelpUrl("")},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN0","digitalPins",a),w.Boards.refreshBlockFieldDropdown(this,"PIN1","digitalPins",a),w.Boards.refreshBlockFieldDropdown(this,"PIN2","digitalPins",a),w.Boards.refreshBlockFieldDropdown(this,"PIN3","digitalPins",a)}},cm.Blocks.switch_button_read={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/button_ico.png",35,35,"*")).appendField("BT State").appendField(new cm.FieldDropdown(w.AllPins),"PIN"),this.setOutput(!0,k.NUMBER.typeId),this.setColour("#9966FF"),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)},updateFields:function(a){w.Boards.refreshBlockFieldDropdown(this,"PIN","AllPins",a)}},cm.Blocks.bluetooth_init={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/Bluetooth.png",35,35)).appendField("","VAR").appendField("RX ").appendField(new cm.FieldDropdown(w.AllPins),"PIN1").appendField("TX ").appendField(new cm.FieldDropdown(w.AllPins),"PIN0").appendField(new cm.FieldDropdown([["9600","9600"],["19200","19200"],["57600","57600"],["115200","115200"],["250000","250000"]]),"SPEED"),this.setColour(cl),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.bluetooth_receive={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/Bluetooth.png",35,35)).appendField("Data Received ??"),this.setOutput(!0,null),this.setColour(cl),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.bluetooth_receive_byte={init:function(){this.appendDummyInput().appendField(new cm.FieldImage("/img/ico/Bluetooth.png",35,35)).appendField("Receive byte"),this.setOutput(!0,null),this.setColour(cl),this.setTooltip(cm.Msg.ARDUINO_VAR_CONST_tooltip),this.setHelpUrl(cm.Msg.HELPURL)}},cm.Blocks.bluetooth_write={init:function(){this.setHelpUrl(cm.Msg.TEXT_APPEND_HELPURL),this.setColour(cl),this.appendValueInput("BT").appendField(new cm.FieldImage("/img/ico/Bluetooth.png",35,35)).appendField("bluetooth Write"),this.setPreviousStatement(!0),this.setNextStatement(!0);let a=this;this.setTooltip(function(){return cm.Msg.TEXT_APPEND_TOOLTIP.replace("%1",a.getFieldValue("VAR"))})},getVarType:function(){return k.TEXT}};var cr=i,cs=((b=cs||{})[b.ATOMIC=0]="ATOMIC",b[b.UNARY_POSTFIX=1]="UNARY_POSTFIX",b[b.UNARY_PREFIX=2]="UNARY_PREFIX",b[b.MULTIPLICATIVE=3]="MULTIPLICATIVE",b[b.ADDITIVE=4]="ADDITIVE",b[b.SHIFT=5]="SHIFT",b[b.RELATIONAL=6]="RELATIONAL",b[b.EQUALITY=7]="EQUALITY",b[b.BITWISE_AND=8]="BITWISE_AND",b[b.BITWISE_XOR=9]="BITWISE_XOR",b[b.BITWISE_OR=10]="BITWISE_OR",b[b.LOGICAL_AND=11]="LOGICAL_AND",b[b.LOGICAL_OR=12]="LOGICAL_OR",b[b.CONDITIONAL=13]="CONDITIONAL",b[b.ASSIGNMENT=14]="ASSIGNMENT",b[b.COMMA=15]="COMMA",b[b.UNARY_NEGATION=16]="UNARY_NEGATION",b[b.MEMBER=17]="MEMBER",b[b.FUNCTION_CALL=1]="FUNCTION_CALL",b[b.NONE=99]="NONE",b),ct="INPUT",cu="OUTPUT",cv="SERIAL",cw=new class extends cr.Generator{constructor(){super("Arduino"),this.includes_={},this.definitions_={},this.variables_={},this.codeFunctions_={},this.userFunctions_={},this.functionNames_={},this.setups_={},this.loops_={},this.pins_={},this.loopCode_={},this.INFINITE_LOOP_TRAP=null,this.ORDER_ATOMIC=0,this.ORDER_UNARY_POSTFIX=1,this.ORDER_UNARY_PREFIX=2,this.ORDER_MULTIPLICATIVE=3,this.ORDER_ADDITIVE=4,this.ORDER_SHIFT=5,this.ORDER_RELATIONAL=6,this.ORDER_EQUALITY=7,this.ORDER_BITWISE_AND=8,this.ORDER_BITWISE_XOR=9,this.ORDER_BITWISE_OR=10,this.ORDER_LOGICAL_AND=11,this.ORDER_LOGICAL_OR=12,this.ORDER_CONDITIONAL=13,this.ORDER_ASSIGNMENT=14,this.ORDER_COMMA=15,this.ORDER_UNARY_NEGATION=16,this.ORDER_MEMBER=17,this.ORDER_FUNCTION_CALL=1,this.ORDER_NONE=99,this.DEF_FUNC_NAME=this.FUNCTION_NAME_PLACEHOLDER_,this.addReservedWords("Blockly,setup,loop,if,else,for,switch,case,while,do,break,continue,return,goto,define,include,HIGH,LOW,INPUT,OUTPUT,INPUT_PULLUP,true,false,integer,constants,floating,point,void,boolean,char,unsigned,byte,int,word,long,float,double,string,String,array,static,volatile,const,sizeof,pinMode,digitalWrite,digitalRead,analogReference,analogRead,analogWrite,tone,noTone,shiftOut,shitIn,pulseIn,millis,micros,delay,delayMicroseconds,min,max,abs,constrain,map,pow,sqrt,sin,cos,tan,randomSeed,random,lowByte,highByte,bitRead,bitWrite,bitSet,bitClear,bit,attachInterrupt,detachInterrupt,interrupts,noInterrupts")}init(a){this.includes_=Object.create(null),this.definitions_=Object.create(null),this.variables_=Object.create(null),this.codeFunctions_=Object.create(null),this.userFunctions_=Object.create(null),this.functionNames_=Object.create(null),this.setups_=Object.create(null),this.loops_=Object.create(null),this.pins_=Object.create(null),this.loopCode_=Object.create(null),this.nameDB_?this.nameDB_.reset():this.nameDB_=new cr.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(a.getVariableMap()),this.nameDB_.populateVariables(a),this.nameDB_.populateProcedures(a);let b=[],c=cr.Variables.allDeveloperVariables(a);for(let a=0;a<c.length;a++)b[a]=`int ${this.nameDB_.getName(c[a],cr.Names.NameType.VARIABLE)};
`;this.definitions_.variables=b.join("\n")}finish(a){let b=[],c=[],d=[],e=[],f=[];for(let a in this.loopCode_)f.push(this.loopCode_[a]);for(let a in this.includes_)b.push(this.includes_[a]);if(b.length){b.push("\n");let a=[...new Set(b)];b.length=0,b.push(...a)}for(let a in this.variables_)d.push(this.variables_[a]);for(let a in d.length&&d.push("\n"),this.definitions_)c.push(this.definitions_[a]);for(let a in c.length&&c.push("\n"),this.codeFunctions_)e.push(this.codeFunctions_[a]);for(let a in this.userFunctions_)e.push(this.userFunctions_[a]);e.length&&e.push("\n");let g=[""],h="";for(let a in void 0!==this.setups_.userSetupCode&&(h=this.setups_.userSetupCode,delete this.setups_.userSetupCode),this.setups_)g.push(this.setups_[a]);h&&g.push(h);let i=g.filter(a=>a),j="";return void 0!==this.loops_.userLoopCode&&(j="\n"+this.loops_.userLoopCode,delete this.loops_.userLoopCode),this.nameDB_?.reset(),b.join("\n")+c.join("\n")+d.join("\n")+e.join("\n")+("void setup() {\n"+i.join("\n")+"\n}\n\n")+("void loop() {\n  "+f.join("\n  ")+j.replace(/\n/g,"\n  "))+"\n}\n\n"}addInclude(a,b){void 0===this.includes_[a]&&(this.includes_[a]=b)}addDeclaration(a,b){void 0===this.definitions_[a]&&(this.definitions_[a]=b)}addVariable(a,b,c=!1){let d=!1;return(c||void 0===this.variables_[a])&&(this.variables_[a]=b,d=!0),d}addSetup(a,b,c=!1){let d=!1;return(c||void 0===this.setups_[a])&&(this.setups_[a]=b,d=!0),d}addLoop(a,b,c=!1){let d=!1;return(c||void 0===this.loops_[a])&&(this.loops_[a]=b,d=!0),d}addFunction(a,b){if(void 0===this.codeFunctions_[a]){let c=this.nameDB_.getDistinctName(a,cr.Names.NameType.PROCEDURE);this.codeFunctions_[a]=b.replace(this.DEF_FUNC_NAME,c),this.functionNames_[a]=c}return this.functionNames_[a]}reservePin(a,b,c,d){if(void 0!==this.pins_[b]){let c=this.pins_[b];c.blockId!==a.id?a.setWarningText(`Pin ${b} is already used by "${c.blockLabel}"`,d):a.setWarningText(null,d)}else this.pins_[b]={pinType:c,blockId:a.id,blockLabel:a.type},a.setWarningText(null,d)}scrubNakedValue(a){return a+";\n"}quote_(a){return'"'+(a=a.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\$/g,"\\$").replace(/'/g,"\\'"))+'"'}scrub_(a,b){if(null===b)return"";let c="";if(!a.outputConnection||!a.outputConnection.targetConnection){let b=a.getCommentText();b&&(c+=this.prefixLines(b,"// ")+"\n");for(let b=0;b<a.inputList.length;b++){let d=a.inputList[b];if(d.connection&&d.connection.type===cr.ConnectionType.INPUT_VALUE){let a=d.connection.targetBlock();if(a){let b=this.allNestedComments(a);b&&(c+=this.prefixLines(b,"// "))}}}}let d=a.nextConnection?.targetBlock();return c+b+this.blockToCode(d)}addLoopCode(a,b){this.loopCode_[a]=b}addLoopTrap(a,b){return this.INFINITE_LOOP_TRAP?this.INFINITE_LOOP_TRAP.replace(/%1/g,`'${b.id}'`)+a:a}getArduinoType_(a){switch(a.typeId){case k.CONST_NUMBER.typeId:return"const int";case k.SHORT_NUMBER.typeId:return"char";case k.NUMBER.typeId:return"int";case k.UNS_NUMBER.typeId:return"unsigned int";case k.LARGE_NUMBER.typeId:return"long";case k.LARGE_UNS_NUMBER.typeId:return"unsigned long";case k.DECIMAL.typeId:return"float";case k.TEXT.typeId:return"String";case k.VOLATIL_NUMBER.typeId:return"volatile";case k.CHARACTER.typeId:return"char";case k.BOOLEAN.typeId:return"boolean";case k.NULL.typeId:return"void";case k.UNDEF.typeId:return"undefined";case k.CHILD_BLOCK_MISSING.typeId:return"int";default:return"Invalid Blockly Type"}}noGeneratorCodeInline(){return["",this.ORDER_ATOMIC]}noGeneratorCodeLine(){return""}};cw.forBlock.logic_boolean=function(a){return["TRUE"===a.getFieldValue("BOOL")?"true":"false",0]},cw.forBlock.logic_operation_AND=function(a){let b=cw.valueToCode(a,"A",0)||"false",c=cw.valueToCode(a,"B",0)||"false";return[`${b} && ${c}`,11]},cw.forBlock.logic_operation_OR=function(a){let b=cw.valueToCode(a,"A",12)||"false",c=cw.valueToCode(a,"B",12)||"false";return[`${b} || ${c}`,12]},cw.forBlock.logic_operation=function(a){let b="AND"===a.getFieldValue("OP")?"&&":"||",c="&&"===b?11:12,d=cw.valueToCode(a,"A",c)||"false",e=cw.valueToCode(a,"B",c)||"false";return[`${d} ${b} ${e}`,c]},cw.forBlock.logic_compare=function(a){let b={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[a.getFieldValue("OP")],c="=="===b||"!="===b?7:6,d=cw.valueToCode(a,"A",c)||"0",e=cw.valueToCode(a,"B",c)||"0";return[`${d} ${b} ${e}`,c]},cw.forBlock.logic_negate=function(a){let b=cw.valueToCode(a,"BOOL",2)||"false";return[`!${b}`,2]},cw.forBlock.logic_null=function(a){return["NULL",0]},cw.forBlock.logic_ternary=function(a){let b=cw.valueToCode(a,"IF",13)||"false",c=cw.valueToCode(a,"THEN",13)||"null",d=cw.valueToCode(a,"ELSE",13)||"null";return[`${b} ? ${c} : ${d}`,13]},cw.forBlock.controls_if=function(a){let b=0,c=cw.valueToCode(a,"IF"+b,99)||"false",d=cw.statementToCode(a,"DO"+b),e=`if (${c}) {
${d}
}`;for(b=1;b<=a.elseifCount_;b++)c=cw.valueToCode(a,"IF"+b,99)||"false",d=cw.statementToCode(a,"DO"+b),e+=` else if (${c}) {
${d}}`;return a.elseCount_&&(d=cw.statementToCode(a,"ELSE"),e+=` else {
${d}
}`),e+"\n"},cw.forBlock.controls_repeat=function(a){let b=a.getFieldValue("TIMES"),c=cw.statementToCode(a,"DO");cw.INFINITE_LOOP_TRAP&&(c=cw.INFINITE_LOOP_TRAP.replace(/%1/g,`'${a.id}'`)+c);let d=cw.nameDB_.getDistinctName("count",i.Names.NameType.VARIABLE);return`for (int ${d} = 0; ${d} < ${b}; ${d}++) {
${c}}
`},cw.forBlock.controls_repeat_ext=function(a){let b=cw.valueToCode(a,"TIMES",14)||"0",c=cw.statementToCode(a,"DO");cw.INFINITE_LOOP_TRAP&&(c=cw.INFINITE_LOOP_TRAP.replace(/%1/g,`'${a.id}'`)+c);let d=cw.nameDB_.getName("count",i.Names.NameType.VARIABLE);return`for (int ${d} = 0; ${d} < ${b}; ${d}++) {
${c}}
`},cw.forBlock.controls_whileUntil=function(a){let b=cw.valueToCode(a,"BOOL",99)||"false",c=cw.statementToCode(a,"DO");return cw.INFINITE_LOOP_TRAP&&(c=cw.INFINITE_LOOP_TRAP.replace(/%1/g,`'${a.id}'`)+c),"UNTIL"===a.getFieldValue("MODE")&&(b.match(/^\w+$/)||(b=`(${b})`),b=`!${b}`),`while (${b}) {
${c}}
`},cw.forBlock.controls_for=function(a){let b=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE),c=cw.valueToCode(a,"FROM",14)||"0",d=cw.valueToCode(a,"TO",14)||"0",e=cw.valueToCode(a,"BY",14)||"1",f=cw.statementToCode(a,"DO");f=cw.addLoopTrap(f,a);let g="",h="",j=a.getChildren(!1)[3];for(;null!=j;)h+=j.type+",",j=j.getNextBlock();if(h.includes("digitalwrite")){let a=parseFloat(c)<=parseFloat(d),f=`  for (int ${b} = ${c}; ${b}${a?" <= ":" >= "}${d}; ${b}`,g=Math.abs(parseFloat(e));1===g?f+=a?"++":"--":f+=(a?" += ":" -= ")+g,f+=`) {
    pinMode(${b}, OUTPUT);
  }
`,cw.addSetup("io_"+b,f,!1)}if(/^-?[\d.]+(?:e-?\d+)?$/.test(c)&&/^-?[\d.]+(?:e-?\d+)?$/.test(d)&&/^-?[\d.]+(?:e-?\d+)?$/.test(e)){let a=parseFloat(c)<=parseFloat(d);g=`for (int ${b} = ${c}; ${b}${a?" <= ":" >= "}${d}; ${b}`;let h=Math.abs(parseFloat(e));1===h?g+=a?"++":"--":g+=(a?" += ":" -= ")+h,g+=`) {
${f}}
`}return g},cw.forBlock.controls_flow_statements=function(a){switch(a.getFieldValue("FLOW")){case"BREAK":return"break;\n";case"CONTINUE":return"continue;\n"}throw Error("Unknown flow statement.")},cw.forBlock.math_numbers=function(a){let b=window.parseFloat(a.getFieldValue("NUM")),c=2*(b<0);return[b.toString(),c]},cw.forBlock.math_number=function(a){let b=window.parseFloat(a.getFieldValue("NUM")),c=2*(b<0);return[b.toString(),c]};var cx={ADD:[" + ",4],MINUS:[" - ",4],MULTIPLY:[" * ",3],DIVIDE:[" / ",3],POWER:[null,99]};function cy({children:a}){return(0,c.jsx)("html",{lang:"en",className:"dark",children:(0,c.jsx)("body",{className:`${e.variable} ${g.variable} font-sans antialiased`,children:(0,c.jsx)(h.AppProvider,{children:a})})})}cw.forBlock.math_arithmetic=function(a){let b=cx[a.getFieldValue("OP")],c=b[0],d=b[1],e=cw.valueToCode(a,"A",d)||"0",f=cw.valueToCode(a,"B",d)||"0";return c?[e+c+f,d]:[`pow(${e}, ${f})`,1]},cw.forBlock.math_single=function(a){let b,c,d=a.getFieldValue("OP");if("NEG"===d)return"-"===(c=cw.valueToCode(a,"NUM",2)||"0")[0]&&(c=" "+c),[b="-"+c,2];switch(c="ABS"===d||"ROUND"===d.substring(0,5)?cw.valueToCode(a,"NUM",1)||"0":"SIN"===d||"COS"===d||"TAN"===d?cw.valueToCode(a,"NUM",3)||"0":cw.valueToCode(a,"NUM",99)||"0",d){case"ABS":b=`abs(${c})`;break;case"ROOT":b=`sqrt(${c})`;break;case"LN":b=`log(${c})`;break;case"EXP":b=`exp(${c})`;break;case"POW10":b=`pow(10,${c})`;break;case"ROUND":b=`round(${c})`;break;case"ROUNDUP":b=`ceil(${c})`;break;case"ROUNDDOWN":b=`floor(${c})`;break;case"SIN":b=`sin(${c} / 180 * M_PI)`;break;case"COS":b=`cos(${c} / 180 * M_PI)`;break;case"TAN":b=`tan(${c} / 180 * M_PI)`;break;default:switch(d){case"LOG10":return[b=`log(${c}) / log(10)`,3];case"ASIN":return[b=`asin(${c}) / M_PI * 180`,3];case"ACOS":return[b=`acos(${c}) / M_PI * 180`,3];case"ATAN":return[b=`atan(${c}) / M_PI * 180`,3];default:throw Error("Unknown math operator: "+d)}}return[b,1]},cw.forBlock.math_trig=cw.forBlock.math_single,cw.forBlock.math_round=cw.forBlock.math_single,cw.forBlock.math_constant=function(a){return({PI:["M_PI",17],E:["E",17],GOLDEN_RATIO:["(1 + sqrt(5)) / 2",3],SQRT2:["SQRT2",17],SQRT1_2:["SQRT1_2",17],INFINITY:["Infinity",0]})[a.getFieldValue("CONSTANT")]},cw.forBlock.math_number_property=function(a){let b,c=cw.valueToCode(a,"NUMBER_TO_CHECK",3)||"0",d=a.getFieldValue("PROPERTY");if("PRIME"===d){let a=["boolean "+cw.DEF_FUNC_NAME+"(int n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1.","  // And false if n is divisible by 2 or 3.","  if (isnan(n) || (n <= 1) || (n == 1) || (n % 2 == 0) || (n % 3 == 0)) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (int x = 6; x <= sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"],d=cw.addFunction("mathIsPrime",a.join("\n"));return cw.addInclude("math","#include <math.h>"),[b=`${d}(${c})`,1]}switch(d){case"EVEN":b=`${c} % 2 == 0`;break;case"ODD":b=`${c} % 2 == 1`;break;case"WHOLE":cw.addInclude("math","#include <math.h>"),b=`(floor(${c}) == ${c})`;break;case"POSITIVE":b=`${c} > 0`;break;case"NEGATIVE":b=`${c} < 0`;break;case"DIVISIBLE_BY":let e=cw.valueToCode(a,"DIVISOR",3)||"0";b=`${c} % ${e} == 0`;break;default:throw Error("Unknown property: "+d)}return[b,7]},cw.forBlock.math_change=function(a){let b=cw.valueToCode(a,"DELTA",4)||"0",c=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE);return`${c} = ${c} + ${b};
`},cw.forBlock.math_on_list=function(){return["",0]},cw.forBlock.math_modulo=function(a){let b=cw.valueToCode(a,"DIVIDEND",3)||"0",c=cw.valueToCode(a,"DIVISOR",3)||"0";return[`${b} % ${c}`,3]},cw.forBlock.math_constrain=function(a){let b=cw.valueToCode(a,"VALUE",99)||"0",c=cw.valueToCode(a,"LOW",99)||"0",d=cw.valueToCode(a,"HIGH",99)||"0";return[`(${b} < ${c} ? ${c} : ( ${b} > ${d} ? ${d} : ${b}))`,1]},cw.forBlock.math_random_int=function(a){let b=cw.valueToCode(a,"FROM",99)||"0",c=cw.valueToCode(a,"TO",99)||"0",d=["int "+cw.DEF_FUNC_NAME+"(int min, int max) {","  if (min > max) {","    // Swap min and max to ensure min is smaller.","    int temp = min;","    min = max;","    max = temp;","  }","  return min + (rand() % (max - min + 1));","}"],e=cw.addFunction("mathRandomInt",d.join("\n"));return[`${e}(${b}, ${c})`,1]},cw.forBlock.math_random_float=function(){return["(rand() / RAND_MAX)",1]},cw.forBlock.math_atan2=function(a){let b=cw.valueToCode(a,"X",99)||"0",c=cw.valueToCode(a,"Y",99)||"0";return[`atan2(${c}, ${b}) / M_PI * 180`,3]},cw.forBlock.text=function(a){return[cw.quote_(a.getFieldValue("TEXT")),0]},cw.forBlock.Simpletext=function(a){let b=a.getFieldValue("TEXT");return[`'${b}'`,0]},cw.forBlock.text_join=function(a){if(0===a.itemCount_)return['""',0];if(1===a.itemCount_)return["String("+(cw.valueToCode(a,"ADD0",1)||'""')+")",1];{let b=[];for(let c=0;c<(a.itemCount_||0);c++){let d=cw.valueToCode(a,"ADD"+c,99);""===d?b[c]='""':b[c]="String("+d+")"}return[b.join(" + "),1]}},cw.forBlock.text_length=function(a){return["String("+(cw.valueToCode(a,"VALUE",1)||'""')+").length()",1]},cw.forBlock.text_isEmpty=function(a){let b=["boolean "+cw.DEF_FUNC_NAME+"(String msg) {","  if (msg.length() == 0) {","    return true;","  } else {","    return false;","  }","}"],c=cw.addFunction("dfg",b.join("\n")),d=cw.valueToCode(a,"VALUE",1);return[c+"("+(d=""===d?'""':"String("+d+")")+")",1]},cw.forBlock.text_append=function(a){let b=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE)||'"v"',c=cw.valueToCode(a,"TEXT",1)||'"v"';return b+" += "+(c=""===c?'""':"String("+c+")")+";\n"},cw.forBlock.text_trim=function(a){let b=a.getFieldValue("MODE"),c=cw.valueToCode(a,"TEXT",1);return[(c=""===c?'""':"String("+c+")")+({LEFT:".trim()",RIGHT:".trim()",BOTH:".trim()"})[b],1]},cw.forBlock.text_print=function(a){let b=t.serial[0][1];cw.addSetup("serial_"+b,b+".begin(9600);",!1);let c=cw.valueToCode(a,"TEXT",99);return b+".print("+(c=""===c?'""':"String("+c+")")+");\n"},cw.forBlock.text_prompt_ext=function(a){let b=t.serial[0][1],c=a.getFieldValue("TYPE"),d=[],e="NUMBER"===c;e?d.push("int "+cw.DEF_FUNC_NAME+"(String msg) {"):d.push("String "+cw.DEF_FUNC_NAME+"(String msg) {"),d.push("  "+b+".println(msg);"),d.push("  boolean stringComplete = false;"),e?d.push("  int content = 0;"):d.push('  String content = "";'),d.push("  while (stringComplete == false) {"),d.push("    if ("+b+".available()) {"),e?(d.push("      content = "+b+".parseInt();"),d.push("      stringComplete = true;")):(d.push("      char readChar = (char)"+b+".read();"),d.push("      if (readChar == '\\n' || readChar == '\\r') {"),d.push("        stringComplete = true;"),d.push("      } else {"),d.push("        content += readChar;"),d.push("      }")),d.push("    }"),d.push("  }"),d.push("  // Empty incoming serial buffer"),d.push("  while(Serial.available()) { Serial.read(); };"),d.push("  return content;"),d.push("}");let f=cw.addFunction("getUserInputPrompt"+c,d.join("\n"));return cw.addSetup("serial_"+b,b+".begin(9600);",!1),[f+"("+(cw.valueToCode(a,"TEXT",99)||'""')+")",1]},cw.forBlock.array_create_with=function(a){let b=a.itemCount_||0,c=[];for(let d=0;d<b;d++)c.push(cw.valueToCode(a,"ADD"+d,15)||"null");return["{"+c.join(", ")+"}",0]},cw.forBlock.array_getIndex=function(a){let b,c=cw.valueToCode(a,"AT",16)||"1",d=cw.valueToCode(a,"VAR",17)||"[]";return b=c,/^-?[\d.]+(?:e-?\d+)?$/.test(b)&&(c=String(parseFloat(c)-1)),[d+"["+c+"]",17]},cw.forBlock.array_modify=function(a){let b=cw.valueToCode(a,"indice",0);return cw.valueToCode(a,"name",0)+"["+b+"] = "+cw.valueToCode(a,"value",0)+";\n"},cw.forBlock.array_declare=function(a){let b=cw.valueToCode(a,"contenu",14),c=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE),d=cw.getArduinoType_(k[a.getFieldValue("type")]),e=a.getFieldValue("choix"),f=a.getFieldValue("dim");switch(e){case"c1":"d2"===f?cw.variables_[c]=d+" "+c+"["+b+"]["+b+"];":cw.variables_[c]=d+" "+c+"["+b+"];";break;case"c2":if("d2"===f){let a=b.split("{"),e=a.length-2,f=a[2].split(",").length-1;cw.variables_[c]=d+" "+c+"["+e+"]["+f+"] = "+b+";"}else cw.variables_[c]=d+" "+c+"[] = "+b+";"}return""},cw.forBlock.creer_tableau=function(a){let b=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE),c=cw.getArduinoType_(k[a.getFieldValue("type")]),d=a.getFieldValue("choix"),e=a.getFieldValue("dim"),f="",g="";switch(d){case"c1":for(let b=0;b<e;b++)f+="["+cw.valueToCode(a,"D"+b,14)+"]";cw.variables_[b]=c+" "+b+f+";";break;case"c2":if("1"===e){let d=cw.valueToCode(a,"D0",14);cw.variables_[b]=c+" "+b+"[] ="+d+";"}else{f+="{";for(let b=0;b<e;b++){let c=cw.valueToCode(a,"D"+b,14),d=c.split(",");f+=c+",",g+="["+d.length+"]"}f=f.slice(0,f.length-1)+"}",cw.variables_[b]=c+" "+b+g+"="+f+";"}}return""},cw.forBlock.fixer_tableau=function(a){let b=cw.valueToCode(a,"value",0),c=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE),d=a.getFieldValue("dim");for(let b=0;b<d;b++)c+="["+cw.valueToCode(a,"D"+b,14)+"]";return c+("="+b+";\n")},cw.forBlock.tableau_getIndex=function(a){let b=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE),c=a.getFieldValue("dim");for(let d=0;d<c;d++)b+="["+cw.valueToCode(a,"D"+d,14)+"]";return[b,0]},cw.forBlock.lists_create_with=cw.forBlock.array_create_with,cw.forBlock.lists_create_empty=function(a){return["{}",0]},cw.forBlock.lists_repeat=function(a){return["/* repeat "+(cw.valueToCode(a,"ITEM",99)||"0")+" x "+(cw.valueToCode(a,"NUM",99)||"0")+" */",0]},cw.forBlock.lists_length=function(a){let b=cw.valueToCode(a,"VALUE",99)||"{}";return["sizeof("+b+") / sizeof("+b+"[0])",1]},cw.forBlock.lists_isEmpty=function(a){return["(sizeof("+(cw.valueToCode(a,"VALUE",99)||"{}")+") == 0)",7]},cw.forBlock.lists_getIndex=function(a){let b=cw.valueToCode(a,"VALUE",17)||"{}",c=a.getFieldValue("MODE"),d=a.getFieldValue("WHERE"),e=cw.valueToCode(a,"AT",99)||"1";if("FROM_START"===d){let a;a=e,e=/^-?[\d.]+(?:e-?\d+)?$/.test(a)?String(parseFloat(e)-1):"("+e+" - 1)"}else"FIRST"===d?e="0":"LAST"===d?e="sizeof("+b+") / sizeof("+b+"[0]) - 1":"RANDOM"===d&&(e="random(sizeof("+b+") / sizeof("+b+"[0]))");let f=b+"["+e+"]";return"REMOVE"===c?f+";\n":[f,17]},cw.forBlock.lists_setIndex=function(a){let b=cw.valueToCode(a,"LIST",17)||"{}",c=cw.valueToCode(a,"TO",99)||"0",d=a.getFieldValue("WHERE"),e=cw.valueToCode(a,"AT",99)||"1";if("FROM_START"===d){let a;a=e,e=/^-?[\d.]+(?:e-?\d+)?$/.test(a)?String(parseFloat(e)-1):"("+e+" - 1)"}else"FIRST"===d?e="0":"LAST"===d?e="sizeof("+b+") / sizeof("+b+"[0]) - 1":"RANDOM"===d&&(e="random(sizeof("+b+") / sizeof("+b+"[0]))");return b+"["+e+"] = "+c+";\n"},cw.forBlock.variables_get=function(a){return[cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE),0]},cw.forBlock.variables_set=function(a){let b=cw.valueToCode(a,"VALUE",14)||"0";return cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE)+" = "+b+";\n"},cw.forBlock.variables_set_type=function(a){let b=cw.valueToCode(a,"VARIABLE_SETTYPE_INPUT",14)||"0";return["("+cw.getArduinoType_(k[a.getFieldValue("VARIABLE_SETTYPE_TYPE")])+")("+b+")",0]},cw.forBlock.variables_const=function(a){let b=cw.valueToCode(a,"VALUE",14)||"0",c=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE);return cw.variables_[c]="const auto "+c+" = "+b+";",""},cw.forBlock.variables_set_init=function(a){let b=cw.valueToCode(a,"VALUE",14)||"0",c=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE),d=cw.getArduinoType_(k[a.getFieldValue("VARIABLE_SETTYPE_TYPE")]);return cw.variables_[c]=d+" "+c+" = "+b+";",""},cw.forBlock.io_VarIN=function(a){let b=a.getFieldValue("PIN")||"2",c=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE);return cw.addSetup("io_"+c,"  pinMode("+c+", INPUT);",!1),cw.variables_[c]="const int "+c+" = "+b+";",""},cw.forBlock.io_VarOut=function(a){let b=a.getFieldValue("PIN")||"2",c=cw.nameDB_.getName(a.getFieldValue("VAR"),i.Names.NameType.VARIABLE);return cw.addSetup("io_"+c,"  pinMode("+c+", OUTPUT);",!1),cw.variables_[c]="const int "+c+" = "+b+";",""},cw.forBlock.io_2Var=function(a){let b=a.getFieldValue("PIN0")||"2",c=cw.nameDB_.getName(a.getFieldValue("VAR0"),i.Names.NameType.VARIABLE),d=a.getFieldValue("PIN1")||"3",e=cw.nameDB_.getName(a.getFieldValue("VAR1"),i.Names.NameType.VARIABLE);return cw.variables_[c]="const int "+c+" = "+b+";",cw.variables_[e]="const int "+e+" = "+d+";",""},cw.forBlock.procedures_defreturn=function(a){let b=cw.nameDB_.getName(a.getFieldValue("NAME"),i.Names.NameType.PROCEDURE),c=cw.statementToCode(a,"STACK");if(cw.STATEMENT_PREFIX){let b=a.id.replace(/\$/g,"$$$$");c=cw.prefixLines(cw.STATEMENT_PREFIX.replace(/%1/g,"'"+b+"'"),cw.INDENT)+c}cw.INFINITE_LOOP_TRAP&&(c=cw.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+a.id+"'")+c);let d=cw.valueToCode(a,"RETURN",99)||"";d&&(d=cw.INDENT+"return "+d+";\n");let e=d?"int":"void",f=[];for(let b=0;b<a.arguments_.length;b++)f[b]="int "+cw.nameDB_.getName(a.arguments_[b],i.Names.NameType.VARIABLE);let g=e+" "+b+"("+f.join(", ")+") {\n"+c+d+"}\n";return g=cw.scrub_(a,g),cw.addDeclaration("%"+b,g),null},cw.forBlock.procedures_defnoreturn=cw.forBlock.procedures_defreturn,cw.forBlock.procedures_callreturn=function(a){let b=cw.nameDB_.getName(a.getFieldValue("NAME"),i.Names.NameType.PROCEDURE),c=[];for(let b=0;b<a.arguments_.length;b++)c[b]=cw.valueToCode(a,"ARG"+b,15)||"null";return[b+"("+c.join(", ")+")",1]},cw.forBlock.procedures_callnoreturn=function(a){let b=cw.nameDB_.getName(a.getFieldValue("NAME"),i.Names.NameType.PROCEDURE),c=[];for(let b=0;b<a.arguments_.length;b++)c[b]=cw.valueToCode(a,"ARG"+b,15)||"null";return b+"("+c.join(", ")+");\n"},cw.forBlock.procedures_ifreturn=function(a){let b="if ("+(cw.valueToCode(a,"CONDITION",99)||"false")+") {\n";if(a.hasReturnValue_){let c=cw.valueToCode(a,"VALUE",99)||"null";b+=cw.INDENT+"return "+c+";\n"}else b+=cw.INDENT+"return;\n";return b+"}\n"},cw.forBlock.base_begin=function(a){let b=cw.statementToCode(a,"base_begin");return cw.addSetup("base_begin_"+a.id,b,!0),""},cw.forBlock.base_setup=function(a){let b=cw.statementToCode(a,"DO");return cw.addSetup("base_setup_"+a.id,b,!0),""},cw.forBlock.pinmode=function(a){return[a.getFieldValue("PINMODE"),0]},cw.forBlock.base_define_name=function(a){return[a.getFieldValue("NAME"),0]},cw.forBlock.base_define=function(a){let b=cw.valueToCode(a,"NAME",0),c=a.getFieldValue("PIN");return cw.addInclude(b,`#define ${b} ${c}`),""},cw.forBlock.base_loop=function(a){let b=a.getInputTargetBlock("LOOP_FUNC"),c=b?cw.blockToCode(b):"";return c&&cw.addLoop("userLoopCode",c,!0),""},cw.forBlock.base_setup_loop=function(a){let b=cw.statementToCode(a,"SETUP_FUNC");b&&cw.addSetup("userSetupCode",b,!0);let c=a.getInputTargetBlock("LOOP_FUNC");return c?cw.blockToCode(c):""},cw.forBlock.base_define_bloc=function(a){let b=cw.statementToCode(a,"DO");return cw.addVariable("base_define_bloc_"+a.id,b,!0),""},cw.forBlock.base_code=function(a){return a.getFieldValue("TEXT")+"\n"},cw.forBlock.base_comment=function(a){return"// "+a.getFieldValue("TEXT")+"\n"},cw.forBlock.base_end=function(a){return"while(true);\n"},cw.forBlock.io_digitalwrite_Var=function(a){let b=cw.valueToCode(a,"VAR",0),c=a.getFieldValue("STATE")||"LOW";return cw.addSetup("io_"+b,`  pinMode(${b}, OUTPUT);`,!1),`digitalWrite(${b}, ${c});
`},cw.forBlock.io_digitalwrite=function(a){let b=a.getFieldValue("PIN"),c=cw.valueToCode(a,"STATE",0)||"LOW";return cw.reservePin(a,b,cu,"Digital Write"),cw.addSetup("io_"+b,`  pinMode(${b}, OUTPUT);`,!1),`digitalWrite(${b}, ${c});
`},cw.forBlock.io_digitalreadVar=function(a){let b=a.getFieldValue("VAR");return cw.reservePin(a,b,ct,"Digital Read"),cw.addSetup("io_"+b,`  pinMode(${b}, INPUT);`,!1),[`digitalRead(${b})`,0]},cw.forBlock.io_digitalread=function(a){let b=a.getFieldValue("PIN");return cw.reservePin(a,b,ct,"Digital Read"),cw.addSetup("io_"+b,`  pinMode(${b}, INPUT);`,!1),[`digitalRead(${b})`,0]},cw.forBlock.io_builtin_led=function(a){let b=a.getFieldValue("BUILT_IN_LED"),c=a.getFieldValue("STATE");return cw.reservePin(a,b,cu,"Set LED"),cw.addSetup("io_"+b,`  pinMode(${b}, OUTPUT);`,!1),`digitalWrite(${b}, ${c});
`},cw.forBlock.io_analogwrite=function(a){let b=a.getFieldValue("PIN"),c=cw.valueToCode(a,"NUM",0)||"0";cw.reservePin(a,b,cu,"Analogue Write"),cw.addSetup("io_"+b,`  pinMode(${b}, OUTPUT);`,!1);let d=Number(c);return!isNaN(d)&&(d<0||d>255)?a.setWarningText("The analogue value set must be between 0 and 255","pwm_value"):a.setWarningText(null,"pwm_value"),`analogWrite(${b}, ${c});
`},cw.forBlock.io_analogreadVar=function(a){let b=a.getFieldValue("VAR");return cw.reservePin(a,b,ct,"Analogue Read"),cw.addSetup("io_"+b,`  pinMode(${b}, INPUT);`,!1),[`analogRead(${b})`,0]},cw.forBlock.io_analogread=function(a){let b=a.getFieldValue("PIN");return cw.reservePin(a,b,ct,"Analogue Read"),cw.addSetup("io_"+b,`  pinMode(${b}, INPUT);`,!1),[`analogRead(${b})`,0]},cw.forBlock.io_highlow=function(a){return[a.getFieldValue("STATE"),0]},cw.forBlock.millis=function(a){return["millis()",0]},cw.forBlock.micros=function(a){return["micros()",0]},cw.forBlock.millis_sec=function(a){return["millis()/1000",0]},cw.forBlock.base_delay=function(a){let b=cw.valueToCode(a,"DELAY_TIME",0);return`delay(${b});
`},cw.forBlock.base_delay_sec=function(a){let b=cw.valueToCode(a,"DELAY_TIME",0);return`delay(${b} * 1000);
`},cw.forBlock.tempo_no_delay=function(a){let b,c=a.getFieldValue("unite"),d=cw.valueToCode(a,"DELAY_TIME",0),e=cw.statementToCode(a,"branche"),f="temps"+d;switch(cw.addDeclaration("temporisation"+d,`long ${f} = 0;`),c){case"us":b=`if ((micros()-${f}>=${d}) {
  ${f}=micros();
${e}}
`;break;case"ms":b=`if ((millis()-${f}>=${d}) {
  ${f}=millis();
${e}}
`;break;case"s":b=`if ((millis()-${f}>=${d}*1000) {
  ${f}=millis();
${e}}
`;break;default:b=""}return b},cw.forBlock.io_pulsein=function(a){let b=a.getFieldValue("PIN"),c=a.getFieldValue("STAT");return cw.addSetup("setup_input_"+b,`pinMode(${b}, INPUT);`,!0),[`pulseIn(${b},${c})`,0]},cw.forBlock.io_pulsein_timeout=function(a){let b=a.getFieldValue("PIN"),c=a.getFieldValue("STAT"),d=cw.valueToCode(a,"TIMEOUT",0)||"0";return cw.addSetup("setup_input_"+b,`pinMode(${b}, INPUT);`,!0),[`pulseIn(${b}, ${c}, ${d})`,0]},cw.forBlock.serial_init=function(a){let b=a.getFieldValue("SPEED"),c=a.getFieldValue("SERIAL");return cw.addSetup("setup_serial_speed",`  ${c}.begin(${b});`,!0),""},cw.forBlock.serial_receive=function(a){return["Serial.available() > 0",0]},cw.forBlock.serial_receive_byte=function(a){return["Serial.read()",0]},cw.forBlock.serial_write=function(a){let b=cw.valueToCode(a,"SERIAL",1);return`Serial.write(${b});
`},cw.forBlock.led_digitalwrite=function(a){let b=a.getFieldValue("PIN"),c=a.getFieldValue("STATE")||"LOW";return cw.reservePin(a,b,cu,"LED"),"j"!==b&&"i"!==b&&cw.addSetup("io_"+b,`  pinMode(${b}, OUTPUT);`,!1),`digitalWrite(${b}, ${c});
`},cw.forBlock.lcd_i2c_lcdinit=function(a){let b=a.getFieldValue("ADD")||"0x27",c=a.getFieldValue("SIZE")||"16x2",d=a.getFieldValue("Cr"),[e,f]=c.split("x").map(a=>a.trim());cw.addInclude("define_Wire","#include <Wire.h>"),cw.addInclude("define_LiquidCrystal_I2C","#include <LiquidCrystal_I2C.h>"),cw.addDeclaration("var_lcd",`LiquidCrystal_I2C lcd(${b}, ${e}, ${f});`);let g="  lcd.init();\n";return g+="  lcd.backlight();\n  lcd.noBlink();\n","TRUE"===d?g+="  lcd.cursor();\n":g+="  lcd.noCursor();\n",cw.addSetup("setup_lcd",g,!0),""},cw.forBlock.lcd_i2c_lcdclear=function(a){return"lcd.clear();\n"},cw.forBlock.lcd_i2c_lcdwrite=function(a){let b=cw.valueToCode(a,"TEXT",1)||"''",c=a.getFieldValue("Col"),d=a.getFieldValue("Row");return`lcd.setCursor(${c},${d});
lcd.print(${b});
`},cw.forBlock.Ultrasonic=function(a){let b=a.getFieldValue("PIN0")||"2",c=a.getFieldValue("PIN1")||"3",d=a.getField("VAR")?.getText()||"myUltrasonic";return cw.reservePin(a,b,cu,"Ultrasonic Trig"),cw.reservePin(a,c,ct,"Ultrasonic Echo"),cw.addInclude("includes_"+d,"#include <HCSR04.h>"),cw.addDeclaration("var_"+d,`HCSR04 ${d}(${b},${c});`),cw.addVariable(d+"1",`const int ${d}_Trig = ${b};`,!0),cw.addVariable(d+"2",`const int ${d}_Echo = ${c};`,!0),cw.addSetup("setup_input_"+b,`  pinMode(${d}_Trig, OUTPUT);`,!0),cw.addSetup("setup_input_"+c,`  pinMode(${d}_Echo, INPUT);`,!0),""},cw.forBlock.Ultrasonic_read=function(a){let b=a.getField("VAR")?.getText()||"myUltrasonic";return cw.addVariable("var1"+b,`int Distance_${b};`,!0),cw.addLoopCode("var2"+b,`Distance_${b} = ${b}.dist();`),[`Distance_${b}`,0]},cw.forBlock.SENSOR_lm35=function(a){let b=a.getFieldValue("PIN");return cw.reservePin(a,b,ct,"LM35"),cw.addVariable("var_"+b,`float Vout_${b};`,!0),cw.addVariable("var1"+b,`float Temp_${b};`,!0),cw.addSetup("lm35","analogReference(INTERNAL);",!0),cw.addLoopCode("var1"+b,`Vout_${b} = analogRead(${b});`),cw.addLoopCode("var2"+b,`Temp_${b} = (Vout_${b}*500/1023);`),[`Temp_${b}`,0]},cw.forBlock.SENSOR_dht11=function(a){let b,c=a.getFieldValue("PIN"),d=a.getFieldValue("choix");return cw.reservePin(a,c,ct,"DHT11"),cw.addInclude("dht.h","#include <DHT.h>"),cw.addDeclaration("dht",`DHT dht(${c}, DHT11);`),cw.addSetup("dht","  dht.begin();",!0),"h"===d?(cw.addVariable("var1"+c,`float Hum_${c};`,!0),cw.addLoopCode("var1"+c,`Hum_${c} = dht.readHumidity();`),b=`Hum_${c}`):(cw.addVariable("var2"+c,`float Tmp_${c};`,!0),cw.addLoopCode("var2"+c,`Tmp_${c} = dht.readTemperature();`),b=`Tmp_${c}`),[b,0]},cw.forBlock.SENSOR_line_follower=function(a){let b=a.getFieldValue("PIN");return cw.reservePin(a,b,ct,"Line Follower"),cw.addSetup("setup_input_"+b,`  pinMode(${b}, INPUT);`,!0),[`digitalRead(${b}) == HIGH`,0]},cw.forBlock.SENSOR_light_sensor=function(a){let b=a.getFieldValue("PIN");return cw.reservePin(a,b,ct,"Light Sensor"),cw.addVariable("var_"+b,`int LDRValue_${b} = 0;`,!0),cw.addLoopCode("var1"+b,`LDRValue_${b} = analogRead(${b});`),[`LDRValue_${b}`,0]},cw.forBlock.SENSOR_PIR=function(a){let b=a.getFieldValue("PIN");return cw.reservePin(a,b,ct,"PIR"),cw.addVariable("var_"+b,`bool motionState_${b} = false;`,!0),cw.addLoopCode("var1"+b,`motionState_${b} = digitalRead(${b});`),[`motionState_${b}`,0]},cw.forBlock.RFID_module=function(a){let b=a.getFieldValue("CS_PIN")||"10",c=a.getFieldValue("RST_PIN")||"9";return cw.reservePin(a,b,"SPI","RFID CS"),cw.reservePin(a,c,"SPI","RFID RST"),cw.addInclude("rfid","#include <SPI.h>"),cw.addInclude("rfid_mfrc522","#include <MFRC522.h>"),cw.addDeclaration("rfid_module",`MFRC522 mfrc522(${b}, ${c});`),cw.addSetup("rfid_init","  SPI.begin();",!0),cw.addSetup("rfid_init2","  mfrc522.PCD_Init();",!0),""},cw.forBlock.motor_servo=function(a){let b=a.getFieldValue("COMMAND")||"init",c=a.getField("VAR")?.getText()||"myServo";if(!c.trim())return"// Error: Servo variable name cannot be empty\n";switch(b){case"init":{let b=a.getFieldValue("PIN")||"9";return cw.reservePin(a,b,"SERVO","Servo"),cw.addInclude("include-Servo","#include <Servo.h>"),cw.addDeclaration("define_Servo_"+c,`Servo ${c};`),cw.addSetup("setup_Servo_"+c,`  ${c}.attach(${b});`,!0),""}case"write":{a.setWarningText(null,"Servo");let b=a.getFieldValue("ANGLE")??90;return`${c}.write(${b});
`}case"attach":return a.setWarningText(null,"Servo"),`${c}.attach();
`;case"detach":return a.setWarningText(null,"Servo"),`${c}.detach();
`;default:return""}},cw.forBlock.DC_Motor=function(a){let b=a.getFieldValue("COMMAND")||"init",c=a.getField("VAR")?.getText()||"MT";if("init"===b){let b=a.getFieldValue("PIN0"),d=a.getFieldValue("PIN1"),e=a.getFieldValue("PIN2"),f=a.getFieldValue("PIN3");return cw.reservePin(a,b,cu,"DC Motor A1"),cw.reservePin(a,d,cu,"DC Motor A2"),cw.reservePin(a,e,cu,"DC Motor B1"),cw.reservePin(a,f,cu,"DC Motor B2"),cw.addInclude("init-motor",`int ${c}A1  = ${b};
int ${c}A2 = ${d};
int ${c}B1 = ${e};
int ${c}B2 = ${f};`),cw.addSetup("setup_motor",`pinMode(${c}A1, OUTPUT);
  pinMode(${c}A2, OUTPUT);
  pinMode(${c}B1, OUTPUT);
  pinMode(${c}B2, OUTPUT);`,!0),cw.addFunction("FuncForward",`void ${c}_Forward(){
  digitalWrite(${c}A1, LOW);
  digitalWrite(${c}A2, HIGH);
  digitalWrite(${c}B1, LOW);
  digitalWrite(${c}B2, HIGH);
}`),cw.addFunction("FuncBackward",`void ${c}_Backward(){
  digitalWrite(${c}A1, HIGH);
  digitalWrite(${c}A2, LOW);
  digitalWrite(${c}B1, HIGH);
  digitalWrite(${c}B2, LOW);
}`),cw.addFunction("FuncLeft",`void ${c}_Left(){
  digitalWrite(${c}A1, HIGH);
  digitalWrite(${c}A2, LOW);
  digitalWrite(${c}B1, LOW);
  digitalWrite(${c}B2, HIGH);
}`),cw.addFunction("FuncRight",`void ${c}_Right(){
  digitalWrite(${c}A1, LOW);
  digitalWrite(${c}A2, HIGH);
  digitalWrite(${c}B1, HIGH);
  digitalWrite(${c}B2, LOW);
}`),cw.addFunction("FuncStop",`void ${c}_Stop(){
  digitalWrite(${c}A1, LOW);
  digitalWrite(${c}A2, LOW);
  digitalWrite(${c}B1, LOW);
  digitalWrite(${c}B2, LOW);
}`),""}return a.setWarningText(null,"DC Motor"),`${c}_${b}();
`},cw.forBlock.switch_button_read=function(a){let b=a.getFieldValue("PIN");return cw.addVariable("button"+b,`bool buttonState_${b} = false;`,!0),cw.addLoopCode("button1"+b,`buttonState_${b} = digitalRead(${b});`),[`buttonState_${b}`,0]},cw.forBlock.bluetooth_init=function(a){let b=a.getFieldValue("PIN0"),c=a.getFieldValue("PIN1"),d=a.getFieldValue("SPEED");return cw.reservePin(a,b,cv,"Bluetooth TX"),cw.reservePin(a,c,cv,"Bluetooth RX"),cw.addInclude("bluetooth_Soft","#include <SoftwareSerial.h>"),cw.addInclude("bluetooth_init",`SoftwareSerial BT(${c}, ${b}); // RX, TX`),cw.addSetup("setup_bluetooth",`  BT.begin(${d});`,!0),""},cw.forBlock.bluetooth_receive=function(a){return["BT.available() > 0",0]},cw.forBlock.bluetooth_receive_byte=function(a){return["BT.read()",0]},cw.forBlock.bluetooth_write=function(a){let b=cw.valueToCode(a,"BT",1);return`BT.write(${b});
`},a.s(["default",()=>cy,"metadata",0,{title:"Hduino - Visual Arduino Programming",description:"A visual block-based programming environment for Arduino. Build, program, and upload your Arduino projects with ease.",keywords:["arduino","blockly","visual programming","embedded systems","electronics"]}],77930)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5e0af9e2._.js.map