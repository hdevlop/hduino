{"version":3,"sources":["../src/arduino/generator.ts"],"sourcesContent":["import * as Blockly from 'blockly/core';\nimport { getArduinoType, ArduinoType } from './types';\n\n/**\n * Order of operation ENUMs for Arduino code generation\n */\nexport enum Order {\n  ATOMIC = 0,            // 0 \"\" ...\n  UNARY_POSTFIX = 1,     // expr++ expr-- () [] .\n  UNARY_PREFIX = 2,      // -expr !expr ~expr ++expr --expr\n  MULTIPLICATIVE = 3,    // * / % ~/\n  ADDITIVE = 4,          // + -\n  SHIFT = 5,             // << >>\n  RELATIONAL = 6,        // is is! >= > <= <\n  EQUALITY = 7,          // == != === !==\n  BITWISE_AND = 8,       // &\n  BITWISE_XOR = 9,       // ^\n  BITWISE_OR = 10,       // |\n  LOGICAL_AND = 11,      // &&\n  LOGICAL_OR = 12,       // ||\n  CONDITIONAL = 13,      // expr ? expr : expr\n  ASSIGNMENT = 14,       // = *= /= ~/= %= += -= <<= >>= &= ^= |=\n  COMMA = 15,            // ,\n  UNARY_NEGATION = 16,\n  MEMBER = 17,\n  FUNCTION_CALL = 1,     // Mapping for function calls\n  NONE = 99,             // (...)\n}\n\n/**\n * Pin type constants for Arduino pin management\n */\nexport const PinTypes = {\n  INPUT: 'INPUT',\n  OUTPUT: 'OUTPUT',\n  PWM: 'PWM',\n  SERVO: 'SERVO',\n  STEPPER: 'STEPPER',\n  SERIAL: 'SERIAL',\n  I2C: 'I2C/TWI',\n  SPI: 'SPI',\n} as const;\n\nexport type PinType = typeof PinTypes[keyof typeof PinTypes];\n\n/**\n * Code sections storage interface\n */\ninterface CodeSections {\n  includes_: Record<string, string>;\n  definitions_: Record<string, string>;\n  variables_: Record<string, string>;\n  codeFunctions_: Record<string, string>;\n  userFunctions_: Record<string, string>;\n  functionNames_: Record<string, string>;\n  setups_: Record<string, string>;\n  loops_: Record<string, string>;\n  pins_: Record<string, PinType>;\n  loopCode_: Record<string, string>;\n  nameDB_?: Blockly.Names;\n}\n\n/**\n * Arduino code generator class\n */\nexport class ArduinoGenerator extends Blockly.Generator {\n  // Allow dynamic property assignment for block generators\n  [key: string]: any;\n\n  protected includes_: Record<string, string> = {};\n  protected definitions_: Record<string, string> = {};\n  variables_: Record<string, string> = {};\n  protected codeFunctions_: Record<string, string> = {};\n  protected userFunctions_: Record<string, string> = {};\n  protected functionNames_: Record<string, string> = {};\n  protected setups_: Record<string, string> = {};\n  protected loops_: Record<string, string> = {};\n  protected pins_: Record<string, { pinType: PinType; blockId: string; blockLabel: string }> = {};\n  protected loopCode_: Record<string, string> = {};\n  declare nameDB_?: Blockly.Names;\n\n  // Infinite loop trap for loop detection\n  INFINITE_LOOP_TRAP: string | null = null;\n\n  // Order constants\n  ORDER_ATOMIC = Order.ATOMIC;\n  ORDER_UNARY_POSTFIX = Order.UNARY_POSTFIX;\n  ORDER_UNARY_PREFIX = Order.UNARY_PREFIX;\n  ORDER_MULTIPLICATIVE = Order.MULTIPLICATIVE;\n  ORDER_ADDITIVE = Order.ADDITIVE;\n  ORDER_SHIFT = Order.SHIFT;\n  ORDER_RELATIONAL = Order.RELATIONAL;\n  ORDER_EQUALITY = Order.EQUALITY;\n  ORDER_BITWISE_AND = Order.BITWISE_AND;\n  ORDER_BITWISE_XOR = Order.BITWISE_XOR;\n  ORDER_BITWISE_OR = Order.BITWISE_OR;\n  ORDER_LOGICAL_AND = Order.LOGICAL_AND;\n  ORDER_LOGICAL_OR = Order.LOGICAL_OR;\n  ORDER_CONDITIONAL = Order.CONDITIONAL;\n  ORDER_ASSIGNMENT = Order.ASSIGNMENT;\n  ORDER_COMMA = Order.COMMA;\n  ORDER_UNARY_NEGATION = Order.UNARY_NEGATION;\n  ORDER_MEMBER = Order.MEMBER;\n  ORDER_FUNCTION_CALL = Order.FUNCTION_CALL;\n  ORDER_NONE = Order.NONE;\n\n  DEF_FUNC_NAME: string;\n\n  constructor() {\n    super('Arduino');\n\n    this.DEF_FUNC_NAME = this.FUNCTION_NAME_PLACEHOLDER_;\n\n    // Add reserved words\n    this.addReservedWords(\n      'Blockly,' +\n      'setup,loop,if,else,for,switch,case,while,do,break,continue,return,goto,' +\n      'define,include,HIGH,LOW,INPUT,OUTPUT,INPUT_PULLUP,true,false,integer,' +\n      'constants,floating,point,void,boolean,char,unsigned,byte,int,word,long,' +\n      'float,double,string,String,array,static,volatile,const,sizeof,pinMode,' +\n      'digitalWrite,digitalRead,analogReference,analogRead,analogWrite,tone,' +\n      'noTone,shiftOut,shitIn,pulseIn,millis,micros,delay,delayMicroseconds,' +\n      'min,max,abs,constrain,map,pow,sqrt,sin,cos,tan,randomSeed,random,' +\n      'lowByte,highByte,bitRead,bitWrite,bitSet,bitClear,bit,attachInterrupt,' +\n      'detachInterrupt,interrupts,noInterrupts'\n    );\n  }\n\n  /**\n   * Initialize the code generator for a workspace\n   */\n  init(workspace: Blockly.Workspace): void {\n    this.includes_ = Object.create(null);\n    this.definitions_ = Object.create(null);\n    this.variables_ = Object.create(null);\n    this.codeFunctions_ = Object.create(null);\n    this.userFunctions_ = Object.create(null);\n    this.functionNames_ = Object.create(null);\n    this.setups_ = Object.create(null);\n    this.loops_ = Object.create(null);\n    this.pins_ = Object.create(null);\n    this.loopCode_ = Object.create(null);\n\n    if (!this.nameDB_) {\n      this.nameDB_ = new Blockly.Names(this.RESERVED_WORDS_);\n    } else {\n      this.nameDB_.reset();\n    }\n\n    this.nameDB_.setVariableMap(workspace.getVariableMap());\n    this.nameDB_.populateVariables(workspace);\n    this.nameDB_.populateProcedures(workspace);\n\n    // Initialize variables\n    const defvars: string[] = [];\n    const variables = Blockly.Variables.allDeveloperVariables(workspace);\n    for (let x = 0; x < variables.length; x++) {\n      defvars[x] = `int ${this.nameDB_.getName(variables[x], Blockly.Names.NameType.VARIABLE)};\\n`;\n    }\n    this.definitions_['variables'] = defvars.join('\\n');\n  }\n\n  /**\n   * Finalize code generation and assemble final Arduino sketch\n   */\n  finish(code: string): string {\n    const includes: string[] = [];\n    const definitions: string[] = [];\n    const variables: string[] = [];\n    const functions: string[] = [];\n    const loopCode: string[] = [];\n\n    // Collect loop code\n    for (const name in this.loopCode_) {\n      loopCode.push(this.loopCode_[name]);\n    }\n\n    // Collect includes\n    for (const name in this.includes_) {\n      includes.push(this.includes_[name]);\n    }\n    if (includes.length) {\n      includes.push('\\n');\n      // Remove duplicates\n      const uniqueIncludes = [...new Set(includes)];\n      includes.length = 0;\n      includes.push(...uniqueIncludes);\n    }\n\n    // Collect variables\n    for (const name in this.variables_) {\n      variables.push(this.variables_[name]);\n    }\n    if (variables.length) {\n      variables.push('\\n');\n    }\n\n    // Collect definitions\n    for (const name in this.definitions_) {\n      definitions.push(this.definitions_[name]);\n    }\n    if (definitions.length) {\n      definitions.push('\\n');\n    }\n\n    // Collect functions\n    for (const name in this.codeFunctions_) {\n      functions.push(this.codeFunctions_[name]);\n    }\n    for (const name in this.userFunctions_) {\n      functions.push(this.userFunctions_[name]);\n    }\n    if (functions.length) {\n      functions.push('\\n');\n    }\n\n    // Collect setup code\n    const setups: string[] = [''];\n    let userSetupCode = '';\n    if (this.setups_['userSetupCode'] !== undefined) {\n      userSetupCode = this.setups_['userSetupCode'];\n      delete this.setups_['userSetupCode'];\n    }\n    for (const name in this.setups_) {\n      setups.push(this.setups_[name]);\n    }\n    if (userSetupCode) {\n      setups.push(userSetupCode);\n    }\n    const filteredSetups = setups.filter((e) => e);\n\n    // Collect loop code\n    let loops = '';\n    if (this.loops_['userLoopCode'] !== undefined) {\n      loops = '\\n' + this.loops_['userLoopCode'];\n      delete this.loops_['userLoopCode'];\n    }\n\n    // Clean up temporary data\n    this.nameDB_?.reset();\n\n    // Assemble final code\n    const allDefs = includes.join('\\n') + definitions.join('\\n') + variables.join('\\n') + functions.join('\\n');\n    const setup = 'void setup() {\\n' + filteredSetups.join('\\n') + '\\n}\\n\\n';\n    const loop = 'void loop() {\\n  ' + loopCode.join('\\n  ') + loops.replace(/\\n/g, '\\n  ') + '\\n}\\n\\n';\n\n    return allDefs + setup + loop;\n  }\n\n  /**\n   * Add an include statement\n   */\n  addInclude(includeTag: string, code: string): void {\n    if (this.includes_[includeTag] === undefined) {\n      this.includes_[includeTag] = code;\n    }\n  }\n\n  /**\n   * Add a global declaration\n   */\n  addDeclaration(declarationTag: string, code: string): void {\n    if (this.definitions_[declarationTag] === undefined) {\n      this.definitions_[declarationTag] = code;\n    }\n  }\n\n  /**\n   * Add a global variable\n   */\n  addVariable(varName: string, code: string, overwrite = false): boolean {\n    let overwritten = false;\n    if (overwrite || this.variables_[varName] === undefined) {\n      this.variables_[varName] = code;\n      overwritten = true;\n    }\n    return overwritten;\n  }\n\n  /**\n   * Add code to setup() function\n   */\n  addSetup(setupTag: string, code: string, overwrite = false): boolean {\n    let overwritten = false;\n    if (overwrite || this.setups_[setupTag] === undefined) {\n      this.setups_[setupTag] = code;\n      overwritten = true;\n    }\n    return overwritten;\n  }\n\n  /**\n   * Add code to loop() function\n   */\n  addLoop(loopTag: string, code: string, overwrite = false): boolean {\n    let overwritten = false;\n    if (overwrite || this.loops_[loopTag] === undefined) {\n      this.loops_[loopTag] = code;\n      overwritten = true;\n    }\n    return overwritten;\n  }\n\n  /**\n   * Add a function definition\n   */\n  addFunction(preferredName: string, code: string): string {\n    if (this.codeFunctions_[preferredName] === undefined) {\n      const uniqueName = this.nameDB_!.getDistinctName(\n        preferredName,\n        Blockly.Names.NameType.PROCEDURE\n      );\n      this.codeFunctions_[preferredName] = code.replace(this.DEF_FUNC_NAME, uniqueName);\n      this.functionNames_[preferredName] = uniqueName;\n    }\n    return this.functionNames_[preferredName];\n  }\n\n  /**\n   * Reserve a pin for a specific use and check for conflicts\n   */\n  reservePin(block: Blockly.Block, pin: string, pinType: PinType, warningTag: string): void {\n    if (this.pins_[pin] !== undefined) {\n      const existing = this.pins_[pin];\n      if (existing.blockId !== block.id) {\n        block.setWarningText(\n          `Pin ${pin} is already used by \"${existing.blockLabel}\"`,\n          warningTag\n        );\n      } else {\n        block.setWarningText(null, warningTag);\n      }\n    } else {\n      this.pins_[pin] = { pinType, blockId: block.id, blockLabel: block.type };\n      block.setWarningText(null, warningTag);\n    }\n  }\n\n  /**\n   * Naked values have their tab removed and end with a semicolon\n   */\n  scrubNakedValue(line: string): string {\n    return line + ';\\n';\n  }\n\n  /**\n   * Encode a string for Arduino\n   */\n  quote_(string: string): string {\n    string = string\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\\n/g, '\\\\\\n')\n      .replace(/\\$/g, '\\\\$')\n      .replace(/'/g, \"\\\\'\");\n    return '\"' + string + '\"';\n  }\n\n  /**\n   * Common scrubbing for blocks\n   */\n  scrub_(block: Blockly.Block, code: string): string {\n    if (code === null) {\n      return '';\n    }\n\n    let commentCode = '';\n    if (!block.outputConnection || !block.outputConnection.targetConnection) {\n      const comment = block.getCommentText();\n      if (comment) {\n        commentCode += this.prefixLines(comment, '// ') + '\\n';\n      }\n\n      for (let x = 0; x < block.inputList.length; x++) {\n        // Modern Blockly: Check if input has a connection of type INPUT_VALUE\n        const input = block.inputList[x];\n        if (input.connection && input.connection.type === Blockly.ConnectionType.INPUT_VALUE) {\n          const childBlock = input.connection.targetBlock();\n          if (childBlock) {\n            const childComment = this.allNestedComments(childBlock);\n            if (childComment) {\n              commentCode += this.prefixLines(childComment, '// ');\n            }\n          }\n        }\n      }\n    }\n\n    const nextBlock = block.nextConnection?.targetBlock();\n    const nextCode = this.blockToCode(nextBlock);\n    return commentCode + code + nextCode;\n  }\n\n  /**\n   * Add code to execute every loop iteration (before main loop body)\n   */\n  addLoopCode(tag: string, code: string): void {\n    this.loopCode_[tag] = code;\n  }\n\n  /**\n   * Add loop trap code if INFINITE_LOOP_TRAP is set\n   */\n  addLoopTrap(branch: string, block: Blockly.Block): string {\n    if (this.INFINITE_LOOP_TRAP) {\n      return this.INFINITE_LOOP_TRAP.replace(/%1/g, `'${block.id}'`) + branch;\n    }\n    return branch;\n  }\n\n  /**\n   * Convert Arduino type to C++ type string\n   */\n  getArduinoType_(type: ArduinoType): string {\n    return getArduinoType(type);\n  }\n\n  /**\n   * Helper functions for no generator code\n   */\n  noGeneratorCodeInline(): [string, number] {\n    return ['', this.ORDER_ATOMIC];\n  }\n\n  noGeneratorCodeLine(): string {\n    return '';\n  }\n}\n\n// Create singleton instance\nexport const arduinoGenerator = new ArduinoGenerator();\n"],"mappings":"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","names":["Order"]}